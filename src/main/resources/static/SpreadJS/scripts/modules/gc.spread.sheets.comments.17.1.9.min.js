/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var o,i,t;function e(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},o[t].call(n.exports,n,n.exports,e)),n.exports}o={"./dist/plugins/comment/comment-actions.js":function(R,t,n){var o,i,c,a,e,u,r,n,s,f,h,l,v,m,d,p,w,g,b,_,C,y,x,k,S,M,N,j,z;function F(t,n,o){var i,e,r,i=!1,e=t.Ut.pI.pZ();return e?(r=e.location(),t.Qy().execute({cmd:v,sheetName:t.name(),row:e.bZ,col:e.yZ,oldValue:r.clone(),newValue:new c.Point(r.x+n,r.y+o),propertyName:"location"})):i}function D(t){var n=t.comment;n&&(r(t.row)||r(t.col))&&(t.row=n.bZ,t.col=n.yZ)}function T(t,n){var o=N.call(this)||this;return D(n),o.Mf=t,o.tT=n,o}function V(t,n){var o=j.call(this)||this;return D(n),o.Mf=t,o.tT=n,o}function O(t,n){var o,i,e;if((n?t.canUndo():t.canExecute())&&(o=t.wZ)){for(i=0;i<o.length;i++)(e=o[i])&&(n?e.undo():e.execute());return!0}return!1}function I(t,n){var o,i,e,r,o=z.call(this)||this,i=o;if(i.wZ=[],i.Mf=t,e=(i.tT=n).commands)for(r=0;r<e.length;r++)i.add(e[r]);return o}o=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CommentPropertyUndoAction=t.CommentDeleteUndoAction=void 0,i=n("Common"),c=n("Core"),a=n("Core"),e=c.GC$,u=c.Events,r=i.Common.lt.ht,n=a.Commands.ActionBase,s="deleteComment",f="deleteCommentByKey",h="deleteCommentByBackspaceKey",l="deactivateComment",v="moveComment",m="moveCommentUp",d="moveCommentDown",p="moveCommentLeft",w="moveCommentRight",g="changeComment",b="changeCommentTransaction",_=null,C=a.Commands.zA,o(T,N=n),T.prototype.execute=function(){var t,n,o,i,e,r,r,t=this;return!!t.canExecute()&&(n=t.Mf,t.X5(n,!0),o=n.comments.get(t.tT.row,t.tT.col),e=(i=n.Ut).pI,r={sheet:n,sheetName:n.name(),comment:o,cancel:!1},n.ki(u.CommentRemoving,r),r.cancel||(i.startTransaction(),e.remove(o.bZ,o.yZ),e.MZ=_,n.cR(),n.ki(u.CommentRemoved,{sheet:n,sheetName:n.name(),comment:o}),r=a.Commands.TI(n.name()),t.tT[r]=i.endTransaction()),t.q5(n,!0),!0)},T.prototype.undo=function(){var t,n,o,t=this,n=t.Mf;return t.X5(n,!0),o=a.Commands.TI(n.name()),n.Ut.undo(t.tT[o]),n.e4(),t.q5(n,!0),!0},t.CommentDeleteUndoAction=y=T,o(V,j=n),V.prototype.execute=function(){var t,n,o,i,e,t=this,n=t.tT,o=t.Mf,i=o.comments.get(n.row,n.col);return!(!t.canExecute()||!i||(t.X5(o,!0),i[e=n.propertyName](n.newValue),"location"===e&&(n.displayMode?i.displayMode(n.displayMode):n.displayMode=i.displayMode()),t.q5(o,!0),0))},V.prototype.undo=function(){var t,n,o,i,t=this,n=t.tT,o=t.Mf;return t.X5(o,!0),!!(i=o.comments.get(n.row,n.col))&&(i[n.propertyName](n.oldValue),t.q5(o,!0),!0)},V.prototype.toJSON=function(){return this.tT},t.CommentPropertyUndoAction=x=V,a.Commands.ChangeComment=x,o(I,z=n),I.prototype.execute=function(){return O(this,!1)},I.prototype.undo=function(){return O(this,!0)},I.prototype.add=function(t){this.wZ.push(t)},k=I,a.Commands[f]={canUndo:!1,execute:function(t,n){var t,n,t=a.Commands.Tp(t,n),n=t.Ut.pI.pZ();return!!n&&t.Qy().execute({cmd:s,sheetName:t.name(),row:n.bZ,col:n.yZ})}},a.Commands[l]={canUndo:!1,execute:function(t,n){var t,n,t=a.Commands.Tp(t,n),n=t.Ut.pI;return!!n.pZ()&&(n.CZ(),t.cR(),t.repaint(),!0)}},a.Commands[m]={canUndo:!1,execute:function(t,n){var o;return F(a.Commands.Tp(t,n),0,-1)}},a.Commands[d]={canUndo:!1,execute:function(t,n){var o;return F(a.Commands.Tp(t,n),0,1)}},a.Commands[p]={canUndo:!1,execute:function(t,n){var t=a.Commands.Tp(t,n);return F(t,t.options.rightToLeft?1:-1,0)}},a.Commands[w]={canUndo:!1,execute:function(t,n){var t=a.Commands.Tp(t,n);return F(t,t.options.rightToLeft?-1:1,0)}},a.Commands[s]={canUndo:!0,execute:function(t,n,o){return C(t,y,n,o)}},a.Commands[v]={canUndo:!0,execute:function(t,n,o){return C(t,x,n,o)}},a.Commands[g]={canUndo:!0,execute:function(t,n,o){return C(t,x,n,o)}},a.Commands[b]={canUndo:!0,execute:function(t,n,o){return C(t,k,n,o)}},a.Commands.SZ=S=function(t){t.register(f,a.Commands[f],46,!1,!1,!1,!1),t.register(h,a.Commands[f],8,!1,!1,!1,!1),t.register(l,a.Commands[l],27,!1,!1,!1,!1),t.register(m,a.Commands[m],38,!1,!1,!1,!1),t.register(d,a.Commands[d],40,!1,!1,!1,!1),t.register(p,a.Commands[p],37,!1,!1,!1,!1),t.register(w,a.Commands[w],39,!1,!1,!1,!1),t.register(s,a.Commands[s]),t.register(g,a.Commands[g]),t.register(b,a.Commands[b]),t.register(v,a.Commands[v])}},"./dist/plugins/comment/comment-touch.js":function(t,n,o){var i,n,e,c,r,a,u,o,s,f,h,l,v,m,d;function p(t,n){return v.call(this,t,n)||this}function w(t,n,o){return m.call(this,t,n,o,new h(t,n))||this}function g(t,n,o){return d.call(this,t,n,o,new u(t,n))||this}function b(t,n,o,i){var e,r,n,e=this,r=e.TZ=n.TZ;e.AZ=new c.IZ(e),e.xZ=new c.NZ(t,"Comment"+r.bZ+r.yZ,e.AZ,2,200),e.kZ=o,e.DZ=i,(n=e.xZ)._Z=function(){return 3!==r.commentState()},n.EZ=function(){return!0},n.jZ=function(t){return i.OZ(t)},n.RZ=function(t){return i.BZ(t)},n.LZ=function(t){return i.FZ(t)},n.PZ=function(t){return i.GZ(t)},n.UZ=function(t){return i.HZ(t)}}function _(t,n){var o=this;o.zZ=t,o.VZ=n,o.TZ=n.TZ,o.Mf=o.TZ.Mf,o.YZ=new c.ZZ(o.Mf)}i=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),Object.defineProperty(n,"__esModule",{value:!0}),n=o("Core"),e=o("./dist/plugins/comment/comment.js"),c=o("Touch"),n.Of.touch&&(r=n.GC$,a=n.mt.vi,_.prototype.WZ=function(t){var t,n,o,t=new c.QZ(t.X,t.Y),n=r(this.zZ).offset();return n&&(o=document.body,t.X+=n.left+o.clientLeft||0,t.Y+=n.top+o.clientTop||0),t},_.prototype.OZ=function(t){t.KZ=35},_.prototype.BZ=function(t){var n,o,n=this,o=n.WZ(t.JZ);n.VZ.XZ({target:t.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),n.YZ.$Z()},_.prototype.FZ=function(t){var n,o,i,e,e,i,n=this,o=t.nW.tW,i=n.Mf,e=i.parent;1!==o&&e&&e.options.allowUserZoom?(i.rt.s9=!1,e=n.VZ,r(e.eW).remove(),n.YZ.iW(o)):(i=n.WZ(t.JZ),n.VZ.pg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}))},_.prototype.GZ=function(t){var n,o,i,e,e,n=this,o=t.nW.tW,i,e=n.Mf.parent;1!==o&&e&&e.options.allowUserZoom?n.YZ.rW(o):(e=n.WZ(t.JZ),n.VZ.bg({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}))},_.prototype.HZ=function(t){var n=this,o=n.TZ,n=n.Mf;try{n.suspendPaint(),3===o.commentState()?o.commentState(1):1===o.commentState()&&o.commentState(2)}finally{n.resumePaint()}},u=_,b.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},b.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},b.prototype.sW=function(t){return this.AZ.sW()},b.prototype.cW=function(t){return this.AZ.cW()},b.prototype.fW=function(t){return this.AZ.fW()},i(g,d=o=b),s=g,i(w,m=o),f=w,i(p,v=u),p.prototype.BZ=function(t){var n,o,n=this,o=n.WZ(t.JZ);n.VZ.lW({target:t.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),n.YZ.$Z()},h=p,e.hW.ch("touch",{init:function(t){var n,o,i,n=this,o,i=n.TZ.Mf.parent.kZ;n.dW=new s(t[0],n,i),n.dW.oW(),n.vW=new f(t[1],n,i),n.vW.oW()},detachEditor:function(t){var n=this,o=n.TZ.Mf;n.vW=new f(t,n,o.parent.kZ),n.vW.oW()},preProcessMouseDownEdit:function(t){var n,o,n=t.e,o=this.vW;o&&!n.isTouch&&o.sW(n)&&(a(n),t.r=!0)},preProcessMouseDownDragResize:function(t){var n,o,n=t.e,o=this.dW;o&&!n.isTouch&&o.sW(n)&&(a(n),t.r=!0)},preProcessMouseMove:function(t){var n,o,i,e,n=t.e,o=n.isTouch,i=this.dW,e=this.vW;i&&!o&&i.fW(n)&&(a(n),t.r=!0),e&&!o&&e.fW(n)&&(a(n),t.r=!0)},preProcessMouseUp:function(t){var n,o,i,e,n=t.e,o=n.isTouch,i=this.dW,e=this.vW;i&&!o&&i.cW(n)&&(a(n),t.r=!0),e&&!o&&e.cW(n)&&(a(n),t.r=!0)},dispose:function(){var t=this;t.dW.uW(),t.dW=null,t.vW.uW(),t.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(t,n,o){var i,e,i=this&&this.__createBinding||(Object.create?function(t,n,o,i){void 0===i&&(i=o);var e=Object.getOwnPropertyDescriptor(n,o);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[o]}}),Object.defineProperty(t,i,e)}:function(t,n,o,i){t[i=void 0===i?o:i]=n[o]}),e=this&&this.__exportStar||function(t,n){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(n,o)||i(n,t,o)};Object.defineProperty(n,"__esModule",{value:!0}),e(o("./dist/plugins/comment/comment.js"),n),e(o("./dist/plugins/comment/comment-actions.js"),n),o("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(i,t,P){var U,u,x,L,l,v,A,p,E,G,W,M,B,P,e,H,J,X,w,Y,s,K,N,q,$,Q,Z,tt,nt,ot,it,h,et,k,S,rt,ct,at,ut,st,ft,ht,lt,vt,mt,dt,pt,wt,gt,bt,_t,Ct,yt,xt,g,b,kt,St,m,d,r,c,a,Mt,Nt,jt,zt,Ft,Dt,Tt,f,_,Vt,Ot,It,C,y,j,z,Rt,Pt,Ut,Lt,At,Et,Gt,Wt,Bt,Ht,Jt,Xt,Yt,Kt,qt,$t,Qt,Zt,F,tn,nn,on,en,rn,cn,an,un,sn,fn,hn,ln,vn,mn,dn,pn,D,wn,gn,bn,_n,Cn,yn,xn,kn,Sn,Mn,Nn,n,jn,zn,n,n,n;function T(t,n){return new x.Point(t,n)}function V(t,n,o,i){return new x.Rect(t,n,o,i)}function O(t){return t.height}function I(t){return t.width}function Fn(t,n){var o=t.options;return!t.isActualProtected()||o.protectionOptions.allowEditObjects||n&&!n.locked()}function Dn(t){return Math.abs(t-9)<.001}function Tn(t,n){var o=t.options;return!t.isActualProtected()||o.protectionOptions.allowEditObjects||n&&!n.lockText()}function Vn(t){var n=96,o=72,i=37.7952755905512;try{return-1!==t.indexOf("pt")?parseFloat(t.replace("pt","")):-1!==t.indexOf("in")?72*parseFloat(t.replace("in","")):-1!==t.indexOf("cm")?parseFloat(t.replace("cm",""))*i*72/96:parseFloat(t)}catch(t){return 0}}function On(t,o,i){function n(t){var t,n,t,t=S(t,"ClientData"),n=parseInt(S(t,"Row").c_[0],10),t=parseInt(S(t,"Column").c_[0],10);return n===o&&t===i}return t.filter(n)[0]}function In(t){var t=S(t,"ClientData");return t&&"Note"===t.ObjectType}function Rn(t){return t&&t.c_?t.c_.filter(In):[]}function Pn(t,n){for(var o,i,e,r,c,a,o=t.defaults.rowHeight,i=0,e=0,c=t.getRowCount()||x.XmlConstants.Io;i<n&&e<c;)i+=r=t.Ut.getSize(!0,3,e)||o,e++;return 0<(a=i-n)?(e--,(a=r-a)<0&&(e+=1)):(a=n-i,e+=1),{row:e,rowOffset:a}}function Un(t,n){for(var o,i,e,r,c,a,o=t.defaults.colWidth,i=0,e=0,c=t.getColumnCount()||x.XmlConstants.xo;i<n&&e<c;)i+=r=t.Ut.getSize(!1,3,e)||o,e++;return 0<(a=i-n)?(e--,(a=r-a)<0&&(e+=1)):(a=n-i,e+=1),{col:e,colOffset:a}}function Ln(t,n){if(!k(n))return"double";if(t)switch(t.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function An(t){var n,o;if(t)switch(t.toLowerCase()){case"solid":n="solid";break;case"dotted":n="1 1";break;case"dashed":n="dash";break;case"double":o="thinThin"}return{dashStyle:n,lineStyle:o}}function En(t,n){var o,t,i,e,o=n.location()||{x:9,y:-18},t=Gn(t,n),i=["position:absolute"],e=h(t.x+o.x+7);return 0<=e&&i.push("margin-left:"+e+"pt"),0<=(e=h(t.y+o.y+7))&&i.push("margin-top:"+e+"pt"),(e=h(n.width()-14)+"pt")&&i.push("width:"+e),(e=h(n.height()-14)+"pt")&&i.push("height:"+e),i.push("z-index:"+n.zIndex()),i.push("visibility:"+(1===n.displayMode()?"visible":"hidden")),i.join(";")}function Gn(t,n){var o,n,i,e,r,o=n.bZ,n=n.yZ,i=t.getSpan(o,n);return i&&(n=i.col+i.colCount-1),{x:e=ot(t,0,n+1),y:r=et(t,0,o)}}function Wn(t){var n=x.ColorHelper.convertColorToHex(t);return n&&"string"==typeof n&&2<n.length?"#"+n.substring(2).toLowerCase():t}function Bn(t,n){var t=(t||"").trim().split(n);return{key:t[0],value:t[1]}}function Hn(t,n,o,i,e){var r,c,a,u,s,f,h,t,r,c=this.Ut.pI;if(t&&c)for(u=c.all(),s=0;s<u.length;s++)f=(a=u[s]).bZ,h=a.yZ,f===n&&h===o||n<=f&&f<n+i&&o<=h&&h<o+e&&c.remove(f,h);(a=c.get(n,o))&&(t=c.mW(a))&&t.gW()}function Jn(){var t=this,n=t.pW&&t.pW();n&&n.bW(t)}function Xn(t,n,o){var i=this,i=i.pW&&i.pW();i&&i.yW(t,n,o)}function Yn(t,n){var o,i,n,o=-1,i=-1;n&&0<=n.rowViewportIndex&&0<=n.colViewportIndex&&(o=n.row,i=n.col),!t.parent||o<0||i<0||(n=t.Ut.pI.get(o,i),t.Ut.pI.wW(n))}function Kn(t,n){return t&&t.getRowHeight(n)}function qn(t,n){return t&&t.getColumnWidth(n)}function $n(t,n){return t&&t.getViewportLeftColumn(n)}function Qn(t,n){return t&&t.getViewportTopRow(n)}function Zn(t,n,o,i){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=t||0:(e.top=t,e.right=n,e.bottom=o,e.left=i)}function to(t){var n=this;n.bZ=-1,n.yZ=-1,n.text(t||""),n.zIndex(Lt)}function no(t,n,o){return Cn.push(t),u.mt.p0(t,n,oo(t),o)}function oo(t){var e=t;return function(t,n){var o=this,i=o.Mf;i&&(i.Ut.MW({type:"property",comment:o,name:e,value:n,newValue:t}),i.hP()&&i.My<=0&&(i.CW(),"indicatorColor"!==e&&"indicatorSize"!==e||i.repaint(i.getCellRect(o.bZ,o.yZ))),i.ki(s.CommentChanged,{sheet:i,sheetName:i.name(),comment:o,propertyName:e}))}}function io(t,n,o,i,e){var n=V(n,o,i,i);n.cursor=e,t.push(n)}function eo(t,n,o,i){(0,x.GC$)(t.SW).css(n,o),(0,x.GC$)(t.TW).css(n,i)}function ro(t,n){for(var o,i,e,o=t.length,i=0,e=0;e<o;e++)i+=$(t[e],n);return i}function co(t,n){t&&t.P_(n)}function ao(t){var t=t;if(t){if("number"==typeof t)return 400<t;if("string"==typeof t)return-1!==t.toLowerCase().indexOf("bold")||400<parseInt(t,10)}}function uo(t){var t=t;return t&&-1!==["italic","oblique"].indexOf(t.toLowerCase().trim())}function R(t,n){var o,i,t,o=this,i=t&&t.Mf;o.AW=1,o.IW=1,o.TZ=t,o.xW(),o._zoomFactor=i.zoom(),o.NW=n,o.li=n.kW,o.Hc(),2===o.TZ.displayMode()?o.EW=o._W():(t=o.DW(o._W()),o.EW=T(t.x,t.y)),o.jW(),o.OW()}function o(t){var n=this;n.Mf=t,n.RW={BW:!1,x:0,y:0,LW:l,FW:-1},n.kW=l,n.PW=l,n.MZ=l,n.wB=[],n.GW=0,n.UW=[],n.HW(),n.zW(),n.cE={}}function so(t){var n=this;n.Mf=l,n.VW=!0,n.YW=n.ZW(),t.appendChild(n.YW)}function fo(t,n){if(t){var t=t.trim().toLowerCase();if(-1!==["false"].indexOf(t))return!1;if(-1!==["true"].indexOf(t))return!0}return n}function ho(t,n,o){return!(50*o<t)&&t<=n/2*o}Object.defineProperty(t,"__esModule",{value:!0}),t.hW=t.Comment=t.Padding=t.DisplayMode=t.CommentState=void 0,U=P("Common"),u=P("Core"),x=P("Core"),L=u.Commands,l=null,v=void 0,A=Math.max,p=Math.min,E=Math.floor,G=Math.ceil,W=Math.atan2,M=Math.abs,B="default",P=u.GC$.extend,e=u.mt.En,H=U.Common.Uf,J="comment",X=u.hi,w=u.Bf,Y=u.mt,s=u.Events,K=Y.vi,N=Y.w0,q=Y.M0,$=Y.bi,Q=Y.sHe,Z=parseFloat,tt=U.Common.zf,nt=u.Lf,ot=x.ExcelHelper.getActualColumnWidth,it=x.ExcelHelper.pointToPixel,h=x.ExcelHelper.pixelToPoint,et=x.ExcelHelper.getActualRowHeight,k=U.Common.lt.ht,S=x.mt.xr,rt=x.mt.c1,ct=x.mt.n1,at=x.mt.vo,ut=x.mt.d1,st=x.mt.h1,ft=x.IndexHelper.nr,ht=x.Util.wr,lt=x.Util.ho,vt=7,mt=document,dt=window,pt=x.UsedRangeUtil.vh,wt=x.XFileConstants.Rr,gt=x.XFileConstants.Lr,bt=x.XFileConstants.ou,Ct="mouse",yt="move",xt="DOMMouseScroll",g="left",b="top",kt="right",St="bottom",m="width",d="height",r="position",c="absolute",a="overflow",Mt="visible",Nt="z-index",jt="hidden",zt="box-sizing",Ft="content-box",Dt="padding",Tt="px",f="div",_=".comment",Vt=".floatBlockCanvas",Ot=".hostContainer",It=".lineCanvasContainer",C=".host",y=".editor",j="gc-spread-",z="className",Rt="cursor",Pt="text",Ut=701,Lt=898,At="gc-no-user-select",Et=" ",Gt="unselectable",Wt="on",Bt="comment_editor",Ht="comment_indicator",Jt="font-family",Xt="font-style",Yt="font-size",Kt="font-weight",qt="color",$t="textArea",Qt=".lineCanvas",Zt=".commentDocument",F="-resize",tn="line-height",nn="background-color",on="text-align",en="mousedown",rn="mousemove",cn="mouseup",an="mousewheel",un="text-decoration",sn="black",fn=1e4,hn=50,(n=ln=ln||{})[n.none=0]="none",n[n.single=1]="single",n[n.double=2]="double",n[n.singleaccounting=3]="singleaccounting",n[n.doubleaccounting=4]="doubleaccounting",u.GC$.extend(x.Worksheet.prototype,{CW:function(t){var n,o,i,e,r,c,a,n=this,o=n.pW&&n.pW();if(n.hP()&&!n.D_)for(i=n.Fi(),e=void 0,r=0;r<=2;r++)for(c=0;c<=2;c++)!(e=i.c9(r,c))||0===I(e)||0===O(e)||t&&!e.intersectRect(t)||(a=n.Ut.pI,o&&a&&o.WW(a))}}),(vn=u.CellRange).prototype.comment=function(t){var n=this,o=n.sheet,i=n.row,e=n.col;return 0===arguments.length?o.Ut.pI.get(i,e):(t instanceof bn&&o.Ut.pI.WB(i,e,t),n)},mn=function(t,n){var o,n;!t.Ut.pI.Oy()&&(o=t.uw(),n=t.hitTest(n.pageX-o.left,n.pageY-o.top))&&Yn(t,n)},dn=function(t,o){o.bind(s.FloatingElementSelected+_,function(t,n){var n;"comments"!==n.type&&((n=o.Ut.pI).CZ(),n.wW(l))}),t.bind(en+_,function(t){o.Ut.pI.CZ(),mn(o,t)}).bind(an+_,function(t){mn(o,t)}).bind(rn+_,function(t){mn(o,t)})},pn=function(t,n){n.unbind(_),t.unbind(_)},s.CommentChanged="CommentChanged",(n=D=t.CommentState||(t.CommentState={}))[n.active=1]="active",n[n.edit=2]="edit",n[n.normal=3]="normal",(n=wn=t.DisplayMode||(t.DisplayMode={}))[n.alwaysShown=1]="alwaysShown",n[n.hoverShown=2]="hoverShown",Zn.prototype.clone=function(){var t=this;return new Zn(t.top,t.right,t.bottom,t.left)},Zn.prototype.toString=function(){var n=this,o="",t;return[b,kt,St,g].forEach(function(t){o+=n[t]+Tt+Et}),o.trim()},gn=Zn,t.Padding=gn,to.prototype.clone=function(){var o,i,o=this,i=new to;return Cn.forEach(function(t){var n=o[t]();o[t].isDefault&&o[t].isDefault(n)||i[t](n&&n.clone?n.clone():n)}),i.Mf=o.Mf,i.bZ=o.bZ,i.yZ=o.yZ,i},to.prototype.toJSON=function(){var o,i,o=this,i={rowIndex:o.bZ,colIndex:o.yZ};return Cn.forEach(function(t){var n=o[t]();o[t].isDefault&&o[t].isDefault(n)||(i[t]=n&&n.clone?n.clone():n)}),i},to.prototype.wh=function(t){var n,o,i,e,r,r,r,c,a,u,a,r,t,o,e,i,c,a,u,s,f,n=this,o=n.Mf,i={n_:"fill",color2:"#ffffe1"},e={n_:"stroke"},r=An(n.borderStyle());return r.dashStyle?e.dashStyle=r.dashStyle:r.lineStyle&&(e.lineStyle=r.lineStyle),r=n.opacity(),k(r)||1===r||(i.opacity=Math.floor(65535*r)+"f"),r=["Left","Center","Right"][n.horizontalAlign()||0]||"Left",!(c={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[n.bZ]},{n_:"Column",c_:[n.yZ]},{n_:"AutoFill",c_:["False"]}]})===n.dynamicMove()&&c.c_.push({n_:"MoveWithCells"}),!1===n.dynamicSize()&&c.c_.push({n_:"SizeWithCells"}),!1===n.locked()&&c.c_.push({n_:"Locked",c_:["False"]}),!1===n.lockText()&&c.c_.push({n_:"LockText",c_:["False"]}),"Left"!==r&&c.c_.push({n_:"TextHAlign",c_:[r]}),1===n.displayMode()&&c.c_.push({n_:"Visible"}),(a=n.padding())&&(u=[h(a.left)+"pt",h(a.top)+"pt",h(a.right)+"pt",h(a.bottom)+"pt"].join(",")),a={n_:"textbox",style:"mso-direction-alt:auto"+(n.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+r}]},r={n_:"shape",id:"_x0000_s"+t,type:"#_x0000_t202",style:En(o,n),fillcolor:Wn(n.backColor()),strokecolor:Wn(n.borderColor()),strokeweight:h(n.borderWidth()||1)+"pt",c_:[e,i,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},a,c]},u?a.inset=u:r["o:insetmode"]="auto",t=[],ao(n.fontWeight())&&t.push({n_:"b"}),uo(n.fontStyle())&&t.push({n_:"i"}),1&(o=n.textDecoration())?t.push({n_:"u"}):8&o?t.push({n_:"u",val:"double"}):2&o&&t.push({n_:"strike"}),(e=-1!==(e=n.fontSize()||"9pt").indexOf("px")?h(parseFloat(e)):e.replace("pt",""))&&t.push({n_:"sz",val:e}),(i=n.foreColor())?(i=st(i),t.push(i)):t.push({n_:"color",indexed:"81"}),n.fontFamily()&&t.push({n_:"rFont",val:n.fontFamily()}),t.push({n_:"family",val:"2"}),c={n_:"t"},a=n.text(),(s=(u=k(a)?"":a).length!==u.trim().length)&&(c["xml:space"]="preserve"),c.c_=[at(u)],{vmlDrawingData:r,commentData:f={n_:"comment",ref:ft(n.yZ)+(n.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:t},c]}]}]}}},to.prototype.fromJSON=function(o,t){var i;o&&(i=this,Cn.forEach(function(t){var n=o[t];n!==v&&("location"===t?i.location(new x.Point(n.x,n.y),!1):"padding"===t?i.padding(new gn(n.top,n.right,n.bottom,n.left),!1):i[t](n,!1))}),o.rowIndex!==v&&(i.bZ=o.rowIndex),o.colIndex!==v)&&(i.yZ=o.colIndex)},to.prototype.yh=function(f,t,h,l,v){var m,n,d,p,o,n,w,g,b,_,C,y;t&&h&&(n=Gn(f,m=this),d=n.x,p=n.y,n=(o=S(t,"text")).c_)&&(w=1===n.length,g=[],n.forEach(function(t){var n,o,i,i,e,e,r,e,r,c,i,e,a,n,r,u,s,t,i,e,r,n,o,r,n=S(t,"rPr");n&&w&&((o=(i=S(n,"rFont"))?i.val:o)&&m.fontFamily(o),i=0,(e=S(n,"u"))&&(r=1,i|=2===(r=(e=e.val)?ln[e]:r)?8:1),S(n,"strike")&&(i|=2),i&&m.textDecoration(i),S(n,"b")&&m.fontWeight("bold"),S(n,"i")&&m.fontStyle("italic"),(o=S(n,"color"))&&(e=ut(o),m.foreColor(e)),o=S(n,"sz").val)&&m.fontSize(o+"pt"),(r=S(t,"t"))?r.c_&&g.push(r.c_[0]):"t"===t.n_&&t.c_&&g.push(t.c_[0]),(o=h.fillcolor)&&m.backColor(o.split(" ")[0]),(o=h.strokecolor)&&m.borderColor(o.split(" ")[0]),(o=h.strokeweight)&&m.borderWidth(it(parseFloat(o.replace("pt","")))),(o=h.style)&&(c=o.split(";")).forEach(function(t){var t=Bn(t,":"),n=t.key,o=t.value;if(!k(o))switch(n){case"margin-left":b=Vn(o);break;case"margin-top":_=Vn(o);break;case"width":C=o;break;case"height":y=o;break;case"z-index":m.zIndex(parseInt(o,10))}}),(o=S(h,"fill"))&&(i=o.opacity)&&("f"===i.substr(-1)?m.opacity(parseFloat(i.substr(0,i.length-1))/65535):m.opacity(parseFloat(i))),(o=S(h,"stroke"))&&m.borderStyle(Ln(o.dashStyle,o.lineStyle)),(o=S(h,"textbox"))&&((e=o.style)&&-1!==e.indexOf("mso-fit-shape-to-text:t")&&m.autoSize(!0),a=[0,0,0,0],o.inset&&o.inset.trim().split(",").forEach(function(t,n){var t=t||["0.1in","0.05in"][n%2];a[n]=it(parseFloat(t.replace("pt","")))}),m.padding(new gn(a[1],a[2],a[3],a[0]))),n=S(h,"ClientData"),S(n,"SizeWithCells")&&m.dynamicSize(!1),S(n,"MoveWithCells")&&m.dynamicMove(!1),(o=S(n,"Locked"))&&m.locked(fo(o.c_[0],!0)),(o=S(n,"LockText"))&&m.lockText(fo(o.c_[0],!0)),(o=rt(S(n,"TextHAlign")))&&-1!==(r=["left","center","right"].indexOf(o.toLowerCase()))&&m.horizontalAlign(r),S(n,"Visible")&&m.displayMode(1),(o=rt(S(n,"Anchor")))?(t=o.split(",").map(function(t){return parseInt(t,10)}),i=ot(f,0,t[0])+t[1]-7,e=et(f,0,t[2])+t[3]-7,r=ot(f,0,t[4])+t[5]+7,n=et(f,0,t[6])+t[7]+7,m.location(new x.Point(i-d,e-p),!1),m.width(r-i),m.height(n-e),t&&(u=t[6]+1,s=t[4]+1)):(o=it(b)-d-7,r=it(_)-p-7,m.location(new x.Point(o,r)),m.width(it(parseFloat(C.replace("pt","")))+14),m.height(it(parseFloat(y.replace("pt","")))+14),u=Pn(f,m.location().y+p+m.height()).row+1,s=Un(f,m.location().x+d+m.width()).col+1),x.Util.Co(l)&&x.Util.So(f,u,s,v)}),m.text(ct(g.join(""))))},bn=to,t.Comment=bn,_n={},Cn=[],(yn=[[Pt,""],["location",T(9,-18)],[m,160,function(t){return 0<t}],[d,100,function(t){return 0<t}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&0<parseInt(t,10)}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return 0<=t&&t<=1}],["borderWidth",1,function(t){return 1<=t}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&1<t}]]).forEach(function(t){_n[t[0]]=no(t[0],t[1],t[2])}),xn=_n.zIndex,_n.zIndex=function(){var t,n,o,t=xn.apply(this,arguments);return 0===arguments.length&&t===Lt&&(n=this.Mf.comments.GW,o=this.lp,t=Lt-(n-1-o)),t},kn=_n.commentState,_n.commentState=function(t,n){var o,i,o=kn.apply(this,arguments);return n&&(i=this.Mf).Rj("comment",null,null,x.SheetArea.viewport,this,this),o},P(bn.prototype,_n),R.prototype.Hc=function(){var t=this,n=t.TZ.Mf;t.QW=j+"floatBlockCanvas",t.KW=j+"host-container",t.JW=j+"host",t.XW=j+"lineCanvas",t.qW=e(f),(0,x.GC$)(t.qW).addClass(j+"floatBlockCanvas-container").css([r,a,zt],[c,jt,Ft]),t.SW=e("canvas"),w.Wl(t.SW,null,n),(0,x.GC$)(t.SW).addClass(t.QW).css([g,b,r],[0,0,c]),t.TW=e(f),(0,x.GC$)(t.TW).addClass(t.KW).css([r,zt,a],[c,Ft,jt]),t.Ti=e(f),(0,x.GC$)(t.Ti).addClass(t.JW+Et+At).css([g,b,m,d,r,"word-wrap","word-break","white-space",a,zt,Gt,tn],[0,0,"100%","100%",c,"break-word","normal","pre-wrap",jt,Ft,Wt,"normal"]),(0,x.GC$)(t.TW).append(t.Ti),(0,x.GC$)(t.qW).append(t.SW).append(t.TW),t.$W=e(f),(0,x.GC$)(t.$W).addClass(j+"lineCanvas-container").css([r,a,"pointer-events"],[c,jt,"none"]),t.tQ=e("canvas"),w.Wl(t.tQ,l,n),(0,x.GC$)(t.tQ).addClass(t.XW).css([g,kt,r],[0,0,c]),(0,x.GC$)(t.$W).append(t.tQ),t.nQ=[],t.eQ=7,t.iQ=!1,t.Eb=!1,R.et(t,"init",[t.SW,t.Ti])},R.prototype.rQ=function(){var t=this,n=t.TZ.Mf;!t.YW&&n&&n.pW&&(t.YW=n.pW().YW),t.YW&&(t.YW.appendChild(t.$W),t.oQ(),t.YW.appendChild(t.qW),t.aQ(t.SW,Vt),t.aQ(t.TW,Ot),t.uQ()?t.sQ():t.cQ(),t.EW=t._W(),t.fQ())},R.prototype.lQ=function(){var t=this;t.qW&&t.$W&&t.YW&&(t.hQ(t.SW,Vt),t.hQ(t.TW,Ot),t.dQ(),t.vQ(),t.mQ(),(0,x.GC$)(t.qW).remove(),(0,x.GC$)(t.$W).remove())},R.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},R.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},R.prototype._W=function(){var t=this,n=t.TZ;return n!==t.NW.PW||n.commentState()!==D.normal||n.ignoreDefaultLocation()?t.bQ(n.location()):(n.yQ=t.bQ(T(9,-18)),n.yQ)},R.prototype.bQ=function(t){var n,o,i,e,r,o,n,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=T(0,0);return i&&(o=n.wQ(i,o.bZ,o.yZ,n.AW,n.IW)).x!==l&&void 0!==o.x&&o.y!==l&&void 0!==o.y&&I(o)&&O(o)&&(n=i.Fi(),r.x=o.x+I(o)+t.x*e-n.XC,r.y=o.y+t.y*e-n.qC),r},R.prototype.wQ=function(t,n,o,i,e){var r,c,a,u,s,f,h,r,u,h,s,r=this,c=V(0,0,0,0),a=t.Fi(),u=Qn(t,i),s=$n(t,e),r=r._zoomFactor,f=N(t,s,o,!1);return s===t.Ab&&(f+=t.my),h=N(t,u,n,!0),u===t.Tb&&(h+=t.ly),c.y=u<=n?h:-h,c.x=s<=o?f:-f,(u=t.getSpan(n,o))!==v&&u!==l?(c.height=0===i&&q(t,n,n+u.rowCount,!0)||N(t,n,n+u.rowCount,!0),c.width=0===e&&q(t,o,o+u.colCount,!1)||N(t,o,o+u.colCount,!1)):(c[d]=Kn(t,n)*r,c[m]=qn(t,o)*r),c.x+=a.XC,c.y+=a.qC,h=a.F6,s=a.L6,1===i?c.y+=s:2===i&&(c.y+=s+t.Sy(a)),1===e?c.x+=h:2===e&&(c.x+=h+t.Gy(a)),c},R.prototype.MQ=function(t){var n,o,i,e,r,o,n,i,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=T(0,0);return i&&(o=n.wQ(i,o.bZ,o.yZ,n.AW,n.IW)).x!==l&&o.x!==v&&o.y!==l&&o.y!==v&&I(o)&&O(o)&&(n=i.Fi(),i=o.x+I(o)-n.XC,r.x=(t.x-i)/e,r.y=(t.y-(o.y-n.qC))/e),r},R.prototype.CQ=function(t){void 0===t&&(t=!0);var n=this;n.EW=n._W(),n.jW(),n.OW(),t&&n.fQ()},R.prototype.SQ=function(){var t,n,t=this,n=t.DW(t._W());t.EW=T(n.x,n.y),t.OW()},R.prototype.TQ=function(){var t,n,t,t=this,n=t.TZ;n.dynamicMove()?n.dynamicSize()?t.AQ():(t.IQ(),t.OW()):(t.jW(),t.OW(),t=t.MQ(t.EW===n.yQ?t._W():t.EW),n.location(t))},R.prototype.gW=function(){var t=this;t.EW=t._W(),t.fQ()},R.prototype.IQ=function(){var t,n,o,t=this,n=t.TZ,o=t.xQ();o&&(t.EW=o,n.location(t.MQ(o),!1),t.fQ())},R.prototype.xQ=function(){var t,n,o,n,i,e,r,c,a,i,u,s,a,i,t=this,n=t.TZ,o=n&&n.Mf,n=t._zoomFactor;if(!k(t.NQ)&&!k(t.DQ)){for(i=$n(o,t.IW),e=Qn(o,t.AW),c=r=0;c<t.IW;c++)r+=o.getViewportWidth(c);for(a=N(o,i,t.NQ,!1,v,v,!0),i<t.NQ?r+=a:r-=a,(i=qn(o,t.NQ))<t.kQ&&(t.kQ=i),r+=t.kQ*n,s=u=0;s<t.AW;s++)u+=o.getViewportHeight(s);return a=N(o,e,t.DQ,!0,v,v,!0),e<t.DQ?u+=a:u-=a,(i=Kn(o,t.DQ))<t._Q&&(t._Q=i),T(r,u+=t._Q*n)}},R.prototype.EQ=function(){var t,n,o,i,e,e,e,r,r,t=this,n=t.TZ,o=n&&n.Mf,i=N(o,t.NQ,t.jQ,!1,v,!0),e=qn(o,t.NQ);e<t.kQ&&(t.kQ=e),(e=qn(o,t.jQ))<t.OQ&&(t.OQ=e),i=i-t.kQ+t.OQ,e=N(o,t.DQ,t.RQ,!0,v,!0),(r=Kn(o,t.DQ))<t._Q&&(t._Q=r),(r=Kn(o,t.RQ))<t.BQ&&(t.BQ=r),e=e-t._Q+t.BQ,n.width(i),n.height(e)},R.prototype.AQ=function(){var t=this;t.EQ(),t.IQ()},R.prototype.jW=function(){var t,n,o,i,n,e,r,c,a,u,s,f,h,l,v,t=this,n=t.TZ,o=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=$n(o,t.IW),e=Qn(o,t.AW),0===t.IW?r=t.EW.x:1===t.IW?r=t.EW.x-o.getViewportWidth(0):2===t.IW&&(r=t.EW.x-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===t.AW?c=t.EW.y:1===t.AW?c=t.EW.y-o.getViewportHeight(0):2===t.AW&&(c=t.EW.y-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=T(r,c),s=u=0,f=n;f<o.getColumnCount();f++){if(!(u+(h=qn(o,f)*i)<a.x)){t.NQ=f,t.kQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Kn(o,l)*i)<a.y)){t.DQ=l,t._Q=(a.y-s)/i;break}s+=v}}},R.prototype.OW=function(){var t,n,o,i,n,e,r,c,a,u,s,f,h,l,v,t=this,n=t.TZ,o=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=$n(o,t.IW),e=Qn(o,t.AW),0===t.IW?r=t.EW.x+t.gQ():1===t.IW?r=t.EW.x+t.gQ()-o.getViewportWidth(0):2===t.IW&&(r=t.EW.x+t.gQ()-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===t.AW?c=t.EW.y+t.pQ():1===t.AW?c=t.EW.y+t.pQ()-o.getViewportHeight(0):2===t.AW&&(c=t.EW.y+t.pQ()-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=T(r,c),s=u=0,f=n;f<o.getColumnCount();f++){if(!(u+(h=qn(o,f)*i)<a.x)){t.jQ=f,t.OQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Kn(o,l)*i)<a.y)){t.RQ=l,t.BQ=(a.y-s)/i;break}s+=v}}},R.prototype.JO=function(t,n){var o=this,i=o.TZ;t<=o.DQ?i.dynamicMove()&&(o.DQ+=n,o.RQ+=n):t>o.DQ&&t<=o.RQ&&i.dynamicSize()&&(o.RQ+=n),o.AQ()},R.prototype.qO=function(t,n){var o=this,i=o.TZ;t<=o.NQ?i.dynamicMove()&&(o.NQ+=n,o.jQ+=n):t>o.NQ&&t<=o.jQ&&i.dynamicSize()&&(o.jQ+=n),o.AQ()},R.prototype.xP=function(t,n){var o,i,e,o=this,i=o.TZ,e=t+n-1;t<o.DQ?e<o.DQ?i.dynamicMove()&&(o.DQ-=n,o.RQ-=n):e<o.RQ&&i.dynamicMove()&&(i.dynamicSize()?o.RQ-=n:o.RQ-=o.DQ-t+1,o.DQ=t,o._Q=0):t<=o.RQ&&(e<o.RQ?i.dynamicSize()&&(o.RQ-=n):i.dynamicSize()&&(o.RQ=t,o.BQ=0)),o.AQ()},R.prototype.NP=function(t,n){var o,i,e,o=this,i=o.TZ,e=t+n-1;t<o.NQ?e<o.NQ?i.dynamicMove()&&(o.NQ-=n,o.jQ-=n):e<o.jQ&&i.dynamicMove()&&(i.dynamicSize()?o.jQ-=n:o.jQ-=o.NQ-t+1,o.NQ=t,o.kQ=0):t<=o.jQ&&(e<o.jQ?i.dynamicSize()&&(o.jQ-=n):i.dynamicSize()&&(o.jQ=t,o.OQ=0)),o.AQ()},R.prototype.fQ=function(){var t,n,o,o,i,t=this,n=t.TZ,o=n.Mf;t.LQ()&&(o=o.zoom(),t._zoomFactor!==o?(t._zoomFactor=o,(i=t.xQ())&&(t.EW=i)):(t._zoomFactor=o,t.EW!==n.yQ||1!==n.displayMode()&&2!==n.commentState()||(t.EW=t._W())),t.xW(),t.FQ(),t.PQ(),t.GQ(),t.UQ(),Y.Tt.chrome)&&t.HQ()},R.prototype.FQ=function(){var t,n,n,t=this,n=t.TZ.Mf,n=n.parent&&n.parent.options.useTouchLayout;t.eQ=n?11:7},R.prototype.xW=function(){var t=this,n=t.TZ,o=n.Mf;t.AW=o.C0(n.bZ),t.IW=o.S0(n.yZ)},R.prototype.PQ=function(){var t,n,o,t=this,n,o=2===t.TZ.commentState()?t.li:t.Ti;t.zQ(),t.VQ(o),t.YQ(o),t.ZQ(o),t.WQ()},R.prototype.YQ=function(t){var n=this,o=n.TZ;t===n.Ti&&(t.innerHTML=tt.j0(o.text()))},R.prototype.ZQ=function(t,n){var o,i,n,e,r,c,a,u,a,u,u,n,s,e,f,a,h,l,v,m,d,h,c,l,d,v,u,h,r,m,f,a,v,u,c,l,d,h,o=this,i=o.TZ,n=n||2===i.commentState()||1===i.displayMode()?o._W():o.EW,e=o._zoomFactor,r=2===i.displayMode();n&&(c=this.Gxn,a=(u=o.pKe(fn))?(a=u.width,u=u.height,o.DW(n,a,u)):o.DW(n),r||o.QQ(a),n=2*((u=o.eQ)+i.borderWidth()),s=G((I(a)-n)*e+n),e=G((O(a)-n)*e+n),h=(f=a.x)+s,l=(a=a.y)+e,v=o.KQ(o.AW,o.IW),m=s,r?eo(o,g,0,u):f<v.x?(d=f-v.x,c?eo(o,g,0,u):eo(o,g,d,d+u),m+=d,f=v.x+1):(eo(o,g,0,u),h>v.x+I(v)&&(m+=d=v.x+I(v)-1-h,c)&&eo(o,g,d,d+u)),r?s=p(I(v)-1+u,s):m=p(I(v)-1+u,m),h=e,r?eo(o,b,0,u):a<v.y?(eo(o,b,a-v.y,a+u-v.y),h+=a-v.y,a=v.y):(eo(o,b,0,u),l>v.y+O(v)&&(h+=v.y+O(v)-1-l)),r?e=p(O(v)-1+u,e):h=p(O(v)-1+u,h),c=(0,x.GC$)(o.qW),d=r?e:h,f=o.MKe(f,l=r?s:m),c.css({left:f,top:a}),v=c.height(),u=c.width(),d<=0&&v<=0||l<=0&&u<=0||((1<M(d-v)||1<M(l-u))&&c.css({width:l,height:d}),w.$l(o.SW,s,e),r=(h=(0,x.GC$)(o.TW)).width(),m=h.height(),f=A(0,s-n),a=A(0,e-n),(1<M(m-a)||1<M(r-f))&&(0,x.GC$)(o.TW).css({width:f,height:a}),u=(v=(0,x.GC$)(t)).width(),c=v.height(),l=f,d=a,(h=i.padding())&&(l-=G(Z(h.left)+Z(h.right)),d-=G(Z(h.top)+Z(h.bottom))),(1<M(c-d)||1<M(u-l))&&(0,x.GC$)(t).css({width:A(0,l),height:A(0,d)})))},R.prototype.QQ=function(t){var n,o,i,i,e,r,c,n=this,o=n.TZ,i=n.EW;t.x===i.x&&t.y===i.y&&I(t)===o.width()&&O(t)===o.height()||(i=n.MQ(T(t.x,t.y)),e=I(t),r=O(t),c=o.location(),i.x===c.x&&i.y===c.y||(o.location(i,!1),n.CQ(!1)),e!==o.width()&&o.width(e,!1),r!==o.height()&&o.height(r,!1),o.dynamicMove()&&(n.EW=T(t.x,t.y)))},R.prototype.WQ=function(){var t=this,n=t.TZ,o;Fn(n&&n.Mf)?(t.aQ(t.SW,Vt),t.aQ(t.TW,Ot),t.oQ(),t.cQ(),t.sQ()):(n.locked()?(t.hQ(t.SW,Vt),t.XQ(t.SW),t.hQ(t.TW,Ot),t.XQ(t.TW),t.SW.style.cursor=B,t.TW.style.cursor=B):(t.aQ(t.SW,Vt),t.aQ(t.TW,Ot)),n.lockText()?(t.dQ(),t.XQ(t.Ti),t.mQ(),t.XQ(t.li),!n.locked()&&n.commentState()===D.active||n.commentState(3),t.Ti.style.cursor=n.locked()?B:yt):(t.cQ(),t.sQ()),t.oQ())},R.prototype.zQ=function(){var t=this,n=t.TZ,o=t.NW,i=n&&n.Mf;switch(n.commentState()){case D.active:o.qQ(n),t.uQ()&&t.$Q(),0<i.getSelections().length&&i.e4(),X.F1(i);break;case D.edit:o.qQ(n),t.uQ()||t.tK(),0<i.getSelections().length&&i.e4(),X.F1(l);break;case D.normal:n===o.pZ()&&(o.CZ(),0===i.getSelections().length)&&i.cR()}},R.prototype.VQ=function(t){var n,o,i,e,i;function r(t,n,o){var o,i;return o?((i=(o=U.Common.ft)._(t)).a=n,o.j(i)):t}o=(n=this).TZ,(i=(0,x.GC$)(t)).css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",parseInt(o.fontSize(),10)*n._zoomFactor+"pt").css("font-weight",o.fontWeight()),i.css("text-decoration",u.W.A5(o.textDecoration())),i.css("text-align",(e={0:"left",1:"center",2:"right",3:"general"})[o.horizontalAlign()]),o.padding()?i.css(Dt,o.padding().toString()):i.css(Dt,"0px"),i.css("background-color",r(o.backColor(),o.opacity(),t===n.Ti)).css("color",o.foreColor()),(0,x.GC$)(n.TW).css("border-width",o.borderWidth()).css("border-style",o.borderStyle()).css("border-color",o.borderColor()),i=n.NW.nK(o),(0,x.GC$)(n.$W).css(Nt,i),(0,x.GC$)(n.qW).css(Nt,i)},R.prototype.HQ=function(){var t,n,o,n,i,n,t,n=this.TZ.Mf,o=(0,x.GC$)(this.TW);n&&o&&(i=.5<=(n=n.uw()).left-E(n.left)?.5:0,n=.5<=n.top-E(n.top)?.5:0,o.css(g,Z(o.css(g))+i),o.css(b,Z(o.css(b))+n))},R.prototype.MKe=function(t,n,o,i){void 0===n&&(n=0);var e=this.TZ.Mf,r=e.Fi();return e.options.rightToLeft?(o=o||r.width-r.XC)-t-n-(i=k(i)?r.XC:i):t},R.prototype.GQ=function(){var t,n,o,n,i,e,r,e,c,n,i,c,n,i,a,u,n,s,f,h,l,o,l,t=this,n=t.TZ,o=n.Mf,n=t.wQ(o,n.bZ,n.yZ,t.AW,t.IW),i=o.Fi(),e=n.x+I(n)-i.XC,e=T(e=t.MKe(e,0),r=n.y-i.qC),n=(0,x.GC$)(t.qW).position(),i=(0,x.GC$)(t.TW).position(),c=(0,x.GC$)(t.TW),c=n.left+i.left>e.x?T(n.left+i.left,n.top+i.top):n.top+i.top+c.height()<e.y?T(n.left+i.left+c.width(),n.top+i.top+c.height()):T(n.left+i.left+c.width(),n.top+i.top),n=t.eQ,i=M(e.x-c.x)+2*n,a=M(e.y-c.y)+2*n,s=(u=p(e.x,c.x)-n)+i,f=(n=p(e.y,c.y)-n)+a,h=t.KQ(t.AW,t.IW,!0),l=o.Fi(),o=o.options.rightToLeft?l.XC:0;u<(l=h.x-o)&&(i-=l-u,u=l),s>l+I(h)&&(i-=s-(l+I(h))),i=p(I(h),i),n<h.y&&(a-=h.y-n,n=h.y),f>h.y+O(h)&&(a-=f-(h.y+O(h))),a=p(O(h),a),(0,x.GC$)(t.$W).css(g,u).css(b,n).css(m,i).css(d,a),w.$l(t.tQ,i,a),e.x=e.x-u,e.y=e.y-n,c.x=c.x-u,c.y=c.y-n,t.eK(e,c)},R.prototype.eK=function(t,n){var o,i,e,o,o=this;o.iK||(o.iK=o.tQ.getContext("2d")),i=o.iK,e=o.TZ.borderColor(),i.strokeStyle=e,i.clearRect(0,0,w.Xl(o.tQ),w.ql(o.tQ)),i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(n.x,n.y),i.stroke(),i.save(),nt.Yl(i,t.x,t.y),i.fillStyle=e,i.beginPath(),o=W(n.y-t.y,n.x-t.x),i.rotate(o),i.moveTo(0,0),i.lineTo(7,-4),i.lineTo(7,4),i.lineTo(0,0),i.fill(),nt.Yl(i,-t.x,-t.y),i.closePath(),i.restore()},R.prototype.UQ=function(){var t,n,o,i,e,r,c,a,u,s,t=this,n=t.TZ,o=n.Mf;t.rK=t.TZ.commentState(),t.oK||(t.oK=t.SW.getContext("2d")),i=t.oK,e=w.Xl(t.SW),r=w.ql(t.SW),c=(0,x.GC$)(t.TW).outerWidth(),a=(0,x.GC$)(t.TW).outerHeight(),u=t.eQ,i.clearRect(0,0,e,r),t.TZ.showShadow()&&(t.aK(i,e,r),i.clearRect(u,u,e-(s=2*(u+2)),r-s),t.uK(i,u,c,a)),Fn(o,n)&&t.sK(i,u,e,r,c,a),i.restore()},R.prototype.uK=function(t,n,o,i){t.save(),t.fillStyle=sn,t.fillRect(n+2,i+n,o,2),t.fillRect(o+n,n+2,2,i),t.restore()},R.prototype.aK=function(t,n,o){var i,e,r;switch(t.save(),t.strokeStyle=sn,this.rK){case D.active:for(t.beginPath(),e=0;e<o;e++)for(i=e%2==0?1:3;i<n;)t.moveTo(i,e),t.lineTo(i+1,e+1),i+=4;t.stroke(),t.closePath();break;case D.edit:for(t.beginPath(),e=i=0,r=4;i<n+o;)t.moveTo(i+4,0),t.lineTo(0,e+4),i+=4,e+=4;t.stroke(),t.closePath()}t.restore()},R.prototype.sK=function(r,t,n,o,i,e){var c=this,a=c.nQ;c.rK!==D.active&&c.rK!==D.edit||(a.splice(0,a.length),io(a,0,0,t,"nw"+F),io(a,n-t,0,t,"ne"+F),io(a,0,o-t,t,"sw"+F),io(a,n-t,o-t,t,"se"+F),3*t<=e?(io(a,0,E(o/2-t/2),t,"w"+F),io(a,n-t,E(o/2-t/2),t,"e"+F)):(a.push(l),a.push(l)),3*t<=i?(io(a,E(n/2-t/2),0,t,"n"+F),io(a,E(n/2-t/2),o-t,t,"s"+F)):(a.push(l),a.push(l)),r.restore(),r.fillStyle="white",r.strokeStyle="#939393",r.lineWidth=1,nt.Yl(r,.5,.5),x.GC$.each(a,function(t,n){var o,i,e,n;n&&(o=n.x,i=n.y,e=I(n),n=O(n),r.beginPath(),r.fillRect(o,i,e-1,n-1),r.strokeRect(o,i,e-1,n-1),r.stroke(),r.closePath())}),nt.Yl(r,-.5,-.5))},R.prototype.CKe=function(t,n,o){var i,i;return this.Gxn?(i=t.width(),i=this.MKe(n,i,o,0),t.css(g,i)):t.css(g,n)},R.prototype.cK=function(){var n,t,o,i,i,n=this,t=n.KQ(n.AW,n.IW);n.eW?(0,x.GC$)(n.eW).remove():n.eW=e(f),o=(0,x.GC$)(n.eW),i=(0,x.GC$)(n.TW),o.addClass("gc-spread-moveResizeContainer").css([r,b,m,d,"border"],[c,n.EW.y+n.eQ-t.y,i.outerWidth()-2,i.outerHeight()-2,"gray solid thin"]),n.CKe(o,n.EW.x+n.eQ-t.x,I(t)),n.fK?(0,x.GC$)(n.fK).remove():n.fK=e(f),(i=(0,x.GC$)(n.fK)).bind("mousemove",function(t){n.pg(t)}).bind(cn,function(t){n.bg(t)}).css([r,a,b,g,m,d,"background",Nt],[c,jt,t.y,n.MKe(t.x,I(t)),I(t),O(t),"rgba(255,255,255,0.01)",901]),i.append(n.eW),n.YW&&n.YW.appendChild(n.fK)},R.prototype.lK=function(t){var n,o,i,e,r,c,a,t,c,u,s,u,f,f,n=this,o=n.eQ,i=n._zoomFactor,e,r=n.NW.RW;r.BW&&(c=n.hK(),a=t.pageX/i-r.x+c.x,t=t.pageY/i-r.y+c.y,0===a&&0===t||(n.Gxn&&(a=-a),c=n.KQ(n.AW,n.IW),s=(0,x.GC$)(n.eW),r.FW<0?(u=r.LW.x+a,f=r.LW.y+t,u=n.bQ(T(u,f)),s.css([b],[u.y+o-c.y])):(f=n.dK(a,t,r.FW),u=n.bQ(T(f.x,f.y)),s.css([b,m,d],[u.y+o-c.y,I(f)*i-2*o-2,O(f)*i-2*o-2])),n.CKe(s,u.x+o-c.x,c.width)))},R.prototype.tK=function(){var t,n,o,t=this,n=t.TZ;t.uQ()||(o=t.NW.kW,(0,x.GC$)(t.Ti).remove(),t.dQ(),(0,x.GC$)(o).remove(),(0,x.GC$)(t.TW).append(o),t.vK(o),t.ZQ(o),(0,x.GC$)(o).focus(),o.selectionStart=o.value.length,t.sQ(),2!==n.commentState()&&n.commentState(2,!0))},R.prototype.$Q=function(){var t,n,o,i,t=this,n=t.TZ,o=n.Mf;t.uQ()&&(i=t.NW.kW,t.mQ(),(0,x.GC$)(i).remove(),(0,x.GC$)(t.TW).append(t.Ti),t.vK(t.Ti),t.cQ(),R.et(t,"detachEditor",t.Ti),2===n.commentState()&&n.commentState(3),(0,x.GC$)(i).val()!==n.text())&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,x.GC$)(i).val(),propertyName:Pt})},R.prototype.mK=function(t){var n,o;return this.TZ.Mf.getViewportHeight(t)},R.prototype.gK=function(t){var n,o;return this.TZ.Mf.getViewportWidth(t)},R.prototype.KQ=function(t,n,o){var i,e,r,o,c,a,u,s,f,e,o;return void 0===o&&(o=!1),r=(e=(i=this).TZ.Mf).Fi(),o=o&&e.options.rightToLeft,c=r.c9(t,n),a=!0===e.Vy,u=r.width,s=r.height,f=e.Gy(r),e=e.Sy(r),o=o?a?r.zy:r.Py:r.F6,0===t&&0===n||0===t&&2===n||2===t&&0===n||2===t&&2===n?c=V(0,0,u,s):0===t&&1===n||2===t&&1===n?c=V(o,0,f,s):1===t&&0===n||1===t&&2===n?c=V(0,r.L6,u,e):1===t&&1===n&&(c=V(o,r.L6,f,e)),c},R.prototype.vK=function(t){var n=this,o=n.TZ,i=(0,x.GC$)(t);t!==n.li&&t!==n.Ti||(t===n.li?t.value=o.text():t.innerHTML=tt.j0(o.text()),i.css([Jt,Xt,Yt,Kt,qt,nn,on,un],[o.fontFamily(),o.fontStyle(),o.fontSize(),o.fontWeight(),o.foreColor(),o.backColor(),o.horizontalAlign(),o.textDecoration()]),o.padding()?i.css(Dt,o.padding().toString()):i.css(Dt,"0px"))},R.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},R.prototype.uQ=function(){var t=this;return t.LQ()&&t.TZ===t.NW.pZ()&&0<(0,x.GC$)(t.TW).find($t).length},R.prototype.pK=function(){var t,n,o,n,t=this,n=t.TZ.Mf,o=l;return t.LQ()&&(n=n.Fi(),o=V(t.EW.x+(n.BA+n.XC),t.EW.y+n.LA+n.qC,t.gQ(),t.pQ())),o},R.prototype.bK=function(){var t,n,o,i,e,r,c,a,t,u,t=this,n=t.TZ,o=t._zoomFactor;return t.LQ()&&(i=t.pK())?(a=c=r=e=void 0,t=(t.eQ+n.borderWidth())*o,V(e=i.x+t,r=i.y+t,c=I(i)-2*t,a=O(i)-2*t)):l},R.prototype.yK=function(t){var n,o,i,e,r,c,a,r,n=this,o=n.TZ,i=o.Mf,e=t.target,r=n.NW.RW,c=e.style,a=B;r.BW?e[z]!==n.JW&&e[z]!==n.QW&&e[z]!==n.XW&&e[z]!==j+"floatPanel"||(a=0<=r.FW?"crosshair":yt):e[z]===n.JW?!Fn(i)&&o.lockText()?o.locked()||(a=yt):a=Pt:e[z]!==n.QW&&e[z]!==n.KW||Fn(i,o)&&(a=0<=(r=n.wK(t))&&r<n.nQ.length?n.nQ[r].cursor:yt),c[Rt]=a},R.prototype.lW=function(t){var n,o,i,e,n=this,o=n.TZ,i=o&&o.Mf;if(i&&i.endEdit()&&o&&i.comments.get(o.bZ,o.yZ)&&(R.et(n,"preProcessMouseDownEdit",e={e:t,r:l}),!e.r))return i.ki(s.FloatingElementSelected,{type:"comments"}),n.NW.qQ(o),o.commentState(2,!0),n.bg(t),K(t)},R.prototype.XZ=function(t){var n,o,i,e,r,c,a,a,e,r,o,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=n.NW,c=r.RW;i.endEdit()&&(R.et(n,"preProcessMouseDownDragResize",a={e:t,r:l}),a.r||(i.ki(s.FloatingElementSelected,{type:"comments"}),c.x=t.pageX/e,c.y=t.pageY/e,c.LW=V(o.location().x,o.location().y,o.width(),o.height()),c.FW=n.wK(t),n.Fg(),c.BW=!0,n.yK(t),r.qQ(o),o.commentState(D.active,!0),Fn(i,o)&&(n.CK={},n.CK.SK=Qn(i,n.AW),n.CK.TK=$n(i,n.IW),n.cK(),c.FW<0?n.iQ=!0:n.Eb=!0),a=i.rt,e=i.uw(),r=T(t.pageX-e.left,t.pageY-e.top),o=i.hitTest(r.x,r.y),a.Rk={e9:o.rowViewportIndex,r9:o.colViewportIndex,Bk:o.hitTestType},a.fk=r,a.Ok(),a.s9=!0,t.stopPropagation()))},R.prototype.DW=function(t,n,o){var i,e,r,c,i,e,n,a,u,n,i,s,f,r=this,c=r._zoomFactor,i=r.TZ,e=void 0!==n?n*c:r.gQ(),n=r.bKe(t,n),a=n.left,u=n.actualWidth,n=n.isCommentHorizontalCoverCell;return i.autoSize()&&u!==e&&(o=null!=(e=null==(i=r.pKe(u))?void 0:i.height)?e:o),V(a,s=(i=r.wKe(t,o,n)).top,u/c,(f=i.actualHeight)/c)},R.prototype.bKe=function(t,n){var o,i,e,r,c,a,u,s,s,n,f,h,t,l,v,m,d,p,w,g,b,_,o,C,y,x,k,S,p,g,b,i=this,e=i.TZ,r=e&&e.Mf,c=i.eQ,a=i._zoomFactor,u=i.IW,s=i.AW,s=i.KQ(s,u),n=void 0!==n?n*a:i.gQ(),f=qn(r,e.yZ)*a,h=2===e.displayMode(),t=t.x,l=t+n,v=0,m=0,d=!1,p=r.getFrozenTrailingState(!0),w,g=r.Fi().Uy,b=i.gK(0),_=i.gK(1),o=i.gK(2);return!1===p&&h&&(o+=g),0===u||2===u?(v=0-c,m=b+_+o):1===u&&(v=s.x-c,h||(v-=C=N(r,r.getViewportRightColumn(0)+1,$n(r,1),!1)),m=v+(y=h?_:N(r,r.getViewportRightColumn(0)+1,$n(r,2),!1))),t<v&&(i.Eb?n-=v-t:l+=v-t,t=v),m<l&&(i.Eb?n-=l-m:i.iQ?t-=l-m:h?(x=i.NW.PW&&!e.ignoreDefaultLocation()?9:e.location().x,p=!1,v<(S=t-(k=2*M(x)+f+n))?(t=S,p=!0):(g=l-m,b=v-S,ho(n-Math.min(b,g),f,a)||(p=(b<g?(n-=b,t=v):n-=g,!0))),p||(t=((S=t-(l-m))<v&&(n-=v-S),v),d=!0)):m<(l=Dn(null==(o=e.location())?void 0:o.x)&&(x=e.location().x,v<(S=t-(k=2*M(x)+f+n)))?(t=S)+n:l)&&(t-=l-m)<v&&(n-=v-t,t=v)),{left:t,actualWidth:n,isCommentHorizontalCoverCell:d}},R.prototype.wKe=function(t,n,o){var i,e,r,c,a,u,s,f,h,n,a,t,l,v,m,d,p,t,w,g,b,_,C,y,p,t,w,b,i=this,e=i.TZ,r=e&&e.Mf,c=i.eQ,a=i._zoomFactor,u=i.IW,s=i.AW,f=i.KQ(s,u),h=2===e.displayMode(),n=void 0!==n?n*a:i.pQ(),a=t.y,t=r.Fi(),l=t.qC,v=a+n,m=0,d=0,p=r.getFrozenTrailingState(!1),t=t.Ty,w=i.mK(0),g=i.mK(1),b=i.mK(2);return!1===p&&h&&(b+=t),0===s||2===s?(m=0-c,d=w+g+b):1===s&&(m=f.y-c,h||(m-=_=N(r,r.getViewportBottomRow(0)+1,Qn(r,1),!0)),d=m+(C=h?g:N(r,r.getViewportBottomRow(0)+1,Qn(r,2),!0))),a<m&&(i.Eb?n-=m-a:v+=m-a,a=m),d<v&&(i.Eb?n-=v-d:i.iQ?a-=v-d:a=(p=a-(y=v-d))<m?(n-=m-p,m):p),o&&(v=a+n-c,0<(w=(t=i.wQ(r,e.bZ,e.yZ,s,u)).y+t.height-l-a)&&v+w<d?a+=w:0<(b=v-(t.y-l)+c)&&m<a-b&&(a-=b)),{top:a,actualHeight:n}},R.prototype.hK=function(){var t,n,o,i,e,r,e,c,t,a,n,t=this,n=t.TZ.Mf,e=t.CK,r=e.SK,e=e.TK,c=Qn(n,t.AW),t=$n(n,t.IW),a=N(n,r,c,!0),n=N(n,e,t,!1),o,i;return T(e<t?n:-n,r<c?a:-a)},Object.defineProperty(R.prototype,"Gxn",{get:function(){return this.TZ.Mf.options.rightToLeft},enumerable:!1,configurable:!0}),R.prototype.AK=function(t){var n,o,i,e,r,c,a,u,s,t,e,u,f,f,h,h,s,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r,c=n.NW.RW,a=L.ChangeComment;c.BW&&(u=n.hK(),s=t.pageX/e-c.x+u.x,t=t.pageY/e-c.y+u.y,0===s&&0===t||(n.Gxn&&(s=-s),u=e=void 0,c.FW<0?(f=c.LW.x+s,h=c.LW.y+t,e=n.bQ(T(f,h)),u=n.DW(e),(f=n.MQ(T(u.x,u.y))).x===o.location().x&&f.x===o.location().y||i.Qy().execute({cmd:"moveComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})):(o.autoSize(!1),h=n.dK(s,t,c.FW),e=n.bQ(T(h.x,h.y)),u=n.DW(e,I(h),O(h)),s=[],(f=n.MQ(T(u.x,u.y))).x===o.location().x&&f.y===o.location().y||s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})),I(u)!==o.width()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.width(),newValue:u.width,propertyName:m})),O(u)!==o.height()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.height(),newValue:u.height,propertyName:d})),0<s.length&&i.Qy().execute({cmd:"changeCommentTransaction",sheetName:i.name(),commands:s}))))},R.prototype.pg=function(t){var n,o,i,i,e,r,o,o,n=this,o=n.TZ.Mf,i={e:t,r:l};if(R.et(n,"preProcessMouseMove",i),!(i.r||(this.yK(t),o.getSelections()&&0<o.getSelections().length)))return i=n.NW,e=t.target,r=o.rt,o=o.uw(),o=T(t.pageX-o.left,t.pageY-o.top),e&&i.RW.BW&&(n.eW&&n.lK(t),1===n.AW&&(r.fk.y=o.y),1===n.IW&&(r.fk.x=o.x),r.a9()),K(t)},R.prototype.bg=function(t){var n,o,i,i,e,o,n=this,o=n.TZ.Mf,i={e:t,r:l};if(R.et(n,"preProcessMouseUp",i),!(i.r||o.getSelections()&&0<o.getSelections().length))return i=t.target,e=n.NW,(o=o.rt).s9=!1,o.l9(),i&&(n.AK(t),n.fK&&((0,x.GC$)(n.fK).remove(),n.fK=null,n.iQ=!1,n.Eb=!1),n.u2(),e.RW.BW=!1,n.yK(t)),K(t)},R.prototype.wK=function(t){var n,o,n,i,e,r,c,n=this,o=n.nQ;if(0<o.length&&(n.rK===D.active||n.rK===D.edit))for(n=n.SW,i=t.pageX-(0,x.GC$)(n).offset().left,e=t.pageY-(0,x.GC$)(n).offset().top,r=0;r<o.length;r++)if((c=o[r])&&c.contains(i,e))return r;return-1},R.prototype.dK=function(t,n,o){var i,e,r,o,t,i=this,e=-1,r=-1;switch(o){case 0:r=e=0;break;case 1:e=2,r=0;break;case 2:e=0,r=2;break;case 3:r=e=2;break;case 4:e=0,r=1;break;case 5:e=2,r=1;break;case 6:e=1,r=0;break;case 7:e=1,r=2}return i.Gxn&&(0===e?e=2:2===e&&(e=0)),o=i.IK(t,e),t=i.oh(n,r),V(o.x,t.y,o.w,t.h)},R.prototype.IK=function(t,n){var o,i,o,e,r,t,o=this,i=2*o.eQ,o=o.NW.RW,e=I(o.LW)-i;return 0===n?e-=t:2===n&&(e+=t),r=o.LW.x,0<=e?0===n&&(r+=t):0===n?r+=I(o.LW)-i:2===n&&(r+=e),t=I(o.LW),{x:r,w:t=1!==n?M(e)+i:t}},R.prototype.oh=function(t,n){var o,i,o,e,r,t,o=this,i=2*o.eQ,o=o.NW.RW,e=O(o.LW)-i;return 0===n?e-=t:2===n&&(e+=t),r=o.LW.y,0<=e?0===n&&(r+=t):0===n?r=O(o.LW)-i:2===n&&(r+=e),t=O(o.LW),{y:r,h:t=1!==n?M(e)+i:t}},R.prototype.XQ=function(t){var n,o,i,n,n=this,o=n.TZ.Mf;if(t){switch(i=v,t){case n.SW:i=Vt;break;case n.TW:i=Ot;break;case n.$W:i=It;break;case n.Ti:i=C;break;case n.li:i=y}i&&((0,x.GC$)(t).unbind(an+i).unbind(xt+i),n=function(t){o.P_(t),K(t)},(0,x.GC$)(t).bind(an+i,n).bind(xt+i,n))}},R.prototype.aQ=function(t,n){var o,i,e,i,o=this,i=o.TZ,e=i&&i.Mf;o.hQ(t,n),i=function(t){co(e,t)},(0,x.GC$)(t).bind(en+n,function(t){o.XZ(t)}).bind(rn+n,function(t){o.pg(t)}).bind(cn+n,function(t){o.bg(t)}).bind(an+n,i).bind(xt+n,i)},R.prototype.hQ=function(t,n){(0,x.GC$)(t).unbind(n)},R.prototype.oQ=function(){var r,t,c,a,u,t,r=this,t=r.TZ,c=t&&t.Mf,a=r.NW;r.vQ(),c&&(u=c.uw(),t=function(t){c.P_(t)},(0,x.GC$)(r.tQ).bind(en+Qt,function(t){var n,o,o,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top);n?(o=n.comment,o=a.mW(o),n.area===Bt?o.lW(t):n.area===Ht&&o.XZ(t),(0,x.GC$)(o.qW).css(Nt,parseInt((0,x.GC$)(r.$W).css(Nt)+1,10))):c.B_(t)}).bind(rn+Qt,function(t){var n,o,i,e,i,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top),o=r.tQ.style;n?(i=n.comment,(e=a.mW(i)).pg(t),n.area===Bt?o.cursor=Pt:n.area===Ht&&(o.cursor=yt)):(c.L_(t),r.NW.wW(l),(i=c.Dg())&&(o.cursor=i.style.cursor))}).bind(cn+Qt,function(t){var n,n,o,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top);n?(n=n.comment,(o=a.mW(n)).bg(t)):c.F_(t)}).bind("dblclick"+Qt,function(t){c.U_(t)}).bind(an+Qt,t).bind(xt+Qt,t))},R.prototype.vQ=function(){var t;(0,x.GC$)(this.tQ).unbind(Qt)},R.prototype.cQ=function(){var n,t,o,t,n=this,t=n.TZ,o=t&&t.Mf;t.commentState()!==D.edit&&n.Ti&&(n.dQ(),t=function(t){co(o,t)},(0,x.GC$)(n.Ti).bind(en+C,function(t){n.lW(t)}).bind(rn+C,function(t){n.pg(t)}).bind(cn+C,function(t){n.bg(t)}).bind(an+C,t).bind(xt+C,t))},R.prototype.dQ=function(){var t=this,n;t.TZ.commentState()!==D.edit&&t.Ti&&(0,x.GC$)(t.Ti).unbind(C)},R.prototype.sQ=function(){var t,n,o,i,t=this,n=t.TZ,o=n&&n.Mf,i=t.li;n.commentState()===D.edit&&i&&(this.mQ(),(0,x.GC$)(i).bind(en+y,function(t){t.stopPropagation()}).bind(rn+y,function(t){t.stopPropagation()}).bind(cn+y,function(t){t.stopPropagation()}).bind("keydown"+y,function(t){27!==t.keyCode&&9!==t.keyCode||(n.commentState(D.active,!0),K(t),X.F1(o))}).bind("focusout"+y,function(){(0,x.GC$)(i).val()!==n.text()&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,x.GC$)(i).val(),propertyName:Pt})}))},R.prototype.pKe=function(t){var n,o,i,e,i,r,c,r,a,u,s,f,h,l,v,r,t,n=this,o=n.TZ,i=n.eQ,e=o.padding(),i=2*(i+o.borderWidth());if(o.autoSize()&&!n.Eb&&!n.iQ){if(c=(r=n.yKe()).targetDOM,r=r.domValue,a=n.ml(c.style),u=5,s=$("M",a),f=5,(h=x.q.un(r,t-i,a))&&0<h.length){for(v=l=0;v<h.length;v++)l=Math.max(l,Q(h[v],a));r=ro(h,a),e&&(l+=(e.left||0)+(e.right||0),r+=(e.top||0)+(e.bottom||0)),t=n._zoomFactor,f=G(A(l,5)/t),s=G(r/t)}return 2===o.commentState()&&o.text(c.value),{width:f+i,height:s+i}}},R.prototype.yKe=function(){var t,n,o,t,t=this,n,t=t.TZ.commentState()===D.edit?(o=t.li).value:(o=t.Ti,tt.dI(o.innerHTML));return{targetDOM:o,domValue:t}},R.prototype.ml=function(t){var n,o,i,n=this,o=n.TZ,i="";return t.font?i+=t.font:(o.fontStyle()&&(i+=Et+o.fontStyle()),o.fontWeight()&&(i+=Et+o.fontWeight()),o.fontSize()&&(i+=Et+parseInt(o.fontSize(),10)*n._zoomFactor+"pt"),o.fontFamily()&&(i+=Et+o.fontFamily())),i},R.prototype.mQ=function(){var t,n=this.li;n&&(0,x.GC$)(n).unbind(y)},R.prototype.Fg=function(){var n=this,t=n.NW.RW;t.BW||((0,x.GC$)(mt).bind(rn+Zt,function(t){n.pg(t)}).bind(cn+Zt,function(t){n.bg(t)}),t.BW=!0)},R.prototype.u2=function(){var t=this.NW.RW;t.BW&&(t.BW=!1,x.GC$)(mt).unbind(Zt)},Sn=R,t.hW=Sn,u.$e(Sn),o.prototype.getUsedRange=function(){var t,n,o,i,e,r,c,a,t,n=this.all(),o={};if(n)for(e=i=void 0,r=0,c=n;r<c.length;r++)i=(a=c[r]).bZ,e=a.yZ,pt(o,{minRow:i,minCol:e,maxRow:i,maxCol:e});return o},o.prototype.dispose=function(t){var n,o,n=this,o;n.all().forEach(function(t){n.NK(t)}),n.kK(),!1!==t&&(n.Mf=l)},o.prototype.add=function(t,n,o){var i,e,r,r,o,i=this,e=i.Mf,r=e.getSpan(t,n);return!r||r.row===t&&r.col===n?(r=i.get(t,n),o="string"==typeof o?new bn(o):o,i.WB(t,n,o),e.Rj("comment",t,n,x.SheetArea.viewport,r,o),o):l},o.prototype.WB=function(t,n,o,i){var e=this,r=e.Mf,c=e.wB;e.DK(t,n),o&&(o.bZ=t,o.yZ=n,o.Mf=r,c.push(o),o.lp=e.GW,r.Ut.MW({type:"add",row:t,col:n,comment:o}),e.GW++,e._K(t,n,o),i||r.zw())},o.prototype.get=function(t,n){return this.cE[t+"_"+n]||l},o.prototype._K=function(t,n,o){this.cE[t+"_"+n]=o},o.prototype.EK=function(t,n,o){var i=t.bZ,e=t.yZ;this.get(i,e)===t&&this._K(i,e,v),this.Mf.Ut.MW({type:"rowcol",comment:t,row:i,col:e,newRow:n,newCol:o}),t.bZ=n,t.yZ=o,this._K(n,o,t)},o.prototype.remove=function(t,n){var o=this,i=o.DK(t,n),o=o.Mf;i&&(o.Rj(J,t,n,x.SheetArea.viewport,i,v),o.zw())},o.prototype.DK=function(t,n){var o,i,e,i,o=this,i=o.Mf,e=o.get(t,n);return e&&(i.Ut.MW({type:"remove",row:t,col:n,comment:e}),o.NK(e),H.VP(o.wB,e),(i=o.mW(e))&&(Sn.et(i,"dispose"),H.VP(o.UW,i)),o._K(t,n,v)),e},o.prototype.clear=function(t){var n,o,i,e,r,c,r,n=this,o=n.Mf,i=n.wB;for(o.suspendPaint(),e=i.length-1;0<=e;e--)c=(r=i[e]).bZ,r=r.yZ,(!t||c>=t.row&&c<t.row+t.rowCount&&r>=t.col&&r<t.col+t.colCount)&&n.remove(c,r);o.resumePaint()},o.prototype.all=function(){return this.wB.concat()},o.prototype.CB=function(t,n,o,i,e,r){(t||i)&&(t&&this.EK(t,e,r),i)&&this.EK(i,n,o)},o.prototype.getOuterContainer=function(t){var t=this.mW(t);return t?t.qW:l},o.prototype.HW=function(){var t=e($t);(0,x.GC$)(t).addClass("gc-comment-editor").css(g,0).css(b,0).css(r,c).css("margin",0).css(Dt,0).css("word-wrap","break-word").css("word-break","normal").css(a,jt).css("resize","none").css("outline","none").css("border","0px").css(zt,Ft).css(tn,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=t},o.prototype.zW=function(){var i=this,t=i.Mf;t&&(t.D3(s.ColumnChanged+_,function(t,n){var n=n.propertyName;n!==m&&"isVisible"!==n||i.jK()}),t.D3(s.RowChanged+_,function(t,n){var n=n.propertyName;n!==d&&"isVisible"!==n||i.jK()}),t.D3(s.ColumnWidthChanged+_,function(){i.jK()}),t.D3(s.RowHeightChanged+_,function(){i.jK()}),t.D3(s.CommentChanged+_,function(t,n){var o,n,n;n&&(o=n.propertyName,n=n.comment,n=i.mW(n))&&("location"===o?n.CQ():o!==m&&o!==d||n.SQ())}))},o.prototype.kK=function(){var t,n=this.Mf;n&&n._3(_)},o.prototype.mW=function(t){var n,o,i,e,n,o=this.UW;if(t)for(i=0;i<o.length;i++)if((e=o[i]).TZ===t)return e;return l},o.prototype.Oy=function(){return 0===this.wB.length},o.prototype.RK=function(){var t,n,o,i,e,t,n=this.wB;if(0<n.length){for(o=n[0].zIndex(),i=1;i<n.length;i++)o<(e=n[i]).zIndex()&&(o=e.zIndex());return o}return 0},o.prototype.JO=function(t,n){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)t<=(c=i[r]).bZ&&o.EK(c,c.bZ+n,c.yZ);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.JO(t,n)},o.prototype.qO=function(t,n){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)t<=(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ+n);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.qO(t,n)},o.prototype.xP=function(t,n){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,u=c.yZ,t<=a&&a<t+n&&o.remove(a,u);for(r=0;r<i.length;r++)t<(c=i[r]).bZ&&o.EK(c,c.bZ-n,c.yZ);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.xP(t,n)},o.prototype.NP=function(t,n){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,t<=(u=c.yZ)&&u<t+n&&o.remove(a,u);for(r=0;r<i.length;r++)t<(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ-n);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.NP(t,n)},o.prototype.pZ=function(){return this.MZ},o.prototype.qQ=function(t){var n=this;t&&t!==n.MZ&&(n.CZ(),n.MZ=t)},o.prototype.CZ=function(){var t,n,o,t=this,n=t.MZ;n&&(o=t.mW(n))&&!o.iQ&&!o.Eb&&(o.uQ()&&o.$Q(),n.commentState(D.normal),t.MZ=l)},o.prototype.$c=function(t){var n,o,n=this,o=n.mW(t);o||(o=new Sn(t,n),n.UW.push(o)),o.rQ()},o.prototype.wW=function(t){var n=this,o=n.MZ;if(o)if(1===o.displayMode()){if(o.commentState()===D.edit)return}else if(o.commentState()===D.edit||o.commentState()===D.active)return;t!==n.PW&&(n.PW&&n.NK(n.PW),t&&2===t.displayMode()?n.RW.BW||t.BK||((n.PW=t).BK=dt.setTimeout(function(){n.$c(t)},200)):n.PW=l)},o.prototype.NK=function(t){var n=this,o=n.mW(t);o&&o.LQ()&&(o.lQ(),t===n.MZ)&&n.Mf.cR(),clearTimeout(t.BK),delete t.BK},o.prototype.LK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,x.GC$)(t.YW).show()},o.prototype.FK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,x.GC$)(t.YW).hide()},o.prototype.PK=function(t,n,o){var t,t,t=this.mW(t);return!(!t||!(t=t.pK()))&&t.contains(n,o)},o.prototype.GK=function(t,n,o){var t,t,t=this.mW(t);return!(!t||!(t=t.bK()))&&t.contains(n,o)},o.prototype.hitTest=function(t,n){for(var o,i,e,r,o=this,i=l,e=0;e<o.wB.length;e++)r=o.wB[e],Fn(o.Mf,r)&&o.PK(r,t,n)&&(!i||r.zIndex()>i.zIndex())&&(i=r);return i?{x:t,y:n,comment:i,area:o.GK(i,t,n)?Bt:Ht}:l},o.prototype.nK=function(t){var n=this,o=n.RK();return t===n.PW?o+2:t===n.MZ?o+1:t.zIndex()},o.prototype.jK=function(){this.UW.forEach(function(t){t.TQ()})},o.prototype.fromJSON=function(t,n){var o,i,e,r,o=this;if(t&&0!==t.length){for(i=o.GW=0;i<t.length;i++)e=t[i],(r=new bn).fromJSON(e,n),3!==r.commentState()&&(o.MZ=r),o.Mf.Ut.pI.WB(r.bZ,r.yZ,r,!0);o.Mf.zw()}},o.prototype.yh=function(t,n,o,i){var e,r,c,a,u,s,f,h,l,e=this;if(t&&n){for(e.GW=0,r=S(t,"commentList"),c=Rn(n),r=r.c_,a=0;a<r.length;a++)u=r[a],l=On(c,f=(s=new bn).bZ=x.IndexHelper.qi(u.ref),h=s.yZ=x.IndexHelper.$i(u.ref)),u.lossless&&(s.showShadow(u.lossless.showShadow),s.indicatorSize(u.lossless.indicatorSize),s.indicatorColor(u.lossless.indicatorColor),s.ignoreDefaultLocation(u.lossless.ignoreDefaultLocation),s.commentState(u.lossless.commentState)),s.yh(e.Mf,u,l,o,i),3!==s.commentState()&&(e.MZ=s),e.Mf.Ut.pI.WB(s.bZ,s.yZ,s,!0);e.Mf.zw(),e.Pfe=S(t,"authors")}},o.prototype.toJSON=function(){var t,n,o,t=this.wB;if(!t||0===t.length)return v;for(n=[],o=0;o<t.length;o++)n.push(t[o].toJSON());return 0===n.length?v:n},Mn=o,so.prototype.L0=function(){this.Mf=l},so.prototype.ZW=function(){var t=e(f);return(0,x.GC$)(t).addClass("gc-comment-layoutPanel"+Et+At).css([r,g,b,d,m,a,Nt,Gt],[c,0,0,0,0,Mt,Ut,Wt]),t},so.prototype.bW=function(t){var n,o,i,o,n=this;t.Ut.pI.Oy()||(o=t.Fi(),(0,x.GC$)(n.YW).css(g,o.x+o.XC).css(b,o.y+o.qC),n.Mf!==t&&(n.Mf&&(o=(i=n.Mf.Ut).pI.pZ())&&o.commentState()===D.edit&&o.commentState(D.active,!0),n.Mf=t))},so.prototype.yW=function(t,n,o){var i,e,r,c,a,o,u,n,u,i,i=o.row,e=o.col,r=o.x,c=o.y,a=I(o),o=O(o),u=this;n===x.SheetArea.viewport&&u.Mf&&(n=u.Mf.Ut.pI.get(i,e))&&(u=this.Mf,i=(n.indicatorSize()||6)*(u?u.zoom():1),t)&&0<a&&0<o&&(t.save(),t.rect(r,c,a,o),t.clip(),t.fillStyle=n.indicatorColor()||"red",t.beginPath(),u.options.rightToLeft?(t.moveTo(r+i,c),t.lineTo(r,c),t.lineTo(r,c+i),t.lineTo(r+i,c)):(t.moveTo(r+a-i,c),t.lineTo(r+a,c),t.lineTo(r+a,c+i),t.lineTo(r+a-i,c)),t.fill(),t.restore())},so.prototype.WW=function(t){var n,o,i,e,r,c,c;if(this.VW){for(t.LK(),n=this.Mf,o=t.all(),i=0;i<o.length;i++)e=o[i],r=t.mW(e),this.UK(t,e)?(1===e.displayMode()&&e===t.PW&&(t.PW=l),r&&r.LQ()?r.fQ():t.$c(e)):r&&r.LQ()&&t.NK(e);(c=t.pZ())&&(c=t.mW(c))&&c.LQ()&&0<n.getSelections().length&&n.Ut.do("clearSelection")}else t.FK()},so.prototype.UK=function(t,n){var o=t.Mf;if(o&&qn(o,n.yZ)&&Kn(o,n.bZ))switch(n.displayMode()){case 1:return!0;case 2:if(3!==n.commentState())return t&&n!==t.PW&&(t.PW=n),!0;if(n===t.PW)return!0}return!1},Nn=so,n=u.Y8,u.GC$.extend(n.prototype,{MW:function(t){var n,o,n=this.G8;n&&(o=(o=n.commentChanges)||(n.commentChanges=[])).push(t)},HK:function(t,n){var o,i,e,r,c,a,a,u,o,i=this.pI;if(t)for(e=0;e<t.length;e++)c=(r=t[e]).comment,"add"===r.type?((a=new bn).fromJSON(c),(c=a).commentState(3)):c=i.get(c.rowIndex,c.colIndex),"add"===r.type?i.WB(r.row,r.col,c):"remove"===r.type?i.DK(r.row,r.col):"property"===r.type?(a=r.name,u=r.newValue,"commentState"!==a&&c[a](u)):"rowcol"===r.type&&i.EK(c,r.newRow,r.newCol);else n&&"changeComment"===n.cmd&&"commentState"!==n.propertyName&&(c=i.get(n.row,n.col))[n.propertyName](n.newValue)},zK:function(t){var n,o,i,e,r,c,a;if(t)for(o=(n=this).pI,i=t.length-1;0<=i;i--)r=(e=t[i]).comment,"add"===e.type?o.DK(e.row,e.col):"remove"===e.type?o.WB(e.row,e.col,e.comment):"property"===e.type?(c=e.name,a=e.value,r[c](a)):"rowcol"===e.type&&o.EK(r,e.row,e.col)},OL:function(t,n,o,i){for(var e,r,c,e=this,r=0;r<o;r++)for(c=0;c<i;c++)0===r&&0===c||e.getCell(t+r,n+c).comment()&&e.comments.remove(t+r,n+c)}}),n.ch("comments",{init:function(){this.pI=new Mn(this.Mf)},applyChanges:function(t){var n,o,i,t,i,n=this,o=t.command,i=t.changes,t=t.isUndo,i=i&&i.commentChanges;(i||o)&&(t?n.zK(i):n.HK(i,o))},undo:function(t){var t=t.commentChanges;t&&this.zK(t)},dispose:function(t){var n=this,t=t&&t.clearCache;n.pI&&n.pI.dispose(t),!1!==t&&(n.pI=l)}}),x.Worksheet.ch("comments",jn={getUsedRange:function(t){var n,o,i;t.type&x.UsedRangeType.comment&&(i=(o=(n=this).comments).getUsedRange(),pt(t.range,i))},init:function(){var n=this;n.comments=n.Ut.pI,n.pW=function(){var t=n.parent;if(t)return t.VK||(t.VK=new Nn(t.j2())),(t.VK.Mf=n).parent.VK}},dispose:function(t){!1!==t.clearCache&&(this.pW=l,this.comments=l),pn(this,(0,x.GC$)(this.Dg()))},setHost:function(t){var n;t&&((n=this.Ut.pI)&&n.zW(),dn(t,this))},onLayoutChanged:function(t){var n,o,i,e,r,c,a;!k(t.sheetArea)&&3!==t.sheetArea||(o=(n=this).Ut.pI,i=t.changeType,e=t.row,r=t.rowCount,c=t.col,a=t.colCount,"addRows"===i?o.JO(e,r):"deletingRows"===i?o.xP(e,r):"addColumns"===i?o.qO(c,a):"deletingColumns"===i?o.NP(c,a):t.sheetArea===x.SheetArea.viewport&&("clear"===i?4==(4&t.type)&&o.clear(new u.Range(e,c,r,a)):"addSpan"===i?Hn.call(n,!0,e,c,r,a):"removeSpan"===i&&Hn.call(n,!1,e,c)))},paint:function(t){this.Ut.pI.Oy()||(Jn.call(this),this.CW(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==x.SheetArea.viewport||Xn.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,n){var o;n&&n.ignoreStyle||(t.comments=this.Ut.pI.toJSON())},fromJson:function(t,n,o){var i,o,i;o&&o.ignoreStyle||t&&(o=n?t.commentManager:t.comments)&&this.Ut.pI.fromJSON(o,n)},lastNonNullRowAndCol:function(){var t,n,o,i,e,r,c,t=0,n=0,o=this.Ut.pI;if(o&&(i=o.UW)&&0<i.length)for(e=0,r=i.length;e<r;e++)(c=i[e])&&c.TZ&&(c.RQ>t&&(t=c.RQ),c.jQ>n)&&(n=c.jQ);return{lastNonNullRow:t,lastNonNullCol:n}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(t){var n=this,o=n.Ut.pI.pZ();o&&n.rt.Pi(t.e)&&Tn(n,o)&&(o.commentState(2,!0),t.r=!0)},yh:function(t,n,o){var i,t,e,e,r,i,c,a,u,s,f,r,t,h,i=S(t,"legacyDrawing"),t=t.rels,e=o&&!1===o.includeStyles;if(i&&!e){for(e=this,r=t.c_,i=i&&i["r:id"],a=0,u=r;a<u.length;a++)if(0<(f=(s=u[a]).Target).indexOf(bt)){c=f.split("/").pop().slice(0,-4);break}r=x.Util.Gr(t,i,n),t=n.comments&&n.comments[c],(h=e.comments).yh(t,r,o,n)}},wh:function(t,n,o){var o,i,e,i,r,c;!t||o&&!1===o.includeStyles||(o=t.rels,i=this.comments&&this.comments.all(),e=this.parent.Cp,o&&i&&0<i.length&&(i=ht(o),c=this.wp,o.c_.push({n_:gt,Id:r=wt+i,Type:x.RelationshipConstants.hc,Target:"../"+x.XFileConstants.ou+c+"."+x.XFileConstants.Cr}),x.Util.Hr(t,e)))}}),u.Workbook.ch("comments",zn={init:function(){L.SZ(this.commandManager())},dispose:function(){this.VK&&(this.VK.L0(),this.VK=l)},wh:function(t,n,o){var i,e,r,c,a,u,s,f,a,h,l,v,m,d,i,e=this.sheets;if(!o||!1!==o.includeStyles)for(r=0;r<e.length;r++)if(c=e[r],a=lt(t,c.name()),(s=(u=c.comments)&&u.all())&&0<s.length)for((f=x.Util.Ur(t,a)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600","o:spt":"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),a=u.Pfe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},h=t[bt+c.wp]={n_:bt,r_:[13,14,15,16],c_:[a,{n_:"commentList",c_:[]}]},l=x.Util.qr(c.wp,f),v=0;v<s.length;v++)(d=(m=s[v]).wh(l)).commentData&&(d.commentData.lossless={showShadow:m.showShadow(),indicatorSize:m.indicatorSize(),indicatorColor:m.indicatorColor(),ignoreDefaultLocation:m.ignoreDefaultLocation(),commentState:m.commentState()}),l++,f.c_.push(d.vmlDrawingData),h.c_[1].c_.push(d.commentData)}})},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets},Touch:function(t){t.exports=GC.Spread.Sheets.Touch}},i={},t=e("./dist/plugins/comment/comment.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Comments=t}();
/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,e,n;function o(n){var t,t,t=e[n];return void 0!==t||(t=e[n]={exports:{}},i[n].call(t.exports,t,t.exports,o)),t.exports}i={"./dist/plugins/namebox/namebox-actions.js":function(n,t,i){var e,t,l,h,v,i,o,m,d,t,b,x,r,u,a,s,c,f,g;function C(n,t){return f.call(this,n,t)||this}function p(n,t){return g.call(this,n,t)||this}e=this&&this.__extends||(c=function(n,t){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}c(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t=i("Common"),l=i("Core"),h=i("SheetsCalc"),v=i("./dist/plugins/namebox/namebox.js"),i=i("./dist/plugins/namebox/namebox.ns.js"),o=l.Commands.ActionBase,m=t.Common.zf,d=t.Common.lt.ht,t=new t.Common.ResourceManager(i.SR,"NameBox"),b=t.getResource.bind(t),x=void 0,r="addCustomName",u="navigateToRange",e(C,f=o),C.prototype.execute=function(){var n,t,i,e,n,o,n,r,u,a,s,c,f,l,n=this,t=!1;if(n.canExecute()){e=(i=n.Mf).getParent(),o=(n=n.tT).nameBox,n=n.selectorValue;try{if(r=i.getSelections(),d(r)||0===r.length)return;if(n.toLowerCase()===v.PRINT_AREA&&i.printInfo)return u=r[0],(a=i.printInfo()).rowStart(u.row),a.rowEnd(u.row+u.rowCount-1),a.columnStart(u.col),a.columnEnd(u.col+u.colCount-1),!0;for(s=i.name(),m.fJ(s,"'")&&m.dT(s,"'")||(s="'"+s+"'"),c=[],f=void 0,l=0;l<r.length;l++)c.push(s+"!"+(0,h.rangeToFormula)(r[l],i.getActiveRowIndex(),i.getActiveColumnIndex(),x,!!e.options.referenceStyle));f=c.join(","),e.addCustomName(n,f,i.getActiveRowIndex(),i.getActiveColumnIndex(),""),t=!0}catch(n){i.jT(15,b().invalidName),o.updateNameRangeSelectorValue()}}return t},a=C,l.Commands[r]={canUndo:!1,execute:function(n,t){l.Commands.zA(n,a,t)}},e(p,g=o),p.prototype.execute=function(){var n,t,i,e,n,o,r,u,n,a,s,c,f,e,n=this,t=!1;if(n.canExecute()){if(e=(i=n.Mf).getParent(),o=(n=n.tT).nameBox,r=n.selectorValue,u=n.selections,n=n.sheetName,a=e.getSheetFromName(n),(s=e.getActiveSheet())!==a&&(e.I2(e.getSheetIndex(n),1,!1,!0),s.b2(!1,!0),a.b2(!0,!0)),a.clearSelection(),c=u[0],d(c))return;for(a.setSelection(c.row,c.col,c.rowCount,c.colCount),f=1;f<u.length;f++)c=u[f],a.addSelection(c.row,c.col,c.rowCount,c.colCount);o.selector.val(r),o.cpt=o.selector.val(),e={sheet:i,sheetName:i.name(),row:c.row,col:c.col},i.ki(l.Events.EnterCellInternal,e),t=!0}return t},s=p,l.Commands[u]={canUndo:!1,execute:function(n,t){l.Commands.zA(n,s,t)}},l.Commands.fpt=function(n){n.register(r,l.Commands[r]),n.register(u,l.Commands[u])}},"./dist/plugins/namebox/namebox-list.js":function(n,t,i){var e,i,o,r,u;function a(n,t){var n=u.call(this,n)||this;return t&&n.setNameList(t),n}e=this&&this.__extends||(r=function(n,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}r(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.NameBoxList=void 0,i=i("CellTypes"),u=i.List,e(a,u),a.prototype.setNameList=function(n){var t=this;t.setOptions({items:t.lpt(n),textEllipsis:!0})},a.prototype.lpt=function(n){return n.map(function(n){return{text:n,value:n}})},a.CustomNameChange="CustomNameChange",t.NameBoxList=a},"./dist/plugins/namebox/namebox.entry.js":function(n,t,i){var e,o,r,u,a,e=this&&this.__createBinding||(Object.create?function(n,t,i,e){void 0===e&&(e=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,e,o)}:function(n,t,i,e){n[e=void 0===e?i:e]=t[i]}),o=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=t.NameBox=void 0,i("./dist/plugins/namebox/namebox-actions.js"),r=i("Core"),u=i("./dist/plugins/namebox/namebox.js"),Object.defineProperty(t,"NameBox",{enumerable:!0,get:function(){return u.NameBox}}),o(i("./dist/plugins/namebox/namebox.ns.js"),t),t.findControl=a=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,r.GC$)(n).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(F,h,n){var v,s,m,r,u,o,n,a,t,d,c,i,f,l,b,e,x,g,C,p,j,w,_,y,O,n,N,E,G,H;function T(n,t,i){var e,o;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.cpt="",this.hpt=!1,this.YRe=!1,n&&t&&(n instanceof HTMLElement?e=n:"string"==typeof n&&(e=document.getElementById(n)),e)&&((o=this).hpt=!0,o.Ti=e,a(e).data(b,o),o.options=O(G,function(n,t,i){o.Ob(n,t,i)}),o.Zp(i),o.dpt(),o.hpt=!1,o.bind(t))}function R(n,t){var i,e,o,r,t,r,i="",e=t.rowCount,o=t.colCount,r=t.row+1,t=t.col+1;return 1===e&&1===o?i=A(n,r,t):e<0&&0<o?i=o+"C":o<0&&0<e?i=e+"R":e<0&&o<0?(r=k(n))&&(i=r.getRowCount()+"R x "+r.getColumnCount()+"C"):i=e+"R x "+o+"C",i}function M(n,t){var i,e,o,i=!1,e=t.getSpans();if(e)for(o=0;o<e.length;o++)if(e[o].row===n.row&&e[o].col===n.col&&e[o].rowCount===n.rowCount&&e[o].colCount===n.colCount){i=!0;break}return i}function A(n,t,i,e){var o,r,u,a,s,c,f,l,h;if(t<1||i<1)return null;if(o="",u=(r=k(n))&&r.name(),e&&r){if(a=M(e,r),(s=n.getCustomNames())!==d)for(c=0;c<s.length;c++)if((f=s[c].getExpression())&&f.type===v.ExpressionType.reference&&f.source&&f.source.getName&&u===f.source.getName()&&null!==(l=f.getRange(0,0))&&l!==d&&(l.row===e.row&&l.col===e.col&&l.row+l.rowCount===e.row+e.rowCount&&l.col+l.columnCount===e.col+e.colCount||l.row===e.row&&l.col===e.col&&a)){o=s[c].getName();break}if(""===o&&s!==d)for(c=0;c<s.length;c++)(f=s[c].getExpression())&&f.type===v.ExpressionType.reference&&((l=f.getRange(0,0)).row===e.row&&l.column===e.col&&l.row+l.rowCount===e.row+e.rowCount&&l.column+l.columnCount===e.col+e.colCount||l.row===e.row&&l.column===e.col&&a)&&(o=s[c].getName())}if(""===o)switch(n.options.referenceStyle){case 0:for(;0<i;)0==(h=i%26)?(o="Z"+o,i--):o=String.fromCharCode("A".charCodeAt(0)+h-1)+o,i=parseInt((i/26).toString(),10);o+=t.toString();break;case 1:o="R"+t.toString()+"C"+i.toString()}return o}function B(n,t,i){var e,o,o;if(void 0===i&&(i=!1),!(e=t.getActiveSheet())){if((o=t.getActiveSheetTab())&&o._gi===s.SheetType.reportSheet)return!1;e=o.getSheet&&o.getSheet()||o.Mf}return!!e&&!(!(o=n.getExpression())||i&&!I(o,t,e))&&(-1<E.indexOf(o.type)||o.type===v.ExpressionType.operator&&16===o.operatorType)}function D(n){var t=n.row,i=n.col,e=n.rowCount,n=n.colCount;return-1!==t&&-1!==e||(e=t=-1),-1!==i&&-1!==n||(n=i=-1),new s.Range(t,i,e,n)}function S(n){if(n)return n.row+e+n.col+e+n.rowCount+e+n.colCount}function L(t,i){var e,n;try{e=(n=o.Common.CultureManager.getCultureInfo()).localeCompare?n.localeCompare(t,i):t.localeCompare(i,"en")}catch(n){e=t.localeCompare(i)}return e}function I(n,t,i){var e,o,r,u,a;try{if(e=!!t.options.referenceStyle,!(o=(0,m.formulaToRanges)(i,(0,m.expressionToFormula)(t,n,i.getActiveRowIndex(),i.getActiveColumnIndex(),e),d,d,d,e))||o.length<1)return;for(r=0,u=o;r<u.length;r++)if(a=u[r],!(t.getSheetFromName(a.sheetName)||t.getSheetTab(a.sheetName)&&t.getSheetTab(a.sheetName)._gi!==s.SheetType.reportSheet))return}catch(n){return}return 1}function U(n){return new RegExp(/[^A-Za-z0-9_.!?'",:\u0080-\uFFFF\\$]+/g).test(n)}function k(n){var t,n,t=n.getActiveSheet();return t=t||(n=n.getActiveSheetTab())&&(n.getSheet&&n.getSheet()||n.Mf)}function V(n){return!!n&&(n._gi===s.SheetType.tableSheet||n._gi===s.SheetType.ganttSheet)}Object.defineProperty(h,"__esModule",{value:!0}),h.getActiveSheet=h.NameBox=h.PRINT_AREA=void 0,v=n("CalcEngine"),s=n("Core"),m=n("SheetsCalc"),r=n("CellTypes"),u=n("./dist/plugins/namebox/namebox-list.js"),o=n("Common"),n=n("./dist/plugins/namebox/namebox.ns.js"),a=s.GC$,t=null,d=void 0,c="A1",i=".gc-name-box",f="div",l="input",b="name-box",e="_",x="invalid",g="gc-name-box-",C="container",p="selector",j="dropdown",w="disabled",_=o.Common.lt.ht,y=s.util.En,O=s.util.b0,n=new o.Common.ResourceManager(n.SR,"NameBox"),N=n.getResource.bind(n),h.PRINT_AREA="print_area",E=[v.ExpressionType.reference,v.ExpressionType.name,v.ExpressionType.structReference],G={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},Object.defineProperty(T.prototype,"selector",{get:function(){return a("."+g+p,this.Ti)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"dropdown",{get:function(){return a("."+g+j,this.Ti)},enumerable:!1,configurable:!0}),T.prototype.getHost=function(){return this.Ti},T.prototype.getCustomNameList=function(n){var t,i,i,e,o,r,i,u,a,s,c,f,l,h,v,m,d;if(void 0===n&&(n=!1),!(i=(t=this).vpt))return[];if(!(i=k(i)))return[];for(e=[],o=t.mpt(i,n),r=t.gpt(n),i=o,u=function(n){return n.getName().toLowerCase()},a=function(n){var t=r[n];o.find(function(n){return u(n)===u(t)})&&r.splice(n,1)},s=r.length-1;-1<s;s--)a(s);for(c=0,f=i=i.concat(r);c<f.length;c++)l=f[c],e.push(l.getName());for(v=0,m=h=t.ppt();v<m.length;v++)d=m[v],e.push(d.name);return e},T.prototype.bind=function(n){var t=this;t.unbind(),n&&(t.vpt=n,t._id=n.bpt()),t.rebuild()},T.prototype.unbind=function(){var n=this;n.ypt(),n.wY=t,n.wpt(),n.vpt=t,n._id=t},T.prototype.refresh=function(){this.updateNameRangeSelectorValue()},T.prototype.rebuild=function(){var n=this;n.hpt||(n.wpt(),n.dpt(),n.v7(),n.Mpt(),n.refresh())},T.prototype.executeCommand=function(n,t,i){var e,o,r,e=this,o=e.vpt,r=k(o);r&&o.commandManager().execute({cmd:n,sheetName:i||r.name(),nameBox:e,selectorValue:e.selector.val(),selections:t||r.getSelections()})},T.prototype.readonly=function(n){if(0===arguments.length)return this.YRe;this.YRe!==!!n&&(this.YRe=!!n,this.rebuild())},T.prototype.updateReadonlyStatus=function(){var n=this,t=n.vpt;t&&n.readonly(V(t.getActiveSheetOrSheetTab()))},T.prototype.dispose=function(){var n=this;n.unbind(),n.wY&&n.wY.dispose(),n.wY=t,n.Cpt&&n.Cpt.close(),n.Cpt=t,a(n.Ti).data(b,t),n.Ti.innerHTML="",n.Ti=t},T.prototype.Ob=function(n,t,i){var e=this;if(t!==i&&(e.options[n]=t,!e.hpt))switch(n){case"dropDownMaxHeight":case"showCustomNameList":e.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":e.refresh()}},T.prototype.Zp=function(n){var i,n,i=this.options,n=n||{};n=a.extend(!0,{},G,n),a.each(n,function(n,t){i.hasOwnProperty(n)&&(i[n]=t)})},T.prototype.Mpt=function(){var n=this;n.wY&&n.wY.setNameList(n.Spt())},T.prototype.Spt=function(){var i=this.getCustomNameList(!0),i;return i=i.filter(function(n,t){return i.indexOf(n)===t}).sort(L)},T.prototype.ypt=function(){var n=this;n.Cpt&&(n.Cpt.close(),n.Cpt=t,n.wY=t)},T.prototype.Tpt=function(){var n,t,i,i,i,e,o,n=this;n.ypt(),(i=k(t=n.vpt))&&!i.isReportTemplateSheet&&(i=y(f),i=new u.NameBoxList(i,n.Spt()),e=new r.PopupControl(i.getContainer(),n.Ti,{align:s.DropDownAlignment.Near,hostElement:n.vpt.getHost(),direction:s.DropDownDirection.Down,Oue:n.vpt&&n.vpt.options.enableAccessibility}),o=+n.options.dropDownMaxHeight||G.dropDownMaxHeight,a(i.getContainer()).css(["width","maxHeight"],[a(n.Ti).width(),o+"px"]).addClass("gc-name-box-list"),e.open(),n.wY=i,n.Cpt=e)},T.prototype.dpt=function(){var n,t,i,e,o,r,n=this,t=n.Ti,i=n.readonly();t.innerHTML="",(e=y(f)).classList.add(g+C),o=y(l),n.vpt&&n.vpt.options.enableAccessibility&&(o.setAttribute("aria-label",N().nameBox),o.setAttribute("role","combobox"),o.setAttribute("aria-expanded","false"),o.setAttribute("aria-autocomplete","list")),o.classList.add(g+p),i&&(o.setAttribute(w,w),o.classList.add(g+w)),n.options.showCustomNameList&&!i&&(r=y(f)).classList.add(g+j),e.appendChild(o),r&&e.appendChild(r),t.appendChild(e)},T.prototype.jf=function(n){var t;if(n=n||this.vpt)return(t=k(n))||void 0},T.prototype.Apt=function(){return i+(this._id||"")},T.prototype.v7=function(){this.ZRe(),this.QRe()},T.prototype.ZRe=function(){var e,i,n,t,e=this,i=e.vpt,n=e.Ti,t=e.Apt();i.bind(s.Events.SelectionChanging+t,n,function(){var n,n,n,n,n=e.jf();n&&n.getSelections&&null!==(n=(n=n.getSelections())[n.length-1])&&n!==d&&(n=R(i,n),e.selector.val(n||""),e.cpt=n||"")}),i.bind(s.Events.InternalSelectionChanging+t,n,function(n,t){var t,t,t=t.newSelections;null!==t&&t!==d&&(t=R(i,t),e.selector.val(t||""),e.cpt=t||"")}),i.bind(s.Events.SelectionChanged+t,function(n,t){var i=e.Ipt();e.updateNameRangeSelectorValue(i,t.shiftKey)}),i.bind(s.Events.DragDropBlockCompleted+t,function(){e.updateNameRangeSelectorValue()}),i.bind(s.Events.ActiveSheetChanged+t,function(){e.updateNameRangeSelectorValue()}),i.bind(s.Events.ActiveSheetChangedInternal+t,function(n,t){e.updateNameRangeSelectorValue(),e.updateReadonlyStatus()}),i.bind(s.Events.EnterCellInternal+t,function(){e.updateNameRangeSelectorValue()}),i.bind(s.Events.ClipboardPasted+t,function(){e.updateNameRangeSelectorValue()}),i.bind(s.Events.ShapeSelectionChanged+t,function(){e.I2t||e.updateNameRangeSelectorValue()}),i.bind(s.Events.FloatingObjectSelectionChanged+t,function(){e.I2t||e.updateNameRangeSelectorValue()})},T.prototype.QRe=function(){var n,t;this.readonly()||(t=(n=this).Apt(),n.selector.bind("blur"+t,n.xpt.bind(n)),n.selector.bind("keydown"+t,n.Npt.bind(n)),n.selector.bind("focus"+t,function(){n.selector[0].select()}),n.dropdown.bind("mousedown"+t,n.kpt.bind(n)))},T.prototype.wpt=function(){this.WRe(),this.JRe()},T.prototype.WRe=function(){var n,t,n,n=this,t=n.vpt,n=n.Apt();t&&t.unbind(n)},T.prototype.JRe=function(){var n,t,n,t=this.Apt();a(document).unbind(t)},T.prototype.updateNameRangeSelectorValue=function(n,t){var i,e,n,e,n,e,o,r,u,i=this;!_(n)&&i.selector?(i.selector.val(n||""),i.cpt=i.selector.val()):0<(e=(n=i.Dpt()).length)?(e=1===e?n[0].name():"",i.selector&&(i.selector.val(e),i.cpt=i.selector.val())):(n=i.Ipt(),_(n)?(o=k(e=i.vpt))?null!==(r=o.getSelections()[o.getSelections().length-1])&&r!==d&&(u=void 0,u=t?R(e,r):A(e,o.getActiveRowIndex()+1,o.getActiveColumnIndex()+1,r),i.selector)&&(i.selector.val(u||""),i.cpt=i.selector.val()):i.selector.val(c):(i.selector.val(n),i.cpt=i.selector.val()))},T.prototype.Ipt=function(){var n,t,i,e,o,r,o,u,n=this,t,i=k(n.vpt),e="";if(i)return o=i.getSelections(),r=i.name(),1===o.length?(e=S(D(o=o[0])),u="",M(o,i)&&(u=S(new s.Range(o.row,o.col,1,1))),n._pt(e,i.name())||n.Ept(e,u,r)):void 0},T.prototype.Ept=function(n,t,i){var e,o,r,u,a,s,c,f,l,f,l;if(n||t)for(u=0,a=r=(e=this).mpt().concat(e.gpt());u<a.length;u++)if(f=(c=(s=a[u]).getName()).toLowerCase()===h.PRINT_AREA,l=(o=s.WK)&&o.source,(f&&!l||l&&l instanceof m.SheetSource&&l.getName()===i)&&(f=o.getRange(s.FY||0,s.jpt||0))&&(n===(l=S(f))||t===l))return c},T.prototype._pt=function(n,t){var i,e,o,r;if(n)for(e=0,o=i=this.ppt();e<o.length;e++)if(t===(r=o[e]).sheet&&n===S(r.range))return r.name},T.prototype.mpt=function(n,t){var i,e;return void 0===t&&(t=!1),i=this.vpt,e=[],(e=(n=n||i&&k(i))?n.getCustomNames():e).filter(function(n){return B(n,i,t)})},T.prototype.gpt=function(t){var i,n;return void 0===t&&(t=!1),n=[],(n=(i=this.vpt)&&i.getCustomNames()).filter(function(n){return B(n,i,t)})},T.prototype.ppt=function(){for(var n,t,i,e,o,r,u,a,s,c,n,t,i,e=[],o=[],r=0,u=this.vpt.sheets;r<u.length;r++)(a=u[r]).tables&&(o=o.concat(a.tables.all()));for(s=0,c=o;s<c.length;s++)n=c[s],e.push({name:n.name(),range:n.dataRange(),sheet:null==(n=n.Mf)?void 0:n.name()});return e},T.prototype.Dpt=function(){var t,n,i,t=[],n,i;return this.Opt().forEach(function(n){n.isSelected()&&t.push(n)}),t},T.prototype.Opt=function(n){var t,n,t,i,e,n,t=this.vpt,n=n||k(t);return n?(t=n.shapes&&n.shapes.all()||[],i=n.floatingObjects&&n.floatingObjects.all()||[],e=[],n.charts&&n.charts.tIe&&(e=n.charts.all()),n=n.pictures&&n.pictures.all()||[],t.concat(e).concat(n).concat(i)):[]},T.prototype.Kfe=function(n){var t,i,e,o,r,u,a;if(n){for(i=(t=this).Opt(),e=n.split(",").map(function(n){return n.trim()}),r=function(n){var t,n,t=e[n],n=i.find(function(n){return n.name()===t});if(!n)return{value:void 0};(o=o||[]).includes(n)||o.push(n)},u=0;u<e.length;u++)if("object"==typeof(a=r(u)))return a.value;return o}},T.prototype.xpt=function(){var n,t,i,e,o,e,n=this,t=n.selector.val(),e=n.Kfe(t);if(e)n.Bpt(),e.forEach(function(n){return n.isSelected(!0)});else if(!t||0<n.Dpt().length)n.Jfe||n.I2t||n.Bpt(),n.updateNameRangeSelectorValue(t);else if(n.cpt.toLocaleUpperCase()!==t.toLocaleUpperCase()){e=k(o=n.vpt);try{i=n.Lpt()}catch(n){if(n.message===x&&e)return void e.jT(15,N().invalidName)}i&&i.sheetName?n.options.enableNavigateToRange&&0<i.ranges.length&&(n.Bpt(i.sheetName),n.executeCommand(n.navigateToRangeCommand,i.ranges,i.sheetName)):n.options.enableAddCustomName&&!e.isReportTemplateSheet&&n.executeCommand(n.addCustomNameCommand)}},T.prototype.Npt=function(n){var t,i,e,t=this,i=t.selector.val();"Enter"===n.key&&(t.Jfe=!1,(e=t.Kfe(i))?(t.Bpt(),t.I2t=!0,e.forEach(function(n){return n.isSelected(!0)}),t.updateNameRangeSelectorValue(),t.I2t=!1,t.Jfe=!0):0<t.Dpt().length&&i&&(t.Dpt()[0].name(i),t.Jfe=!0),n.currentTarget.blur(),t.Jfe=!1,t.vpt)&&t.vpt.focus(!0),n&&n.stopPropagation&&n.stopPropagation()},T.prototype.kpt=function(){var i=this;i.Tpt(),i.wY&&i.wY.on("ValueChangedEvent",function(n){var n,t,n=n.value;_(n)&&!n||(t=i.selector.val(),i.updateNameRangeSelectorValue(n),i.cpt=t,i.xpt()),i.ypt()})},T.prototype.Bpt=function(n){var t,i,n,e,o,r,u,t=this,i=t.vpt,n=i.getSheetFromName(n)||k(i);if(n)for(o=0,r=e=t.Opt(n);o<r.length;o++)(u=r[o]).isSelected()&&u.isSelected(!1)},T.prototype.Lpt=function(){var n,t,i,e,o,r,u,a,s,c,c,f,c,n=this,t=n.selector.val(),e=n.vpt,o=k(e);if(U(t=t.replace(/, /g,",")))throw new Error(x);if(r=t.split(","),u={ranges:[],sheetName:""},o)for(a=0,s=r;a<s.length;a++)if(c=s[a],i=(0,m.formulaToRanges)(o,c,o.getActiveRowIndex(),o.getActiveColumnIndex()),_(i)||0===i.length){if(1<r.length)throw new Error(x);o.isReportTemplateSheet&&(f=(c=e.getCustomName(c))&&c.WK)&&(u.ranges.push(f.getRange(c.getRow()||0,c.getColumn()||0)),u.sheetName=f.source.getName())}else if(1===i.length){if(c=i[0],u.sheetName&&c.sheetName!==u.sheetName)throw new Error(x);if(!e.getSheetFromName(c.sheetName))throw new Error(x);u.ranges=u.ranges.concat(c.ranges),u.sheetName=c.sheetName}return u},h.NameBox=T,s.Workbook.ch("nameBox",{init:function(){s.Commands.fpt(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){N()}}),a.extend(s.Workbook.prototype,{bpt:function(){var n=this.curNameBoxId+(new Date).getTime().toString();return this.curNameBoxId+=1,n}}),h.getActiveSheet=k},"./dist/plugins/namebox/namebox.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/namebox/namebox.res.en.js");t.SR={en:i}},"./dist/plugins/namebox/namebox.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.nameBox=t.invalidName=void 0,t.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection.",t.nameBox="Name Box"},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes}},e={},n=o("./dist/plugins/namebox/namebox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).NameBox=n}();
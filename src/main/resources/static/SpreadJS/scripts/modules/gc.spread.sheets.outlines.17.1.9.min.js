/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,r,n;function o(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,o)),t.exports}i={"./dist/plugins/group/group-actions.js":function(E,n,t){var i,r,a,x,t,F,o,e,u,f,s,c,v,h,l,r,d,p,r,w,g,r,m,C,n,O,b,j,y,_,R,L,M,k,D,J,P,T,H,Y,$;function G(n){var t,i;return S(n.v2t,n.Mf)}function S(n,t){return n?t.rowOutlines:t.columnOutlines}function q(n){var t,i,r,o,e,u,n,t=this,i=!1;return(n?t.canExecute():t.canUndo())&&(r=t.Mf,o=t.tT.index,e=t.tT.count,u=G(t),r)&&u&&!l(o)&&!l(e)&&(n=n?u.group:u.ungroupRange,t.X5(r,!0),n.call(u,o,e),t.q5(r,!0),i=!0),i}function U(n,t,i){var n=_.call(this,n,t)||this;return n.v2t=i,n}function z(n,t){return R.call(this,n,t,!1)||this}function B(n,t){return L.call(this,n,t,!0)||this}function A(n,t,i){var n=M.call(this,n,t)||this;return n.v2t=i,n}function K(n,t){return k.call(this,n,t,!1)||this}function Q(n,t){return D.call(this,n,t,!0)||this}function V(n,t,i,r,o){for(var e=0,u,u=t;u<=i&&u<r;u++)e+=o.call(n,u)*n.zoom();return e}function W(n,t,i,r,o){for(var e=0,u,u=t;u<r&&e<i;u++)t++,e+=o.call(n,u)*n.zoom();return r<=t?r-1:t}function X(n,t,i,r,o){if(t<r)return r;if(o<t)return o;for(var e=t;e<=o;e++)if(i.call(n,e))return e;return-1}function Z(n,t,i,r,o,e,u){for(var f,s,a,f=0,s=-1,a=i;0<=a;a--)if(r<=(f+=o.call(n,a))){if(a<t){s=r<f?a+1:a;break}s=t;break}return s=u<(s=s<e?e:s)?u:s}function nn(n,t,i,r,o){var e,u,f,s,s,a,c,v,h,c,l,d,p,w,p,g,m,C,f,a,o,e=i?n.getRowCount():n.getColumnCount(),u=void 0,f=S(i,n),s=f.KMi;r<0||e<=r||s||(s=1===f.direction(),(0,x.isIndexValid)(f,a=s?r-1:r+1)&&(c=n.Fi(),v=i?n.frozenRowCount():n.frozenColumnCount(),h=i?n.frozenTrailingRowCount():n.frozenTrailingColumnCount(),c=i?c.Ty:c.Uy,l=i?n.Ny:n.Vy,d=i?n.getRowHeight:n.getColumnWidth,p=i?n.getViewportTopRow:n.getViewportLeftColumn,w=i?n.getViewportHeight:n.getViewportWidth,p=p.call(n,1),f=f.find(a,o))&&(a=s?f.start:r,o=s?r:f.end,s?(t?a=r:a<v&&(a=v),a<p&&(p=a),e-h<=o&&(o=e-h-1),g=w.call(n,1),C=X(n,p=(g+=l?0:c)<(m=V(n,p,o,e,d))?W(n,p,m-g,e,d):p,d,v,e-1)):(t?o=r:e<=o&&(o=e-1),e-h<=o&&(o=e-h-1),a<p?C=X(n,a,d,v,e-1):(g=w.call(n,1),(g+=l?0:c)<(m=V(n,p,o,e,d))&&(C=Z(n,a,o,g,d,v,e-1)))),i&&C!==u?(n.Tb=C,n.tw()):i||C===u||(n.Ab=C,n.ow())))}function tn(n,t,i,r,o){var t,e,u,e,t=t;r.suspendPaint(),(u=1===(e=S(o,r)).direction()?0<=t-1&&e.find(t-1,i):t+1<e.items.length&&e.find(t+1,i))&&e.setCollapsed(t,n),nn(r,n,o,t=l(t)?(0,x.getExtendIndex)(r,o,i):t,i),(e=r.getCalcService()).Vct=4,r.recalcRange(0,0,r.getRowCount(),r.getColumnCount()),delete e.Vct,r.resumeCalcService(!1),e.Zct(),r.resumePaint()}function rn(n){var t,i,r,o,e,u,f,o,s,t=this,i=!1;return(n?t.canExecute():t.canUndo())&&(r=t.Mf,o=t.tT,e=G(t),u=o.collapsed,f=o.index,o=o.level,s=t.v2t,!r||!e||l(u)||l(f)||l(o)||(t.X5(r,!0),tn(u=n?u:!u,f,o,r,s),t.q5(r,!0),i=!0)),i}function I(n,t,i){var n=J.call(this,n,t)||this;return n.v2t=i,n}function on(n,t){return P.call(this,n,t,!1)||this}function en(n,t){return T.call(this,n,t,!0)||this}function N(n,t,i){var n=H.call(this,n,t)||this;return n.v2t=i,n}function un(n,t){return Y.call(this,n,t,!1)||this}function fn(n,t){return $.call(this,n,t,!0)||this}i=this&&this.__extends||(y=function(n,t){return(y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}y(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=n.expandOutlineAction=void 0,r=t("Common"),a=t("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return a.Commands}}),x=t("./dist/plugins/group/group.js"),t=a.Commands.ActionBase,F=a.GC$,o="outlineColumn",e="removeColumnOutline",u="expandColumnOutline",f="expandColumnOutlineForLevel",s="outlineRow",c="removeRowOutline",v="expandRowOutline",h="expandRowOutlineForLevel",l=r.Common.lt.ht,i(U,_=t),U.prototype.execute=function(){var n,t,i,r,n,o,n=this,t=n.Mf,i=n.tT,r=t.Ut;return r.startTransaction(),n=q.call(n,!0),i[o=a.Commands.TI(t.name())]=r.endTransaction(),n},U.prototype.undo=function(){return q.call(this,!1)},i(z,R=r=U),d=z,i(B,L=r),p=B,i(A,M=t),A.prototype.execute=function(){var n,t,i,r,o,e,u,f,s,n=this,t=n.Mf,i=t.Ut,r=!1;return n.canExecute()&&(e=(o=n.tT).index,u=o.count,f=G(n),t)&&f&&!l(e)&&!l(u)&&(i.startTransaction(),n.X5(t,!0),f.ungroupRange(e,u),n.q5(t,!0),o[s=a.Commands.TI(t.name())]=i.endTransaction(),r=!0),r},A.prototype.undo=function(){var n,t,i,r,r,n=this,t=!1,i=n.Mf;return n.canUndo()&&(r=a.Commands.TI(i.name()),r=n.tT[r],i)&&r&&(n.X5(i,!0),i.Ut.undo(r),n.q5(i,!0),t=!0),t},i(K,k=r=A),w=K,i(Q,D=r),g=Q,n.expandOutlineAction=tn,i(I,J=t),I.prototype.canExecute=function(){var n,t,i,r,n,n=this,t,i=n.Mf.NMi;return!i||(r=n.tT.level,n=G(n),i.detailColumnsVisible())||r<n.getMaxLevel()},I.prototype.execute=function(){var n,t,i,r,n,o,n=this,t=n.Mf,i=n.tT,r=t.Ut;return r.startTransaction(),n=rn.call(n,!0),i[o=a.Commands.TI(t.name())]=r.endTransaction(),n},I.prototype.undo=function(){return rn.call(this,!1)},i(on,P=r=I),m=on,i(en,T=r),C=en,i(N,H=t),N.prototype.canExecute=function(){var n,t,i,r,n,n=this,t,i=n.Mf.NMi;return!i||(r=n.tT.level,n=G(n),i.detailColumnsVisible())||r<=n.getMaxLevel()},N.prototype.execute=function(){var n,t,i,r,o,e,u,u,u,n=this,t=n.Mf,i=!1;if(n.canExecute()&&(r=void 0,o=n.tT.level,e=G(n),t)&&e&&!l(o)){for(t.Ut.startTransaction(),n.X5(t,!0),t.suspendCalcService(),t.Ut.m2t(n.v2t),e.Xst(),r=0;r<o;r++)e.expand(r,!0,!0);e.expand(o,!1,!0),e.$st(),t.Ut.m2t(n.v2t,!0),u=n.tT.index,l(u)&&(u=(0,x.getExtendIndex)(t,n.v2t,o)),nn(n.Mf,!1,n.v2t,u,o-1),(u=t.getCalcService()).Vct=4,t.recalcRange(0,0,t.getRowCount(),t.getColumnCount()),delete u.Vct,t.resumeCalcService(!1),u.Zct(),n.q5(t,!0),u=a.Commands.TI(t.name()),n.tT[u]=t.Ut.endTransaction(),i=!0}return i},N.prototype.undo=function(){var n,t,i,r,r,n=this,t=!1;return n.canUndo()&&(i=n.Mf,r=a.Commands.TI(i.name()),r=n.tT[r],i)&&r&&(n.X5(i,!0),i.Ut.undo(r),n.q5(i,t=!0)),t},i(un,Y=n=N),O=un,i(fn,$=n),b=fn,j=a.Commands.zA,a.Commands[o]={canUndo:!0,execute:function(n,t,i){return j(n,d,t,i)}},a.Commands[s]={canUndo:!0,execute:function(n,t,i){return j(n,p,t,i)}},a.Commands[e]={canUndo:!0,execute:function(n,t,i){return j(n,w,t,i)}},a.Commands[c]={canUndo:!0,execute:function(n,t,i){return j(n,g,t,i)}},a.Commands[u]={canUndo:!0,execute:function(n,t,i){return j(n,m,t,i)}},a.Commands[v]={canUndo:!0,execute:function(n,t,i){return j(n,C,t,i)}},a.Commands[f]={canUndo:!0,execute:function(n,t,i){return j(n,O,t,i)}},a.Commands[h]={canUndo:!0,execute:function(n,t,i){return j(n,b,t,i)}},a.Commands.g2t=function(n){n.register(o,a.Commands[o]),n.register(s,a.Commands[s]),n.register(e,a.Commands[e]),n.register(c,a.Commands[c]),n.register(u,a.Commands[u]),n.register(v,a.Commands[v]),n.register(f,a.Commands[f]),n.register(h,a.Commands[h])}},"./dist/plugins/group/group.entry.js":function(n,t,i){var r,o,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,o)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),o=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),o(i("./dist/plugins/group/group-actions.js"),t),o(i("./dist/plugins/group/group.js"),t),o(i("./dist/plugins/group/group.ns.js"),t)},"./dist/plugins/group/group.js":function(m,c,n){var x,t,M,O,n,i,R,C,Y,$,G,q,a,L,z,d,v,h,B,E,b,j,f,k,y,F,D,S,_,U,K,V,W,Q,J,l,P,p,T,H,X,Z,t,nn,n,tn,rn,on,n,w,A,r,en,un,t,t;function fn(n,t){n.ki(M.Events.RangeGroupStateChanging,t)}function sn(n,t){n.ki(M.Events.RangeGroupStateChanged,t)}function an(n,t){var i,r,n,i=n.options,r;return!n.isActualProtected()||(n=i.protectionOptions,t?n.allowOutlineRows:n.allowOutlineColumns)}function cn(n,t){var i,r,t,r,o,e,i=t.what===l,r=an(n,i);n.isEditing&&n.isEditing()||!r?r||n.jT(M.InvalidOperationType.groupProtected,(0,c.getSR)().Exp_GROUP_PROTECTED):(r=i?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",fn(n,o=hn(n,i,-1,t=t.info.index,!0)),e=ln(n,i,t-1),o&&!1===o.cancel&&(n.Qy().execute({cmd:r,sheetName:n.name(),level:t,index:e}),sn(n,hn(n,i,-1,t,!1))))}function vn(n,t){var i,r,r,t,o,e,u,f,i=t.what===p,r=an(n,i);n.isEditing&&n.isEditing()||!r?r||n.jT(M.InvalidOperationType.groupProtected,(0,c.getSR)().Exp_GROUP_PROTECTED):I(i,n)&&(o=t=(r=t.info).index,e=r.level,f=i?"expandRowOutline":"expandColumnOutline",1===r.lineDirection?t--:t++,fn(n,u=hn(n,i,t,e,!(u=void 0))),u)&&!1===u.cancel&&(n.Qy().execute({cmd:f,sheetName:n.name(),index:o,level:e,collapsed:r.isExpanded}),sn(n,hn(n,i,t,e,!1)))}function hn(n,t,i,r,o){var n={sheet:n,sheetName:n.name(),isRowGroup:t,index:i,level:r};return o&&(n.cancel=!1),n}function ln(n,t,i){var r,o,e,u,r=t?n.rowOutlines:n.columnOutlines;if(r)for(o=r.items,e=!1,u=0;u<o.length;u++)if(o[u])if(o[u].level===i)e=!0;else if(e)return u;return t?n.getActiveRowIndex():n.getActiveColumnIndex()}function dn(n,t){var i,r,o,e,u,f,o,f,s,i=this,r=i.gj(),o=r.width,e=r.height;return(o||e)&&(u=i.Fi(),f=i.options.rightToLeft,o=new M.Rect(r.x,r.y,o,u.height),f=new M.Rect((f?u:r).x,r.y,u.width,e),o.contains(n,t)||f.contains(n,t))?(s=(s=pn(i,n,t,r.rowMaxLevel,!0))||pn(i,n,t,r.colMaxLevel,!1))||{what:"empty",info:R}:R}function o(n,t,i){var r=this;r.PADDING=2,r.Mf=n,r.v2t=t,r.$X=f(i)?i:I(t,n).getMaxLevel()}function e(n,t,i,r){var o=this;o.PADDING=2,o.LINE_SIZE=2,o.START_LINE_SIZE=6,o.p2t=[],o.b2t=[],o.y2t=[],o.Mf=n,o.v2t=t,o.w2t=i,o.$X=f(r)?r:I(t,n).getMaxLevel()}function pn(n,t,i,r,o){var e,u,f,s,e,u=new tn(n,o,r).M2t(t,i,o);if(u)return{what:o?l:P,info:u};for(f=wn(n,o,r),s=0;s<=2;s++)if(u=f[s].C2t(t,i,o))return{what:o?p:T,info:u};return R}function wn(n,t,i){for(var r=[new rn(n,t,0,i),new rn(n,t,1,i),new rn(n,t,2,i)],o,o=0;o<=2;o++)r[o].S2t();return r}function gn(n,t){var t=t?n.width:n.height;return Y(0,(t-2*this.PADDING)/(this.$X+2))}function I(n,t){return n?t.rowOutlines:t.columnOutlines}function mn(n,t,i,r){var o=this;o.children=[],o.parent=R,o.model=n,o.start=t,o.end=i,o.level=r}function Cn(n){this.level=n?n.level:0,this.collapsed=!!n&&n.collapsed,this.viewCollapsed=!!n&&n.viewCollapsed}function xn(n,t,i){var r,o,e,u;if(0<i){for(r=n.items,e=o=void 0,u=[],o=0;o<i;o++)u.push(R);if(n.items=r=r.slice(0,t).concat(u,r.slice(t)),n.T2t<=0&&0<t&&(e=r[t-1]))for(o=0;o<i;o++)r[t+o]=new A(e);_n(n)}}function On(n,t,i){var i,i,r;0<i&&(i=n.items.splice(t,i),0<t&&0<i.length&&(i=i[0],r=n.items[t],i)&&i.collapsed&&(r?i.level===r.level&&(r.collapsed=i.collapsed):n.items.length>t&&-1===i.level&&i.collapsed&&(n.items[t]=new A(i))),_n(n))}function bn(n,t,i){for(var r,o,e,e,u,f,s,a,r=R,o=n.items,u=t,f=B(o);u<f&&(!(e=o[u])||e.level<i||(r=r||new w(n,u,u,i),e.level>i&&(u=(e=bn(n,u,i+1)).index,r.addChild(e.g)),u>r.end&&(r.end=u),!n.isGroupEnd(u,i)));u++);if(r)for(s=r.end+1,a=r.start;a<s;a++)o[a].groupInfo||(o[a].groupInfo=r);return{g:r,index:u}}function u(n,t){return-1<=t&&t<B(n.items)}function jn(n,t,i){var n,r,o,n=n&&n.items;if(n)for(r=n[t]&&n[t].groupInfo;r;){if((o=r.level)===i)return r;if(!(i<o))break;r=r.parent}return R}function yn(n,t){switch(n){case"head":case"tail":return t===R;case"direction":return 1===t;case"itemsData":return 0===B(t);default:return}}function _n(n){n.A2t=R,n.refresh()}function N(n,t){!t&&n.I2t||(n.A2t=n.createRangeGroup(),Ln(n))}function Rn(n){n.I2t&&!n.A2t&&(n.A2t=n.createRangeGroup())}function Ln(n,t){!n.I2t&&n.groupChangeHandler&&n.groupChangeHandler(t)}function Mn(n,t,i){if(kn(n,t),!u(n,t+i-1))throw new Error((0,c.getSR)().Exp_InvalidCount)}function kn(n,t){if(!u(n,t))throw new Error((0,c.getSR)().Exp_InvalidIndex)}function Gn(n,t){for(var i,r,i=n.parent;i&&(r=t?n.end===i.end:n.start===i.start);)i=(n=i).parent;return n}function s(n,t,i){var r=this;r.head=R,r.tail=R,r.A2t=R,r.items=new Array(n),r.T2t=0,r.x2t=!0,r.Mf=t,r.v2t=i}function g(n){return n&&new A(n)}function Sn(n){return{items:n.items.map(g),head:g(n.head),tail:g(n.tail),x2t:n.x2t,direction:n.direction()}}function Un(n,t){n.items=t.items.map(g),n.head=g(t.head),n.tail=g(t.tail),n.x2t=t.x2t,n.direction(t.direction),N(n,!0)}function An(n,t,i,r,o){var e,u,f,s,a,c,v,h,l,d,p,w,g,m,C,x,g;if(n)for(e=0===r,u=n.rowItems,s=function(n){return e?n<t.rowCount:0<=n},a=function(n){return e?n+1:n-1},c=function(n){return e?n-1:n+1},v=function(n,t){var n=u[n];if(n)return n.level<=t?n:v(n.parentIndex,t)},h=(f=function(){return e?0:t.rowCount-1})(),l=void 0;s(h);h=a(h))(d=u[h])&&-1!==d.level?(p=c(h),g=!(w=u[p])&&"number"==typeof d.level||w&&w.level<d.level,m=w&&w.level>d.level,x=C=void 0,g?(C=p,x=!!w&&(w.collapsed||w.viewCollapsed)):m?-1===d.level?x=!1:(g=void 0,(g=w.parentIndex===l?w:v(w.parentIndex,d.level))&&(C=g.parentIndex,x=g.viewCollapsed)):(C=w.parentIndex,x=w.viewCollapsed),d.parentIndex=C,!(d.viewCollapsed=x)&&i[h].hidden&&(i[h].visible=!1,k(o.infos[h])&&(o.infos[h]={}),o.infos[h].visible=!1)):l=h}function In(n,t,i,r,o,e){var u,f,s,a,c,u=n.itemsData;u&&(f=u[u.length-1],s=u[u.length-2],a=f&&f.info,c=s&&s.info,a)&&(r&&o&&1===f.count?c&&s.index===f.index-1&&c.level===a.level-1?c.collapsed=!0:0<t?u.splice(u.length-2,0,{index:f.index-1,count:1,info:{level:a.level-1,collapsed:!0}}):n.head={collapsed:!0,level:i-1}:!r&&e&&(c&&f.index===s.index+1&&a.level===c.level-1?f.collapsed=!0:t>=f.index+f.count&&u.push({index:f.index+f.count,count:1,info:{level:a.level-1,collapsed:!0}})))}x=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var r=0,o=t.length,e;r<o;r++)!e&&r in t||((e=e||Array.prototype.slice.call(t,0,r))[r]=t[r]);return n.concat(e||Array.prototype.slice.call(t))},Object.defineProperty(c,"__esModule",{value:!0}),c.Outline=c.isIndexValid=c.OutlineInfo=c.OutlineState=c.OutlineDirection=c.getExtendIndex=c.getSR=void 0,t=n("Common"),M=n("Core"),O=n("./dist/plugins/group/group-actions.js"),n=n("./dist/plugins/group/group.ns.js"),i={},R=null,C=void 0,Y=Math.max,$=Math.min,G=Math.round,q=Math.ceil,a=M.GC$,L=a.each,z=M.I.fl,d=t.Common.Uf,v=d.N2t,h=d.d5,B=d.tR,E=8.25,b=17,j=4,f=M.mt.T1,k=t.Common.lt.ht,y=M.mt.p0,F=M.mt.vt,D=M.mt.o1,S=M.mt.xr,_="rangegroup",V=(K=(U="gc-group")+"-box")+"-expand",W=K+"-collapsed",Q=U+"-line",J=U+"-dot",l="rgh",P="cgh",p="rg",T="cg",H=M.XFileConstants.Su,X=M.XFileConstants.bo,Z="1",t=new t.Common.ResourceManager(n.SR,"Outlines"),c.getSR=t.getResource.bind(t),nn=M.NodeHelper.ur,n={gj:function(){var n,t,t,i,i,r,o,e,u,r,t,n=this,t=n.k2t;return t||(i={x:(i=(t=n.options).sheetAreaOffset).left,y:i.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},r=n.rowOutlines,o=n.columnOutlines,e=17*n.zoom(),n.showRowOutline()&&r&&!r.Oy()&&0<=(u=r.getMaxLevel())&&(i.width=e*(u+2)+4,i.rowMaxLevel=u,r=t.rightToLeft,t=n.ot(),r)&&(i.x=t.x+t.width-i.width),n.showColumnOutline()&&o&&!o.Oy()&&0<=(u=o.getMaxLevel())&&(i.height=e*(u+2)+4,i.colMaxLevel=u),n.k2t=i)},showRowOutline:y("showRowOutline",!0,function(){this.zw()}),showColumnOutline:y("showColumnOutline",!0,function(){this.zw()})},a.extend(M.Worksheet.prototype,n),c.getExtendIndex=ln,o.prototype.D2t=function(n){var t,i,r,o,e,u,f,s,r,a,c,v,h,l,e,d,p,w,g,m,C,p,e,x,O,b,j,y,_,R,L,M,k,t=this,i=t.Mf,r=t.$X;if(!(r<0)&&(o=t.v2t,e=i.gj(),u=gn.call(t,e,o))){if(f=i.options.rightToLeft,s=r+2,r=t.PADDING,a=i.options,c=e.width,v=e.height,h=e.x,l=e.y,d=(e=i.Fi()).width,p=e.height,w=e.qC,g=e.XC,m=e.BA,C=e.LA,n.save(),n.fillStyle=z(U).backgroundColor,n.strokeStyle=z(U).borderTopColor,n.lineWidth=1,o?(n.fillRect(h,l,c,p),n.strokeRect(h-.5,l-.5,c,p+1)):(n.fillRect(f?e.x:h,l,d,v),n.strokeRect(f?e.x-1:h-.5,l-.5,d+1,v)),o?n.strokeRect(h-.5,C-.5,c,w):n.strokeRect(m-.5,l-.5,g,v),p=(o?w:g)-u,o?(O=Y(0,C-a.sheetAreaOffset.top+p/2),x=r):(x=Y(0,m-a.sheetAreaOffset.left+p/2),O=r),n.restore(),e=o?a.colHeaderVisible:a.rowHeaderVisible,n.save(),e&&0<=p){for(j=[],b=0;b<s;b++)j.push(f&&o?s-1-b:b);for(y=0,_=j;y<_.length;y++)b=_[y],R=u-1,k=M=L=void 0,k=o?(M=G(h+x)+.5,l+O):(M=f?x:h+x,l+O+.5),n.fillStyle=z(K).backgroundColor,n.fillRect(M,k,R,R),n.font=E*i.zoom()+"pt Arial",n.strokeStyle=z(K).borderTopColor,n.strokeRect(M,k,R,R),n.fillStyle=z(K).color,L=F(n.font),t._2t(n,M,k,R,u,b+1,L),o?x+=u:O+=u}n.restore()}},o.prototype._2t=function(n,t,i,r,o,e,u){var e=""+e,f=n.measureText(e).width;f<=r&&u<=o&&(n.textBaseline="middle",n.fillText(e,t+(r-f)/2,i+r/2))},o.prototype.M2t=function(n,t,i){var r,o,e,e,u,f,s,r=this,o=r.Mf,e=r.$X;return e<0?R:(e=e+2,u=o.Fi(),s=(f=o.options).sheetAreaOffset,i?r.E2t(o,n,t,i,f.colHeaderVisible,u.qC,u.LA-s.top,e):r.E2t(o,n,t,i,f.rowHeaderVisible,u.XC,u.BA-s.left,e))},o.prototype.E2t=function(n,t,i,r,o,e,u,f){var s,a,c,v,n,h,l,d,p,e,w,g,m,s=this,a=n.gj(),c=n.options.rightToLeft,v=gn.call(s,a,r),n=e-v;if(v&&o&&0<=n){for(h=Y(0,u+n/2),l=s.PADDING,r&&(e=h,h=l,l=e),w=[],p=0;p<f;p++)w.push(c&&r?f-1-p:p);for(g=0,m=w;g<m.length;g++){if(p=m[g],(d=new M.Rect(c&&!r?h:a.x+h,a.y+l,v,v)).contains(t,i))return{index:p};r?h+=v:l+=v}}return R},tn=o,e.prototype.S2t=function(){var i,n,i=this;-1!==i.$X&&(n=i.j2t(0,i.v2t),L(n,function(n,t){i.O2t(t)}))},e.prototype.O2t=function(n){var e,t,i,t,u,r,o,i,f,s,a,c,v,h,l,d,h,p,w,g,m,C,x,O,b,j,x,y,_,e=this,t=e.Mf,i=e.v2t,t=I(i,t).direction(),u=1===t,r=0===t,o=e.R2t(!0,i),i=e.R2t(!1,i),f=n.start,s=n.end,a=n.level;if(u?c=s+1:r&&(c=f-1),0===n.state()){if(v=!0,(v=(h=n.parent)&&(r&&f===h.start||u&&s===h.end)?!1:v)&&e.B2t(!0,a,c,o,i,t),f<=i&&o<=s){for(l=Y(o,f),d=$(i,s),p=h=void 0,v&&(h={start:l,end:d,level:a,startLine:R},(u&&l===f||r&&d===s)&&(h.startLine=!0),e.p2t.push(h)),g=[],m=n.children,p=l;p<=d;p++)g.push(!1);for(L(m,function(n,t){var i=t.start,r=t.end,o;if(1===t.state())for(w=i;w<=r;w++)g[w-l]=!0;g[(o=u?r+1:r-1)-l]=!0,e.O2t(t)}),C=!0,p=0;p<B(m);p++){if(O=(x=m[p]).start,x=(b=x.end)===s,(j=O===f)&&x){C=!1;break}if(u&&x||r&&j)for(w=O;w<=b;w++)g[w-l]=!0}if(C)for(y=l;y<=d;y++)g[y-l]||e.b2t.push(_={index:y,level:a+1})}}else 1===n.state()&&e.B2t(!1,a,c,o,i,t)},e.prototype.B2t=function(n,t,i,r,o,e){var t={isExpanded:n,level:t};n&&(t.paintLine=!0),r<=i&&i<=o&&(t.index=i,t.lineDirection=e,this.y2t.push(t))},e.prototype.L2t=function(n){var t=this,i=t.Mf,r=t.w2t;return t.v2t?i._y(r).findRow(n):i.Yy(r).findCol(n)},e.prototype.F2t=function(n){var t,i,r,o,e,u,f,s,a,c,i,v,h,l,r,t=this;-1!==t.$X&&(r=(i=t.Mf).options.rightToLeft,o=i.gj(),e=t.v2t,u=gn.call(t,o,e))&&(f=parseInt(z(Q).borderTopWidth,10),f=isNaN(f)?2:f,s=G(u/3),c=(u-f)/2+(a=t.PADDING),n.save(),n.fillStyle=z(U).color,i=i.Fi(),r=e?(v=r?o.x:0,h=i.y+i.qC,l=o.width,i.height-i.qC):(v=r?i.x:i.x+i.XC,h=0,l=r?i.width:i.width-i.XC,o.height),n.rect(v,h,l,r),n.clip(),t.P2t(n,t.b2t,e,o,u,c,f),e?t.G2t(n,t.p2t,e,o,u,c,f,s):t.U2t(n,t.p2t,e,o,u,c,f,s),t.H2t(n,t.y2t,e,o,u,c,f,a),n.beginPath(),n.restore())},e.prototype.P2t=function(e,n,u,f,s,a,c){var v,h,l,t,i,r,d,p,i,w,g,m,l=this,t=2,i=l.Mf,r=i.options,d=i.Fi(),p=i.options.rightToLeft,i=r.sheetAreaOffset,w=i.left,g=i.top;e.save(),e.fillStyle=z(J).color,m=l.p2t,L(n,function(n,t){var i,r,o,i,r,o,i,r,i=t.index,r=t.level,o=l.L2t(i);o&&!l.z2t(m,i,r)&&(i=u?o.y:o.x,0<=(r=(u?o.height:o.width)-c))&&(v=i+Y(0,r/2),h=(p&&u?l.$X+1-t.level:t.level)*s+a,u?(o=v,v=h+.5,h=o,h-=g):(h+=.5,v-=w),e.strokeStyle="transparent",e.lineWidth=0,(i=p&&!u?d.x+v:f.x+v)%1!=0&&(i+=.5),(r=f.y+h)%1!=0&&(r+=.5),e.strokeRect(i,r,2,2),e.fillRect(i,r,2,2))}),e.restore()},e.prototype.z2t=function(n,t,i){for(var r,o,e,r=!1,o=B(n),e=0;e<o;e++)if(n[e].level===i&&n[e].start<=t&&n[e].end>=t){r=!0;break}return r},e.prototype.G2t=function(n,t,i,r,o,e,u,f){var s,a,c,v,a,h,l,d,p,w,g,m,C,x,O,b,j,b;for(n.save(),n.strokeStyle=z(Q).borderTopColor,n.fillStyle=z(Q).borderTopColor,n.lineWidth=u,c=I(i,a=(s=this).Mf).direction(),l=(h=(a=a.options).sheetAreaOffset).top,d=a.rightToLeft,v=0;v<B(t);v++){for(w=(p=t[v]).start,g=p.end,C=m=void 0;m=s.L2t(w),w++,!m&&w<=g;);for(;C=s.L2t(g),g--,!C&&w<=g;);(m||C)&&(m?C=C||m:m=C,x=m.y,O=(d&&i?s.$X+1-p.level:p.level)*o+e,b=u,j=Y(0,C.y+C.height-m.y),1===c?x+=1:--x,x-=l,n.beginPath(),b=r.x+O+b/2,b=q(b),n.moveTo(b,r.y+x),n.lineTo(b,r.y+x+j),n.stroke(),p.startLine)&&0<o/2-2*u&&(x=0===c?x+j-u-l:x)>=m.y-l&&x<C.y+C.height-l&&(d&&i?n.fillRect(q(r.x+O)-f,r.y+x,f,u):n.fillRect(q(r.x+O),r.y+x,f,u))}n.restore()},e.prototype.U2t=function(n,t,i,r,o,e,u,f){var s,i,a,c,v,h,l,d,p,w,g,m,C,x,O,b,j,y,_;for(n.save(),n.strokeStyle=z(Q).borderTopColor,n.fillStyle=z(Q).borderTopColor,n.lineWidth=u,a=I(i,i=(s=this).Mf).direction(),l=(h=(v=i.options).sheetAreaOffset).left,d=i.Fi(),p=v.rightToLeft,c=0;c<B(t);c++){for(g=(w=t[c]).start,m=w.end,x=C=void 0;C=s.L2t(g),g++,!C&&g<=m;);for(;x=s.L2t(m),m--,!x&&g<=m;);(C||x)&&(C?x=x||C:C=x,O=p?C.x+C.width:C.x,b=w.level*o+e,j=p?-(C.x+C.width-x.x):Y(0,x.x+x.width-C.x),1===a&&(p?O-=2:O+=1),O-=l,y=r.y+b+u/2,y=q(y),n.beginPath(),n.moveTo((p?d:r).x+O,y),n.lineTo((p?d:r).x+O+j,y),n.stroke(),w.startLine)&&0<o/2-2*u&&(0===a&&(p?O+=j:O=O+j-u-l),_=p?O>=x.x-l&&O<C.x+C.width-l:O>=C.x-l&&O<x.x+x.width-l)&&n.fillRect((p?d:r).x+O,q(r.y+b),u,f)}n.restore()},e.prototype.V2t=function(n){var n=z(n).backgroundImage;return n=(n="none"===n?"":n)&&(n=(n=n.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()},e.prototype.H2t=function(n,t,i,r,o,E,e,F){var u,f,s,a,c,v,h,l,D,J,P,T,H,a,d,p,w,s,a,g,m,C,x,O,b,b,j,y,_,R,L,M,k,G,S,U,L,y,A,I,N,j,j,I,b,k,G,R,G,u=this,s=u.Mf,a=s.options,c=a.sheetAreaOffset.left,v=s.Fi(),h=s.options.rightToLeft,l=a.sheetAreaOffset.top,D=z(K).borderTopColor,J=z(K).backgroundColor,P=z(K).color,T=z(Q).borderTopColor,H=1,a=s.BO(),d=u.V2t(V),p=u.V2t(W);for(d&&!a.getState(d)&&a.addImage(d),p&&!a.getState(p)&&a.addImage(p),w=p&&a.getImage(p),s=d&&a.getImage(d),a=z(V),g=z(W),m=s?a.backgroundColor:"",C=w?g.backgroundColor:"",x=s?a.borderTopColor:"",O=w?g.borderTopColor:"",f=0;f<B(t);f++)n.save(),_=t[f],!(R=u.L2t(_.index))||(L=i?R.height:R.width)<=0?n.restore():(M=Y(0,(L-o)/2),S=(i?R.y-l:R.x-c)+M,U=(h&&i?u.$X+1-_.level:_.level)*o+F,I=A=G=k=void 0,N=L-(L=$(y=o,L)),I=i?(j=S,S=U,U=j,j=L,L=y,y=j,A=.5,0):(A=0,.5),j=_.isExpanded?x:O,n.strokeStyle=j||D,n.lineWidth=1,b=_.isExpanded?m:C,n.fillStyle=b||J,n.fillRect((h&&!i?v:r).x+S,r.y+U,L,y),k=(h&&!i?v:r).x+S+A,G=r.y+U+I,n.strokeRect(k,G,L,y),n.fillStyle=P,b=_.isExpanded?d:p,u.Y2t(n,_.isExpanded,b,k,G,L,y),n.restore(),_.paintLine&&0<N&&(n.save(),n.strokeStyle=T,S=i?R.y-l:R.x-c,U=(h&&i?u.$X+1-_.level:_.level)*o+E,I=0===_.lineDirection,b=i?e:M,k=i?M:e,i?(G=S,S=U,U=G,I&&(U+=M+y,k=N-M)):(I&&!h||!I&&h)&&(S+=M+L,b=N-M),n.beginPath(),n.lineWidth=e,R=q((h&&!i?v:r).x+S+e/2),G=q(r.y+U+e/2),i?(n.moveTo(R,r.y+U),n.lineTo(R,r.y+U+k-1)):(y=0,w&&!_.isExpanded&&(y=1),n.moveTo((h?v:r).x+S,G),n.lineTo((h?v:r).x+S+A+b+y,G)),n.stroke(),n.restore()))},e.prototype.Y2t=function(n,t,i,r,o,e,u){var f,s,a,a,i,c,f=this,s,a=this.Mf.BO();if(i&&a.getState(i)){i=(a=a.getImage(i)).width,c=a.height;try{n.drawImage(a,0,0,i,c,G(r),G(o),e-1,u-1)}catch(n){}}else f.Z2t(n,t,r,o,e,u)},e.prototype.Z2t=function(n,t,i,r,o,e){var u,f,t,s,u=G(o/4),f=G(o/2);t||(t=G(e/4),s=G(e/2),n.fillRect(i+o/2-1,r+t,2,e-s)),n.fillRect(i+u,r+e/2-1,f,2)},e.prototype.j2t=function(n,t){var i,r,o,e,u,f,s,a,i,c,v,i,i=this,r=i.Mf,o=[],u=-1,f=-1,s=I(t,r),a,i=(t?r._y:r.Yy).call(r,i.w2t),c=B(i);for(c&&(v=i[0],i=i[c-1],u=Y(0,(t?v.row:v.col)-1),f=t?$(r.getRowCount(),i.row+2):$(r.getColumnCount(),i.col+2));u<f;)(e=s.find(u,n))?(u=e.end+1,o.push(e)):u++;return o},e.prototype.R2t=function(n,t){var i=-1,r=this,o=r.Mf,r=r.w2t,e=o.frozenRowCount(),u=o.frozenColumnCount(),f=o.frozenTrailingRowCount(),s=o.frozenTrailingColumnCount(),a=o.getRowCount(),o=o.getColumnCount();return 0===r?i=n?0:(t?e:u)-1:1===r?i=n?t?e:u:(t?a-f:o-s)-1:2===r&&(i=n?t?a-f:o-s:(t?a:o)-1),i},e.prototype.W2t=function(n){n&&this.Mf.Oi&&(n.x-=2,n.y-=2,n.width+=4,n.height+=4)},e.prototype.C2t=function(n,t,i){var r,o,e,u,f,s,a,c,v,h,l,d,p,w,g,m,p,m,C,m,d,x,O,O,r=this,o=r.$X,e=r.Mf,u=e.options,f=e.Fi(),s=u.rightToLeft,a=u.sheetAreaOffset.left,c=u.sheetAreaOffset.top;if(!(o<0)&&(v=e.gj(),h=gn.call(r,v,i)))for(l=r.y2t,w=0;w<B(l);w++)if(m=(g=l[w]).index,p=(s&&i?r.$X+1-g.level:g.level)*h+r.PADDING,(m=r.L2t(m))&&!((d=i?m.height:m.width)<=0)&&(C=$(h,d),d=(i?m.y-c:m.x-a)+Y(0,(d-(m=h))/2),x=p,i&&(O=C,C=m,m=O,O=d,d=p,x=O),p=new M.Rect((s&&!i?f:v).x+d+.5,v.y+x+.5,C,m),r.W2t(p),p.contains(n,t)))return g;return R},rn=e,(t=on=c.OutlineDirection||(c.OutlineDirection={}))[t.backward=0]="backward",t[t.forward=1]="forward",i.OutlineDirection=on,(t=n=c.OutlineState||(c.OutlineState={}))[t.expanded=0]="expanded",t[t.collapsed=1]="collapsed",i.OutlineState=n,mn.prototype.state=function(n){var t=this,i=t.model;if(!arguments.length)return i?i.getState(t):0;i&&i.expandGroup(t,0===n)},mn.prototype.contains=function(n){return this.start<=n&&n<=this.end},mn.prototype.addChild=function(n){n&&(this.children.push(n),n.parent=this)},w=mn,c.OutlineInfo=w,i.OutlineInfo=w,A=Cn,c.isIndexValid=u,s.prototype.L0=function(){this.Mf=R},s.prototype.getUsedRange=function(n){var n,t,i,r,o,n,e,n,u,f,s,a,c;if(n&M.UsedRangeType.axis&&(t=(n=this).items,i=n.v2t,o=(r=Object.keys(t)).length,n=n.Mf,0<o)&&n){for(u=(n=o)-1,f=e=0;f<o;f++)if(t[+r[f]]){e=f;break}for(s=o-1;0<=s;s--)if(t[+r[s]]){u=s;break}if(a=t[+r[e]],c=t[+r[u]],a&&c)return a&&-1===a.level&&(e+=1),c&&-1===c.level&&(n=u),i?{minRow:+r[e],minCol:0,maxRow:+r[n-1],maxCol:1/0}:{minRow:0,minCol:+r[e],maxRow:1/0,maxCol:+r[n-1]}}},s.prototype.group=function(n,t){var i=this,r,o;for(Mn(i,n,t),i.Mf.Ut.m2t(i.v2t),r=0;r<t;r++)i.items[o=n+r]?i.items[o].level++:i.items[o]=new A;i.I2t&&i.A2t&&(i.A2t=R),i.Mf.Ut.m2t(i.v2t,!0),N(i),i.x2t=!1},s.prototype.Xst=function(){this.I2t=!0,this.A2t=R},s.prototype.$st=function(){var n=this;n.I2t=!1,n.refresh()},s.prototype.ungroupRange=function(n,t){var i=this,r,o;for(Mn(i,n,t),i.Mf.Ut.m2t(i.v2t),r=0;r<t;r++)(o=i.items[n+r])&&-1<o.level&&o.level--;i.Mf.Ut.m2t(i.v2t,!0),N(i)},s.prototype.ungroup=function(){var n=this,t=B(n.items);n.Mf.Ut.m2t(n.v2t),n.items=new Array(t),N(n),n.x2t=!0},s.prototype.expand=function(n,t,i){var r,o,e,u,f,s,a;if(n<-1)throw new Error((0,c.getSR)().Exp_InvalidLevel);for(o=(r=this).items,(u=r.Mf).Ut.m2t(r.v2t),Rn(r),f=u.op(),u.suspendPaint(),f.suspend(),s=0,a=o.length;s<a;s++)o[s]&&(e=r.find(s,n))&&(r.expandGroup(e,t,!0),s=e.end);i||r.Mf.Ut.m2t(r.v2t,!0),f.resume(!1),u.resumePaint()},s.prototype.expandGroup=function(n,t,i){if(!n)throw new Error((0,c.getSR)().Exp_GroupInfoIsNull);var r=this,o=r.direction(),e=-1;i||r.Mf.Ut.m2t(r.v2t),0===o?e=n.start-1:1===o&&(e=n.end+1),r.setCollapsed(e,!t,n.level,i),i||r.Mf.Ut.m2t(r.v2t,!0),r.Mf.zw()},s.prototype.tF=function(n){return!(!this.x2t&&u(this,n)&&this.isCollapsed(n))},s.prototype.isCollapsed=function(n){var n=this.items[n];return!!(n&&n.viewCollapsed&&-1<n.level)},s.prototype.find=function(n,t){var i=this,r;return Rn(i),r=-1===t?i.A2t:(i.Mf.NMi||kn(i,n),jn(i,n,t))},s.prototype.getLevel=function(n){var n=this.items[n];return n?n.level:-1},s.prototype.getCollapsed=function(n){var n=this.items[n];return!!n&&!!n.collapsed},s.prototype.Q2t=function(n,t,i,r){for(var o,e,o=t;o<=i;o++)(e=n[o])||((e=n[o]=new A).level=-1),e.viewCollapsed=r},s.prototype.setCollapsed=function(n,t,i,r){var o,e,u,f,s,a,s,u,c,v,h,o=this,e=!1,u=o.items,s=o.Mf.Ut,a=[];if(r||s.m2t(o.v2t),Rn(o),n<0?f=(f=o.head)||(o.head=new A):n<B(u)?(f=u[n])||((f=u[n]=new A).level=-1):f=(f=o.tail)||(o.tail=new A),s=1===o.direction(),(u=i!==C)||f.collapsed===t?u&&(f.level===i-1&&(f.collapsed=t),e=!0,o.K2t(n,t,i)):(f.collapsed=t,e=!0,o.K2t(n,t,i)),e&&(v=o.find(n+=s?-1:1,o.getLevel(n)))){for(h=v.start;h<=v.end;h++)a.push(h);c={indexes:a}}Ln(o,c),r||o.Mf.Ut.m2t(o.v2t,!0)},s.prototype.J2t=function(n,t){var i,i,i=this.items;i[n]?i[n].collapsed!==t&&(i[n].collapsed=t):((i=i[n]=new A).level=-1,i.collapsed=t)},s.prototype.K2t=function(n,t,i){var r,o,e,u,f,s,a,s,c,i,v,h,l,d,p,w,g,m,r=this,o=r.items,e=1===r.direction(),u,f=i!==C,s=n+(e?-1:1),a=f?i:r.getLevel(s),s=jn(r,s,a);if(s&&(c=e?s.end+1:s.start-1)!==n&&(s=null),k(s)&&(a=f?i:r.getLevel(n),s=jn(r,n,a)),s)if(i=void 0,v=s.parent,t)f||(i=e?s.end+1:s.start-1,r.J2t(i,!0),s=Gn(s,e)),r.Q2t(o,s.start,s.end,!0);else{for(h=!1,l=void 0;v;){if(o[l=e?v.end+1:v.start-1]&&o[l].collapsed&&-1<o[l].level){h=!0;break}v=v.parent}if(!h)for(f||(i=e?s.end+1:s.start-1,r.J2t(i,!1),s=Gn(s,e)),r.Q2t(o,s.start,s.end,!1),d=[s],p=0;0<=p;)if(w=d[p],p--,o[l=e?w.end+1:w.start-1]&&o[l].collapsed&&-1!==o[l].level)r.Q2t(o,w.start,w.end,!0);else for(g=w.children,m=0;g&&m<g.length;m++)d[++p]=g[m]}},s.prototype.getMaxLevel=function(){var i=-1,n=this.items,r;return L(n,function(n,t){t&&(r=t.level,i<r)&&(i=r)}),i},s.prototype.PB=function(n,i,t,r){var o,e,u,f,s;if(!(t<=0||n===i)){for((o=this).Mf.Ut.m2t(o.v2t),i<0&&(i=0),e=[],u=o.items,f=v(u,(n=n<0?0:n)-1);0<=f&&f<n+t;)s=new A(u[f]),e.push({index:f-n,value:s}),f=v(u,f);r&&h(u,n,t),h(u,i,t),L(e,function(n,t){u[i+t.index]=t.value}),_n(o),o.Mf.Ut.m2t(o.v2t,!0)}},s.prototype.FB=function(n,t,i,r,o){var e,u,f,e=this;if(e.Mf.Ut.m2t(e.v2t),t<0&&(t=0),i<0&&(i=0),u=[],n)for(f=v(n.items,t-1);0<=f&&f<t+r;)u[f-t]=new A(n.items[f]),f=v(n.items,f);h(e.items,i,r),0<u.length&&u.forEach(function(n,t){e.items[i+t]=n}),o&&h(n.items,t,r),e.Mf.Ut.m2t(e.v2t,!0)},s.prototype.refresh=function(){this.x2t||N(this)},s.prototype.X2t=function(n){var t=this,i=t.items,r,o=n-B(i);o<0?i.splice(n,-o):t.items=i.concat(new Array(o)),_n(t)},s.prototype.getState=function(n){var t=this,i=t.items,r,r=t.direction(),o=-1;return 0===r?o=n.start-1:1===r&&(o=n.end+1),(r=o<0?t.head:o<B(i)?i[o]:t.tail)&&r.collapsed?1:0},s.prototype.q2t=function(n,t){var i=this,r=i.items;n<0?(i.head||(i.head=new A),i.head.level=t):n<B(r)?(r[n]||(r[n]=new A),r[n].level=t):(i.tail||(i.tail=new A),i.tail.level=t),_n(i)},s.prototype.suspendAdding=function(){this.T2t++},s.prototype.resumeAdding=function(){this.T2t--},s.prototype.createRangeGroup=function(){for(var n,t,i,r,o,e,u,n=this,t=n.items,i=B(n.items),r=new w(n,0,i-1,-1),o=0;o<i;)t[o]&&(t[o].groupInfo=R),o++;for(o=0;o<i;)t[o]?(u=(e=bn(n,o,0)).g,o=e.index+1,u&&-1<u.level&&r.addChild(u)):o++;return r},s.prototype.$2t=function(n,t){return 1===this.direction()?t===n.end+1:t===n.start-1},s.prototype.tpt=function(n,t,i,r){var o=this,e=-1,u=0;if(1===o.direction()&&(e=0,u=1),n===t)return o.$2t(n,i)||o.$2t(n,r)?{start:n.start,end:n.end,level:n.level}:{start:i,end:r,level:n.level};for(;n.level>t.level;){if(t===n.parent)return o.$2t(t,r)?{start:t.start,end:t.end,level:t.level}:{start:n.start+e,end:r,level:n.level-1};n=n.parent}for(;n.level<t.level;){if(n===t.parent)return o.$2t(n,i)?{start:n.start,end:n.end,level:n.level}:{start:i,end:t.end+u,level:t.level-1};t=t.parent}for(;0<=n.level;){if(n.parent===t.parent)return{start:n.start+e,end:t.end+u,level:t.level-1};n=n.parent,t=t.parent}return{start:n.start+e,end:t.end+u,level:t.level-1}},s.prototype.npt=function(n){var t,i,r,t,o,e,t=this,i=t.items,r=i[n],t=1===t.direction()?i[n-1]:i[n+1],o,e;return(r?r.level:-1)<(t?t.level:-1)?t&&t.groupInfo:r&&r.groupInfo},s.prototype.lB=function(n,t){var i,r,o,e,i,i=this,r=i.npt(n),o=i.npt(n+t-1);if(k(r)&&k(o))return{start:n,end:n+t-1,count:t,level:-1};if(!r||!o){for(e=r||o;e&&-1!==e.level;)e=e.parent;r=r||e,o=o||e}return(i=i.tpt(r,o,n,n+t-1)).count=i.end-i.start+1,i},s.prototype.kB=function(n,t){for(var i,r,o,e,i,i,i=this,r=i.items,o=n;o<n+t;o++)if(e=r[o]&&r[o].groupInfo&&r[o].groupInfo.level,!k(e)&&0<=e)return!0;return i=r[i=1===i.direction()?n-1:n+t]&&r[i].groupInfo&&r[i].groupInfo.level,!k(i)&&0<=i},s.prototype.ept=function(n){var t,i,i,t,i=this.items,i=i[n]&&i[n].groupInfo&&i[n].groupInfo.level;return k(i)?-1:i},s.prototype.ipt=function(n,t,i){for(var r,o,e,u,f,r=this,o=[],e=[],u=n;u<n+t;u++)(f=r.ept(u))===i&&e.push(u),r.ept(u+1)<i&&0<e.length&&(o.push(e),e=[]);return 0<e.length&&o.push(e),o},s.prototype.hB=function(n,t){var i,r,o,e,u,i=this;if(1===t)return i.ipt(n.start,n.count,n.level);for(r=[],o=i.getMaxLevel(),e=2===t?n.level+1:n.level,u=o;e<=u&&-1<=u;u--)r=r.concat(i.ipt(n.start,n.count,u));return r},s.prototype.vB=function(n,t,i){for(var r,o,e,u,r=this,o=n.length-1;0<=o;o--)(e=n[o]).collapse&&r.setCollapsed(e.head,!1),r.ungroupRange(e.start,e.count);for(o=n.length-1;0<=o;o--)e=n[o],u=d.hD(t,e.head)+i,1===r.direction()?r.group(u-e.count,e.count):r.group(u+1,e.count),e.collapse&&r.setCollapsed(u,e.collapse)},s.prototype.dB=function(n,t,i){var r,o,e,u,i,f,s,a,c,v,h,l,r=this,o=r.items;if(1===i)for(e=r.getMaxLevel(),u=t.level+1;u<=e;u++)n.splice.apply(n,x([0,0],r.ipt(t.start,t.count,u),!1));else 2===i&&n.push.apply(n,r.ipt(t.start,t.count,t.level));for(f=n[(i=n.length)-1].concat([]),s=[],u=i-2;0<=u;u--)c=(a=o[n[u][0]]).groupInfo,1===r.direction()?(v=c.end+1,h=d.hD(f,v),f.splice.apply(f,x([h,0],n[u],!1)),s.push({head:v,start:c.start,count:v-c.start,collapse:a.viewCollapsed})):(v=c.start-1,h=d.hD(f,v),f.splice.apply(f,x([h+1,0],n[u],!1)),s.push({head:v,start:c.start,count:c.end-v,collapse:a.viewCollapsed}));for(l=!1,u=0;u<t.count;u++)if(f[u]!==u+t.start){l=!0;break}return{array:f,isChanged:l,groupSwap:s}},s.prototype.isGroupEnd=function(n,t){var i,r,o,i,i,r,o,e,n,i=this,r=i.items,o=n+1;return!u(i,o)||!(i=r[o])||(o=!1,(i=i.level)<(r=r[n].level)&&0<=(n=r-t)&&n<(e=r-i))||o},s.prototype.hitTest=function(n,t,i){return dn.call(n,t,i)},s.prototype.getBtnRectangle=function(){var n,t,i,r,o,e,u,f,n,s,o,i,a,c,v,e,h,l,d,p,n,n=this.Mf,t=this.v2t,i=n.Fi(),r=n.options.rightToLeft,o=n.options,e=o.sheetAreaOffset,u=t?i.qC:i.XC,f=n.gj(),n=t?f.rowMaxLevel:f.colMaxLevel,s=t?f.width:f.height,o=t?o.colHeaderVisible:o.rowHeaderVisible,i=t?i.LA-e.top:i.BA-e.left,a=2,c=n+2,v=Y(0,(s-4)/c),e=u-v,h=[];if(v&&o&&0<=e)for(l=Y(0,i+e/2),d=2,t&&(n=l,l=d,d=n),p=0;p<c;p++)h.push({x:(r&&!t?0:f.x)+l,y:f.y+d,width:v,height:v}),t?l+=v:d+=v;return h},s.prototype._e=function(n,t,i,r){var o,e,u,f,s,a,c,f,e,v,s,h,l,d;if(!this.Oy()&&(o=n.gj(),e=n.Fi(),u=n.Jt,f=o.width,s=o.height,a=n.Fi(),c=n.options.rightToLeft,f||s)){if(f=r?f:e.width,e=r?e.height:s,v=r?o.rowMaxLevel:o.colMaxLevel,s=r?u.kl:u._l,t.save(),t.beginPath(),!i||i.intersect((c&&!r?a:o).x,o.y,f,e))for(d=l=void 0,(h=new tn(n,r,v)).D2t(t),l=s.call(n.Jt,function(){return wn(n,r,v)}),d=0;d<=2;d++)l[d].F2t(t);t.beginPath(),t.restore()}},s.prototype.rpt=function(n,t){var i;t&&((i=t.what)===l||i===P?cn(n,t):i!==p&&i!==T||vn(n,t))},s.prototype.Oy=function(){return this.x2t},s.prototype.Ry=function(){var n=parseInt(z(Q).borderTopWidth,10);return isNaN(n)?2:n},s.prototype.fromJSON=function(n,t){var t,i,r,o,t,e,u,n,f,s,a,c,v,h,l,t=t&&t.ignoreStyle;if(n&&!t){if(r=(i=this).items,o=n.items,t=n.itemsData,e=n.direction,u=n.head,n=n.tail,c=[],k(e)||i.direction(e),u&&(i.head=u),n&&(i.tail=n),v=!1,o&&0<o.length)for(l=0;l<o.length;l++)k(o[l])||(h=new A(o[l]),i.direction()===on.forward&&(v=!!h.viewCollapsed||v&&!(h.collapsed=!0)),r[l]=h,i.x2t=!1);else L(t,function(n,t){if(f=t.index,s=t.info,0<=f&&s){for(a=0;a<t.count&&!(f+a>=B(r));a++)t.info.collapsed&&c.push(t),r[f+a]=new A(s);i.x2t=!1}});for(N(i,!0),l=0;l<c.length;l++)i.K2t(c[l].index,!0)}},s.prototype.toJSON=function(n){var n,n,t,i,r,o,e,u,f,n,s,n=n&&n.ignoreStyle;if(!n){for(t=[],i=(n=this).items,o=-1,e=[],r=0;r<B(i);r++)u=t[o],(f=i[r])&&(e[r]={level:f.level,collapsed:f.collapsed,viewCollapsed:f.viewCollapsed},0<=o&&r===u.count+u.index&&f.level===u.info.level&&f.collapsed===u.info.collapsed?t[o].count++:t[++o]={index:r,count:1,info:{level:f.level,collapsed:f.collapsed}});return n={items:e,itemsData:t,direction:n.direction(),head:n.head,tail:n.tail},s={},L(n,function(n,t){yn(n,t)||(s[n]=t)}),a.isEmptyObject(s)?C:s}},r=s,(c.Outline=r).prototype.direction=y("direction",1),i.Outline=r,a.extend(M.Y8.prototype,{m2t:function(n,t){var i,r,i=this,r=i.G8;r&&(r.originalOutlines||(r.originalOutlines=[]),!n||!t&&r.originalOutlines[0]?n||!t&&r.originalOutlines[1]||(r.originalOutlines[t?3:1]=Sn(i.opt)):r.originalOutlines[t?2:0]=Sn(i.apt))},upt:function(n,t,i){var r,t,r=this;void 0!==t&&(this.Mf.outlineColumn.NB=t),n&&((t=n[i?2:0])&&Un(r.apt,t),t=n[i?3:1])&&Un(r.opt,t)}}),M.Y8.ch(_,{init:function(){var n=this,t=n.Mf;n.opt=new r(n.getColumnCount(),t,!1),n.apt=new r(n.getRowCount(),t,!0)},applyChanges:function(n){var t,i,n,r,t,i=n.changes,n=n.isUndo,r=i&&i.originalOutlines;(r||i.oldOptions)&&this.upt(r,i.oldOptions,!n)},undo:function(n){var t=n.originalOutlines;(t||n.oldOptions)&&(this.upt(t,n.oldOptions),this.Mf.zw())},dispose:function(n){var t=this,i;!1!==(n&&n.clearCache)&&(t.opt&&(t.opt.L0(),t.opt=R),t.apt)&&(t.apt.L0(),t.apt=R)}}),M.Worksheet.ch(_,en={init:function(){var o=this;o.rowOutlines=o.Ut.apt,o.columnOutlines=o.Ut.opt,o.rowOutlines.groupChangeHandler=function(n){var n,t,t,i,r,t,n=n&&n.indexes;n&&o.recalcRows&&(t=o.getCalcService())&&!t.IsSuspended()&&o.recalcRows(n),(t=o.parent)&&o!==t.getActiveSheet()||o.iP(),t=n?(i=n[0],r=n[n.length-1],!0):(i=0,r=o.getRowCount()-1,!1),M.Worksheet.et(o,"onGroupChanged",{start:i,end:r,isRow:!0,fromSetCollapsed:t})},o.columnOutlines.groupChangeHandler=function(n){var t,t,i,r,n,t=o.parent;t&&o!==t.getActiveSheet()||o.rP(),n=(t=n&&n.indexes)?(i=t[0],r=t[t.length-1],!0):(i=0,r=o.getColumnCount()-1,!1),M.Worksheet.et(o,"onGroupChanged",{start:i,end:r,isRow:!1,fromSetCollapsed:n})},o.$L.push(o.rowOutlines),o.nF.push(o.columnOutlines)},dispose:function(n){var t=this;!1!==n.clearCache&&(t.rowOutlines&&(t.rowOutlines.groupChangeHandler=R),t.columnOutlines)&&(t.columnOutlines.groupChangeHandler=R),a(t.Dg()).unbind("mousedown.group")},setHost:function(n){var i;n&&(i=this,n.bind("mousedown.group",function(n){var t,n,t,t=i.uw(),n=dn.call(i,n.pageX-t.left,n.pageY-t.top);n&&((t=n.what)===p||t===l?i.rowOutlines.rpt(i,n):t!==T&&t!==P||i.columnOutlines.rpt(i,n))}))},preProcessMouseDbClick:function(n){var t=this;k(t.sw)||k(t.sw.outlineHitInfo)||(n.r=!0)},onPaintSuspend:function(n){var t=this;n.suspend?(t.rowOutlines.Xst(),t.columnOutlines.Xst()):(t.rowOutlines.$st(),t.columnOutlines.$st())},beforeLayoutChanged:function(n){var t,i;"invalidateLayout"===n.changeType&&(this.k2t=R)},onLayoutChanged:function(n){var t,i,r,o,e,u,n,f,s,a,c,t=this,i=n.changeType,r=n.row,o=n.rowCount,e=n.col,u=n.colCount,n=n.sheetArea,f=t.rowOutlines,s=t.columnOutlines,a=k(n)||3===n,c=this.Ut;"addRows"===i&&a?(c.m2t(!0),xn(f,r,o),c.m2t(!0,!0)):"deleteRows"===i&&a?(c.m2t(!0),On(f,r,o),c.m2t(!0,!0)):"addColumns"===i&&a?(c.m2t(!1),xn(s,e,u),c.m2t(!1,!0)):"deleteColumns"===i&&a?(c.m2t(!1),On(s,e,u),c.m2t(!1,!0)):"invalidateLayout"===i?t.k2t=R:"setColumnCount"===i?(c.m2t(!1),3!==n&&1!==n||s.X2t(u),c.m2t(!1,!0)):"setRowCount"!==i||3!==n&&2!==n||(c.m2t(!0),f.X2t(o),c.m2t(!0,!0))},paint:function(n){var t,n,i,r,o,t=n.ctx,n=n.clipRect,i=this,r=i.rowOutlines,o=i.columnOutlines;r&&r._e(i,t,n,!0),o&&o._e(i,t,n,!1)},fromJson:function(n,t,i){var r,o,e,u,e,u;n&&(r=this,o=void 0,e=n.showRowRangeGroup,u=n.showColumnRangeGroup,e=f(e)?e:n.showRowOutline,u=f(u)?u:n.showColumnOutline,k(e)||r.showRowOutline(e),k(u)||r.showColumnOutline(u),(o=n.rowRangeGroup||n.rowOutlines)&&r.rowOutlines.fromJSON(o,i),o=n.colRangeGroup||n.columnOutlines)&&r.columnOutlines.fromJSON(o,i)},toJson:function(n,t){var i,r,o,e,e,i=this,r=i.rowOutlines,o=i.columnOutlines,e=i.showRowOutline();!0!==e&&(n.showRowOutline=e),!0!==(e=i.showColumnOutline())&&(n.showColumnOutline=e),n.rowOutlines=r?r.toJSON(t):C,n.columnOutlines=o?o.toJSON(t):C},wh:function(n,t,i){var i,i,r,o,e,e,i,e,i,e,u,f,u,s,a,c,v,h,l,d,p,w,g,m,i=i&&!1===i.includeStyles;if(!i){for(r=(i=this).rowOutlines,o=i.columnOutlines,!0!==(e=i.showRowOutline())&&(n.lossless.showRowOutline=e),!0!==(e=i.showColumnOutline())&&(n.lossless.showColumnOutline=e),0!==r.direction()&&0!==o.direction()||((i=S(n,H))||n.c_.push(i={n_:H,c_:[]}),i.c_.push(e={n_:"outlinePr"}),0===r.direction()&&(e.summaryBelow="0"),0===o.direction()&&(e.summaryRight="0")),i=S(n,M.XFileConstants._u),e=r.getMaxLevel(),u=-1!==(u=o.getMaxLevel())?u+1:C,i.outlineLevelRow=f=-1!==e?e+1:C,i.outlineLevelCol=u,s=n.tempCols,a=o.items,c=i.defaultColWidth,v=0;v<a.length;v++)(h=a[v])&&(l=h.viewCollapsed,(d=s[v]||{width:c,hidden:C,collapsed:C,outlineLevel:C}).hidden!==Z&&!l||(d.hidden=Z),!0===h.collapsed&&(d.collapsed=Z),-1!==h.level&&(d.outlineLevel=h.level+1),s[v]=d);for(p=S(n,X),w=r.items,v=0;v<w.length;v++)(g=w[v])&&(l=g.viewCollapsed,(m=p[v]||{}).v===C&&!1===l&&(m.v=0),m.f=!0===g.collapsed?1:0,m.l=g.level+1,p[v]=m)}},yh:function(n,t,i){var r,r,o,r,e,f,o,o,o,s,a,u,c,v,h,l,d,p,w,g,m,C,x,O,b,j,j,x,x,y,_,R,L,r=i&&!1===i.includeStyles;if(!r&&(n.lossless&&(r=n.lossless.showRowOutline,o=n.lossless.showColumnOutline,k(r)||this.showRowOutline(r),k(o)||this.showColumnOutline(o)),e=(r=this).rowOutlines,f=r.columnOutlines,(o=D(n,H+"&outlinePr"))&&("0"===o.summaryBelow&&e.direction(0),"0"===o.summaryRight)&&f.direction(0),(o=(o=S(n,M.XFileConstants.Eu))&&o.c_)&&0<o.length&&(s=f.items,a=r.getColumnCount(),o.forEach(function(n){var t,i,r,o,e,u;if((0<n.outlineLevel||!k(n.collapsed))&&(f.x2t=!1,t=n.min-1,i=n.max-1,r=+n.outlineLevel||0,o=nn(n.hidden,!1),e=nn(n.collapsed,!1),0<=t)&&0<=i)for(i===M.MAX_COLUMN_COUNT-1&&(i=Math.max(a,t)),u=t;u<=i;u++)s[u]=new A({level:r-1,collapsed:e,viewCollapsed:o}),a<u+2&&!(r<=0&&(!s[u-1]||s[u-1]&&s[u-1].level<0))&&(a=u+2)}),a>r.getColumnCount())&&r.setColumnCount(a),u=S(n,X))){for(c=r.Ut.Q_(!0),h=[],l=e.items,d=(v={rowItems:[],itemsData:[]}).rowItems,p=v.itemsData,w=u.rowCount,g=0===e.direction(),m=r.getRowCount(),C=0;C<w;C++)(x=u[C])?(O=!!x.f,(0<(b=+x.l||0)||O)&&(d[C]={level:b-1,collapsed:O},(j=p[p.length-1])&&C===j.index+j.count&&j.info.level===b-1&&j.info.collapsed===O?j.count++:p.push({index:C,count:1,info:{level:b-1,collapsed:O}})),j=!!x.v,x=h[C-1]&&h[C-1].hidden,p&&In(v,C,b,g,j,x),((x={}).hidden=j)&&0===b&&(x.visible=!1),h.push(x),!M.Util.ko(i)&&!g&&m<+C+2&&(0<b||O)&&(m=+C+2)):h.push({});if(An(v,u,h,e.direction(),c),y=!1,_=void 0,R=[],d&&0<d.length)for(L=0;L<d.length;L++)k(d[L])||(_=new A(d[L]),e.direction()===on.forward&&(y=!!_.viewCollapsed||y&&!(_.collapsed=!0)),l[L]=_,e.x2t=!1);for(N(e,!0),L=0;L<R.length;L++)e.K2t(R[L].index,!0);for(m>r.getRowCount()&&r.setRowCount(m),L=0;L<h.length;L++)!1===h[L].visible&&c.R8.push(L)}}}),M.Workbook.ch(_,un={init:function(){O.Commands.g2t(this.commandManager())},onCultureChanged:function(){(0,c.getSR)()}})},"./dist/plugins/group/group.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/group/group.res.en.js");t.SR={en:i}},"./dist/plugins/group/group.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_GROUP_PROTECTED=t.Exp_GroupInfoIsNull=t.Exp_InvalidLevel=t.Exp_InvalidCount=t.Exp_InvalidIndex=void 0,t.Exp_InvalidIndex="Invalid index",t.Exp_InvalidCount="Invalid count",t.Exp_InvalidLevel="Invalid level",t.Exp_GroupInfoIsNull="groupInfo is null",t.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=o("./dist/plugins/group/group.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Outlines=n}();
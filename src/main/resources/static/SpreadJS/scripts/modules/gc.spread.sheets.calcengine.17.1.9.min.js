/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,t,i){var c,u,e,s,a,l,h,v,d;function r(f,o,u){for(var s,n,t,n=function(n){var t,n,e,i,r,t=o[n];if(t.l)for(n=w(t.k),e=f.oT(n[1],n[2],!0),t.v&&f.nbt(e),t.b,e.aT=t.l.map(function(n){return parseInt(n,10)}),i=function(n){var r=t.l[n];e[r]=(0,c.createMap)(),null!=(s=t[r])&&s.map(function(n){var t,i,i,t=w(n),i=t[0];"?"!==i[0]&&"!"!==i[0]||(i=i.slice(1)),i=u[i],e[r].set(n,i.oT(t[1],t[2],!0))})},r=0;r<t.l.length;r++)i(r)},t=0;t<o.length;t++)n(t)}function w(n){return n.split(",").map(function(n,t){return n=0<t?parseInt(n,10):n})}function f(n,t,i){var r,e,f,o,u,s,c,a,l,a,r=n.uT(!0);for(e in t.l)if(t.l.hasOwnProperty(e))for(o in f=t[e])if(f.hasOwnProperty(o))for(u=o.split(",").map(function(n,t){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)}),s=0;s<f[o].length;s++)a=(l=i[a="?"!==(a=(c=w(f[o][s]))[0])[0]&&"!"!==a[0]?a:a.slice(1)]).oT(c[1],c[2],!0),r.processListener(parseInt(e,10),u[0],u[1],u[2],u[3],a,!0)}function o(n){}function m(n,t){var i,r,e,f,o,u,i={};if(t&&t.idMap){for(f in e={},r=n.rO)r.hasOwnProperty(f)&&(e[r[f].getSource().getName()]=r[f]);for(f in o=t.idMap)o.hasOwnProperty(f)&&(u=o[f],i[f]=e[u])}return i}function C(n){var t,i,r,t=n.rO,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r].getSource().getName());return i}function _(n,t){return p(n,t)}function p(n,t){var i,r,e,f,o,o,o,i=n.t;if(4===i||2===i||3===i||8===i||100===i)(r=new c.Expression(i)).value=n.v;else{if(5===i)(r=new c.Expression(5)).value=c.CalcError.ibt(n.v);else if(6===i)(r=new c.Expression(6)).value=new c.CalcArray(n.v);else if(9===i)r=(0,c.rbt)(n.o,p(n.v,t),n.w&&p(n.w,t));else if(10===i)(r=new c.Expression(10)).value=p(n.v,t);else if(11===i)r=new c.Expression(11);else if(7===i)for(r=new c.Expression(7),n.f&&(r.function=p(n,t)),n.n&&(r.function=t.getFunction(n.n),r.functionName=n.n),e=r.arguments=[],f=0;f<n.p.length;f++)n.p[f]&&(e[f]=p(n.p[f],t));else 1===i?(r=new c.ReferenceExpression(1),(o=n.v.split("*"))[0]&&(r.source=t.getExternalSource("",o[0])),o[1]&&(r.endSource=t.getExternalSource("",o[1])),o[2]&&(r.row=parseInt(o[2],10)),o[3]&&(r.column=parseInt(o[3],10)),o[4]&&(r.endRow=parseInt(o[4],10)),o[5]&&(r.endColumn=parseInt(o[5],10)),o=parseInt(o[6],10),r.rowRelative=!!(o&s),r.columnRelative=!!(o&a),r.endRowRelative=!!(o&l),r.endColumnRelative=!!(o&h),r.isFullRow=!!(o&v),r.isFullColumn=!!(o&d),r.isFullRow&&(r.column=r.endColumn=c.BAND_INDEX_CONST),r.isFullColumn&&(r.row=r.endRow=c.BAND_INDEX_CONST)):13===i?(r=new u.obt,o=n.v,r.abt=o[0],r.source=o[1],r.ubt=o[2],r.sbt=o[3],r.lbt=o[6],r.hbt=o[7],r.source=t.getExternalSource("",r.source),r.abt=t.getTableByName(r.abt)):r&&r.type;n.es&&(r.ensureSingle=!0)}return r}function g(n){return b(n)}function b(n){var t,i,r,r;if(!n)return n;if(t={t:n.type},n.ensureSingle&&(t.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)t.v=n.value;else if(5===n.type)t.v=n.value._code;else if(6===n.type)t.v=n.value.array;else if(9===n.type)t.o=n.operatorType,t.v=b(n.value),t.w=n.value2&&b(n.value2);else if(10===n.type)t.v=b(n.value);else if(7===n.type)for((0,c.isExpression)(n.function)?t.f=b(n.function):n.functionName&&(t.n=n.functionName),t.p=[],i=0;i<n.arguments.length;i++)t.p[i]=b(n.arguments[i]);else 1===n.type?(r=(n.rowRelative&&s)|(n.columnRelative&&a)|(n.endRowRelative&&l)|(n.endColumnRelative&&h)|(n.isFullRow&&v)|(n.isFullColumn&&d),r=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,r],n.isFullRow&&(r[3]=r[5]=e),n.isFullColumn&&(r[2]=r[4]=e),t.v=r.join("*")):13===n.type?t.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,0,0,n.lbt,n.hbt]:n.type;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.exprToJSON=t.exprFromJSON=t.dbt=t.vbt=t.mbt=t.gbt=t.pbt=void 0,c=i("CalcEngine"),u=i("./dist/plugins/sheetsCalc/parser-sheets.js"),e=null,s=1,a=2,l=4,h=8,v=16,d=32,t.pbt=r,t.gbt=f,t.mbt=o,t.vbt=m,t.dbt=C,t.exprFromJSON=_,t.exprToJSON=g},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(N,n,t){var i,H,r,b,g,U,m,q,k,D,s,x,V,T,$,Y,L,X,R,B,z,W,K,Q,I,y,A,E,O,M,j,c,t,t,e,S,u,a,F,J,G,f,e,P,o,l,Z,nn;function h(n,t,i,r,e,f,o){var u=this;u.Zc=n,u.FY=i,u.jpt=r,u.WK=t,B(e)||(u.TZ=e),u.t1e="boolean"==typeof f&&f,u.DJ=o}function v(n,t,i,r,e,f,o){var n,r,n=P.call(this,n,r,e,f,o)||this,r=n;return r.bbt=t,r.ybt=i,n}function tn(n){var t=o.call(this,T)||this;return t.references=n,t}function d(n,t,i,r){var e,t,f,o;for(void 0===r&&(r={}),e=l.call(this,n&&n.Uw(r.sheetArea),t,i,r)||this,n||(n=d.wbt=d.wbt||new H.Worksheet,e.source)||(e.source=n.Uw(r.sheetArea)),e.Mf=n,e.row=i&&i.row||0,e.column=i&&i.col||0,f=(t=n.getCalcService()).getResolvers(),o=0;o<f.length;o++)if(f[o]instanceof g.SheetReferenceResolver)return e;return t.addResolver(new g.SheetReferenceResolver),t.addResolver(new g.StructureReferenceResolver),e}function w(n){this.XRe=n,this.YEi()}function C(n,t,i){var i=Z.call(this,i)||this;return i.getCalcSourceModel=function(){return this.Mbt},i.createSourceModel=function(n){var n=new U.CalcSourceModel(n,this);return n.usedRange=new H.BaseUsedRange,n},i.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},i.getSheetRangeReference=function(n){var t,t,i,r,e,f,o,t=this.Mf,t=t&&t.parent;if(n.endSource&&t&&t.sheets&&n.endSource instanceof C){for(i=t.sheets,r=!1,e=void 0,f=[],o=0;o<i.length;o++){if((e=i[o].Uw())===this)r=!0;else if(e===n.endSource){f.push(e.getReference(n));break}r&&f.push(e.getReference(n))}return new u(f)}},i.Mf=n,i.t8=new k.Z8(i),i.nT=t||3,i}function _(n){var t=nn.call(this,T)||this;return t.createSourceModel=function(n){return new U.CalcSourceModel(n,this)},t.vpt=n,t.Cbt={},t}function rn(n,t,i,r,e,f){var n,o,n,n=n&&n instanceof H.Worksheet&&n,o=new U.Parser;return i=i===$?0:i,r=r===$?0:r,n=new a(n,!!e,(0,U.eV)(i,r)),f&&(n.culture=!0),o.parse(n,t)}function en(n,t,i,r,e,f){var n,o,e,n=n&&n instanceof H.Worksheet&&n,o=new U.Parser;return i=i===$?0:i,r=r===$?0:r,(e=new a(n,!!e,(0,U.eV)(i,r))).Sbt=f,e.Nme=n&&n.vle,o.unparse(e,t)}function fn(n,t,i,r,e){var f;return on(n,rn(n,t,i=i===$?0:i,r=r===$?0:r,e,!0),i,r)}function on(n,t,i,r,e){var f,o,n,f=n.op();return i===$&&(i=n.getActiveRowIndex()),r===$&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==$&&(o=e.convertNullToZero),n=n.Uw(e&&e.sheetArea),f.evaluateParsedFormula(n,t,(0,U.eV)(i,r),!1,o)}function un(n,t,i,r,e){var f,o,e,n,f=n.op();return i===$&&(i=n.getActiveRowIndex()),r===$&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==$&&(o=e.convertNullToZero),e=n.Uw(),(n=(0,U.eV)(i,r)).Tbt=Math.random().toString(36).substring(2),f.Abt(e,t,n,o)}function p(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,f=n.row,o=n.col,u=n.row+n.rowCount-1,s=n.col+n.colCount-1,c=!1,a=!1,l=!1,h=!1;return 4<=arguments.length&&(f-=(c=0!=(1&r))?t:0,u-=(a=0!=(4&r))?t:0,o-=(l=0!=(2&r))?i:0,s-=(h=0!=(8&r))?i:0),e&&(d=cn(n,e,t),w=an(n,e,t),d)&&w?g.StructureReferenceResolver.create(e,d,w,n.col-e.dataRange().col,n.col+n.colCount-e.dataRange().col-1):1===n.rowCount&&1===n.colCount?(0,U.knt)(T,T,f,o,c,l):(n.row<0&&(f=u=m.BAND_INDEX_CONST),n.col<0&&(o=s=m.BAND_INDEX_CONST),(0,U.lJ)(T,T,f,o,u,s,c,l,a,h,t,i))}function sn(n){return 0<=n.indexOf("[")&&1<n.indexOf("]")}function cn(n,t,i){if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 2;if(t.hasTotalsRow()&&n.row===t.endRow())return 8;if(i===n.row)return 1}else{if(t.hasHeadersRow()&&n.row===t.startRow()){if(n.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1+1)return 14}if(n.row===t.dataRange().row){if(n.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1)return 12}}return $}function an(n,t,i){return n.col===t.startColumn()&&n.colCount===t.dataRange().colCount?1:1===n.colCount?2:n.col>=t.startColumn()&&n.col+n.colCount-1<=t.endColumn()?4:$}function ln(n,t,i,r,e){var n,r,f,e,n=p(n,t,i,r),r=new a(T,!!e,(0,U.eV)(t,i)),f,e=(new U.Parser).unparse(r,n);return r.L0(),e}function hn(n,t,i,r,e,f,o){var t,e,u,t=p(t,i,r,e,o),e=new a(n,!!f,(0,U.eV)(i,r)),u;return(new U.Parser).unparse(e,t)}function vn(n,t,i){if(!n)return!1;var r=!1,e=!1;if(1===t.rowCount){if(n.hasHeadersRow()&&t.row===n.startRow())return!0;if(n.hasTotalsRow()&&t.row===n.endRow())return!0;if(t.row===i&&t.col>=n.startColumn()&&t.col+t.colCount<=n.startColumn()+n.dataRange().colCount)return!0}else n.hasHeadersRow()&&t.row===n.startRow()&&(t.rowCount===n.dataRange().rowCount+1&&(r=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1+1&&(r=!0),t.row===n.dataRange().row&&(t.rowCount===n.dataRange().rowCount&&(r=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1&&(r=!0);return t.col+t.colCount<=n.startColumn()+n.dataRange().colCount&&(e=!0),r&&e}function dn(n,t,i,r){var e,t,f,o,u,s,c,a,l,u,s;if(!t)return null;if(i=i||0,r=r||0,o=!1,(t=(e=n.op()).parse(n.Uw(),t,i,r,!0,!0))&&(7===t.type&&"ANCHORARRAY"===t.functionName&&(t=t.arguments[0],o=!0),!(f=t.source)||13!==t.type)&&1===t.type&&t.endSource){for(u=t.source,s=t.endSource,c=u.getSources(s),a=!1,l=0;l<c.length;l++)if(c[l]===n.Uw()){a=!0;break}t=a&&t}return t&&t.getRange&&(!f||f===n.Uw())&&(u=t.getRange(i,r))?(o&&(s=new U.CalcReference(n.qgt,[u]).getSpillRef())&&s.$gt&&(u=s.$gt[0]),new H.Range(u.row,u.col,u.rowCount,u.colCount)):null}function wn(n,t,i,r,e,f,o){var u,s,c,a,l,o,h,v,d,w,m,C,_,p,u=[],s=[];if(t)if(i=i||0,r=r||0,o)try{c=rn(n,t,i,r),(a=n.Lp.evaluateExpression(n.qgt,c,{row:i,col:r},!1,!0))&&a.$gt&&(a.$gt.forEach(function(n){s.push(new H.Range(n.row,n.col,n.rowCount,n.colCount))}),u.push({sheetName:a.rT.getName(),ranges:s}))}catch(n){}else for(l={},o=new U.Parser,h=g.Vgt(o,t,n,i,r,$,e,f),v=0;v<h.length;v++)if((d=h[v].sheetRanges)&&!V(d))for(w=0;w<d.sheets.length;w++)for(m=d.sheets[w],(s=l[m])||(l[m]=s=[],u.push({sheetName:m,ranges:s})),C=d[m],_=0;_<C.length;_++)p=C[_],B(p)||s.push(new H.Range(p.row,p.col,p.rowCount,p.colCount));return u}function mn(n,t,i,r,e){var f,e,f,f=new U.Parser,e=new a(T,!!e,(0,U.eV)(t,i)),f=Cn(f,e,n,t,i,r);return e.L0(),f}function Cn(n,t,i,r,e,f,o){for(var u,s,c,c,a,u="",s=0;s<i.length;s++)c=p(i[s],r,e,f),c=n.unparse(t,c),u+=0<s?(a=o&&b.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+c:c;return u}function _n(t,i,r,e,f,o,u,n){var s,c,a,n,l,h,v,d,w,m,C,_,p,g,s=(n=n||{}).maximumIterations||100,c=n.tolerance||.001,a=function(n){return t.setValue(i,r,n),e.mL(f,o,$,$,{realValue:!0})},n=function(n){var t=(y(n)?+n:0)-u;return y(n)&&Math.abs(t)<c};if(t.suspendPaint(),t.suspendEvent(),l=e.mL(i,r,$,$,{realValue:!0}),C=!1,_=.01,v=y(l)?+l:0,h=e.mL(f,o,$,$,{realValue:!0}),w=(y(h)?+h:0)-u,y(h)&&Math.abs(w)<c)C=!0;else if(R(h))C=!1;else for(d=v+(0===v?_:_*v),p=0;!C&&p<s;p++)h=a(d=b.Common.st.E8(d,13)),m=(y(h)?+h:0)-u,y(h)&&Math.abs(m)<c?C=!0:d=R(h)?(v+d)/2:v-d==0?v+(0===v?_:_*v):w-m==0?v+2*(d-v):(g=d-m*(v-d)/(w-m),v=d,w=m,g);return(C=C||pn(a,n,l,u))||t.setValue(i,r,l),t.resumeEvent(),t.resumePaint(),C}function pn(n,t,i,r){var i,e,f,o,u,s,c,c,i=gn(n,i),e=i.find,f=i.left,o=i.right;if(e)for(u=0;u<100;){if(t(c=n(s=(f+o)/2)))return!0;c=c-r,(n(f)-r)*c<0?o=s:(n(o)-r)*c<0&&(f=s),u++}return!1}function gn(n,t){var i,r,e,f,o,u,i=-1e6,r=1e6,e=1e-5,f=t;return y(n(t))?{find:!0,left:o=bn(n,i,f,e),right:u=xn(n,f,r,e)}:{find:!1,left:0,right:0}}function bn(n,t,i,r){for(var e,f,e=0;e<100;){if(i-t<=r)return i;y(n(f=(i+t)/2))?i=f:t=f,e++}}function xn(n,t,i,r){for(var e,f,e=0;e<100;){if(i-t<=r)return t;y(n(f=(i+t)/2))?t=f:i=f,e++}}i=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}f(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.goalSeek=n.RangeReferenceRelative=n.Ibt=n.rangesToFormula=n.formulaToRanges=n.formulaToRange=n.isStructureReference=n.rangeToFormulaWithStructReference=n.rangeToFormula=n.isValidExternalReference=n.rangeToExpression=n.xbt=n.evaluateExpression=n.evaluateFormula=n.expressionToFormula=n.formulaToExpression=n.SpreadSource=n.SheetSource=n.SheetParserContext=n.SheetRangeReference=n.FormatterNameInfo=n.NameInfo=n.ReferenceStyle=void 0,H=t("Core"),r=t("Core"),b=t("Common"),g=t("./dist/plugins/sheetsCalc/parser-sheets.js"),U=t("CalcEngine"),m=t("./dist/plugins/sheetsCalc/calc.ns.js"),q=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=t("./dist/plugins/sheetsCalc/dynamic-array.js"),D=b.Common.lt,s=b.Common.zf,x=D.Dh,V=D._h,T=null,$=void 0,(Y=["v","n","s","b","d","sn"])[11]="an",L=U.Errors.Value,X=b.Formatter&&b.Formatter.GeneralFormatter,R=U.Convert.BJ,B=D.ht,z=H.mt.xr,W=H.range_parser.jc,K=H.mt.vo,Q=H.Util.addXLFNPrefix,I=b.Common.rbush,y=function(n){return U.Convert.q8(n,!0)},A=H.Range.prototype.contains,E=s.Gmt,O="number",M=H.UsedRangeUtil.updateUsedRangeByData,j="__hyperlink__",c={},(t=U.CalcSource.prototype).referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,s=this,l=1,h=1,m=[],w=n.getRangeCount();if(0===w)m.isError=!0;else{for(p=s.getRowCount(),g=s.getColumnCount(),i=i===$||i,b=0;b<w;b++){if(i||m.push(_=[]),0===(l=n.getRowCount(b)))return m.isError=!0,m;if(0===(h=n.getColumnCount(b)))return m.isError=!0,m;if(v=n.getRow(b),d=n.getColumn(b),2!==i){if(p<=v||g<=d)return(m=[T]).rowCount=1,m.colCount=1,m.rangeCount=1,m;g<d+h&&(h=g-d)}for(p<v+l&&(l=p-v),x=void 0,R=0;R<l;R++)for(c=v+R,i||_.push(x=[]),y=0;y<h;y++){if(C=s.getValue(c,a=d+y),r&&U.Convert.BJ(C))return(m=[C]).isError=!0,m;if(C=U.Convert.Nbt(C,t,!U.ExcelCompatibleCalcMode,f,u),e&&C===U.Convert.CalcConvertedError)return(m=[L]).isConvertError=!0,m;C===T&&f||(2===i?m[R*h+y]=C:(i?m:x).push(C))}}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w}return m},t.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new U.CalcReference(n),n.kbt},(e=t=n.ReferenceStyle||(n.ReferenceStyle={}))[e.a1=0]="a1",e[e.r1c1=1]="r1c1",r.ReferenceStyle=t,h.prototype.getName=function(){return this.Zc},h.prototype.set=function(n,t,i,r,e){this.DJ.qRe(this.Zc,n,t,i,r),this.TZ=e},h.prototype.btV=function(n){this.Zc=n},h.prototype.getRow=function(){return this.FY},h.prototype.getColumn=function(){return this.jpt},h.prototype.getExpression=function(){return this.WK},h.prototype.getComment=function(){return this.TZ},h.prototype.SB=function(n,t,i,r){t&&t.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n,B(i)||(this.FY=i),B(r)||(this.jpt=r)},h.prototype.isReadOnly=function(n){return"boolean"==typeof n&&(this.t1e=n),this.t1e},n.NameInfo=e=h,r.NameInfo=e,i(v,P=e),v.prototype.getFormatter=function(){return this.bbt},v.prototype.getSheetTabName=function(){return this.ybt},n.FormatterNameInfo=v,U.CalcSource.prototype.createSourceModel=function(n){return new U.CalcSourceModel(n,this)},o=U.CalcReference,i(tn,o),tn.prototype.toArray=function(n,t,i,r,e){for(var f,o,u,s,f=this.references,o=[],u=0;u<f.length;u++){if((s=f[u].rT.referenceToArray(f[u],n,t,i,r,e)).isError&&i)return s;t?Array.prototype.push.apply(o,s):o.push(s),u||(o.rowCount=s.rowCount,o.colCount=s.colCount)}return o.rangeCount=f.length,o},u=tn,n.SheetRangeReference=u,l=U.ParserContext,i(d,l),d.prototype.getExternalSource=function(n,t){var i,r,e,f,o,u,i=this,r=i.Mf.parent,e=i.Mf.Uw();if(n&&(!r||r.name!==n))return T;if(!r)return s.Dbt(i.Mf.name(),t)?e:T;if(sn(t))return r._p.parseSource(t,e.G3);if((f=r.sheets)&&0<f.length)for(o=0;o<f.length;o++)if(u=f[o],s.Dbt(u.name(),t))return u.Uw();return U.ParserContext.prototype.getExternalSource.call(this,n,t)},d.prototype.getExternalSourceToken=function(n){return n.getName(this)},d.prototype.getTableByName=function(n){var t,i,r,e,f,t=this.Mf.tables,i=!0,r=t?t._bt(n,!0):T;if(!r&&(e=this.Mf.parent&&this.Mf.parent.sheets))for(f=0;f<e.length&&(!(t=e[f].tables)||!(r=t._bt(n,!0)));f++);return r||this.Mf.parent&&this.Mf.parent.Ofe(n)},d.prototype.getTableByIndex=function(n,t){var i=this.Mf.tables;return i?i.Hq(n,t,!0):T},d.prototype.setSource=function(n){var n=this.source=n;n&&n.getSheet&&(this.Mf=n.getSheet())},d.prototype.L0=function(){this.Mf&&this.Mf!==d.wbt&&this.Mf.L0(),this.Mf=T},a=d,n.SheetParserContext=a,w.prototype.Oy=function(){return 0===this.$Re.data.length},w.prototype.YEi=function(){var t,n,n,t=this,n=null==(n=this.XRe.Mf)?void 0:n.tables;this.$Re=new I,n&&(n.all().forEach(function(n){n.tFe(t.$Re)}),this.Oy())&&(this.$Re=$),this.nFe=!0},w.prototype.eFe=function(n,t,i,r,e){var f,o,u,f,o=this.$Re;o&&(c.minX=n,c.minY=t,c.maxX=n+i-1,c.maxY=t+r-1,(u=o.search(c)).forEach(function(n){e(n.expr,n.nodes)}))},w.prototype.o_t=function(t,n,i,r){var e,f,o;void 0===i&&(i=1),void 0===r&&(r=1),(f=(e=this).$Re)&&(c.minX=t,c.minY=n,c.maxX=t+i-1,c.maxY=n+r-1,(o=f.search(c)).forEach(function(n){n.currentRow?n.nodes.forEach(function(n){n.row>=t&&t+i>n.row&&n.vyt()}):n.nodes.forEach(function(n){n.vyt()})}))},w.prototype.J_t=function(t){var n,n,n=null==(n=this.XRe.Mf)?void 0:n.tables;this.$Re&&n&&n.all().forEach(function(n){var n;null!=(n=n.aT)&&n.forEach(function(n){n.forEach(function(n){n&&n.w3&&n.w3!==t&&n.vyt&&n.vyt()})})})},w.prototype.a_t=function(t,n,i){var r,e,f,o,r,e=this.$Re;e&&(f=i?1:-1,c.minX=c.maxX=t,c.minY=c.maxY=n,(o=e.search(c)).forEach(function(n){n.currentRow?n.nodes.forEach(function(n){n.row===t&&(n.delay+=f)}):n.nodes.forEach(function(n){n.delay+=f})}))},F=w,Z=U.CalcSource,i(C,Z),C.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},C.prototype.addReferenceSheetName=function(n){var t=this;t.Ebt||(t.Ebt={}),t.Ebt[n]=1},C.prototype.setReferenceSheetNames=function(n){this.Ebt=n},C.prototype.startCalculation=function(){this.jbt,this.Obt(),this.K5=[]},C.prototype.endCalculation=function(n){this.jbt=T,this.Rbt=T,!1!==n&&this.Bbt(),this.K5=T},C.prototype.HJe=function(n,t){n?(this.VJe||(this.VJe=this.jbt,this.YJe=this.Rbt),this.startCalculation()):(this.endCalculation(t),this.jbt=this.VJe,this.VJe=null,this.Rbt=this.YJe,this.YJe=null)},C.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout(function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt},0))},C.prototype.Bbt=function(n){var t,i,i,n,r,t,n=n||this.K5;n&&0<n.length&&(t=null==(t=(r=this.Mf).Ut)?void 0:t.W_(3).B8,!r.Ut||null!=(i=null==(i=r.parent)?void 0:i.Lp)&&i.lb||r.ki(H.Events.RangeChanged,{isUndo:!B(t&&t.vE),sheet:r,sheetName:r.name(),row:0,col:0,rowCount:r.getRowCount(),colCount:r.getColumnCount(),changedCells:n,action:6},r.QI))},C.prototype.clearValueCache=function(){this.Obt()},C.prototype.Obt=function(){var n=this.getRowCount(),t=this.getColumnCount();this.jbt={rowCount:n,colCount:t},this.Rbt={arrayInfo:[]}},C.prototype.Gw=function(){this.jbt=T,this.Rbt=T,this.K5=T},C.prototype.getValue=function(n,t){for(var i,r,e,f,o,u,s,n,c,a,l,h,v,d,w,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(f=(e=this).Mf,typeof n==O)o=n,u=arguments[1],t=arguments[2],s=arguments[3];else if(n.row!==$)o=n.row,u=n.col;else if(n.name)return null;return n=e.nT,o<0||u<0?L:f.Gbt&&f.Ubt===o&&f.Hbt===u?f.zbt:(c=e.jbt,a=Y[t=t||0],c?(l=c.rowCount,h=c.colCount,w=d=v=void 0,l<=o||h<=u?T:((w=(d=(d=(v=(v=c[o])||(c[o]={}))[u])||(v[u]={v:s?f.getValueIgnoreDefault(o,u,n,$,!0):e.Mf.mL(o,u,n,$,{realValue:!0})}))[a])===$&&(w=U.Convert.Nbt(d.v,t,!U.ExcelCompatibleCalcMode),d[a]=w),H.mt.V0(w))):o>=e.getRowCount()||u>=e.getColumnCount()?T:s?e.Mf.getValueIgnoreDefault(o,u,n,$,!0):e.Mf.mL(o,u,n,$,{realValue:!0}))},C.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName()+"."+r+"."+e+"."+f+"."+t},C.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new U.CalcReference(t,[n])},C.prototype.getSources=function(n){var t,i,r,e,f;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof C){for(t=this.Mf.parent.sheets,i=!1,r=void 0,e=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this&&(i=!0),r===n){e.push(r);break}i&&e.push(r)}return e}},C.prototype.Vbt=function(r,e){var n,f,o,u,n,f=this.Rbt,o=f&&f.arrayInfo;o&&(u=!1,o.forEach(function(n,t){var i,n;n&&(i=n.reference,n=n.key,A.call(i.$gt[0],r,e))&&(delete f[n],o[t]=$,u=!0)}),u)&&(f.arrayInfo=[],o.forEach(function(n){n&&f.arrayInfo.push(n)}))},C.prototype.referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,A,E,O,M,S,F,h=l=1,m=[],p=(s=this).Mf,g=s.jbt,b=s.Rbt,y=Y[t=t||0];if(0===(w=n.getRangeCount()))m.isError=!0;else{if(b&&(C=b[R=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i]))return C;for(j=this.getRowCount(),N=this.getColumnCount(),i=i===$||i,k=0;k<w;k++){if(i||m.push(_=[]),0===(l=n.getRowCount(k)))return m.isError=!0,m;if(0===(h=n.getColumnCount(k)))return m.isError=!0,m;if(v=n.getRow(k),d=n.getColumn(k),2!==i){if(j<=v||N<=d)return(m=i?[T]:[[T]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;N<d+h&&(h=N-d)}for(j<v+l&&(l=j-v),A=I=void 0,E=p.Gbt,O=0;O<l;O++)for(c=v+O,i||_.push(I=[]),g&&(g[c]||(g[c]={}),x=g[c]),M=0;M<h;M++){if(a=d+M,E&&p.Ubt===c&&p.Hbt===a)C=p.zbt,E=!1;else{if(g?(A=x[a])?C=A.v:(C=p.mL(c,a,s.nT,$,{realValue:!0}),A=x[a]={v:C}):C=p.mL(c,a,s.nT,$,{realValue:!0}),o&&(F=void 0,"@"===(F=(S=p.getFormatter())instanceof X?S.formatString():S)?C=p.getText(c,a):C instanceof Date&&(C=D.uJ(C)),V(A)||(A=x[a]={v:C})),r&&U.Convert.BJ(C))return(m=[C]).isError=!0,m;if(A&&A[y]!==$)C=A[y];else if(C=U.Convert.Nbt(C,t,!U.ExcelCompatibleCalcMode,f,u),A&&(A[y]=C),e&&A===C)return(m=[L]).isConvertError=!0,m}U.Convert.Ybt(C,f)||(2===i?m[O*h+M]=C:(i?m:I).push(C))}}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w,b&&(n.Zbt&&b.arrayInfo.length<200||!isNaN(w)&&!isNaN(l)&&!isNaN(h)&&100<w*l*h&&w*l*h<1e6&&b.arrayInfo.length<50)&&(b[R]=m,b[R].rowCount=l,b[R].colCount=h,b[R].rangeCount=w,b.arrayInfo.push({reference:n,key:R}))}return m},C.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},C.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},C.prototype.isHiddenRow=function(n,t){var i=this.Mf,r;return!!(i.iA&&i.iA()||!t)&&0===i.getRowHeight(n)},C.prototype.getName=function(){var n,t,n=this.nT,t=B(this.Wbt)?this.Mf.name():this.Wbt;return n===H.SheetArea.colHeader?t+"CH":n===H.SheetArea.rowHeader?t+"RH":t},C.prototype.setArray=function(n,t,i,r,e){return this.t8.setArray(n,t,i,r,e)},C.prototype.updateItem=function(n,t,i){return this.t8.updateItem(this,n,t)},C.prototype.HE=function(n,t){this.t8.HE(n,t)},C.prototype.setValue=function(n,t,i,r,e,f){var o,u,s,c,a,l,h,h,l,v,d,d,w,m,w,d,m,C,c,c,C,_,p,o=this,u=o.Mf,s=o.nT,c=o.jbt;c&&(l=c[n])&&(h=l[t])&&(!B(i)&&B(i[j])?(h.v=i,a=!0,h.b!==$&&(h.b=$),h.d!==$&&(h.d=$),h.n!==$&&(h.n=$),h.s!==$&&(h.s=$),h.sn=$,h.an=$):delete l[t]),h=H.mt.Z0(i),l=u.Ut,v=!1,d=(d=u.tables)&&d.find(n,t),3===s&&d&&(w=d.showHeader()&&n===d.headerIndex(),m=d.showFooter()&&n===d.footerIndex(),w||m||(v=d.Kbt(n,t,h))),w=u.H3,3===s&&!v&&w&&w._dataSource&&(m=!1,(d=w.getValue(n,t)).hasBinding&&(C=void 0,C=c?(C=(c=c.bindingRows=c.bindingRows||{})[n])||(c[n]=x({},u.getDataItem(n))):x({},u.getDataItem(n)),l.dE(n,t,{gE:C,d6:d.value}),m=w.setValue(n,t,h,l.G8)),v="dataManagerBindingSource"===w.K$?m:d.hasBinding),c=u.pivotTables,3===s&&!v&&c&&(v=c.eJt(n,t,h)),o.Qpe&&!f&&a?o.Qpe[p=s+" "+n+" "+t]=[n,t,s,h]:(v||(!B(h)&&h[j]&&(C=h[j],l.setHyperlink&&l.do("setHyperlink",n,t,_={url:C}),h=h.toString()),l.do("setValue",n,t,h,s,!0,!0,e,!0,!0)),u.iL=!0,this.K5?this.K5.push({row:n,col:t,sheetArea:s}):u.ki(H.Events.CellChanged,{sheet:u,sheetName:u.name(),row:n,col:t,sheetArea:s,propertyName:"value",oldValue:r,newValue:i,KO:!0}))},C.prototype.startIterativeCalc=function(){this.Qpe={}},C.prototype.endIterativeCalc=function(){var n,t,i,r,e,f,o,u,e,s,c,n=this,t=n.Mf,i=t.Ut;for(r in n.Qpe)Object.prototype.hasOwnProperty.call(n.Qpe,r)&&(f=(e=n.Qpe[r])[3],o=e[0],u=e[1],e=e[2],!B(f)&&f[j]&&(s=f[j],i.setHyperlink&&i.do("setHyperlink",o,u,c={url:s}),f=f.toString()),i.do("setValue",o,u,f,e,!0,!0,!1,!0,!0),t.iL=!0,this.K5?this.K5.push({row:o,col:u,sheetArea:e}):t.ki(H.Events.CellChanged,{sheet:t,sheetName:t.name(),row:o,col:u,sheetArea:e,propertyName:"value",KO:!0}));delete n.Qpe},C.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):T},C.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():T},C.prototype.getCustomNameInfo=function(n){return n=E(n),this.Mf?this.Mf.getCustomName(n):T},C.prototype.getSheet=function(){return this.Mf},C.prototype.setFormula=function(n,t,i,r,e){var f,o,u,s,c,o,c,f=this;f.Mf.Ut.G8&&(s=f.Mf.Ut.G8.formulas,u=f.getCalcSourceModel(),s=s||(f.Mf.Ut.G8.formulas={}),-1<=n)&&-1<=t&&((c=f.getCalcService()).backupR1C1Formula&&(o=f.Mbt.pB(n,t),i=en(f.Mf,o,n,t,!0,!1)),!r&&c.allowDynamicArray&&(r=f.Mbt.sT(n,t)),o=(o=s[n])||(s[n]={}),i&&"="===i[0]&&(i=i.substring(1)),c=o[t]&&o[t].formula,e?o[t]&&void 0!==o[t].oldFormula||(r=x({},r),o[t]=x({},o[t],{oldFormula:i,oldArrayInfo:r}),i)||delete o[t].oldArrayInfo:(o[t]=x({},o[t],{formula:i,arrayInfo:r}),i||delete o[t].arrayInfo,u.usedRange&&M(u.usedRange,n,t,c,i)))},C.prototype.isFormulaHidden=function(n,t){var i,r,i,e,f,i=this,r;return!!(i.getCalcSourceModel().getFormula(n,t)&&(i=i.Mf)&&(e=i.isActualProtected())&&(f=i.l0(n,t,"hidden")))},C.prototype.setArrayFormula=function(n,t,i,r,e){var f;this.setFormula(n,t,e,{row:n,col:t,rowCount:i,colCount:r})},C.prototype.setFormulaByName=function(n,t,i){var r,e,r,r=this;r.Mf.Ut.G8&&((r=(r=(e=(e=r.Mf.Ut.G8.formulas)||(r.Mf.Ut.G8.formulas={})).names)||(e.names={}))[n]=x({},r[n],{formula:t,oldFormula:i}))},C.prototype.refresh=function(){var n=this.Mf.parent;n&&n.repaint()},C.prototype.toJSON=function(n,t,i,r,e){var f,o,u,s,c,a,t,l,h,v,d,w,m,C,_,p,g,b,a,x,R,y,j,N,k,I,A,E,E,O,o=t,t=this.Mf,l=n.data||{},h=!0,v=this.op(),d=this===t.qgt,C=0;for(d&&(w=(0,U.createMap)(),t.Xbt=m={}),_=v.forceR1C1Formula&&!t.isReportTemplateSheet,p=0;p<=i;p++)if(f=l.dataTable||{},u=o[p]){for(h=!(c=f[p]),c=c||{},g=0;g<=r;g++)if(b=(s=u[g])&&s.WK,a=s&&s.calc&&s.calc.isDefault(),s&&!a&&(b||s.qbt)){a=c[g]||{};try{R=x=void 0,d&&b&&!s.$bt&&(y=b.tyt=b.tyt||v.unparse(this,b,p,g,$,2)).indexOf("!")<0&&(!(j=w.get(y))||j.baseColumn>g?_?(R=y,w.set(y,{formula:R,baseRow:p,baseColumn:g})):(R=v.unparse(this,s.WK,p,g,!1,!0)).indexOf("[")<0&&w.set(y,{formula:R,baseRow:p,baseColumn:g}):(x=j.obj)?((k=m[x.si]).lastRow=p,k.lastColumn=Math.max(g,k.lastColumn)):(x=j.obj={si:C},m[C]={formula:j.formula,baseRow:j.baseRow,baseColumn:j.baseColumn,lastRow:p,lastColumn:g},(N=p===j.baseRow?c:f[j.baseRow])[j.baseColumn].formula=j.obj,C++)),R=s.qbt||x||R||v.unparse(this,b,p,g,!1,_?2:1),s.$bt?s.$bt.row===p&&s.$bt.col===g&&(a.arrayInfo=s.$bt,a.formula=R):a.formula=R,h=!1,c[g]=a}catch(n){}}if(h){if(f!==l.dataTable)continue}else f[p]=c;l.dataTable=f}if(m&&(m.nextIndex=C),e){for(I=l.columnDataArray||[],A=0;A<e.length;A++)(E=e[A])&&E.WK&&(E=this.op().unparse(this,E.WK,0,A,!1,!0),(O=I[A]||{}).formula=E,I[A]=O);0<I.length&&(l.columnDataArray=I)}V(l)||(n.data=l)},C.prototype.iFe=function(){return this.rFe=this.rFe||new F(this),this.rFe.nFe||this.rFe.YEi(),this.rFe},C.prototype.oFe=function(){this.rFe&&(this.rFe.nFe=!1)},C.prototype.wh=function(n,V,T,Y,L,t){var r,i,e,f,o,u,s,c,X,a,l,h,v,d,J,w,m,C,_,p,g,G,P,b,x,R,y,j,N,k,I,A,E,O,M,S,F,D,r=z(n,H.XFileConstants.bo),i=this.op();for(i.nyt=!0,s=H.Util.ko(t),h=0,(X=this===(c=this.Mf).qgt)&&(a=(0,U.createMap)(),c.Xbt=l={}),v=n.lossless.exprs=[],d=s&&(null==t?void 0:t.saveR1C1Formula)&&!c.isReportTemplateSheet,J=!s&&!1===(null==t?void 0:t.exportSharedFormula),w=[],n.richValueDataArray=[],m=0;m<=T;m++)if(e=V[m],o=r[m],e)for(o=o||(r[m]={}),C=0;C<=Y;C++)if(f=e[C],u=o[C],_=f&&f.WK,g=!(p=[]),G=f&&f.calc&&f.calc.isDefault(),f&&!G&&_){u=u||{},s||7!==_.type||"IMAGE"!==_.functionName||(g=!0,3<(P=_.arguments).length&&(p=_.arguments.splice(5)));try{R=x=b=void 0,y=-1,(j=f.$bt)||(N=this.t8.Pme(m,C))&&(j={row:m,rowCount:N.maxX-m+1,col:C,colCount:N.maxY-C+1,isDynamicArray:!0},N.isValid||(j.isInvalid=!0)),X&&!j&&!J&&(k=_.tyt=_.tyt||i.unparse(this,_,m,C,$,2),s||k.indexOf("!")<0)&&(!(I=a.get(k))||I.baseColumn>C?d?(x=k,a.set(k,{formula:x,baseRow:m,baseColumn:C})):(x=i.unparse(this,_,m,C,$,1)).indexOf("[")<0&&a.set(k,{formula:x,baseRow:m,baseColumn:C}):((b=I.obj)?((A=l[b.si]).lastRow=m,A.lastColumn=Math.max(C,A.lastColumn)):(b=I.obj={si:h},l[h]={formula:I.formula,baseRow:I.baseRow,baseColumn:I.baseColumn,lastRow:m,lastColumn:C},h++),R=b.si,x=void 0)),B(R)&&(x=f.qbt||x||i.unparse(this,_,m,C,!1,d?2:1),t&&t.includeCalcModelCache&&(E=(0,q.exprToJSON)(_),f.eyt||(E.nw=1),v.push(E),y=v.length-1),x=K(Q(x))),j?(j.row===m&&j.col===C&&(O=W(j),(j.isInvalid||!j.rowCount)&&0<O.indexOf(":")&&(O=O.substring(0,O.indexOf(":"))),u.f=x,u.r=O),j.isDynamicArray&&(u.a="1",j.isInvalid||t.fileType!==H.OpenSaveFileType.excel||w.push(j))):(u.f=x,u.g=R,u.c=1,g&&(M=u.v&&u.v.value.imageBase64Data,B(M)||(S={url:_.arguments[0]&&_.arguments[0].value,ref:H.IndexHelper.nr(C)+(m+1),f:x,structureMap:{}},_.arguments[1]&&!B(_.arguments[1].value)&&(S.structureMap.a=_.arguments[1].value),_.arguments[2]&&!B(_.arguments[2].value)&&(S.structureMap.s=_.arguments[2].value),_.arguments[3]&&!B(_.arguments[3].value)&&(S.structureMap.h=_.arguments[3].value),_.arguments[4]&&!B(_.arguments[4].value)&&(S.structureMap.w=_.arguments[4].value),S.imageBase64Data=M,n.richValueDataArray.push(S)),u.v="#VALUE!",u.t="e")),-1!==y&&(u.x=y)}catch(n){}g&&0<p.length&&(_.arguments=_.arguments.concat(p)),o[C]=u}for(F in l)Object.prototype.hasOwnProperty.call(l,F)&&(D=l[F],O=W(new H.Range(D.baseRow,D.baseColumn,D.lastRow-D.baseRow+1,D.lastColumn-D.baseColumn+1)),(u=r[D.baseRow][D.baseColumn]).r=O,u.g=parseInt(F,10));w.forEach(function(n){for(var t,i,t=n.row;t<n.row+n.rowCount;t++)for(i=n.col;i<n.col+n.colCount;i++)(u=r[t]&&r[t][i])&&(u.t2=!0)}),delete i.nyt},(n.SheetSource=J=C).prototype.getParserContext=function(n,t,i){return t=t||(0,U.eV)(0,0),new a(this.Mf,n,t,i)},nn=U.CalcSource,i(_,nn),_.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},_.prototype.getUsedCustomNames=function(){return this.Cbt||{}},_.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):T},_.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():T},_.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):T},n.SpreadSource=_,n.formulaToExpression=rn,n.expressionToFormula=en,n.evaluateFormula=fn,n.evaluateExpression=on,n.xbt=un,n.rangeToExpression=p,n.isValidExternalReference=sn,n.rangeToFormula=ln,n.rangeToFormulaWithStructReference=hn,n.isStructureReference=vn,n.formulaToRange=dn,n.formulaToRanges=wn,n.rangesToFormula=mn,n.Ibt=Cn,n.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},n.goalSeek=_n},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=t.BAND_INDEX_CONST=void 0;var i=i("Core");t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=i.XmlConstants.Io,t.MAX_COLUMN_COUNT=i.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(n,t,i){var w,r,h,v,e,m,C,f;function c(n){return n.isValid}function o(n){return{row:n.minX,col:n.minY,rowCount:n.maxX-n.minX+1,colCount:n.maxY-n.minY+1,isValid:n.isValid}}function u(n){this.Gme=new r.Common.rbush,this.rT=n}Object.defineProperty(t,"__esModule",{value:!0}),t.Z8=void 0,w=i("Core"),r=i("Common"),h=i("CalcEngine"),v=i("CalcEngine"),e=null,m=void 0,C=r.Common.lt.ht,u.prototype.Ume=function(){return this.rT.Mf.Ut},u.prototype.L0=function(){this.rT=e,this.Gme=e},u.prototype.Fme=function(){var n=this.Gme.data;if(n&&isFinite(n.minX))return{minRow:n.minX,minCol:n.minY,maxRow:n.maxX,maxCol:n.maxY}},u.prototype.jme=function(n,t,i,r){return this.Gme.search({minX:n,minY:t,maxX:n+(i=void 0===i?1:i)-1,maxY:t+(r=void 0===r?1:r)-1})},u.prototype.Pme=function(t,i){return this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0]},u.prototype.Hme=function(n,t){return this.jme(n,t).filter(c)[0]},u.prototype.zme=function(){var n,n,n=this.Ume();return n.G8?(n.G8.calc=n.G8.calc||[],(n=n.G8.calc).Vme=n.Vme||[],n.Vme):[]},u.prototype.Fgt=function(t,i,r,e){var f,o,u,n,s,f=this;void 0===r&&(r=1),void 0===e&&(e=1),o=this.jme(t,i,r,e),u=this,n=o.filter(function(n){return n.minX>=t&&n.minX<t+r&&n.minY>=i&&n.minY<i+e}),s=this.b3(),n.forEach(function(n){n.isValid&&s.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1),u.Rme(n),u.Lme(n,!0)}),o.filter(c).forEach(function(n){u.Rme(n),o=o.concat(f.jme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1))}),o.forEach(function(n){n.isValid||(u.Yme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)?s.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1):s.gF(n.minX,n.minY,1,1))})},u.prototype.getAnchorCell=function(t,i){var n=this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0];return n&&o(n)},u.prototype.getAnchorInfo=function(t,i,n){var r,r,r=this.jme(t,i),r=r.filter(function(n){return n.minX===t&&n.minY===i})[0]||r.filter(c)[0];return r&&o(r)},u.prototype.setValue=function(n,t,i,r){r?this.Ume().setValue(n,t,i,3,!0,!0,!1,!1,!0):this.pBt().setValue(n,t,i)},u.prototype.b3=function(){return this.rT.Mbt},u.prototype.pBt=function(){return this.rT},u.prototype.Rme=function(n,t,i,r){var e,f;if(n){if(n.isValid){for(e=n.minX;e<=n.maxX;e++)for(f=n.minY+(e===n.minX?1:0);f<=n.maxY;f++)this.setValue(e,f,m,i);n.isValid=!1,i&&this.zme().push([n,"isValid",!0]),t||this.setValue(n.minX,n.minY,v.Errors.Spill,i)}t&&(this.Lme(n,i),r||this.setValue(n.minX,n.minY,m,i))}},u.prototype.Lme=function(n,t){this.Gme.remove(n),t&&this.zme().push([n])},u.prototype.Bme=function(n,t){this.Gme.insert(n),t&&this.zme().push([m,n])},u.prototype.HE=function(n,t){this.Pme(n,t).isValid=!1},u.prototype.Yme=function(n,t,i,r,e){for(var f,o,u,s,c,a,l,a,h,v,d,f=this.Gme.search({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1}),o=this.pBt(),u=this.b3(),s=0;s<f.length;s++)if((c=f[s]).isValid&&(c.minX!==n||c.minY!==t))return!1;if(t+r>o.getColumnCount()||n+i>o.getRowCount())return!1;if(a=(0,w.Ec)(n,t,i,r),(l=o.Mf).Ut.getSpans(a).length)return!1;if((a=l.tables)&&a.Pl&&a.Pl(n,t,i,r))return!1;for(h=n;h<n+i;h++)for(v=t+(h!==n||e?0:1);v<t+r;v++)if(d=o.getValue(h,v,m,!0),!C(d)||u.hasFormula(h,v,!0))return!1;return!0},u.prototype.Zme=function(n,t,i,r,e){var f;this.Gme.insert({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:e})},u.prototype.setArray=function(n,t,i,r,e,f,o){var u,s,c,a,l,u=this,s=this.Pme(n,t);if(s&&s.maxX===n+i-1&&s.maxY===t+r-1&&s.isValid||(u.Rme(s,!0,o),s={minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:!0},f||(s.isValid=u.Yme(n,t,i,r)),u.Bme(s,o)),s.isValid)for(c=n;c<n+i;c++)for(a=t;a<t+r;a++)e&&e[c-n]&&(l=e[c-n][a-t],C(l)?l=0:(h.Convert.Nh(l)||h.Convert.LE(l))&&(l=1===l.getRowCount()&&1===l.getColumnCount()?h.Convert.Nh(l)?l.getValue(0,0):l.getValue(0,0,0):v.Errors.Calc),this.setValue(c,a,l,o));else this.setValue(n,t,v.Errors.Spill,o);return s.isValid},u.prototype.updateItem=function(n,t,i){var t=this.Pme(t,i);if(t)return this.Rme(t,!0),!0},u.prototype.rE=function(r,e){var f=this,n;f.jme(r,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){var t,i;if(n.minX>=r)f.Gme.remove(n),n.minX+=e,n.maxX+=e,f.Gme.insert(n);else if(n.maxX>=r)if(n.isValid){for(t=r;t<=n.maxX;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t+e,i));for(t=n.maxX+1;t<=n.maxX+e;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,m)}else f.b3().Gde(n.minX,n.minY)})},u.prototype.aE=function(f,o,u){var s=this,n;s.jme(f,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){var t,i,r,e;if(n.minX>=f+o)s.Gme.remove(n),n.minX-=o,n.maxX-=o,s.Gme.insert(n);else if(n.minX>=f)s.Rme(n,!0,u);else if(n.maxX>=f&&n.isValid)if(t=n.maxX>f+o-1?n.maxX+1:f+o,i=n.maxX>f+o-1?o:n.maxX-f+1,s.Yme(t,n.minY,i,n.maxY-n.minY+1,!0))for(r=n.maxX;f<=r;r--)for(e=n.minY;e<=n.maxY;e++)s.setValue(r+o,e,s.pBt().getValue(r,e),u);else s.Rme(n,!1,u)})},u.prototype.Eme=function(t,i){var r=this,n;r.jme(t,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){n.minX>=t&&(r.Gme.remove(n),n.minX+=i,n.maxX+=i,r.Gme.insert(n))})},u.prototype.oE=function(r,e){var f=this,n;this.jme(-1,r,-1,h.MAX_COLUMN_COUNT).forEach(function(n){var t,i;if(n.minY>=r)f.Gme.remove(n),n.minY+=e,n.maxY+=e,f.Gme.insert(n);else if(n.maxY>=r)if(n.isValid){for(t=n.minX;t<=n.maxX;t++)for(i=r;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t,i+e));for(t=n.minX;t<=n.maxX;t++)for(i=n.maxY+1;i<=n.maxY+e;i++)f.pBt().setValue(t,i,m)}else f.b3().Gde(n.minX,n.minY)})},u.prototype.uE=function(f,o,u){var s=this,n;this.jme(-1,f,-1,h.MAX_COLUMN_COUNT).forEach(function(n){var t,i,r,e;if(n.minY>=f+o)s.Gme.remove(n),n.minY-=o,n.maxY-=o,s.Gme.insert(n);else if(n.minY>=f)s.Rme(n,!0,u);else if(n.maxY>=f&&n.isValid)if(t=n.maxY>f+o-1?n.maxY+1:f+o,i=n.maxY>f+o-1?o:n.maxY-f+1,s.Yme(n.minX,t,n.maxX-n.minX+1,i,!0))for(r=n.minX;r<=n.maxX;r++)for(e=n.maxY;f<=e;e--)s.setValue(r,e+o,s.pBt().getValue(r,e),u);else s.Rme(n,!1,u)})},u.prototype.Ome=function(t,i){var r=this,n;this.jme(-1,t,-1,h.MAX_COLUMN_COUNT).forEach(function(n){n.minY>=t&&(r.Gme.remove(n),n.minY+=i,n.maxY+=i,r.Gme.insert(n))})},u.prototype.Wme=function(n){for(var t,i,r,e,r,t=this,i=n.length-1;0<=i;i--)e=(r=n[i])[0],2<r.length?e[r[1]]=r[2]:1<r.length?t.Gme.remove(r[1]):(r=t.Pme(e.minX,e.minY),t.Rme(r,!0),t.Gme.insert(e))},t.Z8=u},"./dist/plugins/sheetsCalc/external-reference.js":function(n,t,i){var r,j,l,M,o,i,N,k,S,F,I,h,A,E,f,e,u,s;function v(n,t){var i,r;if(Array.isArray(n))n.forEach(t);else if("object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t(r=n[i],i)}function d(n){return n}function c(n){return"string"==typeof n&&"/OADate("===n.substr(0,8)?parseFloat(n.substr(8,n.length-10)):n}function w(n){var n,t,n=n.value;return n&&n.richText?(t="",n.richText.forEach(function(n){t+=n.text}),t):c(n)}function a(n,t,i){var r,n,e,i,r=s.call(this,F)||this;return r.getSheetRangeReference=function(n){var t,i,r,e,f,t=this.rT.sheetNames;if(n.endSource&&t&&n.source instanceof a){for(i=!1,r=[],e=0;e<t.length&&((i=t[e]===n.source.oyt?!0:i)&&(f=new a("["+this.rT.i+"]"+t[e],this.ayt,!0),r.push(f.getReference(n))),t[e]!==n.endSource.oyt);e++);return new o.SheetRangeReference(r)}return M.Errors.Name},n=n.split("]"),i&&(e=n[0].substring(1)),t.iyt[e]?r.rT=t.iyt[e]:(i=n[0].indexOf("["),r.rT=t.ryt(n[0].substring(i+1),n[0].substring(0,i),!0)),r.oyt=n[1],r.ayt=t,r}function m(n,t){var i,r,e;if(n)for(i in n)I(n,i)&&(e=(r=n[i]).getExpression())&&e.forEachNodes(function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof f&&(t[n.source.rT.i]=!0)})}function C(n,t){var t=n.getRange(t.row,t.column);return t.sheetName=n.source.oyt,t}function _(n){this.iyt=n||{},this.uyt={},this.syt()}r=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalReferenceManager=t.ExternalSource=void 0,j=i("Core"),l=i("Common"),M=i("CalcEngine"),o=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=l.Common.lt,N=j.XFileConstants.Rr,k=j.XFileConstants.Lr,S=void 0,F=null,I=l.Common.kh,h=i.ht,A=j.Util.wr,E=j.Util.Mr,s=M.CalcSource,r(a,s),a.prototype.cyt=function(n,t,i){var r,e,r=n.getKey();this.rT=this.ayt.fyt(this.rT),this.eme(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},t?e[r]?e[r][1].push(i):e[r]=[n,[i]]:e[r]&&delete e[r]},a.prototype.eme=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),n=this.rT.data[this.oyt]={isNew:!0}),n},a.prototype.getValue=function(n,t){var i,n,i,i=this.eme(),n=i[n];return!n||h(n[t])?!i.isNew||n&&n.hasOwnProperty(t)?0:M.Errors.Reference:(i=n[t])&&i._code&&(i._error||i._calcError)?new M.CalcError(i._error||i._calcError):i},a.prototype.getRowCount=function(){return M.MAX_ROW_COUNT},a.prototype.getColumnCount=function(){return M.MAX_COLUMN_COUNT},a.prototype.createSourceModel=function(){return F},a.prototype.getCalcSourceModel=function(){return F},a.prototype.setCalcSourceModel=function(){},a.prototype.getPeerSource=function(n){return new a("["+this.rT.i+"]"+n,this.ayt,!0)},a.prototype.getSources=function(n){var t,i,r,e,f,t=this.rT.sheetNames,i=[];if(n&&t&&n.oyt)for(r=!1,e=0;e<t.length&&((r=t[e]===this.oyt?!0:r)&&(f=new a("["+this.rT.i+"]"+t[e],this.ayt,!0),i.push(f)),t[e]!==n.oyt);e++);return i},a.prototype.referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,A,E,O,s=this,l=1,h=1,m=[],p=s.rT.Rbt,g=s.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i;if(p){if(p.has(g))return p.get(g)}else p=s.rT.Rbt=(0,M.createMap)();if(0===(w=n.getRangeCount()))m.isError=!0;else{for(R in b=-1,x=s.eme())x.hasOwnProperty(R)&&(y=Number(R),!isNaN(y))&&b<y&&(b=y);if(-1===b)(m=[M.Errors.Reference]).isError=!0;else{for(j=b+1,N=s.getColumnCount(),i=i===S||i,k=0;k<w;k++){if(i||m.push(_=[]),v=n.getRow(k),d=n.getColumn(k),0===(l=n.getRowCount(k)))return m.isError=!0,m;if(-1===l&&(v=0,l=j),0===(h=n.getColumnCount(k)))return m.isError=!0,m;if(-1===h&&(d=0,h=N),j<=v||N<=d)return(m=i?[F]:[[F]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;for(j<v+l&&(l=j-v),N<d+h&&(h=N-d),I=void 0,A=!1,E=0;E<l;E++)for(c=v+E,i||_.push(I=[]),O=0;O<h;O++)C=s.getValue(c,a=d+O),A||(C=M.Convert.Nbt(C,t,!M.ExcelCompatibleCalcMode,f,u),r&&M.Convert.BJ(C)&&(A=(m=[C]).isError=!0),M.Convert.Ybt(C,f))||(i?m:I).push(C);if(A)return m}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w,p&&p.set(g,m)}}return m},a.prototype.getName=function(n){var n,n=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return n+this.oyt},a.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName(n)+"."+r+"."+e+"."+f+"."+t},a.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new M.CalcReference(t,[n])},f=a,t.ExternalSource=f,_.prototype.parseSource=function(n,t){return new f(n,this,t)},_.prototype.ryt=function(n,t,i,r){var e,f;for(e in this.iyt)if(I(this.iyt,e)&&(f=this.iyt[e])&&f.option.name===n&&f.option.path===t)return f;if(!i)for(e in this.iyt)if(I(this.iyt,e)&&(f=this.iyt[e]).option.name===n&&""===t)return f;return r?S:{option:{name:n,path:t},sheetNames:[],data:{}}},_.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},_.prototype.fyt=function(n){var t,t,t=this.ryt(n.option.name,n.option.path,!0,!0);return t||(t=Object.keys(this.iyt).length+1,(this.iyt[t]=n).i=t,n)},_.prototype.Ep=function(n){var t,i,r,e,f,o,i={},r={},e=1;for(f in this.iyt)I(this.iyt,f)&&(this.uyt[f]&&!j.GC$.isEmptyObject(this.uyt[f])||(t||(t={},m(n.hyt,t),n.sheets.forEach(function(n){m(n.hyt,t)})),t[f]))&&(i[(o=this.iyt[f]).i=e]=o,r[e]=this.uyt[f],e++);this.iyt=i,this.uyt=r},_.prototype.toJSON=function(){var n,t,i,n={};for(t in this.iyt)I(this.iyt,t)&&(i=this.iyt[t],n[t]={option:{name:i.option.name,path:i.option.path},sheetNames:i.sheetNames,data:i.data});return n},_.prototype.wh=function(n){var g,b,t,x,R,y,i,r,g=this.iyt,b=[],t={n_:"externalReferences",c_:b},x={},R=n.workbook.rels,y=0,i=function(n){var t,i,r,n,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p;if(I(g,n)){for(y++,i=(t=g[n]).option.id=N+A(R),R.c_.push({n_:k,Id:i,Type:j.RelationshipConstants.uc,Target:E(j.XFileConstants.nu+"/"+j.XFileConstants.tu+n)}),b.push({n_:"externalReference","r:id":i}),n={n_:"sheetNames",c_:r=[]},e={n_:"sheetDataSet",c_:[]},(f=t.sheetNames)&&f.forEach(function(n){r.push({n_:"sheetName",val:j.mt.Nfe(n)})}),o=t.data,u=0,s=f.length;u<s;u++)if(c=o&&o[f[u]]){for(h in a={n_:j.XFileConstants.bo,sheetId:u},c.isNew&&(a.refreshError=1),l=[],c)if(c.hasOwnProperty(h)&&(v=parseInt(h,10)+1,!isNaN(v))){for(C in m={n_:"row",r:v,c_:w=[]},d=c[h])d.hasOwnProperty(C)&&(_=d[C],(p={n_:"cell"}).r=j.IndexHelper.nr(parseInt(C,10))+v,"string"==typeof _?p.t="str":"boolean"==typeof _?(p.t="b",_=_?"1":"0"):_&&_.code&&(p.t="e","#SPILL!"!==(_=_._calcError||_.error)&&"#CALC!"!==_||(_="#VALUE!")),p.c_=[{n_:"v",c_:[_]}],w.push(p));l.push(m)}a.c_=l,e.c_.push(a)}x[i]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[n,0<e.c_.length?e:F]}],option:t.option}}};for(r in g)i(r);return{externalReferencesNode:t,externalLinks:x,count:y}},_.prototype.dyt=function(n,i,t,e){var r,f,o,r,n,u,s,c,a,r=i&&i.sheets&&Object.keys(i.sheets),f=r&&i.sheets[r[0]].data&&i.sheets[r[0]].data.dataTable,o=f?w:d,r=this.ryt(n,t||"",S,!0);if(!h(r)){for(a in n=r.i,delete(u=this.iyt[n]).Rbt,s=this.uyt[n]||{},u.ime=new l.Common.rbush,c=function(n){var t;I(s,n)&&((t=s[n][0]).vyt(),s[n][1].forEach(function(n){var n=n.getRange(t.row,t.column);u.ime.insert({minX:n.row,minY:n.col,maxX:n.row+n.rowCount-1,maxY:n.col+n.colCount-1})}))},s)c(a);u.sheetNames.forEach(function(n){var t,r,t=f?i.sheets[n]&&i.sheets[n].data.dataTable:i&&i[n];t&&(u.data[n]&&e?e&&delete u.data[n].isNew:u.data[n]={},r=u.data[n],v(t,function(n,i){u.ime.collides({minX:i,minY:-1,maxX:i,maxY:-1})&&(r[i]=r[i]||{},v(n,function(n,t){u.ime.collides({minX:i,minY:t,maxX:i,maxY:t})&&(r[i][t]=o(n))}))}))})}},_.prototype._6=function(t,n,i,r){var e,f,e=this;"string"==typeof t?e.dyt(t,n,i,r):t&&(f=e.myt(!0)).forEach(function(n){t[n.filePath+n.name]&&e.dyt(n.name,t[n.filePath+n.name],n.filePath,r)})},_.prototype.myt=function(n){var t,i,r,e,f,o,u,t=[];for(i in this.iyt)if(I(this.iyt,i)){if(r=this.iyt[i],e={name:r.option.name,filePath:r.option.path},n)for(u in f=this.uyt[i]||{},e.items=[],o=function(n){var t,i,n,n;I(f,n)&&(i={row:(t=f[n][0]).row,col:t.column,sheetName:t.w3.rT.getName()},n=1===(n=f[n][1]).length?C(n[0],t):n.map(function(n){return C(n,t)}),e.items.push({target:i,source:n}))},f)o(u);t.push(e)}return t},t.ExternalReferenceManager=_},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(f,n,t){var fn,u,ln,j,R,on,L,t,I,un,w,sn,cn,C,g,A,E,M,T,c,i,o,m,t;function a(n,t){var i,r,e,n,i=w(n.row,(t=t||this).row),r=w(n.column,t.column),e=un(n.row+n.rowCount,t.row+t.rowCount),n=un(n.column+n.columnCount,t.column+t.columnCount);return e<=i||n<=r?cn:{row:i,column:r,rowCount:e-i,columnCount:n-r,intersectWith:a}}function H(n,i,r){var e=[];return n.forEachNodes&&n.forEachNodes(function(n){var t;1===n.type&&((n.endSource?null:n.source||r)===i?e.push(n):i===r&&((n.rowRelative||n.endRowRelative)&&(e.rc=!0),n.columnRelative||n.endColumnRelative)&&(e.cc=!0))}),e}function U(n,t,i,r){var e,f,o,u,s,c,e=(0,fn.createSet)(),f=(0,fn.createSet)(),o=H(n,t,i);if(r)for(u=o.rc,s=0;s<o.length;s++)(c=o[s]).isFullColumn||((c.rowRelative?e:f).add(c.row),c.endRowRelative?e.add(c.endRow):!1===c.endRowRelative&&f.add(c.endRow));else for(u=o.cc,s=0;s<o.length;s++)(c=o[s]).isFullRow||((c.columnRelative?e:f).add(c.column),c.endColumnRelative?e.add(c.endColumn):!1===c.endColumnRelative&&f.add(c.endColumn));return[Array.from(e),Array.from(f),u]}function v(n,t,i,r,e,f){return n?f?i<=e+t&&e+t<i+r?"2":e+t<i&&i<=e||e<i&&i<=e+t?"1":"0":i+r<=e+t?"1":i<=e+t?"2":"0":i+r<=t?"1":i<=t?"2":"0"}function $(n,t,i,r,e,f,o){var u,s,c,a,l,h,u=[],s=!1;if(f&&(o?n.rc:n.cc)&&(u.push("9"),s=!0),o){for(c=0;c<n.length;c++)if(!(a=n[c]).isFullColumn&&("0"!==(l=v(a.rowRelative,a.row,t,i,r,e))&&(s=!0),u.push(l),!L(a.endRow))){if(h=v(a.endRowRelative,a.endRow,t,i,r,e),"2"===l&&"2"!==h&&a.endRowRelative||"2"!==l&&"2"===h&&a.rowRelative)return-1;"0"!==h&&(s=!0),u.push(h)}}else for(c=0;c<n.length;c++)if(!(a=n[c]).isFullRow&&("0"!==(l=v(a.columnRelative,a.column,t,i,r,e))&&(s=!0),u.push(l),!L(a.endColumn))){if(h=v(a.endColumnRelative,a.endColumn,t,i,r,e),"2"===l&&"2"!==h&&a.endColumnRelative||"2"!==l&&"2"===h&&a.columnRelative)return-1;"0"!==h&&(s=!0),u.push(h)}return s?u.join(","):0}function B(n,t,i,r,e){var f,o,u,s,f=[],o=!1;for(n[2]&&e&&(f.push("9"),o=!0),u=0;u<n[0].length;u++)s=n[0][u],r&&(i+s<t&&t<=i||i<t&&t<=i+s)||!r&&t<=i+s?(f.push("1"),o=!0):f.push("0");for(u=0;u<n[1].length;u++)t<=(s=n[1][u])?(f.push("1"),o=!0):f.push("0");return o?f.join(","):0}function r(n,t,i,r,e,f,o,u){var s=this;s.gyt=n,s.pyt=t,s.byt=i,s.yyt=r,s.wyt=e,s.Myt=f,s.Sx=o,s.Cyt=u}function X(n,t,i,r){return(!r||n<t)&&i}function W(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function J(n,t,i,r,e){var t=t.rT.id+" "+i+" "+r;n.set(t,e)}function G(n,t,i,r){var t;if(0!==n.size)return t=t.rT.id+" "+i+" "+r,n.has(t)}function s(n,t){var t=new fn.Expression(t);return t.value=n,t}function e(n,t){if(n){for(;10===n.type||12===n.type;)n=n.value;if(1===n.type||13===n.type)t(n);else if(9===n.type)e(n.value,t),n.value2&&e(n.value2,t);else if(7===n.type)for(var i=0;i<n.arguments.length;i++)e(n.arguments[i],t)}}function hn(n,t,i,r,e){var f,o,f,o,n,f=!n&&L(t),o=!i&&L(r);if(f&&!o&&(t=0),o&&!f&&(r=0),!f||!o)return t instanceof Date&&(t=u.Common.ct.o0(t)),r instanceof Date&&(r=u.Common.ct.o0(r)),f=n&&!e.useValue?s(n,fn.ExpressionType.parentheses):s(t,fn.ExpressionType.number),o=i?s(i,fn.ExpressionType.parentheses):s(r,fn.ExpressionType.number),(n=new fn.Expression(fn.ExpressionType.operator)).operatorType=c(e.option),n.value=o,n.value2=f,n}function vn(n){e(n,function(n){var t,t,t,t,t;1===n.type&&(n.rowRelative&&n.columnRelative||n.endRowRelative&&n.endColumnRelative)&&(t=[n.row,n.column],n.column=t[0],n.row=t[1],t=[n.endColumn,n.endRow],n.endRow=t[0],n.endColumn=t[1],t=[n.columnRelative,n.rowRelative],n.rowRelative=t[0],n.columnRelative=t[1],t=[n.endColumnRelative,n.endRowRelative],n.endRowRelative=t[0],n.endColumnRelative=t[1],t=[n.isFullColumn,n.isFullRow],n.isFullRow=t[0],n.isFullColumn=t[1])})}function an(){}function q(n,t,i,r,e,f){var o,u,s,c,o={};if(n)if(t)for(s in i.QDt)i.QDt[s]&&((u=i.QDt[s]).id===r.id&&(u.row>=e?u.row+=f:u.row+u.rowCount>e&&(u.rowCount+=f)),o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u);else for(s in i.QDt)i.QDt[s]&&((u=i.QDt[s]).id===r.id&&(u.col>=e?u.col+=f:u.col+u.colCount>e&&(u.colCount+=f)),o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u);else if(t){for(s in i.QDt)if(i.QDt[s]){if((u=i.QDt[s]).id===r.id)if(u.row>=e+f)u.row-=f;else if(u.row>=e){if(!(u.row+u.rowCount>e+f))continue;u.row=e,u.rowCount=u.row+u.rowCount-f-e}else u.row+u.rowCount>e+f?u.rowCount-=f:u.row+u.rowCount>e&&(u.rowCount=e-u.row);o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u}}else for(s in i.QDt)if(i.QDt[s]){if((u=i.QDt[s]).id===r.id)if(u.col>=e+f)u.col-=f;else if(u.col>=e){if(!(u.col+u.colCount>e+f))continue;u.col=e,u.colCount=u.col+u.colCount-f-e}else u.col+u.colCount>e+f?u.colCount-=f:u.col+u.colCount>e&&(u.colCount=e-u.col);o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u}i.QDt=o}function O(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,n;return 0<=i||!e?(h=r+(e?i:0),v=f+(o?i:0),d=a&&_(u,n,a),n=!a&&_(u,n,a),l&&-1===f?e?s+c<=h&&s<=i&&i<s+c?i-s+s+c<=h&&(h+=c):s<=h&&!(s<=i&&i<s+c)&&(h+=c):s<=h&&(h+=c):((d||n)&&(!l&&s+c<=i||l&&s<=i)&&(h-=e?c:0,v-=o?c:0),d=a&&_(u,t,a),n=!a&&_(u,t,a),(d||n)&&(!l&&s<=h||l&&(e&&s<=i+r||!e&&s<=r)?(h+=c,v+=c):(!l&&s<=v||l&&(o&&s<=i+f||!o&&s<=f))&&(v+=c)),l&&s+c<=i&&(h+=e?c:0,v+=o?c:0)),{index:h-=e?i:0,endIndex:v-=o?i:0}):{index:r,endIndex:f}}function F(n,t,i,r,e,f,o,u,s,c,a,l,h){var h,v,d,w,m;if(t&&!h){if(h=s?e.row:e.column,v=s?e.rowRelative:e.columnRelative,d=void 0,w=e.row+(e.rowRelative&&i),m=e.column+(e.columnRelative&&r),l&&!l(w,m))return e;if(e.rowRelative&&e.columnRelative&&0===e.row&&0===e.column&&0===o&&a&&(s&&a.Tge||!s&&a.Age))return e;if(s&&0<=i||!s&&0<=r||!v){if(c)d=O(n,t,s?i:r,h,v,-1,!1,f,o,u,s,l).index;else if(d=dn(n,t,s?i:r,h,v,f,o,u,s,l),C(d))return(0,fn.Syt)(d);d!==h&&(e=e.offset(s?d-h:0,s?0:d-h,!0))}}return e}function D(n,t,i,r,e,f,o,u,s,c,a,l){var l,l,h,v,d,w,c,n;if(t&&!l){if(3===(l=e.Tyt())||s&&2===l||!s&&1===l)return e;if(l=s?e.rowRelative:e.columnRelative,h=s?e.endRowRelative:e.endColumnRelative,v=s?e.row:e.column,d=s?e.endRow:e.endColumn,w=void 0,s&&0<=i||!s&&0<=r||!l||!h){if(c)w=O(n,t,s?i:r,v,l,d,h,f,o,u,s,a);else if(w=wn(n,t,s?i:r,v,l,d,h,f,o,u,s,a),C(w))return(0,fn.Syt)(w);c=w.index,n=w.endIndex,c===v&&n===d||(e=e.offset2(s?c-v:0,s?0:c-v,s?n-d:0,s?0:n-d,i,r))}}return e}function V(n,t,i,r,e,f,o,u,s,c){if(t){var t=e;if(t&&f===t.source)return t.offsetWhenInsertRemoveColumn(o,u,s,c)}return e}function x(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,w,m,C,_,p,g,b,h=x,v=r;if(r){if(1===r.type&&r.hmt())v=F(n,r.source||n,t,i,r,e,f,o,u,s,c,a,l);else if(1===r.type)v=D(n,r.source||n,t,i,r,e,f,o,u,s,a,l);else if(10===r.type)(d=h(n,t,i,r.value,e,f,o,u,s,c,a,l))!==r.value&&(v=(0,fn.Ayt)(d));else if(9===r.type)w=h(n,t,i,r.value,e,f,o,u,s,c,a,l),m=r.value2&&h(n,t,i,r.value2,e,f,o,u,s,c,a,l),w===r.value&&m===r.value2||(v=(0,fn.rbt)(r.operatorType,w,m));else if(7===r.type){for(C=cn,p=_=void 0,b=(g=r).arguments.length,p=0;p<b;p++)if((d=h(n,t,i,_=g.arguments[p],e,f,o,u,s,c,a,l))!==_){(C=[])[p]=d;break}if(C){for(p=0;p<b;p++)_=g.arguments[p],C[p]!==sn&&C[p]!==cn||(C[p]=h(n,t,i,_,e,f,o,u,s,c,a,l));v=(0,fn.YJ)(g,C),g.s8t&&(v.s8t=g.s8t,v.u8t=g.u8t)}}else a&&!n.Iyt||u||13!==r.type||(v=V(n,n,t,i,r,e,f,o,s,a));return r.ensureSingle&&(v.ensureSingle=!0),v}}function l(f,o,u,s,n,t,i,r,c,a,l){var e,h,v,h,e=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e,l)},h=f.getSheet();h&&(v=h.b8&&(h.parent||h).xyt(),h=h.Ut&&h.Ut.pj(),d(v,e,c,h))}function d(n,t,i,r){var e,e,f,o,u,s,c,a,l,h,v,d,w,u,m,C,_,p,g,b,x;if(n)for(s=0;s<n.length;s++){for(a=c=!0,l=R.maxRowCount-1,h=R.maxColumnCount-1,d=0,w=(v=(e=n[s].validator)._S).length;d<w&&(m=(u=v[d]).rowCount,C=u.colCount,o=u.row,u=u.col,-1!==m&&(a=!1,l=o<l?o:l),-1!==C&&(c=!1,h=u<h?u:h),c||a);d++);if(!(i&&a||!i&&c)&&(_=(f=n[s].sheet).Uw(),e=e.condition(),p=void 0,v&&v[0]&&(-1===v[0].row&&(p={Tge:1}),-1===v[0].col)&&(p={Age:1}),(g=e.getExpressions())&&0<g.length)){for(b=0;b<g.length;b++)x=g[b],g[b]=t(_,x,l,h,p);e.setExpressions(g,r)}}}function h(n){var i,t,r,n,e,f,o,i=[],t=n.parent,r=[].concat(t&&t.sheets||[n]),n=null==t?void 0:t.mp;if(n&&n.length)for(e=0,f=n;e<f.length;e++)(o=f[e])&&o.getSheet&&o.getSheet()&&r.push(o.getSheet());return r.forEach(function(t){var n=t.conditionalFormats,n=n&&n.getRules();n&&n.length&&n.forEach(function(n){n.KK&&i.push({rule:n,sheet:t})})}),i}function z(n){var t,i,r,n,e,f,o,t=[],i=n.parent,r=[].concat(i&&i.sheets||[n]),n=null==i?void 0:i.mp;if(n&&n.length)for(e=0,f=n;e<f.length;e++)(o=f[e])&&o.getSheet&&o.getSheet()&&r.push(o.getSheet());return r.forEach(function(n){n.tables&&(t=t.concat(n.tables.all()))}),t}function K(f,o,u,s,c,a){var n,t,i,r,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e)},t=f.getSheet();t&&Q(i=h(t),n,r=t.Ut&&t.Ut.pj(),c,a)}function Q(n,t,i,r,e){var f,o,u,s,c,a,l,c,h,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,y,I,A,E,O;if(n)for(f=0,o=n.length;f<o;f++){if(s=(u=n[f].rule).ranges(),a=(c=M(s)).r,l=c.c,h=(c=n[f].sheet).Uw(),v=u.condition(),(d=c.tables)&&s&&1===s.length&&(m=(w=s[0]).row,C=w.col,_=w.rowCount,p=w.colCount,g=void 0,e&&r?g=d.AJ(m,C,_,p):c.EB&&c.Nyt&&(g=[c.Nyt]),g)&&g.length){for(b=!1,x=0,R=g.length;x<R;x++)if(j=(y=g[x]).row,N=y.col,k=y.rowCount,y=y.colCount,m===j&&_===k&&N<=C&&C+p<=N+y){b=!0;break}if(b)continue}if(v||(u.initCondition(),v=u.condition()),I=v&&v.getExpressions(),A=void 0,s&&s[0]&&(-1===s[0].row&&(A={Tge:1}),-1===s[0].col)&&(A={Age:1}),I&&0<I.length){for(E=0;E<I.length;E++)O=I[E],I[E]=t(h,O,a,l,A);v.setExpressions(I,i)}}}function Z(n,e,f){var t,n,t=function(n,t,i,r){return Y.call(this,n,i,r,t,e,f)},n=n.getSheet();tn(n,t,n.Ut.pj())}function nn(f,o,u,s,c,a){var n,t,i,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e)},t=f.getSheet();t&&(i=t.Ut&&t.Ut.pj(),tn(t,n,i,u,s,c,a))}function tn(c,a,n,l,h,v,d){var t=z(c);t&&t.forEach(function(r){var e,n,f,o,u,s;r&&!r.IHe&&(e=r.Mf.Uw(),n=r.dataRange(),f=n.row,o=n.col,s=r.footerIndex(),r.BSt.forEach(function(n,t){var t,i,t;u=o+t,(t=n.dataAreaFormula())&&((i=a(e,t,f,u))!==t&&r.Mf.Ut.YSt(r,A,{column:n.name(),expr:t}),n.dataAreaFormula(i),v)&&d&&h&&r.Mf===c&&r.aFe(c,l,h,n,u),(t=n.footerFormula())&&((i=a(e,t,s,u))!==t&&r.Mf.Ut.YSt(r,E,{column:n.name(),expr:t}),n.footerFormula(i))}))})}function rn(n,e,f){var t,n,i,t=function(n,t,i,r){return Y.call(this,n,i,r,t,e,f)},n=n.getSheet(),i;Q(h(n),t,n.Ut.pj())}function en(n,t,i,r,e,f,o){var u,s,o,c,a,l,h,v,d,w,m,C,_,v,_;if(!o&&(c=(o=(s=(u=n.getSheet()).Ut)&&s.yle())&&o.gle()))for(a in c)if(c.hasOwnProperty(a)&&(l=c[a]))for(h in l)l.hasOwnProperty(h)&&(d=+a,w=+h,v=l[h])&&v.expr&&!L(u.getValueIgnoreDefault(d,w))&&(m=u.op(),C=v.expr,_=v.oldRow,v=v.oldCol,m)&&_&&v&&C&&(C=t.call(self,n,d,w,C,n,i,r,e,f,sn),_=m.unparse(n,C,d,w),s.setDefaultValue(d,w,_,cn,on.DefaultChangeValueType.Expression,cn,!0))}function dn(n,t,i,r,e,f,o,u,s,c){var a,l,n;if(0<=i||!e){if(a=r+(e?i:0),c&&a<i&&a<o)return r;if(l=s&&_(f,n,s),n=!s&&_(f,n,s),(l||n)&&o<=i&&(a+=e?u:0),l=s&&_(f,t,s),n=!s&&_(f,t,s),l||n)if(o+u<=a)a-=u;else if(o<=a)return g;return c&&o<=i&&e&&o<(a-=u)+u&&a<o?g:a-=e?i:0}return r}function _(n,t,i){var i=i?{2:!0}:{1:!0};return n===t||n.Mf===t.Mf&&(3===n.nT&&i[t.nT]||i[n.nT]&&3===t.nT)}function wn(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,w,n,u,t;if(0<=i||!e){if(h=r+(e?i:0),v=f+(o?i:0),d=s+c-1,w=a&&_(u,n,a),n=!a&&_(u,n,a),(w||n)&&s<=i&&(h+=e?c:0,v+=o?c:0),w=a&&_(u,t,a),n=!a&&_(u,t,a),w||n)if(u=i+r,t=i+f,!l&&d<h||l&&d<u)h-=c,v-=c;else{if(!l&&s<=h&&v<=d||l&&s<=u&&t<=d)return g;!l&&v<s||l&&t<s||(!l&&d<=v||l&&d<=t?(h=!l&&h<=s||l&&u<=s?h:s,v-=c):v=s-1)}return h-=e?i:0,v-=o?i:0,l&&s<=i&&(h-=e?c:0,v-=e?c:0),{index:h,endIndex:v}}return{index:r,endIndex:f}}function mn(n,t,i){var r,e,f,o,u,s,c,a,c,c,a,c,l,h,a,c,v,d,r=mn,e=t;if(t)if(t.source)if(s=t.source,(c=t.endSource)&&s!==c){if(!(a=s.Mf&&s.Mf.parent))return fn.kyt;c===i?(c=i.S3,e.endSource=a.getSheet(c-1).Uw()):s===i&&(c=i.S3,e.source=a.getSheet(c).Uw()),delete i.S3,e.source===e.endSource&&delete e.endSource}else(n!==i&&s===i||n===i&&s!==i)&&(e=fn.kyt);else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,fn.Ayt)(f));else if(9===t.type)a=r(n,t.value,i),c=t.value2&&r(n,t.value2,i),a===t.value&&c===t.value2||(e=(0,fn.rbt)(t.operatorType,a,c));else if(7===t.type){for(l=cn,h=t.arguments.length,u=0;u<h;u++)if((f=r(n,o=t.arguments[u],i))!==o){(l=[])[u]=f;break}if(l){for(u=0;u<h;u++)o=t.arguments[u],l[u]!==sn&&l[u]!==cn||(l[u]=r(n,o,i));e=(0,fn.YJ)(t,l)}}else 8===t.type&&(a=n||i,c=I(t.value),s=(v=a.getCustomName(c))&&v.source||(v=(d=a.Lbt.getGlobalSourceModel()||a.getCalcSourceModel()).getSource().getCustomName(c))&&v.source?v.source:s)&&(n!==i&&s===i||n===i&&s!==i)&&(e=fn.kyt);return t.ensureSingle&&(e.ensureSingle=!0),e}function S(n,t,i,r,e){return mn(n,r,e)}function Cn(n,t){return n.yyt===n.gyt&&t!==n.yyt}function _n(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,h,w,m,C,m,w,C,d,o=!!r.source,u=r.source||n,s=r.rowRelative,c=r.columnRelative,d=t,h=i,w=e.yyt.Mf;if(e.R0i&&(m=r.row,C=r.column,d=e.wyt+(m-e.pyt)+w.lT(e.wyt,m-e.pyt+1,!0),h=e.Myt+(C-e.byt)+w.lT(e.Myt,C-e.byt+1)),m=e.Dyt(d),w=e._yt(h),(0<=t||!s)&&(0<=i||!c)){if(a=r.row+(s?t:0),l=r.column+(c?i:0),f&&f.isNameID||n===e.gyt&&(v=n===e.yyt?e.Eyt(e.yyt,t,i,1,1)&&!e.R0i:(C=t,d=i,f&&f.crossSheetMoved&&(C-=m,d-=w),e.jyt(e.gyt,C,d,1,1))),v&&(a-=s?m:0,l-=c?w:0),u===e.yyt&&e.Eyt(u,a,l,1,1)&&!e.jyt(u,a,l,1,1))return fn.kyt;if((h=(o&&u===e.gyt||!o&&n===e.gyt)&&e.jyt(e.gyt,a,l,1,1))&&(a+=m,l+=w),l-=c?i:0,u=r.source,e.gyt!==e.yyt&&(h&&v?o&&(u=e.yyt):h?u=e.yyt:v&&!o&&(u=e.gyt)),(a-=s?t:0)!==r.row||l!==r.column||u!==r.source)return(0,fn.knt)(u,cn,a,l,s,c)}else if((0<=t||!s)&&-1===i){if(a=r.row+(s?t:0),e.Eyt(n,t,i,1,1)&&(a-=s?m:0),e.jyt(u,a,-1,1,-1))a+=m;else if(e.Eyt(u,a,-1,1,-1))return fn.kyt;if((a-=s?t:0)!==r.row)return(0,fn.knt)(r.source,cn,a,r.column,s,r.columnRelative)}else if(-1===t&&0<=i&&!c){if(l=r.column+(c?i:0),e.Eyt(n,t,i,1,1)&&(l-=c?w:0),e.jyt(u,a,l,1,1))l+=w;else if(e.Eyt(u,a,l,1,1))return fn.kyt;if(l-=c?i:0,a!==r.row||l!==r.column)return(0,fn.knt)(r.source,r.endSource,r.row,l,r.rowRelative,c)}return r}function b(n,t){var i,r,e,f;return(t=n.getIntersect(t,0,0))?(i=n.row,r=n.col,e=n.rowCount,f=n.colCount,n.rowCount===t.rowCount&&n.colCount===t.colCount||(n.rowCount===t.rowCount?(n.col===t.col&&(r=n.col+t.colCount),f=n.colCount-t.colCount):n.colCount===t.colCount&&(n.row===t.row&&(i=n.row+t.rowCount),e=n.rowCount-t.rowCount)),(0,on.Ec)(i,r,e,f)):cn}function pn(n,t,i,r,e){var n,f;return t&&n&&(!(n=t.getIntersect(n,0,0))&&(f=t.getIntersect(i,0,0))||!(!n||!(n.rowCount===t.rowCount&&0!==e||n.colCount===t.colCount&&0!==r)))}function gn(n,t,i){var n=n.getRange(t,i);return(0,on.Ec)(n.row,n.col,n.rowCount,n.colCount)}function y(n,t,i,r){var t,e,t=b(n,t);return t?(e=t.union(i),r?(e.col=n.col,e.colCount=n.colCount):(e.row=n.row,e.rowCount=n.rowCount)):e=i,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function N(n,t,i,r,e){var f,n,t,f=b(n,t),n=n.getIntersect(t,0,0);return n?(n.row+=r,n.col+=e,{startRow:(t=f?f.union(n):i).row,endRow:t.row+t.rowCount-1,startColumn:t.col,endColumn:t.col+t.colCount-1}):cn}function bn(n,t){var i,r,e,n,f,o,u,t,i=n.row,r=n.col,e=n.rowCount,n=n.colCount,f=t.row,o=t.col,u=t.rowCount,t=t.colCount;return 1===e&&1!==n?o<r&&r<=o+t-1||o<=r+n-1&&r+n-1<o+t-1:1!==n||1===e||f<i&&i<=f+u-1||f<=i+e-1&&i+e-1<f+u-1}function xn(n,t,i,r,e,f){var r,e,f,o,u,s,c,a,l,h,v,d,n,w,m,C,_,p,r=gn(r,e,f),e=r.row,f=r.row+r.rowCount-1,o=r.col,u=r.col+r.colCount-1,s=n.pyt,c=s+n.Sx-1,a=n.byt,l=a+n.Cyt-1,h=n.wyt,v=n.Myt,d=(0,on.Ec)(s,a,n.Sx,n.Cyt),n=(0,on.Ec)(h,v,n.Sx,n.Cyt),w=r.getIntersect(n,0,0);if(pn(d,r,n,t,i))if(p=_=void 0,C=0!==t)if(p=s<=f&&f<=c,(_=s<=e&&e<=c)&&p)e+=t,f+=t;else if(_&&!p){if(t<=0)e+=t;else if(!(f<s+t)){if(!(c+t<f))return N(r,d,n,t,i);if(s===e)return y(r,d,n,C);e+=t}}else if(!_&&p){if(0<=t)f+=t;else if(!(c+t<e)){if(!(e<h))return N(r,d,n,t,i);if(c===f)return y(r,d,n,C);f+=t}}else w&&!w.equals(n)&&bn(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,u=m.col+m.colCount-1);else if(p=a<=u&&u<=l,(_=a<=o&&o<=l)&&p)o+=i,u+=i;else if(_&&!p){if(i<0)o+=i;else if(!(u<a+i)){if(!(l+i<u))return N(r,d,n,t,i);if(a===o)return y(r,d,n,C);o+=i}}else if(!_&&p){if(0<i)u+=i;else if(!(l+i<o)){if(!(o<v))return N(r,d,n,t,i);if(l===u)return y(r,d,n,C);u+=i}}else w&&!w.equals(n)&&bn(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,u=m.col+m.colCount-1);return{startRow:e,endRow:f,startColumn:o,endColumn:u}}function Rn(n,t,i,r){return t<i||i+r-1<n}function yn(n,t,i,r){return i<=n&&t<=i+r-1}function jn(n,t,i,r){return n<i&&i+r-1<t}function Nn(n,t,i,r){return i===n&&i+r-1<t||n<i&&i+r-1===t}function kn(n,t,i,r){return i<n&&n<=i+r-1&&i+r-1<t||n<i&&i<=t&&t<i+r-1}function p(n,t,i,r,e){return i<=n&&e<=n||t<=i+r-1&&t<=e+r-1}function In(n,t,i,r,e){for(var f,o,u,f=[Rn,yn,jn,Nn,kn],u=0;u<f.length;u++)if(f[u](n,t,i,r)){o=u+"_";break}if(i===e)o+="9";else for(u=0;u<f.length;u++)if(i!==e&&f[u](n,t,e,r)){o+=u;break}return o}function An(n,t,i,r,e){return{row:w(n.startRow,t),col:w(n.startColumn,i),endRow:un(n.endRow,r),endCol:un(n.endColumn,e)}}function En(n,t,i,r,e){return!e.R0i&&n===e.yyt&&e.wyt<=t&&t<=e.Sx+e.wyt-1&&e.Myt<=i&&i<=e.Cyt+e.Myt-1&&(t=t+e.pyt-e.wyt,i=i+e.byt-e.Myt),{startRow:r.row+(r.rowRelative?t:0),endRow:r.endRow+(r.endRowRelative?t:0),startColumn:r.column+(r.columnRelative?i:0),endColumn:r.endColumn+(r.endColumnRelative?i:0)}}function k(n,t,i,r,e,f,o,u,s){return L(f)&&(f=t.startRow),L(o)&&(o=t.startColumn),L(u)&&(u=t.endRow),L(s)&&(s=t.endColumn),(0,fn.lJ)(e||n.source,cn,n.rowRelative?f-i:f,n.columnRelative?o-r:o,n.endRowRelative?u-i:u,n.endColumnRelative?s-r:s,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,i,r)}function On(n,t,i,r,e){var f,n,o,u,n,s,c,a,l,h,v,d,f=En(n,t,i,r,e),n=r.source||n;if(e.gyt===n&&e.yyt===n)switch(n=(o=In(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))+"-"+(u=In(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)),s=e.wyt-e.pyt,c=e.Myt-e.byt,a=An(f,e.pyt,e.byt,e.pyt+e.Sx-1,e.byt+e.Cyt-1),d=v=h=l=void 0,n){case m.outToCover+"-"+m.outToCover:case m.crossToCover+"-"+m.outToCover:case m.outToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.crossToCover:case m.coverToCover+"-"+m.outToCover:case m.outToCover+"-"+m.coverToCover:case m.coverNoMove+"-"+m.outToCover:case m.outToCover+"-"+m.coverNoMove:return fn.kyt;case m.outToCross+"-"+m.outToCover:case m.coverToCross+"-"+m.outToCover:case m.insideToCross+"-"+m.outToCover:case m.partToCross+"-"+m.outToCover:case m.crossToCross+"-"+m.outToCover:case m.crossNoMove+"-"+m.outToCover:case m.outToCross+"-"+m.coverNoMove:case m.outToCross+"-"+m.coverToCover:case m.outToCross+"-"+m.crossToCover:case m.insideToCross+"-"+m.coverNoMove:case m.insideToCross+"-"+m.coverToCover:case m.insideToCross+"-"+m.crossToCover:return e.wyt<=f.startRow?k(r,f,t,i,cn,e.wyt+e.Sx):k(r,f,t,i,cn,cn,cn,e.wyt-1);case m.outToCover+"-"+m.outToCross:case m.outToCover+"-"+m.coverToCross:case m.outToCover+"-"+m.insideToCross:case m.outToCover+"-"+m.partToCross:case m.outToCover+"-"+m.crossToCross:case m.outToCover+"-"+m.crossNoMove:case m.coverNoMove+"-"+m.outToCross:case m.coverToCover+"-"+m.outToCross:case m.crossToCover+"-"+m.outToCross:case m.coverNoMove+"-"+m.insideToCross:case m.coverToCover+"-"+m.insideToCross:case m.crossToCover+"-"+m.insideToCross:return e.Myt<f.startColumn?k(r,f,t,i,cn,cn,e.Myt+e.Cyt):k(r,f,t,i,cn,cn,cn,cn,e.Myt-1);case m.partToOut+"-"+m.coverNoMove:case m.crossToOut+"-"+m.coverNoMove:if(!p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverNoMove+"-"+m.partToOut:case m.coverNoMove+"-"+m.crossToOut:if(o===m.coverNoMove&&!p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.crossToInside+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.crossToInside:return f.startRow>=e.pyt&&u===m.coverNoMove||f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,cn,a.row+s,a.col+c):k(r,f,t,i,cn,cn,cn,a.endRow+s,a.endCol+c);case m.partToInside+"-"+m.coverNoMove:return f.startRow>=e.pyt?k(r,f,t,i,cn,un(a.row+s,a.endRow+1)):k(r,f,t,i,cn,cn,cn,w(a.endRow+s,a.row-1));case m.coverNoMove+"-"+m.partToInside:return f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,cn,cn,un(a.col+c,a.endCol+1)):k(r,f,t,i,cn,cn,cn,cn,w(a.endCol+c,a.col-1));case m.partToCross+"-"+m.coverNoMove:case m.crossToPart+"-"+m.coverNoMove:case m.crossToCross+"-"+m.coverNoMove:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return f.startRow>=e.pyt?k(r,f,t,i,cn,a.row+s):k(r,f,t,i,cn,cn,cn,a.endRow+s);case m.crossToCover+"-"+m.coverNoMove:case m.partToPart+"-"+m.coverNoMove:return e.pyt<e.wyt?k(r,f,t,i,cn,un(a.row+s,a.endRow+1),cn,a.endRow+s):k(r,f,t,i,cn,a.row+s,cn,w(a.endRow+s,a.row-1));case m.coverNoMove+"-"+m.partToCross:case m.coverNoMove+"-"+m.crossToPart:case m.coverNoMove+"-"+m.crossToCross:if(p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return f.startColumn>=e.byt?k(r,f,t,i,cn,cn,a.col+c):k(r,f,t,i,cn,cn,cn,cn,a.endCol+c);case m.coverNoMove+"-"+m.crossToCover:case m.coverNoMove+"-"+m.partToPart:return e.byt<e.Myt?k(r,f,t,i,cn,cn,un(a.col+c,a.endCol+1),cn,a.endCol+c):k(r,f,t,i,cn,cn,a.col+c,cn,w(a.endCol+c,a.col-1));case m.crossToCross+"-"+m.coverToCover:case m.crossToPart+"-"+m.coverToCover:case m.partToCross+"-"+m.coverToCover:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverToCover+"-"+m.crossToCross:case m.coverToCover+"-"+m.crossToPart:case m.coverToCover+"-"+m.partToCross:if(o===m.coverToCover&&p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.coverToCover+"-"+m.partToPart:case m.partToPart+"-"+m.coverToCover:case m.coverToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.coverToCover:return k(r,f,t,i,cn,a.row+s,a.col+c,a.endRow+s,a.endCol+c);case m.partToPart+"-"+m.crossToCover:case m.partToCross+"-"+m.crossToCover:case m.crossToPart+"-"+m.crossToCover:case m.crossToCross+"-"+m.crossToCover:return p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt)?k(r,f,t,i):(h=a.row===f.startRow?a.col===f.startColumn?(v=f.endColumn,d=a.col+c,l=a.endRow+s,a.row+s):(v=f.startColumn,d=a.endCol+c,l=o===m.partToCross||o===m.crossToCross?e.pyt+s-1:f.endRow,f.startRow):a.col===f.startColumn?(v=f.endColumn,d=a.col+c,l=f.endRow,o===m.partToCross||o===m.crossToCross?e.pyt+e.Sx-1+s+1:f.startRow):(v=f.startColumn,d=a.endCol+c,l=o===m.partToCross||o===m.crossToCross?a.row+s:f.startRow,a.endRow+s),k(r,f,t,i,cn,un(l,h),un(v,d),w(l,h),w(v,d)));case m.crossToCover+"-"+m.partToPart:case m.crossToCover+"-"+m.partToCross:case m.crossToCover+"-"+m.crossToPart:case m.crossToCover+"-"+m.crossToCross:return p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)?k(r,f,t,i):(h=a.row===f.startRow?(l=(d=a.col===f.startColumn?(v=a.endCol+c,a.col+c):(v=f.endColumn,u===m.partToCross||u===m.crossToCross?e.byt+e.Cyt-1+c+1:f.startColumn),f.endRow),a.row+s):a.col===f.startColumn?(v=f.startColumn,d=u===m.partToCross||u===m.crossToCross?e.byt+c-1:f.endColumn,l=a.endRow+s,f.startRow):(v=u===m.partToCross||u===m.crossToCross?a.col+c:f.startColumn,d=a.endCol+c,l=f.startRow,a.endRow+s),k(r,f,t,i,cn,un(l,h),un(v,d),w(l,h),w(v,d)));case m.coverToOut+"-"+m.coverToOut:case m.coverToOut+"-"+m.coverToCross:case m.coverToOut+"-"+m.coverToCover:case m.coverToOut+"-"+m.coverNoMove:case m.coverToCross+"-"+m.coverToOut:case m.coverToCross+"-"+m.coverToCross:case m.coverToCross+"-"+m.coverToCover:case m.coverToCross+"-"+m.coverNoMove:case m.coverToCover+"-"+m.coverToOut:case m.coverToCover+"-"+m.coverToCross:case m.coverToCover+"-"+m.coverToCover:case m.coverToCover+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.coverToOut:case m.coverNoMove+"-"+m.coverToCross:case m.coverNoMove+"-"+m.coverToCover:return k(r,f,t,i,cn,f.startRow+s,f.startColumn+c,f.endRow+s,f.endColumn+c);default:return k(r,f,t,i)}}function Mn(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,g,A,E,g,b,O,M,f,g,b,x,O,M,f,b,x,s=!!r.source,c=s?r.source:n,g=f&&f.isDataValidator,b=Cn(e,n),x=!1,a=r.rowRelative,l=r.columnRelative,h=r.endRowRelative,v=r.endColumnRelative;if(0<=t||!a||!h||0<=i||!l||!v){if(d=r.row+(a?t:0),w=r.endRow+(h?t:0),m=r.column+(l?i:0),_=w-d+1,p=(C=r.endColumn+(v?i:0))-m+1,!g&&b){if(E=e.jyt(c,d,m,_,p))return r.offset(o,u,!0,t,i);if(e.Eyt(c,d,m,_,p))return fn.kyt;if(c!==e.gyt||c!==e.yyt||0!==o&&0!==u)return r;x=!0}if(f&&f.isNameID||n===e.gyt&&(A=n===e.yyt?e.Eyt(e.yyt,t,i,1,1):(g=t,b=i,f&&f.crossSheetMoved&&(g-=o,b-=u),e.jyt(e.gyt,g,b,1,1))),(x||n===c&&n===e.gyt&&n===e.yyt)&&(O=t,M=i,A&&(O-=o,M-=u),0===o||0===u)){if(!(f=xn(e,o,u,r,O,M)))return fn.kyt;if(0===u&&o&&f.endColumn>=C&&f.startColumn<=m||0===o&&u&&f.endRow>=w&&f.startRow<=d)return g=f.startRow,b=f.startColumn,x=f.endRow,O=f.endColumn,g===d&&x===w&&b===m&&O===C?r:(a&&(g-=t),h&&(x-=t),l&&(b-=i),v&&(O-=i),(0,fn.lJ)(r.source,cn,g,b,x,O,a,l,h,v,t,i))}if(A&&(M=e.wyt-e.pyt,f=e.Myt-e.byt,_+=(a?-M:0)+(h?M:0),p+=(l?-f:0)+(v?f:0)),c===e.yyt&&e.Eyt(c,d,m,_,p)&&!p&&(!a&&!l&&!h&&!v||!A))return fn.kyt;if(g=(s&&c===e.gyt||!s&&n===e.gyt)&&(!A&&e.jyt(e.gyt,d,m,_,p)||A&&e.Eyt(e.yyt,a?d:d+o,l?m:m+u,_,p)),A&&(d-=j=a?o:0,w-=N=h?o:0,m-=k=l?u:0,C-=I=v?u:0),b=!1,g)d+=o,w+=o,m+=u,C+=u;else if(e.Eyt(c,d,m,_,p)){if(!(x=e.intersectWith(c,d,m,_,p))||x.rowCount!==_&&x.colCount!==p)return fn.kyt;d=x.row+o,m=x.col+u,w=d+x.rowCount,C=m+x.colCount,b=!0}return w-=h?t:0,m-=l?i:0,C-=v?i:0,e.gyt===e.yyt?c=s?r.source:sn:(c=r.source,g&&A&&s?c=e.yyt:g&&A||(g?c=e.yyt:A&&!s&&(c=e.gyt))),(d-=a?t:0)!==r.row||m!==r.column||w!==r.endRow||C!==r.endColumn||b||c!==r.source?(0,fn.lJ)(c,cn,d,m,w,C,a,l,h,v,t,i):void 0}}function Sn(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,w,m,C,v,d,_,p,g,p,_,g,f,g,b,x,m,R,b,x,R,b,g,v,f,d,o,u=!!r.source?r.source:n,s=r.Tyt(),v=t,d=i,_=e.yyt.Mf;if(e.R0i&&(p=r.row,g=r.column,v=e.wyt+(p-e.pyt)+_.lT(e.wyt,p-e.pyt+1,!0),d=e.Myt+(g-e.byt)+_.lT(e.Myt,g-e.byt+1)),p=e.Dyt(v),_=e._yt(d),0===s){if(g=!e.Oyt&&On(n,t,i,r,e))return g;if(g=Mn(n,t,i,r,e,f,p,_))return g}else if(1===s){if(c=r.rowRelative,l=r.endRowRelative,0<=t||!c||!l){if(v=r.row+(c?t:0),(d=r.endRow+(l?t:0))<v)return fn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),u===e.gyt&&u===e.yyt&&0===e.byt&&0===e.Myt&&e.Cyt===u.getColumnCount()){if(f=e.pyt,g=e.wyt,C&&(v-=p,d-=p),x=f+(b=e.Sx),R=f<=d&&d<x,(m=f<=v&&v<x)&&R)return C?r:r.offset(p,_,!0,t,i);if(b=g+b,m&&g<=d?(v+=p,d<b&&g<=d&&(d=b-1,v=x)):R&&v<=b&&(d+=p,g<=v)&&w<b&&(v=g,d=f-1),d-=l?t:0,(v-=c?t:0)!==r.row||d!==r.endRow)return(0,fn.lJ)(r.source,r.endSource,v,j.BAND_INDEX_CONST,d,j.BAND_INDEX_CONST,c,a,l,h,t,i)}if(C)return r.offset(-p,_,!0,t,i)}}else if(2===s&&(a=r.columnRelative,h=r.endColumnRelative,0<=i||!a||!h)){if(w=r.column+(a?i:0),(m=r.endColumn+(h?i:0))<w)return fn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),u===e.gyt&&u===e.yyt&&0===e.pyt&&0===e.wyt&&e.Sx===u.getRowCount()){if(x=e.byt,R=e.Myt,C&&(w-=_,m-=_),g=x+(b=e.Cyt),f=x<=m&&m<g,(v=x<=w&&w<g)&&f)return C?r:r.offset(p,_,!0,t,i);if(d=R+b,v&&R<=m?(w+=_,m<d&&R<=m&&(m=d-1,w=g)):f&&w<=d&&(m+=_,R<=w)&&w<d&&(w=R,m=x-1),m-=h?i:0,(w-=a?i:0)!==r.column||m!==r.endColumn)return(0,fn.lJ)(r.source,r.endSource,j.BAND_INDEX_CONST,w,j.BAND_INDEX_CONST,m,c,a,l,h,t,i)}if(C)return r.offset(p,-_,!1,t,i)}return r}function Y(n,t,i,r,e,f,o){var u,s,c,a,l,h,v,d,w,u=Y,s=r;if(1===r.type&&r.hmt())s=f?_n(n,t,i,r,e,o):Dn(n,t,i,r,e);else if(1===r.type)s=f?Sn(n,t,i,r,e,o):Vn(n,t,i,r,e);else if(10===r.type)(c=u(n,t,i,r.value,e,f,o))!==r.value&&(s=(0,fn.Ayt)(c));else if(13===r.type){if(s=r.offset(0,0,!0),r.ubt&&(s.ubt=r.ubt,-1===(a=r.abt.getColumnIndexInTable(r.ubt))))return fn.kyt;if(r.sbt&&(s.sbt=r.sbt,-1===(a=r.abt.getColumnIndexInTable(r.sbt))))return fn.kyt}else if(9===r.type)l=u(n,t,i,r.value,e,f,o),h=r.value2&&u(n,t,i,r.value2,e,f,o),l===r.value&&h===r.value2||(s=(0,fn.rbt)(r.operatorType,l,h));else if(7===r.type){for(v=cn,a=d=void 0,w=r.arguments.length,a=0;a<w;a++)if((c=u(n,t,i,d=r.arguments[a],e,f,o))!==d){(v=[])[a]=c;break}if(v){for(a=0;a<w;a++)d=r.arguments[a],v[a]!==sn&&v[a]!==cn||(v[a]=u(n,t,i,d,e,f,o));s=(0,fn.YJ)(r,v)}(0,fn.isExpression)(r.function)&&(s.function=u(n,t,i,r.function,e,f,o))}return r.ensureSingle&&(s.ensureSingle=!0),s}function Fn(n,t,i){for(var r,e,f,o,u,u,s,c,a,l,u,h,v,d,r,e=t.gyt.getSheet().Ut.pj(),f=0;f<n.length;f++)if((o=n[f].validator).Epe)delete o.Epe;else if(u=o._S,s=(u=M(u)).r,c=u.c,l=(a=n[f].sheet).Uw(),(h=(u=o.condition()).getExpressions())&&0<h.length){for(v=0;v<h.length;v++)d=h[v],h[v]=Y(l,s,c,d,t,i,{isDataValidator:!0});u.setExpressions(h,e)}}function Dn(n,t,i,r,e){var f,o,u,s,c,a,l,f=r.source||n,o=r.rowRelative,u=r.columnRelative,a=e.Dyt(t),l=e._yt(i);if((0<=t||!o)&&(0<=i||!u)){if(s=r.row+(o?t:0),c=r.column+(u?i:0),e.Eyt(n,t,i,1,1)?(s-=o?a:0,c-=u?l:0):e.jyt(n,s,c,1,1)&&(s+=o?a:0,c+=u?l:0),e.jyt(f,s,c,1,1)?(s+=a,c+=l):e.Eyt(f,s,c,1,1)&&(s-=a,c-=l),c-=u?i:0,(s-=o?t:0)!==r.row||c!==r.column)return(0,fn.knt)(r.source,cn,s,c,o,u)}else if((0<=t||!o)&&-1===i){if(s=r.row+(o?t:0),e.Eyt(n,t,-1,1,-1)?s-=o?a:0:e.jyt(n,s,-1,1,-1)&&(s+=o?a:0),e.jyt(f,s,-1,1,-1)?s+=a:e.Eyt(f,s,-1,1,-1)&&(s-=a),(s-=o?t:0)!==r.row||c!==r.column)return(0,fn.knt)(r.source,cn,s,r.column,o,r.columnRelative)}else if(-1===t&&0<=i&&!u&&(c=r.column+0,e.Eyt(n,-1,i,-1,1)?c-=0:e.jyt(n,-1,c,-1,1)&&(c+=0),e.jyt(f,-1,c,-1,1)?c+=l:e.Eyt(f,-1,c,-1,1)&&(c-=l),c-=0,s!==r.row||c!==r.column))return(0,fn.knt)(r.source,cn,r.row,c,r.rowRelative,u);return r}function Vn(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,f=r.source||n,o=r.Tyt(),R=e.Dyt(t),y=e._yt(i);if(0===o){if(v=r.rowRelative,d=r.columnRelative,w=r.endRowRelative,m=r.endColumnRelative,!(0<=t)&&v&&w||!(0<=i)&&d&&m)if(!(0<=t)&&v&&w||-1!==i){if(-1===t&&(0<=i||!d||!m)){if((c=r.column+(d?i:0))<(a=r.endColumn+(m?i:0)))return fn.kyt;if(e.Eyt(n,-1,i,-1,1)?(c-=g=d?y:0,a-=x=m?y:0):e.jyt(n,-1,i,-1,1)&&(c+=g=d?y:0,a+=x=m?y:0),e.jyt(f,-1,c,-1,h=a-c)?(c+=_=y,a+=_):e.Eyt(f,-1,c,-1,h)&&(c-=_=y,a-=_),a-=m?i:0,(c-=d?i:0)!==r.column||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,c,r.endRow,a,r.rowRelative,d,r.endRowRelative,m,t,i)}}else{if((u=r.row+(v?t:0))<(s=r.endRow+(w?t:0)))return fn.kyt;if(e.Eyt(n,t,-1,1,-1)?(u-=p=v?R:0,s-=b=v?R:0):e.jyt(n,t,-1,1,-1)&&(u+=p=v?R:0,s+=b=v?R:0),e.jyt(f,u,-1,l=s-u,-1)?(u+=C=R,s+=C):e.Eyt(f,u,-1,l,-1)&&(u-=C=R,s-=C),s-=w?t:0,(u-=v?t:0)!==r.row||s!==r.endRow)return(0,fn.lJ)(r.source,cn,u,r.column,s,r.endColumn,v,r.columnRelative,w,r.endColumnRelative,t,i)}else if(u=r.row+(v?t:0),s=r.endRow+(w?t:0),c=r.column+(d?i:0),l=s-u,h=(a=r.endColumn+(m?i:0))-c,e.Eyt(n,t,i,1,1)?(u-=p=v?R:0,s-=b=w?R:0,c-=g=d?y:0,a-=x=m?y:0):e.jyt(n,u,c,l,h)&&(u+=p=v?R:0,s+=b=w?R:0,c+=g=d?y:0,a+=x=m?y:0),e.jyt(f,u,c,l,h)?(u+=C=R,s+=C,c+=_=y,a+=_):e.Eyt(f,u,c,l,h)&&(u-=C=R,s-=C,c-=_=y,a-=_),s-=w?t:0,c-=d?i:0,a-=m?i:0,(u-=v?t:0)!==r.row||c!==r.column||s!==r.endRow||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,u,c,s,a,v,d,w,m,t,i)}else if(1===o){if(v=r.rowRelative,w=r.endRowRelative,0<=t||!v||!w){if((u=r.row+(v?t:0))<(s=r.endRow+(w?t:0)))return fn.kyt;if(e.Eyt(n,t,-1,1,-1)?(u-=p=v?R:0,s-=b=w?R:0):e.jyt(n,t,-1,1,-1)&&(u+=p=v?R:0,s+=b=w?R:0),e.jyt(f,u,-1,l=s-u,-1)?(u+=C=R,s+=C):e.Eyt(f,u,-1,l,-1)&&(u-=C=R,s-=C),s-=w?t:0,(u-=v?t:0)!==r.row||s!==r.endRow)return(0,fn.lJ)(r.source,cn,u,j.BAND_INDEX_CONST,s,j.BAND_INDEX_CONST,v,!1,w,!1,t,i)}}else if(2===o){if(d=r.columnRelative,m=r.endColumnRelative,c=r.column+(d?i:0),(a=r.endColumn+(m?i:0))<c)return fn.kyt;if(e.Eyt(n,-1,i,-1,1)?(c-=g=d?y:0,a-=x=m?y:0):e.jyt(n,-1,i,-1,1)&&(c+=g=d?y:0,a+=x=m?y:0),e.jyt(f,-1,c,-1,h=a-c)?(c+=_=y,a+=_):e.Eyt(f,-1,c,-1,h)&&(c-=_=y,a-=_),a-=m?i:0,(c-=d?i:0)!==r.column||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,j.BAND_INDEX_CONST,c,j.BAND_INDEX_CONST,a,!1,d,!1,m,t,i)}return r}function P(n,t,i,r,e,f){n.Ryt(t,i,r,e,!0,!1,f)}function Tn(n,t,i){var r,e,f,o,u,s,c,a,l,r=Tn,e=t;if(8===t.type){if(t.value===i&&(!t.source||t.source===n.getSource()))return(0,fn.Syt)(g,t.source)}else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,fn.Ayt)(f));else if(9===t.type)s=r(n,t.value,i),c=t.value2&&r(n,t.value2,i),s===t.value&&c===t.value2||(e=(0,fn.rbt)(t.operatorType,s,c));else if(7===t.type){for(a=cn,l=t.arguments.length,u=0;u<l;u++)if((f=r(n,o=t.arguments[u],i))!==o){(a=[])[u]=f;break}if(a){for(u=0;u<l;u++)o=t.arguments[u],a[u]!==sn&&a[u]!==cn||(a[u]=r(n,o,i));e=(0,fn.YJ)(t,a)}}return t.ensureSingle&&(e.ensureSingle=!0),e}Object.defineProperty(n,"__esModule",{value:!0}),n.adjustFormulaOnMoveSwap=n.CalcOperatorAdjustor=n.MoveSwapInfo=void 0,fn=t("CalcEngine"),u=t("Common"),ln=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=t("./dist/plugins/sheetsCalc/calc.ns.js"),R=t("./dist/plugins/sheetsCalc/parser-sheets.js"),on=t("Core"),L=u.Common.lt.ht,t=u.Common.zf,I=t.Gmt,un=Math.min,w=Math.max,sn=void 0,cn=null,C=fn.Convert.BJ,g=fn.Errors.Reference,A="columnFormula",E="footerFormula",M=on.util.z0,r.prototype.Dyt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.wyt+1,i=i.ix(t.wyt,n,!0),t.wyt-t.pyt+i):t.wyt-t.pyt},r.prototype._yt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.Myt+1,i=i.ix(t.Myt,n),t.Myt-t.byt+i):t.Myt-t.byt},r.prototype.jyt=function(n,t,i,r,e){var f=this;return f.gyt===n&&(-1===f.pyt||f.pyt<=t&&t+r<=f.pyt+f.Sx)&&(-1===f.byt||f.byt<=i&&i+e<=f.byt+f.Cyt)},r.prototype.Eyt=function(n,t,i,r,e){var f,o,u,s,c,a,l,f=this,o=f.yyt.Mf,u=o&&o.o5(),s=f.wyt,c=f.Myt,a=f.Sx,l=f.Cyt;return u&&(a+=o.lT(s,a,!0),l+=o.lT(c,l)),f.yyt===n&&(-1===s||s<=t&&t+r<=s+a)&&(-1===c||c<=i&&i+e<=c+l)},r.prototype.intersectWith=function(n,t,i,r,e){var f,t,o,f=this;return f.yyt!==n?cn:(t=f.Byt(n,t,i,r,e),(o=f.Byt(n,f.pyt,f.byt,r,e)).intersectWith(t))},r.prototype.Byt=function(n,t,i,r,e){var f,o,u,s,f,o,u,s;return{row:-1===t?0:t,column:-1===i?0:i,rowCount:-1===t||-1===r?n.rowCount:r,columnCount:-1===i||-1===e?n.colCount:e,intersectWith:a}},T=r,n.MoveSwapInfo=T,c=function(n){switch(n){case on.PasteOperationOptions.add:return 3;case on.PasteOperationOptions.subtract:return 4;case on.PasteOperationOptions.multiply:return 5;case on.PasteOperationOptions.divide:return 6}},an.gB=function(n,t,i,r,e,f,o,u,s,c,a){var l,h,v,d,w,m,C,_,p,l=i,h=an,v=this.gB;if(i){if(10===(m=i.type))l=(0,fn.Ayt)(v.call(h,n,t,i.value,r,e,f,o,u,s,c,a));else if(1===m&&i.hmt()){if(d=un((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=un((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&(i.row+r<0||i.row+r>=d)||i.columnRelative&&(i.column+e<0||i.column+e>=w))return(0,fn.Syt)(g,i.source);l=i.offset(0,0,!1)}else if(1===m){if(d=un((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=un((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&!i.isFullColumn&&(i.row+r<0||i.row+r>d)||i.columnRelative&&!i.isFullRow&&(i.column+e<0||i.column+e>w)||i.endRowRelative&&!i.isFullColumn&&(i.endRow+r<0||i.endRow+r>d)||i.endColumnRelative&&!i.isFullRow&&(i.endColumn+e<0||i.endColumn+e>w))return(0,fn.Syt)(g,i.source,i.endSource);l=i.offset(0,0,!1,r,e)}else if(9===i.type)l=(0,fn.rbt)(i.operatorType,v.call(h,n,t,i.value,r,e,f,o,u,s,c,a),i.value2&&v.call(h,n,t,i.value2,r,e,f,o,u,s,c,a));else if(7===m){if(_=[],i.arguments&&0<i.arguments.length)for(p=0;p<i.arguments.length;p++)_[p]=v.call(h,n,t,i.arguments[p],r,e,f,o,u,s,c,a);l=(0,fn.YJ)(i,_)}else 13===m&&(l=i.offsetWhenCopy(n,t,r,e,f,o,u,s,c,a));i.ensureSingle&&(l.ensureSingle=!0)}return l},an.copyFormula=function(V,T,Y,n,t,i,L,X,J,G,P,r,H){var e,f,U,$,o,B,u,W,s,c,a,l,h,v,d,w,m,C,_,p,g,b,q,z,K,Q,x,R,Z,nn,y,j,N,tn,rn,k,I,A,E,E,E,E,O,en,E,M,S,M,S,F,D,D,e=V.b3(),f=n.b3(),U=e.getSource(),$=U.getSheet(),o=f.getSource(),B=an;if(e&&f){for(r&&(u=r.transpose,W=r.operationOptions),s=o&&o.getSheet().Ut.pj(),a=Y,l=t,h=i,v=L,d=X,(c=T)<0&&(c=0,v=un(e.rC(),f.rC())),Y<0&&(a=0,d=un(e.cC(),f.cC())),t<0&&(l=0),i<0&&(h=0),w=new fn.CalcSourceModel(e.op(),U),g=o.getSheet(),b=!G&&g.o5(),q=v,z=d,K=g.getRowCount(),Q=g.getColumnCount(),m=0;m<v;m++)for(C=0;C<d;C++)x=m+c,R=C+a,u&&(x=c+C,R=a+m),H&&on.util.df(x,R,$)||e.Lyt(w,x,R,m,C);for(Z={},nn=f.op(),_=m=0;m<v&&m+l<K;m++)if(y=m+l,b&&0===g.getRowHeight(y))v++;else{if(!J||!o.isHiddenRow(y,!0))for(p=C=0,d=z;C<d&&C+h<Q;C++)if(j=C+h,b&&0===g.getColumnWidth(j))d++;else{if((N=w.pB(_,p))||r){if(N===Z)continue;if(N=B.gB(U,o,N,y,j,tn=t+m-T-_,rn=i+C-Y-p,t,i,q,z),k=w.sT(_,p),o){if(b&&k)continue;if(k&&!k.isDynamicArray){for(I=k.rowCount,A=k.colCount,0<(E=c-k.row)&&(I-=E),(E=v-m)<I&&(I=E),0<(E=a-k.col)&&(A-=E),(E=d-C)<A&&(A=E),O=0;O<I;O++)for(en=0;en<A;en++)w.bB(m+O,C+en,Z);f.setArrayFormula(y,j,I,A,nn.unparse(o,N,y,j),sn,s)}else{if(E=w.Ile(_,p),P&&g&&E&&(g.vle=E),W&&(M=_+c,S=p+a,u&&(M=p+c,S=_+a),N=hn(N,V.getValue(M,S),f.pB(y,j),n.getValue(y,j),W))&&N.value.type===fn.ExpressionType.number&&N.value2.type===fn.ExpressionType.number){(M=(0,ln.evaluateExpression)(n,N))instanceof fn.CalcError||n.setValue(y,j,M),p++;continue}N&&u&&vn(N),S=N?nn.unparse(o,N,y,j):sn,o.setFormula(y,j,S,sn),E&&g.Ut.setDefaultValue(y,j,S,cn,on.DefaultChangeValueType.Expression,cn,!0),(F=w.Fyt(_,p))&&(D=new fn.EvaluateContext(o,(0,fn.eV)(y,j),!1,sn,sn,f.oT(y,j,!0)),F=(F=f.Lbt.allowDynamicArray?(0,fn.h0t)(D,N,!1,0,0,!0,!0):(0,fn.Pyt)(D,N,!1,0,0,!1,!1))===N?sn:F),f.Gyt(y,j,N,F,k,s),E&&(delete g.vle,D=f.oT(y,j))&&D.isDefault(E)}}else f.bB(y,j,N),f.Uyt(y,j,k)}else f&&f.pB(y,j)&&f.Gyt(y,j,sn,sn,sn,s);p++}_++}}},an.moveFormula=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,V,v,d,w,m,n,C,_,p,g,b,x,R,y,j,T,N,k,I,A,E,Y,O,M,S,F,D,F,m,n,s=n.b3(),c=r.b3(),a=s.op();if(s&&c){for(l=r.getRowCount(),h=r.getColumnCount(),V=s.pj(),v=c.pj(),d=a.Hyt(),t<0&&(t=0,o=un(n.getRowCount(),l)),e<0&&(e=0),i<0&&(i=0,u=un(n.getColumnCount(),h)),f<0&&(f=0),w=!(n===r&&n.name()===r.name()),n=u,C=m=o,(p=r.o5())&&(m+=r.lT(e,o,!0),n+=r.lT(f,u)),s.mF(t,i,o,u),P(s,t,i,o,u),d.uFe(s,t,i,o,u),c.mF(e,f,m,n),P(c,e,f,m,n),d.uFe(c,e,f,m,n),g=[],b=0;b<o;b++)for(A=b+t,x=0;x<u;x++)R=s.pB(A,E=x+i),y=s.sT(A,E),j=s.Fyt(A,E),N=(T=s.oT(A,E))&&T.isDefault(),R&&(g[b*u+x]={WK:R,$bt:y,eyt:j,xle:N},s.zyt(A,E,V),y&&(A!==y.row||E!==y.col)||s.rT.setFormula(A,E,cn,sn));for(O=w?{}:null,k=b=0;b<C&&b+e<l;b++)if(M=b+e,p&&0===r.getRowHeight(M))C++;else{for(I=x=0,_=u;x<_&&f+x<h;x++)if(S=x+f,p&&0===r.getColumnWidth(S))_++;else{if(F=g[k*u+I]){if(R=F.WK,y=F.$bt,p&&y){I++;continue}a&&y&&!y.isDynamicArray&&y.row===t+b&&y.col===i+x&&(Y=(0,on.Ec)(M,S,y.rowCount,y.colCount)),D=y&&!y.isDynamicArray?Y:sn,j=F.eyt,(N=F.xle)&&(r.vle=N),c.Vyt(v,M,S),c.bB(M,S,R),c.Uyt(M,S,D),c.Yyt(M,S,j),c.Nle(M,S,N),(!D||D.row===M&&D.col===S)&&(F=c.getFormula(M,S),c.rT.setFormula(M,S,F,D),N)&&r.Ut.setDefaultValue(M,S,F,cn,on.DefaultChangeValueType.Expression,cn,!0),w&&(O[M+", "+S]=R),N&&delete r.vle}else L(c.pB(M,S))||(c.Vyt(v,M,S),c.bB(M,S,sn),c.Uyt(M,S,sn));I++}k++}d.Zyt(s,t,i,o,u),d.Zyt(c,e,f,m,n),n=(m=s.getSource().getSheet()).b8&&(m.parent||m).xyt(),d.Wyt(n,s.getSource(),t,i,c.getSource(),e,f,o,u,!0,O),!0==w&&d.Wyt(n,s.getSource(),t,i,c.getSource(),e,f,o,u,!0,O)}},an.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.Qyt=function(n,t){var i=this,r,e;isNaN(t)||(i.y3||(i.y3={},i.Kyt={}),r=i.y3[t],e=i.Kyt[t],n&&!n.preAdj&&n!==r&&(r?e.nextAdj=n:i.y3[t]=n,n.preAdj=e,n.nextAdj=cn,i.Kyt[t]=n))},an.prototype.Jyt=function(n,t){var i,r,r,e,i=this;isNaN(t)||(r=i.y3&&i.y3[t],n&&(n.preAdj||n===r)&&(r=n.preAdj,e=n.nextAdj,r?r.nextAdj=e:i.y3[t]=e,e?e.preAdj=r:i.Kyt[t]=r,n.preAdj=cn,n.nextAdj=cn))},an.prototype.Xyt=function(n,t,i,r,e,f,o,u){u?this.qyt(n,x,t,i,r,e,f,o):this.sFe(n,x,t,i,r,e,f,o);var u=0,s=0,c=0,a=0;0===t&&(r&&e?c=i:r?u=i:e?a=i:s=i),l(n,x,t,i,u,s,c,a,r,e,f),K(n,x,t,i,r,e),f||nn(n,x,t,i,r,e),en(n,x,t,i,r,e,o)},an.prototype.sFe=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,d,V,x,R,c,y,j,s,N,N,k,y,I,A,E,O,M,T,S,Y,F,D,a=this,l=a.y3;if(l){for(d=n.Mbt,g=(0,fn.createMap)(),b={l:!0},(d=d.uT())&&(V=f?d.cFe:d.fFe).call(d,i,r,e);l[0];){if(x=void 0,p=(w=(C=l[0]).w3).pj(),_=w.getSource(),h=C.row,v=C.column,R=w.oT(h,v),G(g,w,h,v)||C!==R);else{if(c=w.pB(h,v),y=w.Fyt(h,v),c)if(j=!1,s=e?h:v,n===_&&i<=s&&(j=!0,s-=f?r:-r),L(c.aMt)?(m=t.call(a,_,h,v,c,n,i,r,e,f,sn,o),y&&(x=t.call(a,_,h,v,y,n,i,r,e,f,sn,o))):(c.Wx&&c.Wx.lt.l||(N=f?U(c,n,_,e):H(c,n,_),c.Wx={lt:b,ct:N}),0===(N=f?B(c.Wx.ct,i,s,n===_,j):$(c.Wx.ct,i,r,s,n===_,j,e))?m=c:c.Wx[N]?(m=c.Wx[N],y&&(x=y.eyt||t.call(a,_,h,v,y,n,i,r,e,f,sn,o))):(m=t.call(a,_,h,v,c,n,i,r,e,f,sn,o),x=y&&t.call(a,_,h,v,y,n,i,r,e,f,sn,o),-1!==N&&(c.Wx[N]=m,y)&&(y.eyt=x))),R.QDt&&q(f,e,R,n,i,r),R.vyt(),!u&&R.isDefault()&&null!=(c=null==(s=w.rT.Mf)?void 0:s.Ut)&&c.WTe(h,v,m),k=w.sT(h,v),f||j||u||k&&!k.isDynamicArray?!an.SaveFormulaChanges||j||u||w.rT.setFormula(h,v,w.getFormula(h,v),k,!0):w.Vyt(w.pj(),h,v),k){if(_===n&&(y=f?r:-r,e?i<=k.row&&(k.row+=y):i<=k.col&&(k.col+=y)),h===k.row&&v===k.col)if(k.isDynamicArray)w.dataTable[h][v].WK=m,w.dataTable[h][v].eyt=x;else for(I=h;I<h+k.rowCount;I++)for(A=v;A<v+k.colCount;A++)w.SB(I,A,m,k,I===h&&A===v,!f&&!j&&!u&&p),J(g,w,I,A,!0)}else w.dataTable[h][v].WK=m,w.dataTable[h][v].eyt=x,an.SaveFormulaChanges&&w.rT.setFormula(h,v,w.getFormula(h,v),sn);else(w.getRowExpression&&w.getRowExpression(h)||w.getColumnExpression&&w.getColumnExpression(v))&&w.gF(h,v,1,1)}a.Jyt(C,0)}for(b.l=!1;l[1];)p=(w=(C=l[1]).w3).pj(),h=C.row,w.getRowExpression&&(m=w.getRowExpression(h))&&w.SB&&(E=w.getSource(),w.SB(h,-1,t.call(a,E,h,-1,m,n,i,r,e,f),sn,!0,X(h,i,p,n.id===E.id))),a.Jyt(C,1);for(;l[2];)p=(w=(C=l[2]).w3).pj(),v=C.column,w.getColumnExpression&&(m=w.getColumnExpression(v))&&w.SB&&(E=w.getSource(),w.SB(-1,v,t.call(a,E,-1,v,m,n,i,r,e,f),sn,!0,X(v,i,p,n.id===E.id))),a.Jyt(C,2);for(;l[3];)M=(O=l[3]).name,m=(w=O.w3).$yt(M),T=t.call(a,w.getSource(),0,0,m,n,i,r,e,f,{isNameID:!0}),w.twt(M,T),a.Jyt(O,3);for(S in l)if(3<(Y=+S)&&l.hasOwnProperty(S))for(;l[S];)D=(F=l[S]).w3,m=t.call(a,D,0,0,F.expression,n,i,r,e,f),D.setExpression(F.id,F.name,m),a.Jyt(F,Y)}},an.prototype.qyt=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,g,s,R,y,j,N,k,I,A,E,O,c=this,a=c.y3;if(a){for(_=(0,fn.createMap)();a[0];){if(C=(l=(w=a[0]).w3).pj(),m=l.getSource(),G(_,l,h=w.row,v=w.column));else{if(!(d=l.pB(h,v))||t===S&&m===n)(l.getRowExpression&&l.getRowExpression(h)||l.getColumnExpression&&l.getColumnExpression(v))&&l.gF(h,v,1,1);else if(d=t.call(c,m,h,v,d,n,i,r,e,f,sn,o,u),p=l.sT(h,v)){if(m===n&&(g=f?r:-r,e?i<=p.row&&(p.row+=g):i<=p.col&&(p.col+=g)),h===p.row&&v===p.col)if(p.isDynamicArray)l.SB(h,v,d,p,!0,X(e?h:v,i,C,n.id===m.id));else for(b=h;b<h+p.rowCount;b++)for(x=v;x<v+p.colCount;x++)l.SB(b,x,d,p,b===h&&x===v,X(e?b:x,i,C,n.id===m.id)),J(_,l,b,x,!0)}else g=m.Mf,(s=!u&&(null==(s=l.oT(h,v))?void 0:s.isDefault()))&&(g.vle=s),l.SB(h,v,d,p,!0,X(e?h:v,i,C,n.id===m.id),cn,cn,u),s&&(R=m.nT,y=l.op().unparse(m,d,h,v),g.Ut.setDefaultValue(h,v,y,R,on.DefaultChangeValueType.Expression,cn,!0),delete g.vle)}c.Jyt(w,0)}for(;a[1];)C=(l=(w=a[1]).w3).pj(),h=w.row,l.getRowExpression&&(d=l.getRowExpression(h))&&l.SB&&(m=l.getSource(),l.SB(h,-1,t.call(c,m,h,-1,d,n,i,r,e,f),sn,!0,X(h,i,C,n.id===m.id))),c.Jyt(w,1);for(;a[2];)C=(l=(w=a[2]).w3).pj(),v=w.column,l.getColumnExpression&&(d=l.getColumnExpression(v))&&l.SB&&(m=l.getSource(),l.SB(-1,v,t.call(c,m,-1,v,d,n,i,r,e,f),sn,!0,X(v,i,C,n.id===m.id))),c.Jyt(w,2);for(;a[3];)N=(j=a[3]).name,d=(l=j.w3).$yt(N),k=t.call(c,l.getSource(),0,0,d,n,i,r,e,f,{isNameID:!0}),l.twt(N,k),c.Jyt(j,3);for(I in a)if(3<(A=+I)&&a.hasOwnProperty(I))for(;a[I];)O=(E=a[I]).w3,d=t.call(c,O,0,0,E.expression,n,i,r,e,f),O.setExpression(E.id,E.name,d),c.Jyt(E,A)}},an.prototype.nwt=function(n){var t=this,i,r,e;P(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),t.qyt(n,S),l(n,S,0,0,0,0,0,0,!0,!1),K(n,S,0,0,!0,!1)},an.prototype.Wyt=function(n,t,i,r,e,f,o,u,V,s,c){var a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,j,y,N,k,y,a,I,A,E,O,M,S,F,D,l=this,h=Y,v=new T(t,i,r,e,f,o,u,V),p=(0,fn.createMap)();if(n&&Fn(n,v,s),rn(t,v,s),Z(t,v,s),R={},b=l.y3){for(;b[0];){if(d=(w=b[0]).w3,m=w.row,C=w.column,g=d.pj(),G(p,d,m,C));else{if(_=d.pB(m,C),x=d.getSource(),_)if(y=sn,c&&c[m+", "+C]&&(x=t,y={crossSheetMoved:!0}),_=h.call(l,x,m,C,_,v,s,y),y=void 0,(j=d.sT(m,C))&&!j.isDynamicArray)if(y=W(j),m===j.row&&C===j.col)for(R[y]=!0,N=m;N<m+j.rowCount;N++)for(k=C;k<C+j.colCount;k++)d.SB(N,k,_,j,N===m&&k===C,g),J(p,d,N,k,!0);else R[y]||(d.SB(m,C,_,j,!1,g),J(p,d,m,C,!0));else y=e.Mf,(a=null==(a=d.oT(m,C))?void 0:a.isDefault())&&(y.vle=a),d.SB(m,C,_,j,!0,g),a&&delete y.vle;else(d.getRowExpression&&d.getRowExpression(m)||d.getColumnExpression&&d.getColumnExpression(C))&&d.gF(m,C,1,1)}l.Jyt(w,0)}for(;b[1];)d=(w=b[1]).w3,m=w.row,g=d.pj(),d.getRowExpression&&(_=d.getRowExpression(m))&&d.ewt&&d.ewt(m,h.call(l,x,m,-1,_,v,s),sn,g),l.Jyt(w,1);for(;b[2];)d=(w=b[2]).w3,C=w.column,g=d.pj(),d.getColumnExpression&&(_=d.getColumnExpression(C))&&d.iwt&&d.iwt(C,h.call(l,x,-1,C,_,v,s),sn,g),l.Jyt(w,2);for(;b[3];)A=(I=b[3]).name,_=(d=I.w3).$yt(A),E=h.call(l,x,0,0,_,v,s),d.twt(A,E),l.Jyt(I,3);for(O in b)if(3<(M=+O)&&b.hasOwnProperty(O))for(;b[O];)D=(F=(S=b[O]).w3).getSource(),_=h.call(l,D,0,0,S.expression,v,s),F.setExpression(S.id,S.name,_),l.Jyt(S,M)}},an.prototype.Zyt=function(n,t,i,r,e,f){for(var o,u,s,c,a,l,h,v,o=this,u=t+r,s=i+e,l=t;l<u;l++)if(n.dataTable[l])for(h=i;h<s;h++)c=n.rwt(l,h),a=n.pB(l,h),(c||a)&&(f?(c.oldRow=c.row,c.oldColumn=c.column,c.row=l,c.column=h):(o.Jyt(c,0),v=this.zCe(n,c,l,h),c&&a&&(c.row!==v.row||c.column!==v.column||c.isDefault())&&(v.oldRow=c.row,v.oldColumn=c.column,v.isDefault(c.isDefault())),c=v),o.Qyt(c,0))},an.prototype.zCe=function(n,t,i,r){var e,t;return t&&t.aT&&t[3]&&(e={aT:[3],3:t[3]}),n.owt(i,r,0),t=n.oT(i,r,!0),e&&(t[3]=e[3],t.aT=e.aT),t},an.prototype.awt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),f=n.uwt(e,!0),r.Qyt(f,2))},an.prototype.swt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),f=n.cwt(e,!0),r.Qyt(f,1))},an.prototype.fwt=function(n){for(var t,i,r,e,f,o,u,t=this,i=n.op().getAllSourceModels(),f=0;f<i.length;f++)if((o=i[f]).lwt)for(r=o.lwt(),u=0;u<r.length;u++)(e=r[u])&&e.isVolatile&&e instanceof fn.CellCalc&&!t.isAdjustCell(e)&&t.Qyt(e,0)},an.prototype.uFe=function(n,t,i,r,e){var n,f,n=n.getSource(),f;(n.iFe&&n.iFe()).eFe(t,i,r,e,function(n,t){n.ubt&&t.forEach(function(n){n.r_t()})})},an.prototype.onBeforeAddRemoveRows=function(n,r,t,e,f){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),e&&f?(n.b_t(r,0,f,i),n.mF(r,0,f,i),n.mF(r+f,0,t-r-f,i,sn,!0)):n.mF(r,0,t-r,i,sn,!0),n.hwt(r,t-r),P(n,r,-1,t-r,-1,e=!e&&an.SaveFormulaChanges?2:e))})},an.prototype.onAfterAddRemoveRows=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(r,0,e,i):t+=e,o.Zyt(n,r,0,t-r,i,!0),o.swt(n,r,t-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!0,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onAfterAddRemoveColumns=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(0,r,t,e):i+=e,o.Zyt(n,0,r,t,i-r,!0),o.awt(n,r,i-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!1,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onBeforeAddRemoveColumns=function(n,r,t,e,f){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),e&&f?(n.b_t(0,r,t,f),n.mF(0,r,t,f),n.mF(0,r,t+f,i-r-f,sn,!0)):n.mF(0,r,t,i-r,sn,!0),n.dwt(r,i-r),P(n,-1,r,-1,i-r,e=!e&&an.SaveFormulaChanges?2:e))})},an.prototype.onAfterRemoveName=function(n,t){var n=n.vwt(t,!1);n&&(n.updateListening(!0,!1),n.vyt(),n.updateListeningOnRemoved())},an.prototype.adjustFormulaOnRemoveName=Tn,an.prototype.invalidName=function(n,t){var i,n;t&&(n=(i=n.getCalcSourceModel()).vwt(t.toUpperCase(),!0))&&n.mB()},an.prototype.onAfterChangeTableColumn=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,i=this,u=i.y3;if(u)for(s=(0,fn.createMap)();u[0];){if(G(s,r=(c=u[0]).w3,e=c.row,f=c.column));else{if(o=r.pB(e,f),a=r.pj(),o)if(o=an.adjustExpressionOnChangeTableColumn(o,n,t,e,f),(l=r.sT(e,f))&&!l.isDynamicArray)for(l=(0,on.Ec)(e,f,l.rowCount,l.colCount),h=e;h<e+l.rowCount;h++)for(v=f;v<f+l.colCount;v++)r.SB(h,v,o,l,h===e&&v===f,a),J(s,r,h,v,!0);else r.SB(e,f,o,l,!0,a);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(c,0)}},an.adjustExpressionOnChangeTableColumn=function(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,o,u,s,f=an.adjustExpressionOnChangeTableColumn;if(9===n.type){if(o=n.value,u=n.value2,s=f(o,t,i,r,e),c=u&&f(u,t,i,r,e),o!==s||u!==c)return(0,fn.rbt)(n.operatorType,s,c)}else if(7===n.type){for(a=!1,l=[],h=0;h<n.arguments.length;h++)d=f(v=n.arguments[h],t,i,r,e),a=a||v!==d,l.push(d);if(a)return(0,fn.YJ)(n,l)}else if(10===n.type){if((o=n.value)!==(u=f(o,t,i,r,e)))return(0,fn.Ayt)(u)}else if(13===n.type){if(n=(s=n).offset(0,0,!0),s.ubt&&(n.ubt=s.ubt,-1===(h=s.abt.getColumnIndexInTable(s.ubt))))return fn.kyt;if(s.sbt&&(n.sbt=s.sbt,-1===(h=s.abt.getColumnIndexInTable(s.sbt))))return fn.kyt}return n},an.prototype.onAfterRemoveTable=function(n,t){for(var i,r,e,f,o,u,s,c,a,l,h,v,d,i=this,u=0;u<n.length;u++)(s=n[u]).eFe(function(n){n.r_t(),n.vyt()});if(c=i.y3)for(a=(0,fn.createMap)();c[0];){if(G(a,r=(l=c[0]).w3,e=l.row,f=l.column));else{if(o=r.pB(e,f))if(o=an.adjustExpressionOnRemoveTable(o,n,e,f,t),(h=r.sT(e,f))&&!h.isDynamicArray)for(h=(0,on.Ec)(e,f,h.rowCount,h.colCount),v=e;v<e+h.rowCount;v++)for(d=f;d<f+h.colCount;d++)r.SB(v,d,o,h,v===e&&d===f),J(a,r,v,d,!0);else r.SB(e,f,o,h,!0);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(l,0)}},an.adjustExpressionOnRemoveTable=function(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,o,u,m,C,_,p,g,f=an.adjustExpressionOnRemoveTable;if(9===n.type){if(o=n.value,u=n.value2,s=f(o,t,i,r,e),c=u&&f(u,t,i,r,e),o!==s||u!==c)return(0,fn.rbt)(n.operatorType,s,c)}else if(7===n.type){for(a=!1,l=[],h=0;h<n.arguments.length;h++)d=f(v=n.arguments[h],t,i,r,e),a=a||v!==d,l.push(d);if(a)return(0,fn.YJ)(n,l)}else if(10===n.type){if((o=n.value)!==(u=f(o,t,i,r,e)))return(0,fn.Ayt)(u)}else if(13===n.type)for(m=n,h=0;h<t.length;h++)if(m.baseTable===t[h])return e?fn.kyt:(C=m.getRange(-1===i?0:i,-1===r?0:r,!0),_=-1===i||1===m.referencePortions(),p=1===C.rowCount&&1===C.colCount,g=m.source,p?(0,fn.knt)(g,cn,_?C.row-i:C.row,C.col,_,!1):(0,fn.lJ)(g,cn,_?C.row-i:C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1,_,!1,_,!1));return n},an.SaveFormulaChanges=!1,i=an,n.CalcOperatorAdjustor=i,(o=fn.CalcService.prototype).mwt=function(){return new i},(t=m=m||{}).outToOut="0_0",t.outToCover="0_1",t.outToInside="0_2",t.outToPart="0_3",t.outToCross="0_4",t.outNoMove="0_9",t.coverToOut="1_0",t.coverToCover="1_1",t.coverToCross="1_4",t.coverNoMove="1_9",t.insideToOut="2_0",t.insideToInside="2_2",t.insideToPart="2_3",t.insideToCross="2_4",t.insideNoMove="2_9",t.partToOut="3_0",t.partToInside="3_2",t.partToPart="3_3",t.partToCross="3_4",t.partNoMove="3_9",t.crossToOut="4_0",t.crossToCover="4_1",t.crossToInside="4_2",t.crossToPart="4_3",t.crossToCross="4_4",t.crossNoMove="4_9",n.adjustFormulaOnMoveSwap=Y},"./dist/plugins/sheetsCalc/parser-sheets.js":function(V,d,n){var t,v,b,A,m,x,R,y,i,n,r,w,C,j,a,_,T,o,u,c,Y,l,e,f,n,n,s,h;function L(n){return i(n+1).split("")}function p(n,t){var i=t+1;return n<0?n%i+i:t<n?n%i:n}function X(n){return new A.ErrorSource(n)}function J(n,t,i,r,e,f,o){return 3===o||0<=i&&0<=r||1===o&&0<=i||2===o&&0<=r}function G(n,t,i,r,e){var f,f,o,o,o,f=x.BAND_INDEX_CONST,f={Ky:f,iw:f,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},o=t?$(n,i,r,0):U(n,0,e);if(o.DX?(f.Ky=o.Mwt,f.gwt=o.Cwt):(f.iw=o.Mwt,f.pwt=o.Cwt),f.ywt=o.ywt,f.bwt=o.bwt,o.bwt&&!(o.ywt>=n.length)){if(!t&&o.DX||t&&!o.DX)return{bwt:!1};if(o=n[f.ywt],(t||!(0,A.isNumber)(o)&&"$"!==o)&&(!t||"C"!==o&&"c"!==o))return{bwt:!1};o=t?$(n,i,r,f.ywt):U(n,f.ywt,e),f.ywt=o.ywt,!o.bwt||!t&&!o.DX||t&&o.DX?f.bwt=!1:(f.ywt<n.length&&(f.wwt=!1),t?(f.iw=o.Mwt,f.pwt=o.Cwt):(f.Ky=o.Mwt,f.gwt=o.Cwt),f.bwt=!0)}return f}function P(n){return(0,A.Swt)(n)||95===n.charCodeAt(0)}function H(n,t,i){for(var r=n,e=t[n],n=!1;r<i&&!P(e);)++r<i&&(e=t[r]);if(r<i){for(;r<i&&P(e);)++r<i&&(e=t[r]);r<i&&(n=!0)}return n}function U(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,r={Cwt:!0,bwt:!1},e=n.length;if(!(e<=t||("$"===n[t]&&(r.Cwt=!1,t++),e<=t)))if(u=n[f=t],(o=0,A.isNumber)(u)&&"0"!==u){for(r.DX=!0;f<e&&(0,A.isNumber)(u);)++f<e&&(u=n[f]);if(7<f-t)return r;for(s=f-1,c=0;t<=s;s--,c++)o+=(n[s].charCodeAt(0)-48)*_[c];if(o<=d.maxRowCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}else if((0,A.Swt)(u)){for(r.DX=!1;f<e&&(0,A.Swt)(u);)++f<e&&(u=n[f]);if(3<(a=f-t)||H(f,n,e))return r;for(h=l=f-1;t<=h;h--){if(!(65<=(v=n[h].charCodeAt(0))&&v<=90||97<=v&&v<=122))return r;o+=((32|v)-96)*w[l-h]}if(o<=d.maxColumnCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}return r}function $(n,t,i,r){var e,f,o,u,s,c,a,t,e,f={ywt:r,Mwt:x.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},o=n.length;if(!(o<=r)){if("R"===(s=n[u=r])||"r"===s)f.DX=!0,c=t;else{if("C"!==s&&"c"!==s)return f;f.DX=!1,c=i}if(u++,o<=++r)f.ywt=r,f.Mwt=c,f.Cwt=!0,f.bwt=!0;else if("["===(s=n[u])&&(r++,u++,f.Cwt=!0),!(o<=r||(a=!1,s=n[u],f.Cwt&&"-"===s&&(r++,u++,a=!0),o<=r)))if(s=n[u],(0,A.isNumber)(s)){for(;u<o&&(0,A.isNumber)(s);)++u<o&&(s=n[u]);if(t=parseInt(n.slice(r,u).join(""),10),f.Cwt){if(o<=u||"]"!==n[u])return f;u++}t<=(f.DX?d.maxRowCount:d.maxColumnCount)&&(f.Mwt=f.Cwt?(t=a?-t:t)+c:t-1,f.ywt=u,f.bwt=!0)}else if(!f.Cwt)f.ywt=r,f.Mwt=c,f.Cwt=!0,f.bwt=!0}return f}function B(n,t,i,r){var e,f,o,u,e=n.row||0,f=n.column||0,o=i.type;if(i.source){if(!(u=q(n,r,i.source,i.endSource)))return void r.push("#","R","E","F","!")}else!i.source&&n.addSheetName&&1===o&&(2===n.addSheetName?r.push("!"):q(n,r,n.source,C));8===o||5===o?i.value2?r.push(i.value2.name):r.push(i.value.toString()):i.value&&i._error?r.push(i.value.toString()):i.hmt()?g(n.useR1C1,e,f,i.row,i.column,i.rowRelative,i.columnRelative,r):W(n.source,n.useR1C1,e,f,i.row,i.column,i.endRow,i.endColumn,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative,r,i.Tyt())}function g(n,t,i,r,e,f,o,u,s){var c,c,c=d.maxRowCount-1;(0===(s=s||0)||1===s)&&-c<r&&r<=2*c&&(r=p(r+=f?t:0,c)),c=d.maxColumnCount-1,J(t,i,r,e=(0===s||2===s)&&-c<e&&e<=2*c?p(e+=o?i:0,c):e,f,o,s)?n?2!==s&&(u.push("R"),0<=r&&(t!==r||!f)&&(f?u.push("["+(r-t)+"]"):u.push(++r+"")),e<0)||1!==s&&(u.push("C"),i===e&&o||(o?u.push("["+(e-i)+"]"):u.push(++e+""))):(0<=e&&(o||u.push("$"),u.push.apply(u,L(e))),r<0||(r++,f||u.push("$"),u.push(r+""))):u.push(A.Errors.Reference.toString())}function W(n,t,i,r,e,f,o,u,s,c,a,l,h,v){3===(v=v||0)&&(e=0,o=d.maxRowCount-1,v=1),g(t,i,r,e,f,s,c,h,v);var s=x.BAND_INDEX_CONST;t&&e===o&&f===u&&(o===s||u===s)||o===s&&u===s||(h.push(":"),g(t,i,r,o,u,a,l,h,v))}function q(n,t,i,r){if(n.getExternalSourceToken){if(i){var i=(0,A.Mge)(n,n.getExternalSourceToken(i).split(""),r&&n.getExternalSourceToken(r).split(""));if(!(0<i.length))return!1;t.push.apply(t,i)}return t.push("!"),!0}return!1}function N(n){var t=new A.Expression(8);return t.value=n,t}function z(n){var t=n;return t=n&&3<=n.length&&"["===n[0]&&"0"===n[1]&&"]"===n[2]?3===n.length?"":n.substring(3):t}function K(n,t,i){var r,n,e,f,o,u,n=n.source;return r=n&&(e=n.G3,f=n.S8,o=n.T8,e)&&(u=0<=t&&t<f&&o<=i||f<=t&&0<=i&&i<o)?n:r}function k(){return f.call(this,8e3)||this}function Q(n,t,i,r,e){return 0===t.uit&&0===t.Twt||!r&&0===t.uit&&4===t.Twt&&(!e||i<n.length-2&&":"===n[i+1].Awt&&0===n[i+2].uit&&4===n[i+2].Twt)}function Z(n,t,i,r,e){return t<=n.startRow()&&i<=n.startColumn()&&t+r>n.endRow()&&i+e>n.endColumn()}function I(){return s.call(this,13)||this}function nn(n,t){this.abt.Iwt(n,this,t)}function E(){return h.call(this,7900)||this}function tn(n,t,i){var r,e,f,i,o,u,o,s,c,a,l,h,v,v,d,r=i,e=0,f=t[e],i=hn(n,t,e,f),o=i.nM;if(!o){if(u=n.keepUnknownFormulas)return;S()}for(r.baseTable=o,e=i.xwt,f=t[++e],o=e;" "===f;)f=t[++e];for("@"!==f&&"["!==f&&(f=t[e=o]),a=c=!(s=1),l=t.length;0!==s&&e<l;)if("["===f&&(s++,f=t[++e]),"#"===f)c&&s<=1&&S(),v=(h=ln(t,e,f,s)).Nwt,e=h.xwt,f=h.kwt,s=h.Dwt,c?2===r.hbt&&3===v||2===v&&3===r.hbt?r.hbt=6:3===r.hbt&&8===v||3===v&&8===r.hbt?r.hbt=12:S():r.hbt=v,c=!0;else if("@"===f){for((1<s||c)&&S(),c=!0,r.hbt=1,f=t[++e];" "===f;)f=t[++e];"["===f&&"#"===t[e+1]&&"this row"===O(t,e+2,e+10).toLowerCase()&&(c=!1),","===f&&S()}else{for(v=e;!y(f)&&"]"!==f&&"["!==f;)if("'"===f&&e++,","===f){for(f=t[++e],d=e;" "===f;)f=t[++e];if("["===f){e=d,f=",";break}}else f=t[++e];if(v<e&&((a||"["===f&&1<s)&&S(),e=(h=rn(r,t,e,f,s,v)).xwt,f=h.kwt,s=h.Dwt,a=!0),"]"===f){if(0===--s)break;e>=t.length&&S(),f=t[++e]}","===f&&(f=t[++e])}c||(r.hbt=n._wt?1:16),a||(r.lbt=1)}function O(n,t,i){return n.slice(t,i).join("")}function rn(n,t,i,r,e,f){var o,u,s,c,a,l,h,h,f,v,h,o=n,u=[],c=!1,a=!1;if(1<e)c=!0,e--,u=t.slice(f,i),":"===(r=t[++i])&&(a="["===(r=t[++i]),s=(h=cn(t,i,r,e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt);else if("["===r){for(a=!0,r=t[l=i-1];" "===r;)r=t[--l];":"!==r&&S(),u=en(u=t.slice(f,l)),s=(h=cn(t,i,r=t[i],e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt}else o.hbt!==C&&16!==o.hbt||(c=!0),0<(l=(h=t.slice(f,i)).indexOf(":"))?(u=h.slice(0,l),"["!==(s=h.slice(l+1))[0]&&S()):u=h;if(f=on(o,u,c),o.ubt=u.join(""),o.sbt=o.ubt,s?(v=on(o,s,a),o.lbt=4,o.sbt=s.join("")):(v=f,o.lbt=2),v<f&&(h=f,f=v,v=h),o.ubt=n.abt.getColumnName(f),o.sbt=n.abt.getColumnName(v),++i<t.length)for(r=t[i];" "===r;)r=t[++i];return{xwt:i,kwt:r,Dwt:e}}function en(n){for(var t=n.length-1;0<=t&&" "===n[t];)t--;for(;0<=t&&" "!==n[t];)t--;return 0<=t?n.slice(t+1,n.length-t-1):n}function fn(n){for(var t=0,i=n.length,r=0;t<i&&" "===n[t];)t++;for(r=t,t=i-1;r<t&&" "===n[t];)t++;return r<=t?n.slice(r,t+1):n}function on(n,t,i){var r,e,f,i;if(t&&un(t,i)){for(r=[],e=0,f=t.length;e<f;e++)"'"===t[e]&&e<f-1&&e++,r.push(t[e]);return t=r,(i=n.abt.getColumnIndexInTable(t.join("")))<0&&S(),i}return-1}function un(n,t){var i,r,e;if(t)return 1;if(i="","#"!==(r=i=n[0])&&"@"!==i&&" "!==i&&","!==i&&":"!==i&&"["!==i&&"]"!==i){for(e=1;e<n.length;e++){if(","===(i=n[e])||":"===i||"["===i&&"'"!==r||"]"===i&&"'"!==r||"@"===i&&"'"!==r||"#"===i&&"'"!==r)return;r=i}return 1}}function M(n){for(var t,i,r,t=[],r=0;r<n.length;r++)"["!==(i=n[r])&&"]"!==i&&"@"!==i&&"#"!==i&&"'"!==i||t.push("'"),t.push(i);return t.join("")}function sn(n){var t,i,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return 1;for(i=1;i<n.length;i++)if(" "===(t=n[i])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return 1}function cn(n,t,i,r){var e,f,f,e=!1;if("["===i)for(e=!0,r++,i=n[++t];" "===i;)i=n[++t];for(f=t;"]"!==i&&(","!==i||1<r);)"'"===i&&t++,i=n[++t];return t<=f&&S(),f=n.slice(f,t),1<r&&r--,{sbt:f=e?f:fn(f),xwt:t,kwt:i,Dwt:r}}function an(n){var t,i,t=(0,A.getMapping)()&&(0,A.getMapping)().tableFunctionsMapping;if(!y(t))for(i in t)if(t[i].toLowerCase()===n)return i.toLowerCase();return n}function ln(n,t,i,r){for(var e,f,o,u,s,c,e=14,f=t;"]"!==i;)"'"===i&&t++,i=n[++t];for(o=an(o=O(n,f,t).toLowerCase().trim()),u=!1,s=0;s<a.length;s++)if(o===(c=a[s])){e=l[o],u=!0;break}if(u||S(),++t>=n.length)r--;else{for(i=n[t];" "===i;)i=n[++t];if(","===i){for(r<=1&&S(),i=n[++t];" "===i;)i=n[++t];"["===i&&(r++,i=n[++t])}1<r&&r--}return{Nwt:e,xwt:t,kwt:i,Dwt:r}}function hn(n,t,i,r){for(var e,f,o,u,f=0,o=t.length;"["!==r&&i<o;)r=t[++i];return{nM:e=0<i?(u=O(t,0,i),n.getTableByName(u)):n.getTableByIndex(n.row,n.column)||n.source.lFe,xwt:i,kwt:r}}function S(){throw r().Exp_FormulaInvalid}function vn(n,t,i){var r,e,f,o,u,s,c,r=(0,A.getMapping)()&&(0,A.getMapping)().tableFunctionsMapping,e=(0,A.sR)().d2t,f=r?r["#All"]:e.All.name,o=r?r["#This row"]:e.thisRow.name,u=r?r["#Headers"]:e.Headers.name,s=r?r["#Data"]:e.Data.name,c=r?r["#Totals"]:e.Totals.name;switch(n){case 1:return i?"["+o+"]":"@";case 2:return t?"["+u+"]":u;case 3:return t?"["+s+"]":s;case 8:return t?"["+c+"]":c;case 6:return"["+u+"], ["+s+"]";case 12:return"["+s+"], ["+c+"]"}return t?"["+f+"]":f}function dn(n,t){var i,r,e,f,o,u,s,c,i,a,l;for(n.unshift(new A.FormulaToken("=",1,0,0,0)),f=[],o=0,e=n.length-1;0<e;e--)n[e].lp===n[e-1].lp&&n[e].Awt===n[e-1].Awt||(f[o]=n[e],o++);for(f[o]=n[e],f.reverse(),u=[],c=s=0;c<f.length;c++,s++)r=wn(f[c]),u[s]=f[c],(i=c+1<f.length?f[c+1].lp:t.length)>f[c].lp+r&&(i=new A.FormulaToken(t.slice(f[c].lp+r,i),7,f[c].lp+r),f[c].ywt=f[c].lp+r-1,u[++s]=i);for(a=0;a<u.length;a++)l=u[a].Awt.trim(),3===u[a].Twt?u[a].Awt='"'+u[a].Awt+'"':"("===l||"{"===l?(u[a].uit=1,u[a].Twt=1):")"!==l&&"}"!==l||(u[a].uit=1,u[a].Twt=2);return u}function wn(n){return 1===n.uit&&"ARRAY"===n.Awt?1:0===n.uit&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n.uit&&12===n.Twt?n.Awt.length+3:n.Awt.length}function F(n,t,i){var t,r;n&&t&&((r=n[t=t.getName&&t.getName()||"!"])||(r=n[t]=[],n.sheets||(n.sheets=[]),n.sheets.push(t)),r.push(i))}function D(n,t,i,r,e,f){var o,u,o,s;if(n){for(;10===n.type;)n=n.value;if(!(2<=(n=12===n.type?n.value:n).type&&n.type<=6))if(1===n.type)o=n.getRange(e,f),!r.source||n.source&&n.source!==r.source||t.push(o),F(i,n.source||r.source,o);else if(13===n.type)o=n.getRange(e,f),n.source===r.source&&o&&t.push(o),F(i,n.source||r.source,o);else if(8===n.type)n.jwt||(n.jwt=!0,o=j,n.source?n.source.op()&&(o=new A.EvaluateContext(n.source,(0,A.eV)(e,f))):o=r,D(o.getName(n.value),t,i,o,e,f),n.jwt=C);else if(9===n.type)D(n.value,t,i,r,e,f),n.value2&&D(n.value2,t,i,r,e,f);else if(7===n.type)for(s=0;s<n.arguments.length;s++)D(n.arguments[s],t,i,r,e,f)}}function mn(n,t,i,r,e,f,o,u,s){var f,t,c,a;n.setParserOption(f),f=[],t=t.split(""),y(s)&&(s=v.SheetArea.viewport);try{c=!!u||i.op().useR1C1,a=i.Uw(s).getParserContext(!o&&c,(0,A.eV)(r,e),{sheetArea:s}),f=n.parseToTokens(a,t,!1)}catch(n){}return Cn(n,f=dn(f,t),t,i,r,e,o,u,s)}function Cn(n,t,i,r,e,f,o,u,s){var c,a,l,h,u;return void 0===s&&(s=v.SheetArea.viewport),a=C,l=r.Uw(s),h=r.op(),u=!!u||h.useR1C1,h?(c=new m.SheetParserContext(r,!o&&u,(0,A.eV)(e,f),{sheetArea:s}),a=new A.EvaluateContext(l,(0,A.eV)(e,f),!1)):c=new A.ParserContext(j,!1,(0,A.eV)(0,0)),c.ignoreError=!0,_n(n,l,c,a,t,i,e,f)}function _n(n,t,i,r,e,f,o,u){for(var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,s=[],a=0;a<e.length;a++)try{if("["===(c=e[a]).Awt||"#"===c.y4[0]||3===c.Twt)s.push({index:c.lp,endIndex:c.ywt,text:c.Ewt||c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt});else if(a=pn(n,i,e,a,l=[]),d=v=h=void 0,0<l.length){for(w=0;w<l.length;w++)if((m=l[w])instanceof A.FormulaToken)s.push({index:m.lp,endIndex:m.ywt,text:f.slice(m.lp,m.ywt+1).join(""),type:m.uit,subType:m.Twt,canDrag:h,ranges:[],value:m.Awt});else if(m.WK){if(_=(C=m.WK).type,p=C.source,g=f.slice(m.lp,m.ywt+1).join(""),b=[],x={},h=!0,R=C.getRange&&C.getRange(o,u),8===_)d=v=!(h=!1),r&&(y=r,D(j=(y=C.source?new A.EvaluateContext(C.source,(0,A.eV)(o,u),!1):y).getName(C.value),b,x,r,o,u));else if(13===_||22===_)d=!(h=!1),p&&t&&p.Mf===t.Mf&&R?b.push(R):b=null,F(x,p,R);else if(1===_)if(d=!0,C.endSource)for(k=C.endSource,I=p.getSources(k),w=0;w<I.length;w++){if(I[w]===t){b.push(R);break}F(x,I[w],R)}else F(x,p||t,R),(!p||t&&p.Mf===t.Mf)&&b.push(R);else d=!1,b=null;b&&0<b.length||d?s.push({index:m.lp,endIndex:m.ywt,text:g,type:0,subType:7,canDrag:h,ranges:b,value:g,sheetRanges:x,sheetArea:p&&p.nT||t.nT,isName:v}):s.push({index:m.lp,endIndex:m.ywt,text:g,type:c.uit,subType:c.Twt,canDrag:h,ranges:b,value:g,sheetRanges:x,isName:v})}}else s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}catch(n){s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}return s}function pn(n,t,i,r,e){var f,n,t,n,o,o,i,f=i[r];return f&&"function"!=typeof f&&0===f.uit&&(t=n.resolveToken(t,i,n=[],r)-1,1===(o=(n=n[0]).type)||13===o||8===o||5===o||22===o&&n.source)?(o=i[t],i={lp:f.lp,ywt:o.ywt,WK:n},e.push(i),t):r}t=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(d,"__esModule",{value:!0}),d.getExpressTokenImp=d.Vgt=d.fillBlankToTokens=d.getValidaColumnName=d.StructureReferenceResolver=d.obt=d.StructReferenceColumnSpecifier=d.StructReferencePortions=d.SheetReferenceResolver=d.validateSheetName=d.maxColumnCount=d.maxRowCount=void 0,v=n("Core"),b=n("Common"),A=n("CalcEngine"),m=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),x=n("./dist/plugins/sheetsCalc/calc.ns.js"),R=n("./dist/plugins/sheetsCalc/external-reference.js"),y=b.Common.lt.ht,i=v.util.Vf,n=new b.Common.ResourceManager(v.SR),r=n.getResource.bind(n),d.maxRowCount=v.XmlConstants.Io,d.maxColumnCount=v.XmlConstants.xo,w=[1,26,676],C=void 0,j=null,a=["#all","#data","#headers","#totals","#this row"],_=[1,10,100,1e3,1e4,1e5,1e6,1e6],d.validateSheetName=A.Cmt,f=A.TokenResolver,t(k,f),k.prototype.resolveToken=function(n,t,i,r){var e,f,o,u,s,c,a,l,h,v,d,w,l,m,C,w,C,h,l,m,h,w,l,_,p,g,e=n.useR1C1,f=n.row||0,o=n.column||0,s=i.length,c=i[r],a=c.Awt,l=c.uit,h=c.Twt;if(0!==l&&6!==h)return!1;if(0===l&&0===h&&r<s-2&&":"===i[r+1].Awt&&12===i[r+2].Twt&&i[r+2].Awt.indexOf(":")<0||0===l&&12===h){if(m=l=void 0,C=a.lastIndexOf(":"),w=a.lastIndexOf("]"),(a=b.Common.zf.fJ(a,"'")&&b.Common.zf.dT(a,"'")?a.substring(1,a.length-1):a)&&(w<C?(l=a.substring(0,C-1),m=a.substring(C)):("'"===(l=a).charAt(0)&&(l=l.substring(1,l.length-1)),0===h&&(m=i[r+2].Awt,r+=2,"'"===m.charAt(0))&&(m=m.substring(1,m.length-1)))),r++,w=!!l,(l=z(l))&&(v=(v=n.getExternalSource("",l))||X(l),m=z(m))&&(v instanceof R.ExternalSource?(d=v.getPeerSource(m)).Dfe=!0:d=(d=n.getExternalSource("",m))||X(m)),(c=i[r])&&"["===c.y4[0])return!1;if(!c)return N(a);a=c.Awt}if(C=r===s-1?j:i[r+1],Q(i,c,r,e,!0)){if(h=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(l=G(c.y4,e,f,o,h)).bwt&&!w)return!1;if(c.Twt=7,l.bwt&&l.wwt){if(m=l.Ky,h=l.iw,w=l.gwt,l=l.pwt,r<s-2&&5===C.uit&&":"===C.Awt&&Q(i,C=i[r+2],r+2,e,!1)&&(_=G(C.y4,e,f,o)).bwt&&m===x.BAND_INDEX_CONST==(_.Ky===x.BAND_INDEX_CONST)&&h===x.BAND_INDEX_CONST==(_.iw===x.BAND_INDEX_CONST))return f=m===x.BAND_INDEX_CONST?0:f,o=h===x.BAND_INDEX_CONST?0:o,{index:r+3,expr:(0,A.lJ)(v,d,m-(w?f:0),h-(l?o:0),_.Ky-(_.gwt?f:0),_.iw-(_.pwt?o:0),w,l,_.gwt,_.pwt,f,o)};if(m===x.BAND_INDEX_CONST||h===x.BAND_INDEX_CONST){if(e)return m-=m!==x.BAND_INDEX_CONST&&w?f:0,h-=h!==x.BAND_INDEX_CONST&&l?o:0,{index:r+1,expr:(0,A.lJ)(v,d,m,h,m,h,w,l,w,l,f,o)};if(!v)return!1;u=N(a)}if(!u)return y(v)&&(v=K(n,f,o)),{index:r+1,expr:u=(0,A.knt)(v,d,p=m-(w?f:0),g=h-(l?o:0),w,l)}}else u=N(a)}else if(6===c.Twt)(u=new A.Expression(5)).value=A.CalcError.parse(c.Awt);else{if(!v||1===c.uit)return!1;u=N(a)}return v&&(u.source=v),d&&(u.endSource=d),{index:r+1,expr:u}},k.prototype.unparse=function(n,t,i,r){var e=i&&i.type;return(1===e||8===e||5===e)&&(B(n,t,i,r),!0)},d.SheetReferenceResolver=k,(n=o=d.StructReferencePortions||(d.StructReferencePortions={}))[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific",(n=u=d.StructReferenceColumnSpecifier||(d.StructReferenceColumnSpecifier={}))[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange",s=A.Expression,t(I,s),I.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(I.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),I.prototype.fHe=function(){var n=this.abt.jHe(this.ubt);return-1===n?0:n},I.prototype.columnReferenceStart=function(){return this.fHe()+this.abt.startColumn()},I.prototype.lHe=function(){var n=this.abt.jHe(this.sbt);return-1===n?this.abt.Tx:n},I.prototype.columnReferenceEnd=function(){return this.lHe()+this.abt.startColumn()},I.prototype.referencePortions=function(){return this.hbt},I.prototype.referenceColumnSpecifier=function(){return this.lbt},I.prototype.getRange=function(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,d,e,r=this,e=r.abt,l=e.startRow(),h=e.endRow(),v=e.hasTotalsRow(),d=e.hasHeadersRow();switch(r.hbt){case 3:case 16:f=d?l+1:l,u=v?h-1:h;break;case 2:if(d)u=f=l;else{if(!i)return j;u=f=l-1}break;case 8:if(v)u=f=h;else{if(!i)return j;u=f=h+1}break;case 1:l+=d?1:0,h-=v?1:0,u=f=n;break;case 6:f=l+(i&&!d?-1:0),u=v?h-1:h;break;case 12:f=d?l+1:l,u=h+(i&&!v?1:0);break;default:f=l+(i&&!d?-1:0),u=h+(i&&!v?1:0)}if(22===r.type){if(1===r.lbt)o=0;else if(o=r.abt.getColumnIndexInTable(r.ubt),s=r.abt.getColumnIndexInTable(r.sbt),-1===o||-1===s)return j}else o=r.columnReferenceStart(),s=r.columnReferenceEnd();return e=e.endColumn(),1===r.lbt&&(s=e),e<o||e<s?(r._error=!0,j):u<f||!i&&f<l||!i&&h<u?j:(0,A.Rwt)(f,o,c=u-f+1,a=s-o+1)},I.prototype.offsetWhenInsertRemoveColumn=function(n,t,i,r){var e,f,o,e=this,f=e.offset(0,0,!0);if(!i){if(e.ubt&&-1===(o=e.abt.getColumnIndexInTable(e.ubt)))return A.kyt;if(e.sbt&&-1===(o=e.abt.getColumnIndexInTable(e.sbt)))return A.kyt}return f.ensureSingle=e.ensureSingle,f.UFe=e.UFe,f},I.prototype.offsetWhenCopy=function(n,t,i,r,e,f,o,u,s,c){var t,a,l,h,v,i,r,e,f,d,w,a=this,l=new m.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,A.eV)(i,r)),h=l.getTableByIndex(i,r),v=a.offset();return h&&(i=i-e,r=r-f,e=o-e,f=u-f,d=void 0,(d=(n===t?l:w=new m.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,A.eV)(i,r))).getTableByIndex(i,r))!==h)&&d===a.abt&&Z(d,e,f,s,c)&&Z(h,o,u,s,c)&&(v.baseTable=h),null!=(t=n.Mf)&&t.$He&&v.Bwt(n.Mf.$He),v.ensureSingle=a.ensureSingle,v.UFe=a.UFe,v},I.prototype.Bwt=function(n){var t,i,n,t=this;2===t.lbt&&n&&((i=((i=t.abt.getColumnIndexInTable(t.ubt))+n)%(n=t.abt.endColumn()-t.abt.startColumn()+1))<0&&(i+=n),t.ubt=t.sbt=t.abt.getColumnName(i))},I.prototype.offset=function(n,t,i){var r,e,r=this,e=new I;return e.baseTable=r.baseTable,e.ubt=r.ubt,e.sbt=r.sbt,e.hbt=r.hbt,e.lbt=r.lbt,e.ensureSingle=r.ensureSingle,e.UFe=r.UFe,e},I.prototype.Lwt=function(n,t){var i=this.abt;return n>=i.startRow()&&t>=i.startColumn()&&n<=i.endRow()&&t<=i.endColumn()},c=I,d.obt=c,h=A.TokenResolver,t(E,h),E.prototype.resolveToken=function(n,t,i,r){var e,i,f,o,e,u,s,e,i,e=i[r],i=i[r+1];if(0===e.uit){if(o=f=void 0,0===e.Twt||7===e.Twt)f=e.Awt;else{if(12!==e.Twt||!i||0!==i.uit||0!==i.Twt||"["!==i.y4[0])return j;f=(e="'"===(e=e.Awt)[0]?e.substr(1,e.length-2):e)+i.Awt,o=!0}if("]"===f.charAt(f.length-1))try{return u=new c,tn(n,f.split(""),u),u.baseTable?(u.abt.Mf.NMi&&((s=u).type=22,s.Iwt=nn),o?{index:r+2,expr:u}:u):new A.Expression(0)}catch(n){}else if(e=n.getTableByName&&n.getTableByName(f))return i=E.create(e),e.Mf.NMi&&(i.type=22,i.Iwt=nn),i}return j},E.prototype.unparse=function(n,t,i,r){var i,e,f,o,u,s,t,c,o,f,e,f,o;if(13!==i.type&&22!==i.type)return!1;if(e=(i=i).abt.Gwt,f=y(e)?i.abt.tableName():e,n.Sbt)o=i.getRange(n.row,n.column,!0),B(n,t,u=(0,A.lJ)(i.source,j,o.row,o.col,o.row+o.rowCount-1,o.col+o.colCount-1,!1,!1,!1,!1),r);else{if(t=r.length,22===i.type&&i.baseTable.Mf.xT)s=!0;else if(16===i.hbt&&1===i.lbt)return r.push(f),void(n.lyt&&r.push("[]"));(c=n.source===i.abt.source()&&i.Lwt(n.row,n.column))&&!n.lyt&&!i.abt.Mf.NMi||(o=y(e)?i.abt.tableName():e,(f=i.abt.Mf)&&f.NMi&&!(0,A.Cmt)(o.split(""))&&(o=(0,A.Mge)(n,o.split(""),null).join("")+"!"),r.push(o)),r.push("["),16!==i.hbt&&(e=vn(i.hbt,1!==i.lbt,n.lyt),r.push(e)),1!==i.lbt&&(1===i.hbt&&!n.lyt||16===i.hbt||(6===i.hbt||12===i.hbt?r.push(", "):r.push(",")),(f=i.ubt)?f=M(f):s=!0,s||(4===i.lbt?(o=i.sbt)?(o=M(o),r.push("[",f,"]:[",o,"]")):s=!0:1===i.hbt&&!n.lyt&&!sn(f)||16===i.hbt?r.push(f):r.push("[",f,"]"))),s?(r.length=t,r.push("#REF!")):r.push("]")}return!0},E.create=function(n,t,i,r,e){void 0===t&&(t=o.NotSpecific),void 0===i&&(i=u.NotSpecific);var f=new c;return f.baseTable=n,f.hbt=t,0<=r&&(f.ubt=n.getColumnName(r)),0<=e&&(f.sbt=n.getColumnName(e)),f.lbt=i,f},d.StructureReferenceResolver=E,d.getValidaColumnName=M,l={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},d.fillBlankToTokens=dn,d.Vgt=mn,d.getExpressTokenImp=_n},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/sheetsCalc/calc.ns.js"),t),e(i("./dist/plugins/sheetsCalc/parser-sheets.js"),t),e(i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),t),e(i("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),t),e(i("./dist/plugins/sheetsCalc/worksheet-formula.js"),t),i("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,t,i){var X,t,r,w,h,J,x,y,e,v,i,R,j,N,k,d,I,G,P,A,H,E,O,M,a,S,U,i;function F(n){n.forEach(function(n){var t;delete n.Uw().G3})}function m(n,c,a,l){X.GC$.each(n,function(n,t){var i,r,e,f,o,u,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.getComment(),u=t.getFormatter&&t.getFormatter(),t=t.getSheetTabName&&t.getSheetTabName();f&&(i={name:i,formula:s=u||c.unparse(a,f,r,e,!1,!0),sheetTabName:t,row:r,col:e},o&&(i.comment=o),l.push(i))})}function $(n,t){var n,i,r,n=I(n);if("str"===t)i=n;else if("b"===t)i="1"===n;else if("e"===t){switch(r=N,n){case"#DIV/0!":r=7;break;case"#N/A":r=42;break;case"#NAME?":r=29;break;case"#NULL!":r=0;break;case"#NUM!":r=36;break;case"#REF!":r=23;break;case"#VALUE!":r=15}i=r!==N?{error:n,code:r}:N}else i=n===N?N:parseFloat(n);return i}Object.defineProperty(t,"__esModule",{value:!0}),X=i("Core"),t=i("Common"),r=i("CalcEngine"),w=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),J=i("./dist/plugins/sheetsCalc/external-reference.js"),x=i("./dist/plugins/sheetsCalc/calc-extra-save.js"),y=i("./dist/plugins/sheetsCalc/worksheet-formula.js"),e=w.SpreadSource,v=t.Common.zf.Gmt,i=new t.Common.ResourceManager(X.SR),R=i.getResource.bind(i),j=void 0,N=null,k=t.Common.lt.ht,d=X.mt.o1,I=X.mt.c1,G=X.mt.xr,P=X.mt.go,A=X.Util.Sr,H=X.IndexHelper.$i,E=X.Util.mr,O=X.mt.n1,M=X.Util.io,a=X.mt.St,S=X.XFileConstants.mo,U=X.XFileConstants.Ki,(i=X.Workbook.prototype).Qp=function(n){var t,i,t=this,i=t.Lp;t.Lp=new r.CalcService,t.Lp.useR1C1=1===t.options.referenceStyle,t.Lp.allowDynamicArray=t.options.allowDynamicArray,t.Lp.iterativeCalculation=t.options.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Lp.calculationMode=t.options.calculationMode,t.Lp.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,n&&i&&t.Lp.cloneFrom(i),t.yC=new e(t),t.wC=t.Lp.getGlobalSourceModel(t.yC)},i.addCustomFunction=function(n){this.Uwt(n)},i.Uwt=function(n){if(!(n&&n instanceof r.Functions.Function))throw new Error(R().Exp_InvalidCustomFunction);n.name=v(n.name),this.Amt[n.name]=n},i.getCustomFunction=function(n){return n?this.Amt[v(n)]:j},i.removeCustomFunction=function(n){n&&delete this.Amt[v(n)]},i.clearCustomFunctions=function(){this.Amt={}},i.addCustomName=function(n,t,i,r,e,f){this.zwt(this.hyt,n,t,i,r,!1,e,f)},i.Vwt=function(n){return!this.hyt[v(n)]},i.isValidCustomName=function(n){return n&&X.mt.P0(n)&&this.Vwt(n)},i.pp=function(n,t,i,r,e,f,o,u){var s,c,s=this;if(!t||!i)throw new Error(R().Exp_InvalidCustomName);u&&s.Lp&&a(i)?(c=u.Ywt(i,r,e),n[v(t)]=new h.FormatterNameInfo(t,i,u.name(),c,r,e)):s.zwt(n,t,i,r,e,f,o)},i.zwt=function(n,t,i,r,e,f,o,u,s){var c,a,a,l,a,i,c=this;if(!t||!i||!f&&!c.isValidCustomName(t))throw new Error(R().Exp_InvalidCustomName);if(c.Lp){if(a=(a=(0,X.jf)(this))?a.Uw():N,l=void 0,f)try{l=c.Lp.parse(a,i,r,e,!1,!0,!0)}catch(n){}else l=c.Lp.parse(a,i,r,e);a=void 0,s?(a=s).SB(l,j,r,e):a=new h.NameInfo(t,l,r,e,o,u,c),n[v(t)]=a,l&&(0,y.addNameInName)(c,l,a),f||((i={})[t]=t,this.Zwt(i,!0))}},i.Wwt=function(n,t,i,r,e,f,o,u){var s,i,n,s=this;if(!t||!i||!o&&!s.isValidCustomName(t))throw new Error(R().Exp_InvalidCustomName);s.Lp&&(i=n[v(t)]=new h.NameInfo(t,r,e,f,u,j,s),r&&(0,y.addNameInName)(s,r,i),o||((n={})[t]=t,this.Zwt(n,!0)))},i.getCustomName=function(n){return n?this.hyt[v(n)]:j},i.qRe=function(t,i,n,r,e){var f,f,o,u,s,f,f,c,a,f,f,l,f,o=this;if(r=null!=r?r:0,e=null!=e?e:0,o.Lp){if(u=o.hyt[v(t)])if(s=void 0,n&&(f=(f=(0,X.jf)(this))?f.Uw():N,s=o.Lp.parse(f,n,r,e)),i&&t!==i){if(!o.isValidCustomName(i))throw new Error(R().Exp_InvalidCustomName);if(c=[],a=[],(f=o.hFe)&&f.forEach(function(n){n.forEach(function(n){n.value!==t||n.source||c.push(n),n.value!==i||n.source||a.push(n)})}),2===(f=null==(f=o.wC)?void 0:f.dFe(t,i,0<c.length,0<a.length)))throw new Error(R().Exp_CustomNameBothInUse);o.suspendCalcService(),(u=o.hyt[v(t)]).btV(i),delete o.hyt[v(t)],o.hyt[v(i)]=u,c.forEach(function(n){n.value=i}),o.wC.updateNameCalc(i,!0),s&&(l=o.hyt[v(i)],o.removeCustomName(i),o.zwt(o.hyt,i,n,r,e,!1,u.getComment(),u.isReadOnly(),l)),3!==f||s||((f={})[i]=i,this.Zwt(f,!0)),o.resumeCalcService()}else s&&(o.suspendCalcService(),l=o.hyt[v(t)],o.removeCustomName(t),o.zwt(o.hyt,t,n,r,e,!1,u.getComment(),u.isReadOnly(),l),o.resumeCalcService());null!=(f=(0,X.jf)(this))&&f.zw()}},i.xO=function(n){return n?this.bp[v(n)]:j},i.getCustomNames=function(){var i=[];return X.GC$.each(this.hyt,function(n,t){i.push(t)}),i},i.Qwt=function(){var i=[];return X.GC$.each(this.bp,function(n,t){i.push(t)}),i},i.removeCustomName=function(n){var t,i,t;n&&(i=this.hyt[v(n)],null!=(t=this.hFe)&&t.delete(i),delete this.hyt[v(n)],(t={})[n]=n,this.Zwt(t,!1))},i.o3=function(n){var t;n&&(delete this.bp[v(n)],(t={})[n]=n,this.Zwt(t,!1))},i.clearCustomNames=function(){var n,t,i,n=this.hyt;if(this.hFe)for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i=n[t],this.hFe.delete(i));this.hyt={},this.Zwt(n,!1)},i.getNameInfos=function(){return this.hyt},i.setNameInfos=function(n){k(n)||(this.hyt=n)},i.Kwt=function(){var n=this.bp;this.bp={},this.Zwt(n,!1)},i.Zwt=function(n,t){var i,r,n;if(n){for(r in i=this.wC,n)i&&i.updateNameCalc(r,t);this.Lp&&!this.Lp.IsSuspended()&&(n=this.getActiveSheet())&&(n.suspendPaint(),this.Lp.recalculateAll(!1),n.resumePaint()),this.ki(X.Events.CustomNameChangedInternal,{})}},i.calculate=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,d,n,i=this,r=i.op();if(r){switch(f=!(e=j),n){case X.CalculationType.rebuild:e=!0;break;case X.CalculationType.minimal:f=e=!1;break;case X.CalculationType.regular:e=!1}if(this.suspendPaint(),k(t)){if(r.suspend(!0),e)for(o=void 0,o=i.sheets||[],(0,y.resetCustomName)(i.hyt,N,r,i),(0,y.resetFormatStringCustomName)(i,i.bp,r),u=0;u<o.length;u++)for(c=(s=o[u]).Uw(),(0,y.resetCustomName)(s.hyt,c,r,i),l=(a=c.getCalcSourceModel()).getAllNodes(),h=0;h<l.length;h++)(d=(v=l[h]).calc)&&v.WK&&(0,y.adjustOneFormula)(r,d);r.resume(e,!f,!0)}else(s=i.getSheetFromName(t))?s.c3n(e,f):0<i.sheets.length&&(n=w.formulaToRanges(i.sheets[0],t,0,0,!0)[0]||w.formulaToRanges(i.sheets[0],t,0,0)[0])&&(s=i.getSheetFromName(n.sheetName)).c3n(e,f,n.ranges[0]);this.resumePaint()}},i.getCalcService=function(){return this.Lp},i.op=function(){return this.Lp},i.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},i.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},i.getCircularReference=function(){return this.Lp.MTe()},i.updateExternalReference=function(n,t,i,r){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,t,i,r),this.resumeCalcService(!1),this.resumePaint()},i.getExternalReferences=function(n){return this._p.myt(n)},X.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new J.ExternalReferenceManager},toJson:function(n){var t,i,i,s,i,r,e,c,t,a,t=this,i=t.Amt;X.GC$.isEmptyObject(i)||(n.customFunctions=i),i=t._p.toJSON(t),X.GC$.isEmptyObject(i)||(n.externalReference=i),s=[],i=[],r=t.getCustomNames(),e=t.Qwt(),c=t.Lp,t=(0,X.Sp)(this),a=t?t.Uw():N,r&&c&&(X.GC$.each(r,function(n,t){var i,r,e,f,o,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:u=c.unparse(a,f,r,e,!1,!0,2),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),s.push(i))}),m(e,c,a,i),0<s.length&&(n.names=s),0<i.length)&&(n.formatStringNames=i)},wh:function(n,t,o){var i,r,r,e,f,u,s,r,e,c,f,a,f,l,h,v,f,r,i=this,r=i.Amt;X.GC$.isEmptyObject(r)||(n.workbook.lossless.customFunctions=r),X.Util.ko(o)&&null!=o&&o.saveR1C1Formula&&(n.workbook.lossless.frc=1),i._p&&(e=(r=i._p.wh(n)).externalReferencesNode,f=r.externalLinks,0<(u=r.count))&&(n.workbook.c_.push(e),n.externalLinks=f),s=[],r=d(n.workbook,"definedNames"),e=i.getCustomNames(),c=i.Lp,f=(0,X.Sp)(this),a=f?f.Uw():N,f=i.yC,l=f&&f.getUsedCustomNames()||{},e&&0<e.length&&c&&(r||n.workbook.c_.push(r={n_:"definedNames",c_:[]}),h=r.c_,v=!o||!1!==o.includeUnusedNames,X.GC$.each(e,function(n,t){var i,r,e,t,f,i,t,i=t.getName(),r=t.getExpression(),e=t.isReadOnly(),t=t.getComment();r&&(v||l[i])&&(f=c.unparse(a,r,0,0,!1,!0,2),i=X.Util.Oge({name:i,comment:t,isReadOnly:e},f),o&&o.includeCalcModelCache&&(t=(0,x.exprToJSON)(r),s.push(t),i.e=s.length-1),h.push(i))})),0<s.length&&(n.workbook.lossless.exprs=s),f=[],(r=i.Qwt())&&0<r.length&&c&&(m(r,c,a,f),0<f.length)&&(n.workbook.lossless.formatStringNames=f),n.workbook.lossless.idMap=(0,x.dbt)(c)},preFromSJSFormat:function(n,V,T){var t,i,r,e,f,o,u,s,c,a,l,h,v,u,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,A,E,O,M,S,S,O,F,D,Y,L,t=G(n.workbook,"externalReferences"),i=n.externalLinks;if(t&&i&&t.c_&&0<t.c_.length){for(e in r={},i)if(i.hasOwnProperty(e)){if(f=i[e],o={},u=G(f,"externalBook")){if(c=[],(s=G(u,"sheetNames"))&&s.c_&&s.c_.length){for(a=0,l=s.c_.length;a<l;a++)(h=s.c_[a])&&(v=h.val)&&(v=X.mt.kfe(v),c.push(v));o.sheetNames=c}if(u=G(u,"sheetDataSet")){if(d={},w=P(u,X.XFileConstants.bo))for(m=0,C=w.length;m<C;m++)if(p=+(_=w[m]).sheetId,g=!!_.refreshError,b=d[v=c[p]]={},g&&(b.isNew=!0),x=P(_,"row"))for(R=0,y=x.length;R<y;R++)if((j=x[R])&&(k=b[N=j.r-1]=b[N]||{},I=P(j,"cell")))for(A=0,E=I.length;A<E;A++)M=void 0,(O=I[A])&&((S=O.r)&&(M=H(S)),S=O.t,F=void 0,(O=G(O,"v"))&&(F=$(O,S)),k[M]=F);o.data=d}}o.option=f.option,r[e]=o}for(D={},L=(Y=t.c_).length,a=0;a<L;a++)D[a+1]=r[Y[a][U]];this._p=new J.ExternalReferenceManager(D)}},yh:function(e,i,r){var f,t,o,u,n,s,c,a,l,h,v,d,w,m,C,C,_,p,g;function b(){var n,n;return t||(n=(n=(0,X.jf)(f)||f.sheets[0])?n.Uw():N,t=n&&n.getParserContext(!1)),t}if(o=(f=this).Lp,u=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2),o&&(o.suspend(),o.lb=u),f.clearCustomNames(),(s=f.sheets).forEach(function(n){n.Uw().G3=!0}),c=e.workbook.lossless,r&&(r.$wt=(0,x.vbt)(o,c)),(a=i.workbookNames)&&0<a.length&&a.forEach(function(n){var t=O(n.name),i=I(n),r=O(n.comment),e=n.isReadOnly;c&&c.exprs&&c.exprs[n.e]?f.Wwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+E(O(i)),(0,x.exprFromJSON)(c.exprs[n.e],b()),0,0,!0,r,!0):i&&f.zwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+E(O(i)),0,0,!0,r,e)}),f.Kwt(),l=c&&c.formatStringNames)for(h=0;h<l.length;h++)v=l[h],k(v.sheetTabName)&&f.pp(this.bp,v.name,v.formula,v.row,v.col,!0,v.comment,j,!0);if(f.clearCustomFunctions(),d=c&&c.customFunctions)for(w in d)d.hasOwnProperty(w)&&(m=d[w],C=(0,X.getTypeFromString)(m.typeName))&&((C=new C).fromJSON(m),f.Uwt(C));n||(_=[],p=e.workbook.rels&&e.workbook.rels.c_,(g=G(e.workbook,S).c_).forEach(function(n){var t,t,n,n,n,i,r,t=M(O(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=A(p,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],_.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){o&&(u?o.resumeWithoutCalc():o.resume(!1,!1,!o.calcOnDemand),delete o.lb),F(s)},[o,e,r],u?j:R().STEP.startCalc,function(){return u?X.STEP_RATE.end:X.STEP_RATE.loadFileData+X.STEP_RATE.parseFile+X.STEP_RATE.loadSheetDataWithCalc+X.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(e,i,r){var f,o,u,n,s,t,c,a,l,h,v,d,w,m,m,C,_,p,f=this,o=f.Lp,u=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2);if(o&&(o.suspend(),o.lb=u),f.clearCustomNames(),(s=f.sheets).forEach(function(n){n.Uw().G3=!0}),t=e.workbook.lossless,(c=i.workbookNames)&&0<c.length&&c.forEach(function(n){var t=O(n.name),i=I(n),r=O(n.comment),n=n.isReadOnly;i&&f.zwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+E(O(i)),0,0,!0,r,n)}),f.Kwt(),a=t&&t.formatStringNames)for(l=0;l<a.length;l++)h=a[l],k(h.sheetTabName)&&f.pp(this.bp,h.name,h.formula,h.row,h.col,!0,h.comment,j,!0);if(f.clearCustomFunctions(),v=t&&t.customFunctions)for(d in v)v.hasOwnProperty(d)&&(w=v[d],m=(0,X.getTypeFromString)(w.typeName))&&((m=new m).fromJSON(w),f.Uwt(m));n||(C=[],_=e.workbook.rels&&e.workbook.rels.c_,(p=G(e.workbook,S).c_).forEach(function(n){var t,t,n,n,n,i,r,t=M(O(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=A(_,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],C.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){var r;o&&(u?o.resumeWithoutCalc():(o.resume(!1,!1,!o.calcOnDemand),delete o.tMt,(r=f.getActiveSheet())&&r.zw()),delete o.lb),F(s)},[o,e,r])},preFromJson:function(n,t,i){this._p=new J.ExternalReferenceManager(n.externalReference)},fromJson:function(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,g,g,b,x,R,r=this,e=r.Lp,f=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(e&&(e.suspend(),e.lb=f),r.clearCustomNames(),c=[],s=n.sheets)for(l in s)"string"==typeof l&&(h=s[l],u=r.getSheetFromName(h.name||l))&&(u.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],r.zwt(this.hyt,(0,y.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(r.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&r.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(r.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),r.Uwt(g));if(s){for(l in o=0,s)"string"==typeof l&&(h=s[l],u=r.getSheetFromName(h.name||l))&&(c.push(u),u.nameFunctionsFromJSON(h,t,i),o++);for(a=c.length,o=0;o<a;o++)(u=c[o]).formulaFromJSON(s[u.name()],t,i)}for(e&&(f?e.resumeWithoutCalc():(e.resume(!1,!1,!e.calcOnDemand),delete e.tMt),delete e.lb),b=0,x=c;b<x.length;b++)delete(R=(u=x[b]).Uw()).G3},Yp:function(n,t,i){var u,s,c,r,a,e,l,f,o,h,v,d,w,m,C,_,p,g,g,u=this,s=u.Lp,c=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(s&&(s.suspend(),s.lb=c),u.clearCustomNames(),e=n.sheets,l=[],e)for(o in e)"string"==typeof o&&(h=e[o],a=u.getSheetFromName(h.name||o))&&(a.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],u.zwt(this.hyt,(0,y.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(u.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&u.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(u.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),u.Uwt(g));if(e){for(o in r=0,e)"string"==typeof o&&(h=e[o],a=u.getSheetFromName(h.name||o))&&(l.push(a),a.nameFunctionsFromJSON(h,t,i),r++);for(f=l.length,r=0;r<f;r++)(a=l[r]).formulaFromJSON(e[a.name()],t,i)}i.incrementLoadTask.addTask(function(n,t,i){var r,e,f,o;for(s&&(c?s.resumeWithoutCalc():(s.resume(!1,!1,!s.calcOnDemand),delete s.tMt,(r=u.getActiveSheet())&&r.zw()),delete s.lb),e=0,f=l;e<f.length;e++)delete(o=(a=f[e]).Uw()).G3},[s,n,i])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(r,n,t){var e,g,i,A,h,p,w,E,b,C,v,x,t,R,y,f,J,o,G,P,m,_,j,N,t,s;function u(n){return"="===n.charAt(0)}function H(n){var t,i;return{left:n.indexOf("["),right:n.indexOf("]")}}function U(n){var n=H(n),t=n.left,n=n.right;return 0<=t&&t<n}function $(n){var t=H(n),i=t.left,t=t.right,n=n.indexOf("@");return i<n&&n<t}function B(n){return u(n)&&$(n)}function W(n){return u(n)&&U(n)}function q(n,t){var i,r;if(n.NMi){if(W(t=t.trim()))return 1;if(0<=t.indexOf("{{")&&0<=t.indexOf("}}"))for(i=t.split(/{{|}}/),r=0;r<i.length;r++)if(W(i[r].trim()))return 1}}function z(n,t,i,r){return i===b&&(i=n.getActiveRowIndex()),n.NMi.nMt(t,i,r)}function K(n){return n.columnRelative}function Q(n){return n.endColumnRelative}function Z(n){return n.rowRelative}function nn(n){return n.endRowRelative}function k(n){return n.op()}function d(n){return n.toUpperCase()===f?o:n}function tn(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new h.SheetSource(n,g.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new h.SheetSource(n,g.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new h.SheetSource(n,g.SheetArea.viewport))}function rn(n,t){var n,i,n=n.Uw(),i;(n&&n.t8.jme(-1,-1,-1,-1)).forEach(function(n){n.isValid||(t.spillCells=t.spillCells||{},t.spillCells[n.minX+","+n.minY]=1)})}function c(n,t,i,r,e,f){var n=n.iT(t,i,r,e,f),t=n&&n.formulas;return t&&0<t.length}function en(n,t,i,r,e,f,o){var u=c(n,t,i,r,e,3);return!u&&f&&(e=n.getColumnCount(2),u=c(n,t,0,r,e,2)),!u&&o&&(r=n.getRowCount(1),u=c(n,0,i,r,e,1)),u}function fn(n){for(var t,i,r,e,f,t=[],i=[],r=0;r<n.length;r++)f=""+(e=n[r]).row+e.col+e.rowCount+e.colCount+e.sheetName,t.indexOf(f)<0&&(t.push(f),i.push(e));return i}function on(n,t){var n=n.formulaLoad/n.total;return t?.4*n+.5:.3*n+.4}function un(n,t,i,r,e,f){var o,u,s,c,a,c,a,o=r.Uw(),u=n&&n.formula;u&&(s=void 0,"object"==typeof u&&(c=r.b3(f),(a=r.Xbt[u.si]).baseRow===t&&a.baseColumn===i?(u=a.formula,a.$fe=!0):a.$fe?(s=c.pB(a.baseRow,a.baseColumn))?(s.aMt=u.si,r.Lp.tMt&&r.Lp.tMt[o.id+","+a.baseRow+","+a.baseColumn]&&(r.Lp.tMt[o.id+","+t+","+i]={id:o.id,row:t,col:i})):(u=a.formula,a.baseRow=t,a.baseColumn=i):(u=a.formula,a.$fe=!0,a.baseRow=t,a.baseColumn=i)),(c=n.arrayInfo)&&!c.isDynamicArray?r.uMt(t,i,j(c.rowCount,10),j(c.colCount,10),u,!0,f):(a=o.getCalcSourceModel(),c&&o.t8.Zme(c.row,c.col,c.rowCount,c.colCount,!c.isInvalid),r.zI(t,i,u,s,!0,f,!0,!c,b,!0),c&&a.Uyt(t,i,c)))}function I(n,t,i,r,e,f,o){var u,s,c,a,l,h,v,d,u,f,u=e&&e.incrementLoadTask;if(u&&!u.isTerminated){for(s=u.isBusyFunc,c=f=f||0,n.suspendPaint(),a=30,l=new Date;c<i;){if(h=t[c])for(v=0;v<r;v++)un(h[v],c,v,n,!0,o);if(c++,s&&s())break;if(30<(d=new Date)-l)break}n.resumePaint(),(u=(e=e||{})&&e.incrementalLoading)&&(u.loadStatus.formulaLoad+=c-f,f=on(u.loadStatus,e.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(g.Events.ProgressChanged,{loadStatus:u.loadStatus,progress:f,sheet:n}),u.loading)&&u.loading(f,{sheet:n}),c<i&&e.incrementLoadTask.pushTask(I,[n,t,i,r,e,c])}}function a(n,t,i,r,e){for(var f,o,u,f=0;f<i;f++)if(o=t[f])for(u=0;u<r;u++)un(o[u],f,u,n,!0,e)}function sn(n,t){var i,r,e,f,o,u;if(t)for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i])r.hasOwnProperty(e)&&(o=+i,u=+e,(f=r[e]).f)&&y(n.getValueIgnoreDefault(o,u))&&!n.getFormula(o,u)&&!n.getBindingPath(o,u)&&n.Ut.setDefaultValue(o,u,m(f.f),b,g.DefaultChangeValueType.Expression)}function cn(n,t,i,r,e,f,o){var u,s,c,s,a,l,h,v,d,h,h,u=n.Uw(),s=n.Ut,c=s.ap||0,s=s.fp||0;t===b||(a=m(t.f),l=t.g,(h=t.r)!==b&&(v=P(h).toJSON()),0<=l&&(a=(a&&(h={formula:a},v&&(h.lastRow=v.rowCount+v.row-1,h.lastColumn=v.colCount+v.col-1,h.baseRow=v.row,h.baseColumn=v.col,v=E),f[l]||(f[l]=h,f.nextIndex=Math.max(f.nextIndex,l+1))),{si:l}),(h=n.Xbt[a.si]).baseRow===i&&h.baseColumn===r?(a=h.formula,h.$fe=!0):h.$fe?(d=e.pB(h.baseRow,h.baseColumn))?(d.aMt=a.si,n.Lp.tMt&&n.Lp.tMt[u.id+","+h.baseRow+","+h.baseColumn]&&(n.Lp.tMt[u.id+","+i+","+r]={id:u.id,row:i,col:r})):(a=h.formula,h.baseRow=i,h.baseColumn=r):(a=h.formula,h.$fe=!0,h.baseRow=i,h.baseColumn=r)),y(a))||(1==+t.a&&v&&(v.isDynamicArray=!0,o)&&o.spillCells&&o.spillCells[i+","+r]&&(v.isInvalid=!0),a=_(a),v&&!v.isDynamicArray?c<=i&&r<s?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,2):i<c&&s<=r?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,1):c<=i&&s<=r&&n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,3):(v&&u.t8.Zme(v.row,v.col,v.rowCount,v.colCount,!v.isInvalid),!d&&o&&o.exprs&&o.exprs[t.x]&&(d=(0,w.exprFromJSON)(o.exprs[t.x],u.getParserContext(!1)),o.exprs[t.x].nw)&&(d.sMt=!0),c<=i&&r<s?n.zI(i,r,a,d,!0,2,!0,!v):i<c&&s<=r?n.zI(i,r,a,d,!0,1,!0,!v):c<=i&&s<=r&&n.zI(i,r,a,d,!0,3,!0,!v,b,!0),v&&e.Uyt(i,r,v)))}function O(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,o,o,s,c=(f&&f.incrementLoadTask).isBusyFunc,a=o=o||0;for(n.suspendPaint(),n.suspendCalcService(),h=30,(l=f.openMode===g.OpenMode.incremental)&&(v=new Date),d=n.Xbt=n.Xbt||{nextIndex:0},w=n.b3(3);a<i;){if(m=t[a])for(C=0;C<r;C++)cn(n,m[C],a,C,w,d,e);if(a++,!u&&c&&c())break;if(l&&(_=new Date,!u)&&30<_-v)break}n.resumeCalcService(),n.resumePaint(),f.loadStatus.formulaLoad+=a-o,l&&(o=f.loadStatus.formulaLoad/f.loadStatus.total,o=+(f.fullRecalc?.3*o+.5:.4*o+.6).toFixed(5),f.incrementLoadTask.progress)&&f.incrementLoadTask.progress({progress:o,sheetName:n.name(),step:x.I5(R().STEP.loadSheetFormula,[n.name()])}),a<i&&f.incrementLoadTask.pushTask(O,[n,t,i,r,e,f,a])}function an(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterFormula;t&&t.call(i,r,e,f)})}function ln(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterSJSFormula;t&&t.call(i,r,e,f)})}function hn(t,i,r,n,e,f){var o,u,s,c,a,l,h,v,o=g.Worksheet.fh,u=!1,s=[],c=n.getReferenceSheetNames(),a=t&&t.v2,l=function(n,t){return n[t]===b||0===n[t]},h=function(n){var r;c.hasOwnProperty(n)&&(u=!0,r=(0,g._f)(t,n),l(a.sheetsState,n))&&l(a.refSheetsState,n)&&r&&(a.refSheetsState[n]=1,a.getSheet(n,function(i){var n,n,n=r.NMi;n?(n.yh(i,e,f),y(i.order)||(n.E0i=i.order),(n=(0,g.Ip)(n,i.lossless.addition,t.dataManager()))&&s.push(n)):(r.yh(i,e,f,!0),y(i.order)||(r.E0i=i.order)),o&&C(o,function(n,t){t.refSheetLazyLoaded&&t.refSheetLazyLoaded.call(r,i,e,f)})}))};for(v in c)h(v);u&&o&&C(o,function(n,t){t.afterRefSheetLazyLoaded&&t.afterRefSheetLazyLoaded.call(i,r,e,f)}),0<s.length&&f&&f.fullRecalc&&Promise.all(s).then(function(){t.suspendPaint(),t.mp[0].Mf.recalcAll(!0),t.resumePaint()})}function M(n,t,i,r){var e,f,o,o;if(n)for(e in n)(o=(f=n[e]).WK)!==b&&(r&&r.hFe&&r.hFe.delete(f),o=i.unparse(t,o,0,0),f.WK=i.parse(t,o,0,0),r)&&S(r,f.WK,f)}function vn(n,t,i){var r,e,f,o,u,s,r=n.getActiveSheet();if(r&&t)for(e in t)t.hasOwnProperty(e)&&(o=D(r,(f=t[e]).Zc,f.FY,f.jpt),(u=f.WK)!==b)&&(n.hFe&&n.hFe.delete(f),s=r.Uw(),f.WK=i.parse(s,o,f.FY,f.jpt,!1,!0,!0),S(n,f.WK,f))}function S(n,t,i){var r=n.hFe=n.hFe||(0,A.createMap)();t.forEachNodes(function(n){var t;8===n.type&&((t=r.get(i))||(t=(0,A.createSet)(),r.set(i,t)),t.add(n))})}function dn(r,e){return function(n){var t,i,t,t=n.w3.rT;t&&t.Mf.xT||(i=(t?t.Mf:e).name(),t=(t?t.Mf:e)._id,r[t+" "+n.row+" "+n.column]={row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:i})}}function wn(n){var t,i,t=[];for(i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}function F(n,e,t,i,f,r,o,u){r&&n.lossless&&([n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){var t,n,i,r;n&&n.dataTable&&(n=n.dataTable,i=e.getRowCount(t=t+1),r=e.getColumnCount(t),o&&!u?I(e,n,i,r,f,0,t):a(e,n,i,r,t))}),n.lossless.defaultData)&&sn(e,n.lossless.defaultData),o&&!u?f.incrementLoadTask.pushTask(ln,[e,n,i,f]):ln(e,n,i,f)}function l(n,t,i){n&&"function"==typeof n.onCustomNameFormulaChanged&&n.onCustomNameFormulaChanged([{nameInfo:t.nameInfo,oldExpr:i,newExpr:t.expr}])}function mn(n){var t=e([],n.sheets,!0);return n.mp&&0<n.mp.length&&n.mp.forEach(function(n){n.Mf&&t.push(n.Mf)}),t}function D(n,t,i,r){var e,n,f,n,o,u,e=!!n.NMi,n=n.getCell(i,r,3),f=(0,h.rangeToFormula)(n,i,r,3),n=t.trim();if(0<=(n="="===n.charAt(0)&&0<=n.indexOf("@")&&!B(n)?n.replace(/@/g,f):n).indexOf("{{")&&0<=n.indexOf("}}")){for(""===(o=n.split(/{{|}}/))[0]&&o.shift(),""===o[o.length-1]&&o.pop(),u=0;u<o.length;u++)-1===o[u].indexOf("=")?o[u]='"'+o[u]+'"':e&&B(o[u])?o[u]=o[u].replace(/=/g,""):(0<=o[u].indexOf("@")&&(o[u]=o[u].replace(/@/g,f)),o[u]=o[u].replace(/=/g,""),o[u]="IF(ISERROR(".concat(o[u],'), "#N/A", ').concat(o[u],")"));n="=CONCAT("+o.join(",")+")"}return n}function Cn(n,t,i,r){var e,f,o,o,u,o=null==n?void 0:n.baseTable;n&&o&&16===n.hbt&&1===n.lbt?(e=o.range(),f=o.Mf&&o.Mf.name()):9===n.type?(Cn(n.value,t,i,r),Cn(n.value2,t,i,r)):(o=i.MX.evaluateExpression(n,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof A.CalcReference&&(f=o.getSource().getName(),0<o.getRangeCount())&&(e=(0,g.Ec)(o.getRow(u=0),o.getColumn(0),o.getRowCount(0),o.getColumnCount(0))),e&&r.push({sheetName:f,range:e})}function V(n,t){var i,r,e,n;return!t||(i=n.getRow(),r=n.getColumn(),(n=n.getExpression().getRange(i,r))&&!(n=n instanceof g.Range?n:new g.Range(n.row,n.col,n.rowCount,n.colCount)).containsRange(t))}function T(e,f,o,u,s,c){var n,a,l,h,v,d,t,i,r,w,m,h=!u&&e.Ut.pj(),v=!!c;if(e.parent&&e.parent.sheets)for(d=mn(e.parent),t=e.parent.getCustomNames(),i=e.parent.Qwt(),r=!y(e.parent.fMt)&&e.parent.wJt(),t&&C(t,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),i&&C(i,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),r&&C(r,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),w=function(i){var r;(n=d[i].getCustomNames())&&(r=[],C(n,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(d[i],e,f,o,u,s,a,v))!==a)&&(t.SB(l,h),r.push({nameInfo:t,oldExpr:a,newExpr:l}))}),0<r.length)&&"function"==typeof d[i].onCustomNameFormulaChanged&&d[i].onCustomNameFormulaChanged(r)},m=0;m<d.length;m++)w(m);else(n=e.getCustomNames())&&C(n,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(e,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)})}function Y(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,l,v,h,d,h,d,l,v,g,b,x,R,y,j,N,k,c,j,I;if(o){if(s=t.Uw(),c=(0,A.Syt)(A.Errors.Reference,s),9===o.type){if(l=o.value,h=o.value2,v=Y(n,t,i,r,e,f,l,u),d=h&&Y(n,t,i,r,e,f,h,u),l!==v||h!==d)return(0,A.rbt)(o.operatorType,v,d)}else if(7===o.type){for(w=!1,m=[],C=void 0,_=0;_<o.arguments.length;_++)p=Y(n,t,i,r,e,f,C=o.arguments[_],u),w=w||C!==p,m.push(p);if(w)return(0,A.YJ)(o,m)}else if(1===o.type&&o.hmt()){if(a=o.source||n&&n.Uw(),h=l=o.row,d=v=o.column,a&&a===s&&(f&&!o.rowRelative||!f&&!o.columnRelative)){if(f&&e)l+=i<=l?r:0;else if(!f&&e)v+=i<=v?r:0;else if(f){if(i+r<=l)l-=r;else if(i<=l)return c}else if(i+r<=v)v-=r;else if(i<=v)return c;if(l!==h||v!==d)return(0,A.knt)(s,E,l,v,o.rowRelative,o.columnRelative)}}else if(1===o.type){if(a=o.source||n&&n.Uw(),h=o.row,d=o.column,l=o.endRow,v=o.endColumn,g=o.rowRelative,b=o.columnRelative,x=o.endRowRelative,R=o.endColumnRelative,y=h,j=d,N=l,k=v,a&&a===s){if(f&&e)h+=!g&&i<=h?r:0,l+=!x&&i<=l?r:0;else if(!f&&e)d+=!b&&i<=d?r:0,v+=!R&&i<=v?r:0;else if(f&&!e){if(!g&&i<=h&&!x&&l<i+r)return c;if(g&&x||l<i)return o;if(!g)if(i+r<=h)h-=r;else if(!(h<i)){if(x)return c;i<h&&(h=i)}if(!x)if(i+r<=l)l-=r;else{if(g)return c;l<i+r&&(l=i-1)}}else{if(!b&&i<=d&&!R&&v<i+r)return c;if(b&&R||v<i)return o;if(!b)if(i+r<=d)d-=r;else if(!(d<i)){if(R)return c;i<d&&(d=i)}if(!R)if(i+r<=v)v-=r;else{if(b)return c;v<i+r&&(v=i-1)}}if(d!==j||v!==k||h!==y||l!==N)return(0,A.lJ)(s,E,h,d,l,v,g,b,x,R)}}else if(10===o.type){if((c=o.value)!==(j=Y(n,t,i,r,e,f,c,u)))return(0,A.Ayt)(j)}else 13===o.type&&(a=o.source||n&&n.Uw())&&a===s&&!f&&(o=o.offsetWhenInsertRemoveColumn(i,r,e,u));return o}}function L(n,t){var i,r,e,f,o,u,s,c,t,a,r,i=t.w3,r=i.getSource(),o=-1,u=-1;t.name?(f=t.name,c=t.id,y(c)?e=i.getNodeByName(f):(e={WK:t.expression},s=!0)):(o=t.row,u=t.column,e=i.getNode(o=void 0===o?-1:o,u=void 0===u?-1:u)),t=e.WK,a=e.$bt,r=n.unparse(r,t,o<0?0:o,u<0?0:u),a&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!a.isDynamicArray)?o===a.row&&u===a.col&&i.setArrayFormula(a.row,a.col,a.rowCount,a.colCount,r):f?s?i.setFormula(c,f,r):i.setFormulaByName(f,r):i.setFormula(o,u,r,null,!0,!0),e.WK.lMt=t.lMt}function _n(n){for(var t,i,r,e,f,o,u,s,c,a,l,h,v,d,t=k(n),i,r,e,f=[n.b3(g.SheetArea.colHeader),n.b3(g.SheetArea.rowHeader),n.b3(g.SheetArea.viewport)],o=0;o<f.length;o++){if(!(u=f[o]))return;for(s=u.getAllNodes(),c=0;c<s.length;c++)if(l=(a=s[c]).calc)for(h=l.aT,v=0;v<h.length;v++)(d=l[h[v]])&&d.forEach(function(n){n&&n instanceof A.PathCalc&&L(t,n)})}}function pn(n,t,i,r,e,f,o,u,s,c,a,l,h){p.CalcOperatorAdjustor.copyFormula(n,t,i,r,e,f,o,u,s,c,a,l,h)}function gn(n,t){var n=n.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}function X(n,t,i,r,e,f,o,u,s,c){var a,l,h,v,d,w,m,C,_,a,l,h,v,a,l,v,h,a;if(c){if(9===c.type){if(a=c.value,l=c.value2,h=X(n,t,i,r,e,f,o,u,s,a),v=l&&X(n,t,i,r,e,f,o,u,s,l),a!==h||l!==v)return(0,A.rbt)(c.operatorType,h,v)}else if(7===c.type){for(d=!1,w=[],m=void 0,C=0;C<c.arguments.length;C++)_=X(n,t,i,r,e,f,o,u,s,m=c.arguments[C]),d=d||m!==_,w.push(_);if(d)return(0,A.YJ)(c,w)}else if(1===c.type){if(a=!Z(c)&&!K(c),l=!nn(c)&&!Q(c),h=t.Uw(),(!c.source||c.source===h)&&a&&l)return v=e.Uw(),a=new p.MoveSwapInfo(h,i,r,v,f,o,u,s),l=gn(c,!0),a.R0i=!0,(v=(0,p.adjustFormulaOnMoveSwap)(h,0,0,l,a,!0))===l?c:1===v.type&&gn(v,!1)||v}else if(10===c.type&&(h=c.value)!==(a=X(n,t,i,r,e,f,o,u,s,h)))return(0,A.Ayt)(a);return c}}function bn(n,t){var i,r,e,f,o,u,s,c,i=n.printInfo&&n.printInfo();if(i)for(r=t.split(","),e=0;e<r.length;e++)for(f=(0,h.formulaToRanges)(n,r[e],0,0),o=0;o<f.length;o++)for(u=f[o].ranges,s=0;s<u.length;s++)-1===(c=u[s]).col||-1===c.colCount?(i.repeatRowStart(c.row),i.repeatRowEnd(c.row+c.rowCount-1)):-1!==c.row&&-1!==c.rowCount||(i.repeatColumnStart(c.col),i.repeatColumnEnd(c.col+c.colCount-1))}function xn(n,t,i,r,e){var n=n[t];n&&(r=n.rT,y(e)||(r.Wbt=e),n.toJSON({data:i}),delete r.Wbt)}function Rn(n,t,i,r,e,f){n&&(t&&!t.fullRecalc?n.resumeWithoutCalc():n.resume(!1,!1,!n.calcOnDemand),delete n.lb),delete i.G3,f.resumePaint()}e=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var r=0,e=t.length,f;r<e;r++)!f&&r in t||((f=f||Array.prototype.slice.call(t,0,r))[r]=t[r]);return n.concat(f||Array.prototype.slice.call(t))},Object.defineProperty(n,"__esModule",{value:!0}),n.QB=n.XB=n.adjustOneFormula=n.hMt=n.convertFormatStringFormula=n.addNameInName=n.resetFormatStringCustomName=n.resetCustomName=n.dMt=n.convertBuiltInNameToDisplayName=void 0,g=t("Core"),i=t("Common"),A=t("CalcEngine"),h=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),p=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),w=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),E=null,b=void 0,C=g.GC$.each,v=i.Common.zf.Gmt,x=i.Common.zf,t=new i.Common.ResourceManager(g.SR),R=t.getResource.bind(t),y=i.Common.lt.ht,f="_XLNM.PRINT_AREA",J="PRINT_AREA",o="Print_Area",G=g.mt.xr,P=g.range_parser._c,m=g.mt.n1,_=g.Util.mr,j=parseInt,N=g.UsedRangeUtil.updateUsedRangeByData,n.convertBuiltInNameToDisplayName=d,n.dMt=a,(t=g.Worksheet.prototype).resetCalc=function(){tn.call(this),this.eMt=!0},t.c3n=function(n,t,i){var r,e,f,o,u,s,c,a,l,h,r=this,e=k(r);if(e){if(this.suspendPaint(),e.suspend(!0),f=this.Uw().getCalcSourceModel(),y(i)){if(n)for(M(r.hyt,r.Uw(),e,r.parent),o=f.getAllNodes(),u=0;u<o.length;u++)(c=(s=o[u]).calc)&&s.WK&&L(e,c);r.oMt.Bde(n,!t),r.iMt.Bde(n,!t),r.rMt.Bde(n,!t)}else if(!1!==n||t)for(-1===i.row&&(i.row=0,i.rowCount=r.getRowCount()),-1===i.col&&(i.col=0,i.colCount=r.getColumnCount()),a=0;a<i.rowCount;a++)for(l=0;l<i.colCount;l++)(c=(s=f.getNode(a+i.row,l+i.col))&&s.calc)&&s.WK&&(n&&L(e,c),!1!==n||t&&c.isVolatile)&&c.vyt();h=!1,1===e.calculationMode&&(h=i?function(n){return n.w3===r.oMt&&i.contains(n.row,n.column)}:function(n){return n.w3===r.oMt||n.w3===r.iMt||n.w3===r.rMt}),e.resume(!1,!0,h),this.resumePaint()}},t.recalcAll=function(n){var t,i,r,e,f,o,u,s,c,a,l,t=k(this);if(t){if(this.suspendPaint(),t.suspend(!0),n)for(r=void 0,r=(i=this.parent)&&i.sheets||[this],M(i&&i.hyt,this.Uw(),t,self.parent),e=0;e<r.length;e++)for(o=(f=r[e]).Uw(),M(f.hyt,o,t,self.parent),s=(u=o.getCalcSourceModel()).getAllNodes(),c=0;c<s.length;c++)(l=(a=s[c]).calc)&&a.WK&&L(t,l);t.resume(n),this.resumePaint()}},n.resetCustomName=M,n.resetFormatStringCustomName=vn,t.recalcRange=function(n,t,i,r){var e=k(this);e&&e.recalcRange(this.Uw(),n,t,i,r)},t.recalcRows=function(n){var t,i,r,e,t=k(this);if(t&&!t.ignoreDirty()&&0<n.length){if(t.suspend(),i=n.reduce(function(n,t){return Math.min(n,t)}),r=n.reduce(function(n,t){return Math.max(n,t)}),n.length*n.length>r-i)t.recalcRange(this.qgt,i,-1,r-i+1,-1);else for(e=0;e<n.length;e++)t.recalculate(this.qgt,n[e],-1);t.resume(!1)}},t.recalcCols=function(n){var t,i,t=k(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,-1,n[i]);t.resume(!1)}},t.gL=function(n,t,i){var i,r,e,i,r=k(this);r&&!r.ignoreDirty()&&(e=this.qgt,1===i?e=this.T3:2===i&&(e=this.A3),(i=null==(i=null==e?void 0:e.t8)?void 0:i.getAnchorInfo(n,t))&&(n=i.row,t=i.col),r.recalculate(e,n,t))},t.getCalcService=function(){return this.Lp||(this.Lp=new A.CalcService,this.Uw(g.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(g.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},t.op=function(){return this.getCalcService()},t.suspendCalcService=function(n){var t=k(this);t&&t.suspend(n)},t.resumeCalcService=function(n){var t=k(this);t&&t.resume(n)},t.Uw=function(n){return y(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:E},t.b3=function(n){var t=this;return 1===n?(!t.iMt&&t.T3&&(t.iMt=t.op().getSourceModel(t.T3)),t.iMt):2===n?(!t.rMt&&t.A3&&(t.rMt=t.op().getSourceModel(t.A3)),t.rMt):(!t.oMt&&t.qgt&&(t.oMt=t.op().getSourceModel(t.qgt)),t.oMt)},t.vMt=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!0,!0)},t.KT=function(n,t,i,r,e,f){var o=this.vMt(n,t,i,r,3);return!o&&e&&(r=this.getColumnCount(2),o=this.vMt(n,0,i,r,2)),!o&&f&&(i=this.getRowCount(1),o=this.vMt(0,t,i,r,1)),o},t.iT=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!1,!0)},t.mT=function(n,t,i,r,e,f,o){var u,e,u=(e=void 0===e?!0:e)&&this.KT(n,t,i,r,f,o),e=!e&&en(this,n,t,i,r,f,o);return!u&&!e||(this.jT(4,R().Exp_ChangePartOfArray),!1)},t.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},t.Uwt=function(n){if(!(n&&n instanceof A.Functions.Function))throw new Error(R().Exp_InvalidCustomFunction);n.name=v(n.name),this.Amt[n.name]=n},t.getCustomFunction=function(n){return n?this.Amt[v(n)]:E},t.removeCustomFunction=function(n){n&&(delete this.Amt[v(n)],this.recalcAll())},t.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},t.Jbt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomFunction(n))&&i&&i.getCustomFunction?i.getCustomFunction(n):t):E},t.addCustomName=function(n,t,i,r,e,f){this.zwt(n,t,i,r,!1,e,f)},t.getCustomName=function(n){return n?this.hyt[v(n)]:b},t.qRe=function(i,r,n,t,e){var f,f,o,u,s,c,a,f,f,l,f,o=this;if(t=null!=t?t:0,e=null!=e?e:0,o.Lp){if(u=o.hyt[v(i)])if(s=void 0,n&&(s=o.Lp.parse(o.Uw(),n,t,e)),r&&i!==r){if(!o.isValidCustomName(r))throw new Error(R().Exp_InvalidCustomName);if(c=[],a=[],(f=o.parent.hFe)&&f.forEach(function(n){n.forEach(function(n){var t,t;n.value===i&&(null==(t=n.source)?void 0:t.Mf)===o&&c.push(n),n.value===r&&(null==(t=n.source)?void 0:t.Mf)===o&&a.push(n)})}),2===(f=null==(f=o.b3())?void 0:f.dFe(i,r,0<c.length,0<a.length,null==(f=o.parent)?void 0:f.wC)))throw new Error(R().Exp_CustomNameBothInUse);o.suspendCalcService(),(u=o.hyt[v(i)]).btV(r),delete o.hyt[v(i)],o.hyt[v(r)]=u,c.forEach(function(n){n.value=r}),o.b3().updateNameCalc(r,!0),s&&(l=o.hyt[v(r)],o.removeCustomName(r),o.zwt(r,n,t,e,!1,u.getComment(),u.isReadOnly(),l)),3!==f||s||((f={})[r]=r,this.Zwt(f,!0)),o.resumeCalcService()}else s&&(o.suspendCalcService(),l=o.hyt[v(i)],o.removeCustomName(i),o.zwt(i,n,t,e,!1,u.getComment(),u.isReadOnly(),l),o.resumeCalcService());o.zw()}},t.getCustomNames=function(){var i=[];return C(this.hyt,function(n,t){i.push(t)}),i},t.removeCustomName=function(n){var t,t,n,i,t;n&&(n=v(n),i=this.hyt[n],null!=(t=null==(t=this.parent)?void 0:t.hFe)&&t.delete(i),delete this.hyt[n],(t={})[n]=n,this.Zwt(t,!1))},t.clearCustomNames=function(){var n,t,i,r,e,f,i=this,r=i.hyt;if(null!=(n=this.parent)&&n.hFe)for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(f=r[e],null!=(t=this.parent))&&t.hFe.delete(f);i.hyt={},this.Zwt(r,!1)},t.createNameInfo=function(n,t,i,r,e){var f,o,f,o,f=this,o=k(f),f=f.Uw();return o&&f?(o=o.parse(f,t,r,e),new h.NameInfo(n,o,r,e,i)):E},t.getNameInfos=function(){return this.hyt},t.setNameInfos=function(n){y(n)||(this.hyt=n)},t.Vwt=function(n){var t,i,t,t=this,i=!t.hyt[v(n)];return i=i&&(t=t.tables)?!t.findByName(n):i},t.isValidCustomName=function(n){return n&&g.mt.P0(n)&&this.Vwt(n)},n.addNameInName=S,t.zwt=function(n,t,i,r,e,f,o,u){var s,c,a,l,c,a,s=this;if(!n||!t||!e&&!s.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);if(c=k(s),a=s.Uw(),c&&a){if(l=void 0,e)try{l=c.parse(a,t,i,r,!1,!0,!0)}catch(n){}else l=c.parse(a,t,i,r);c=void 0,u?(c=u).SB(l,b,i,r):c=new h.NameInfo(n,l,i,r,f,o,s),s.hyt[v(n)]=c,l&&s.parent&&S(s.parent,l,c),e||((a={})[n]=n,this.Zwt(a,!0))}},t.Wwt=function(n,t,i,r,e,f,o,u){var s,t,c,t,c,s=this;if(!n||!t||!f&&!s.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);t=k(s),c=s.Uw(),t&&c&&(t=s.hyt[v(n)]=new h.NameInfo(n,i,r,e,o,b,s),i&&s.parent&&S(s.parent,i,t),f||((c={})[n]=n,this.Zwt(c,!0)))},t.Zwt=function(n,t){var i,r,e,r=this.b3();if(r){for(e in n)r.updateNameCalc(e,t);null!=(i=this.parent)&&i.Zwt(n,t),this.recalcAll(!1)}this.ki(g.Events.CustomNameChangedInternal,{})},t.gMt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomName(n))&&i&&i.getCustomName?i.getCustomName(n):t):E},t.setFormula=function(n,t,i,r){this.zI(n,t,i,E,!1,r)},t.zI=function(n,t,i,r,e,f,o,u,s,c,a){var l,h,v,d,w,m,C,C,_,m,h,v,u,C,c,p,r,l=this;y(f)&&(f=3),n<0||n>=l.getRowCount(f)||t<0||t>=l.getColumnCount(f)?l.jT(0,R().Exp_IndexOutOfRange):(h=0<=n?n:0,v=0<=t?t:0,d=l.Uw(f),w=l.options.keepUnknownFormulas,(m=l.Lp).forceR1C1Formula&&3===f&&!l.isReportTemplateSheet?(C=m.useR1C1,m.useR1C1=!0,r=r||(i&&m?m.parse(d,i,h,v,!1,e,!1,w):E),m.useR1C1=C):r=r||(i&&m?m.parse(d,i,h,v,!!l.OTe,e,e,w):E),r&&u&&(r.ensureSingle=!0),C=l.tables,3===f&&0<=n&&0<=t&&C&&!(_=C.pMt(n,t,1,1,i,r))||(m=w&&i&&!r,h=l.b3(f),v=l.conditionalFormats,h&&(u=h.getFormula(n,t,b,!0),C=l.Ut,c||d.t8.Fgt(n,t),(c=y(l.vle)&&!i)&&(l.vle=!(i||l.Sge&&l.Sge(n,t))),h.FE=!0,p=l.vle&&i===E,h.setFormula(n,t,i,r,e,p,!a&&C.pj(),s,w),c&&delete h.FE,delete l.vle,h.usedRange&&N(h.usedRange,n,t,u,i),m&&(r=h.getNode(n,t,!0))&&(r.qbt=i),!v||d&&!0===d.G3||v.dl(),l.hasFormula(n,t,f)&&C.JE(n,t,f),o?l.Lj(l,[{row:n,col:t}],0):l.Rj("formula",n,t,f,u,i)),l.Q1i&&l.Q1i(n,t,1,1,f),l.zw()))},t.eL=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,s=this,c=this.op();if(n<0||n>=s.getRowCount()||t<0||t>=s.getColumnCount())s.jT(0,R().Exp_IndexOutOfRange);else if(l=s.b3(o))for(h=n;h<i+n;h++)for(v=t;v<r+t;v++)h===n&&v===t&&(s.zI(n,t,e,E,!1,o),a=l.pB(n,t),s.Xbt=s.Xbt||{nextIndex:0},d=s.Xbt.nextIndex,s.Xbt[d]={formula:c.unparse(this.qgt,a,n,t,!1,!0),baseRow:n,baseColumn:t,lastRow:n+i-1,lastColumn:t+r-1},s.Xbt.nextIndex++,a.aMt=d),s.zI(h,v," ",a,!0,o,!0,!0)},t.setArrayFormula=function(n,t,i,r,e,f){this.uMt(n,t,i,r,e,!1,f)},t.uMt=function(n,t,i,r,e,f,o,u){var s,c,a,l,c,h,v,d,w;if(void 0===o&&(o=3),s=this,n<0||n+i>s.getRowCount()||t<0||t+r>s.getColumnCount())s.jT(0,R().Exp_IndexOutOfRange);else if(s.Ut.eE(n,t,i,r))s.jT(0,R().Exp_ArrayFormulaSpan);else if(c=s.tables,!(3===o&&0<=n&&0<=t&&c)||(a=c.pMt(n,t,i,r,e))){if(l=s.b3(o),c=s.conditionalFormats,l){for(h=[],v=n;v<n+i;v++)for(h[v]=[],d=t;d<t+r;d++)h[v][d]=l.getFormula(v,d);for(l.setArrayFormula(n,t,i,r,e,f,s.Ut.pj(),u,!1),v=n;v<n+i;v++)for(d=t;d<t+r;d++)l.usedRange&&N(l.usedRange,v,d,h[v][d],e);if(c&&c.dl(),s.vf<1){for(w=[],v=n;v<n+i;v++)for(d=t;d<t+r;d++)w.push({row:v,col:d});s.SI(n,t,i,r,w,5,o,e)}}s.zw()}},t.getFormula=function(n,t,i,r){var i,e,i=this.b3(i);return!i||(e=i.oT(n,t))&&e.isDefault()?E:i.getFormula(n,t,r)},t.bMt=function(n,t,i){var i=this.b3(i);return i?i.pB(n,t):E},t.getFormulaInformation=function(n,t,i,r){var e,i,f,o,f,u,u,s,c,e={},i=this.b3(i);if(i){if(o=(f=i.oT(n,t))&&f.isDefault())return e;(f=i.pB(n,t))?(u=i.sT(n,t),e.hasFormula=!0,u&&(e.baseRange=new g.Range(u.row,u.col,u.rowCount,u.colCount)),e.isArrayFormula=u&&!u.isDynamicArray,n=u?u.row:n,t=u?u.col:t,r||(e.formula=this.Lp.unparse(this.qgt,f,n,t),e.formulaWithCulture=this.Lp.unparse(this.qgt,f,n,t,!0)),e.hasFormula=!!e.formula):(u=this.Uw().t8.getAnchorInfo(n,t))&&u.isValid&&(s=u.row,c=u.col,e.baseRange=new g.Range(u.row,u.col,u.rowCount,u.colCount),n===s&&t===c||(f=i.pB(s,c),r||(e.formulaWithCulture=this.Lp.unparse(this.qgt,f,s,c,!0)),e.hasFormula=!0,e.isDynamicArray=!0))}return e},t.VI=function(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,w,m,C;for(i||(i=this,r=n,e=t,f=[]),o=i.qwt(r,e),u=this.name(),s=0;s<o.length;s++)if(!f[a=(c=o[s]).sheetName+"_"+c.row+"_"+c.col+"_"+c.rowCount+"_"+c.colCount]){if(f[a]=!0,(c.row<=n&&n<c.row+c.rowCount||-1===c.rowCount)&&(c.col<=t&&t<c.col+c.colCount||-1===c.colCount)&&u===c.sheetName)return!0;for(l=c.sheetName===u?i:i.parent.getSheetFromName(c.sheetName),h=c.rowCount,v=c.row,d=c.colCount,w=c.col,-1===h&&(h=l.getRowCount(),v=0),-1===d&&(d=l.getColumnCount(),w=0),m=v;m<h+v;m++)for(C=w;C<d+w;C++)if(this.VI(n,t,l,v,w,f))return!0}return!1},t.getCrossSheetReferences=function(r){for(var n,e,t,i,f,o,u,s,c,a,l,h,v,d,n=this,e=(0,A.createMap)(),t=n.getRowCount(),i=n.getColumnCount(),f=n.b3(),o=f.rT.id,s=function(n,t){var i,i,i=n.w3.getSource();i&&i.id!==o&&(r?(i=i.getName())&&0<i.length&&e.set(i,!0):e.set(t,n))},c=0;c<t;c++)for(a=0;a<i;a++)if((l=f.oT(c,a))&&l.aT)for(u=l.aT,h=0;h<u.length;h++)(v=l[u[h]])&&v.forEach(s);if((d=f.uT())&&d.aT)for(u=d.aT,h=0;h<u.length;h++)(v=d[u[h]])&&v.forEach(function(n){n&&n.content.forEach(s)});return e},t.getPrecedents=function(n,t){var i,r,r,e,f,n,f,i=[],r=this.b3();return r&&(r=r.Fyt(n,t)||r.pB(n,t),n=(f=(e=this.getFormulaInformation(n,t,3,!0)).baseRange)?f.row:n,f=f?f.col:t,this.yMt(r,n,f,i),i=fn(i)),i},t.getDependents=function(c,a){var l,n,h,l=[],n=this.parent&&this.parent.sheets||[this],h=this.name();return n.forEach(function(n){for(var t,i,r,e,f,o,u,s,t=n.getRowCount(),i=n.getColumnCount(),r=n.name(),e=0;e<t;e++)for(f=0;f<i;f++)for(o=n.getPrecedents(e,f),u=0;u<o.length;u++)if((s=o[u]).sheetName===h&&(-1===s.row||s.row<=c&&c+1<=s.row+s.rowCount)&&(-1===s.col||s.col<=a&&a+1<=s.col+s.colCount)){l.push({row:e,col:f,rowCount:1,colCount:1,sheetName:r});break}}),l},s={},t.qwt=function(n,t){var i,r,e,r,r,f,o,u,i={},r=this.b3().oT(n,t),e=this.b3().uT();if(r&&(r=r[0])&&r.forEach(dn(i,this)),e&&e[0])for(r=e["0c"],s.minX=t,s.minY=n,s.maxX=t,s.maxY=n,f=r.search(s),o=0;o<f.length;o++)(u=f[o].content).forEach(dn(i,this));return wn(i)},t.yMt=function(n,t,i,r){var e,f,f,o,u,s;if(n)switch(e=n.type){case A.ExpressionType.reference:case A.ExpressionType.structReference:f=n.getRange(t,i),r.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:(n.source&&n.source.Mf?n.source.Mf:this).name()});break;case A.ExpressionType.operator:this.yMt(n.value,t,i,r),this.yMt(n.value2,t,i,r);break;case A.ExpressionType.expand:case A.ExpressionType.parentheses:this.yMt(n.value,t,i,r);break;case A.ExpressionType.name:f=this.gMt(n.value),this.yMt(f.getExpression(),t,i,r);break;case A.ExpressionType.function:for(o=n.arguments,u=0;u<o.length;u++)s=o[u],this.yMt(s,t,i,r)}},t.hasFormula=function(n,t,i,r){var i=this.b3(i);return!!i&&i.hasFormula(n,t,r)},t.wMt=function(){var n=this.b3();n&&n.MMt(function(n){n.CMt(),n.yB()})},t.clearFormula=function(n,t,i,r,e){var f,o,u,f=this;for(n<0&&(n=0,i=f.getRowCount()),t<0&&(t=0,r=f.getColumnCount()),o=0;o<i;o++)if(e(f,o+n))for(u=0;u<r;u++)f.setFormula(o+n,u+t,E)},t.nameFunctionsFromJSON=function(n,t,i,r){var e,f,o,u,s,s,c,a,l;if(n){if(e=this,f=n.customFunctions)for(o in f)f.hasOwnProperty(o)&&(u=f[o],s=(0,g.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u,t),e.Uwt(s));if((c=n.names)&&0<c.length){for(a=0;a<c.length;a++)l=c[a],e.zwt(d(l.name),l.formula,l.row,l.col,!0,l.comment,l.isReadOnly);e.wMt()}r&&r()}},t.formulaFromJSON=function(n,t,e){var f,o,u;n&&((f=this).Xbt=n.sharedFormulas,o=e&&e.ignoreFormula,u=e&&e.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach(function(n,t){var t,n,i,r;n&&!o&&n.dataTable&&(n=n.dataTable,i=f.getRowCount(t=t+1),r=f.getColumnCount(t),u?I(f,n,i,r,e,0,t):a(f,n,i,r,t))}),n.defaultData&&sn(f,n.defaultData),u?e.incrementLoadTask.pushTask(an,[f,n,t,e]):an(f,n,t,e))},t.formulaFromSJSFormat=function(n,t,i,r){var e,f,o,u,s,c,f,a,l,e=this,f=e.Uw(),o=!i||!1!==i.includeFormulas,u=g.Util.Mo(i),s=g.Util.wo(i,e.parent&&e.parent.v2),c=e.b3(3);f.G3=!0,o&&n.lossless&&n.lossless.tree&&i.$wt&&f.setReferenceSheetNames(n.lossless.referenceSheetNames),(f=G(n,g.XFileConstants.bo))?(a=f.rowCount,l=f.colCount,r?(o&&O(e,f,a,l,n.lossless,i,0,r),F(n,e,c,t,i,o,u,r)):(o&&i.incrementLoadTask.addTask(O,[e,f,a,l,n.lossless,i,0],x.I5(R().STEP.loadSheetFormula,[e.name()]),function(){var n=i.loadStatus.formulaLoad/i.loadStatus.total;return i.fullRecalc?s?.5:n*g.STEP_RATE.loadSheetFormulaWithCalc+g.STEP_RATE.loadSheetDataWithCalc+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData:s?.6:n*g.STEP_RATE.loadSheetFormula+g.STEP_RATE.loadSheetData+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData},e.name()),i.incrementLoadTask.addTask(F,[n,e,c,t,i,o,u]))):r?F(n,e,c,t,i,o,u,r):i.incrementLoadTask.addTask(F,[n,e,c,t,i,o,u])},t.nameFunctionFromSJSFormat=function(n,t,i){var e,f,r,o,u,s,s,c,a,e=this,f=e?e.Uw():E,r=n.lossless&&n.lossless.customFunctions;if(r)for(o in r)r.hasOwnProperty(o)&&(u=r[o],s=(0,g.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u),e.Uwt(s));c=n.lossless&&n.lossless.definedNames,a=n.lossless&&n.lossless.nExpr,c&&0<c.length&&(c.forEach(function(n){var t=""+n.c_[0],i=m(n.name),r=m(n.comment);"_xlnm.Print_Titles"===i?bn(e,t):a&&a[n.e]?e.Wwt(d(i),_(m(t)),(0,w.exprFromJSON)(a[n.e],f.getParserContext(!1)),0,0,!0,r,"_xlnm.Print_Area"!==i):e.zwt(d(i),_(m(t)),0,0,!0,r,n.isReadOnly)}),e.wMt())},t.SMt=function(n){var t=this,i=t.Lp;i&&!n||(t.Lp=n||new A.CalcService,t.Uw(g.SheetArea.colHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.rowHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.viewport).setCalcService(t.Lp),t.Lp.initParserContext(t.Uw()),i?(n.setSourceModel(t.T3,i.getSourceModel(t.T3)),n.setSourceModel(t.A3,i.getSourceModel(t.A3)),n.setSourceModel(t.qgt,i.getSourceModel(t.qgt))):(t.iMt=t.Lp.getSourceModel(t.T3),t.rMt=t.Lp.getSourceModel(t.A3),t.oMt=t.Lp.getSourceModel(t.qgt)),t.oMt.usedRange=new g.BaseUsedRange)},t.setCalc=function(n,t){this.Lp=n,this.qgt=t||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},t.YA=function(){this.ol(!1,1)},t.TMt=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,i=this,r=n.changeType,e=n.row,f=n.rowCount,o=n.col,u=n.colCount,s=n.sheetArea,c=y(s)||s===g.SheetArea.viewport,a=i.b3(s),l=a.usedRange;a&&(v=(h=i.Ut).pj(),d=k(a),w=a.rT,m=d.Hyt(),C=d.MX.asyncManager,"addingRows"===r?i.mT(e,0,0,i.getColumnCount(),void 0,!0,!1)?n.onlyCheck||(_=c?i.b3(2):b,m.onBeforeAddRemoveRows(a,e,_),T(i,e,f,!0,!0),[a,_].forEach(function(n){n&&n.addRows(e,f)}),C.addRows(w,e,f)):n.canAdd=!1:"addRows"===r?(d.suspend(),_=c?i.b3(2):b,m.onAfterAddRemoveRows(a,e,f,!0,t,_),d.resume(!1),v&&v.push({type:"addRows",row:e,rowCount:f,sheetArea:s}),l&&l.addHeadInfo(e,f,!0)):"deletingRows"===r?i.mT(e,0,f,i.getColumnCount(),void 0,!0,!1)?n.onlyCheck||(_=c?i.b3(2):b,d.KAe=v,m.onBeforeAddRemoveRows(a,e,_,!t,f),T(i,e,f,!1,!0),[a,_].forEach(function(n){n&&n.deleteRows(e,f,t)}),C.deleteRows(w,e,f)):n.canDelete=!1:"deleteRows"===r?(d.suspend(),_=c?i.b3(2):b,m.onAfterAddRemoveRows(a,e,f,!1,t,_),d.resume(!1),v&&v.push({type:"deleteRows",row:e,rowCount:f,sheetArea:s}),delete d.KAe,l&&l.removeHeadInfo(e,f,!0)):"setRowCount"===r&&f!==e?(d.suspend(),_=i.b3(2),e<f?(a.gF(e+1,0,f-e,i.getColumnCount()),_.gF(e+1,0,f-e,i.getColumnCount()),a.rT.t8.Fgt(e+1,-1,f-e,-1)):(a.gF(f+1,0,e-f,i.getColumnCount()),_.gF(f+1,0,e-f,i.getColumnCount()),a.rge(f,e),_.rge(f,e)),d.AMt(2),d.resume(!1)):"setColumnCount"===r&&u!==o?(d.suspend(),p=i.b3(1),o<u?(a.gF(0,o+1,i.getRowCount(),u-o),p.gF(0,o+1,i.getRowCount(),u-o),a.rT.t8.Fgt(-1,o+1,-1,u-o)):(a.gF(0,u+1,i.getRowCount(),o-u),p.gF(0,u+1,i.getRowCount(),o-u),a.oge(u,o),p.oge(u,o)),d.AMt(3),d.resume(!1)):"addingColumns"===r?i.mT(0,o,i.getRowCount(),0,void 0,!1,!0)?n.onlyCheck||(p=c?i.b3(1):b,m.onBeforeAddRemoveColumns(a,o,p),T(i,o,u,!0,!1),[a,p].forEach(function(n){n&&n.addColumns(o,u)}),C.addColumns(w,e,f)):n.canAdd=!1:"addColumns"===r?(d.suspend(),p=c?i.b3(1):b,m.onAfterAddRemoveColumns(a,o,u,!0,t,p),d.resume(!1),v&&v.push({type:"addColumns",col:o,colCount:u}),l&&l.addHeadInfo(o,u,!1)):"deletingColumns"===r?i.mT(0,o,i.getRowCount(),u,void 0,!1,!0)?n.onlyCheck||(p=c?i.b3(1):b,d.KAe=v,m.onBeforeAddRemoveColumns(a,o,p,!t,u),T(i,o,u,!1,!1),[a,p].forEach(function(n){n&&n.deleteColumns(o,u,t)}),C.deleteColumns(w,e,f)):n.canDelete=!1:"deleteColumns"===r&&(d.suspend(),p=c?i.b3(1):b,m.onAfterAddRemoveColumns(a,o,u,!1,t,p),d.resume(!1),v&&v.push({type:"deleteColumns",col:o,colCount:u,sheetArea:s}),delete d.KAe,l)&&l.removeHeadInfo(o,u,!1))},t.IMt=function(n,t,i,r){var e,f,o,u,s,c,e=i.type,f=this;if(r){if("addRows"===e)i.changeType="addingRows",f.TMt(i),i.changeType="addRows",f.TMt(i);else if("deleteRows"===e)i.changeType="deletingRows",f.TMt(i),i.changeType="deleteRows",f.TMt(i);else if("addColumns"===e)i.changeType="addingColumns",f.TMt(i),i.changeType="addColumns",f.TMt(i);else if("deleteColumns"===e)i.changeType="deletingColumns",f.TMt(i),i.changeType="deleteColumns",f.TMt(i);else if("customName"===e)o=n.parse(f,i.newFormula,0,0),u=i.nameInfo.getExpression(),i.nameInfo.SB(o),l(f,i,u);else if("condition"===e){for(s=[],c=0;c<i.newFormulas.length;c++)o=n.parse(f,i.newFormulas[c],0,0),s.push(o);i.condition.setExpressions(s)}}else if("addRows"===e)i.changeType="deletingRows",f.TMt(i,!0),i.changeType="deleteRows",f.TMt(i,!0);else if("deleteRows"===e)i.changeType="addingRows",f.TMt(i,!0),i.changeType="addRows",f.TMt(i,!0);else if("addColumns"===e)i.changeType="deletingColumns",f.TMt(i,!0),i.changeType="deleteColumns",f.TMt(i,!0);else if("deleteColumns"===e)i.changeType="addingColumns",f.TMt(i,!0),i.changeType="addColumns",f.TMt(i,!0);else if("customName"===e)o=n.parse(f,i.formula,0,0),u=i.nameInfo.getExpression(),i.nameInfo.SB(o),l(f,i,u);else if("condition"===e){for(s=[],c=0;c<i.formulas.length;c++)o=n.parse(f,i.formulas[c],0,0),s.push(o);i.condition.setExpressions(s)}},t.xMt=function(n,t,i){var r,e,f,r=i.type,e=this;"addRows"===r?(i.changeType="deletingRows",e.TMt(i,!0),i.changeType="deleteRows",e.TMt(i,!0)):"deleteRows"===r?(i.changeType="addingRows",e.TMt(i,!0),i.changeType="addRows",e.TMt(i,!0)):"addColumns"===r?(i.changeType="deletingColumns",e.TMt(i,!0),i.changeType="deleteColumns",e.TMt(i,!0)):"deleteColumns"===r?(i.changeType="addingColumns",e.TMt(i,!0),i.changeType="addColumns",e.TMt(i,!0)):"customName"===r?(f=i.nameInfo.getExpression(),i.nameInfo.SB(i.expr),l(e,i,f)):"condition"===r&&i.condition.setExpressions(i.expressions)},t.NMt=function(n,t){var i,r,e,f,o,i=this,r=k(i),e=i.b3();if(r.suspend(),t)for(f=0;f<n.length;f++)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue&&i.setFormula(o[0],o[1],o.formula);else for(f=n.length-1;0<=f;f--)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue||i.setFormula(o[0],o[1],o.formula);r.resume(!1)},t.xj=function(n){var t,t,i,r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,t=n[n.length-1],t=t&&t.sheetArea,i=y(t)||t===g.SheetArea.viewport,r=k(this),e=this.b3(t),f=this.Uw(t);for(r.suspend();n.length;)if((o=n.pop()).type)this.xMt(r,e,o);else{if(u=o[0],s=o[1],c=o[2],a=o[3],l=o[4],h=u.pB(s,c),d=[],v=i&&f.t8.getAnchorInfo(s,c)){for(w=v.row;w<v.row+v.rowCount;w++)for(d[w]=[],m=v.col;m<v.col+v.colCount;m++)d[w][m]=this.getValue(w,m);!v.isValid||a||l||f.t8.Rme(f.t8.Pme(s,c),!0,!1,!0)}if(u.kMt.apply(u,o),(C=i&&u&&u.usedRange)&&(N(C,s,c,h,a),v))for(w=v.row;w<v.row+v.rowCount;w++)for(m=v.col;m<v.col+v.colCount;m++)w===s&&m===c||N(C,w,m,d[w][m],a)}n&&n.Vme&&f.t8.Wme(n.Vme),r.resume(!1)},t.getReferenceRange=function(n){var t,i,r,e,f,o,n,u,t=this.Uw(),i=this.getCalcService(),r=i.parse(t,n,0,0,void 0,!0),o=r.baseTable;return r&&o&&n===o.name()?(e=o.range(),f=o.Mf&&o.Mf.name()):(n=i.MX.evaluateExpression(r,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof A.CalcReference&&(f=n.getSource().getName(),0<n.getRangeCount())&&(e=(0,g.Ec)(n.getRow(u=0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))),{sheetName:f,range:e}},t.sCe=function(n){var t,i,n,r,e,f,t=this.Uw(),i=this.getCalcService(),n=i.parse(t,n,0,0,void 0,!0),r=[],e=[],f={};return Cn(n,t,i,r),r.forEach(function(n){var t=n.sheetName,n=n.range;f[t]||(f[t]={sheetName:t,ranges:[]},e.push(f[t])),f[t].ranges.push(n)}),e},t.dL=function(n,t,i,r){var e,f,f,e=this,f="string"==typeof r&&e.parent&&e.parent.xO(r);return f&&-1!==n&&-1!==t?(f=f.getExpression(),q(e,r)?z(e,f,n,t):(0,h.evaluateExpression)(e,f,n,t,{sheetArea:i})):b},t.TL=function(n,t,i){var r,e,f,r=this,e=r.parent;e.xO(i)||(f=D(r,i,n=-1===n?0:n,t=-1===t?0:t),e.pp(e.bp,i,f,n,t,!0,"",r.NMi))},t.NO=function(n,t,i,r){var e=this;return(q(e,n)?z:(0,h.evaluateExpression))(e,t,i,r)},n.convertFormatStringFormula=D,n.hMt=T,n.adjustOneFormula=L,n.XB=pn,n.QB=X,g.Worksheet.ch("calc",{priority:1e3,init:tn,dispose:function(n){var n,n,t,i,t,t,t,t,i=this;!1!==n.clearCache&&(i.qgt=E,i.A3=E,i.T3=E,i.Lp=E,(t=i.oMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.oMt=E),(t=i.rMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.rMt=E),(t=i.iMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.iMt=E),t=null==(n=i.parent)?void 0:n.Lp)&&null!=(t=null==(n=t.MX)?void 0:n.asyncManager)&&t.clearNodesByName(i.name())},attach:function(n){var t=this;n instanceof g.Workbook?t.SMt(n.Lp):t.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,t){var s,i,r,c,i,a,e,f,o,u,s=this,i=s.Amt;g.GC$.isEmptyObject(i)||(n.customFunctions=i),r=t&&t.newWorkSheetName,c=[],i=s.getCustomNames(),a=k(s),e=s.b3(),f=e.rT,i&&a&&(!y(r)&&e&&f&&(f.Wbt=r),C(i,function(n,t){var i,r,e,f,o,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:u=a.unparse(s.Uw(),f,r,e,!1,!0,1),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),c.push(i))}),0<c.length&&(n.names=c),delete f.Wbt),(o=t&&t.ignoreFormula)||(u=[s.oMt,s.iMt,s.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach(function(n,t){xn(u,t,n,f,r)}),s.Xbt&&0<s.Xbt.nextIndex&&(n.sharedFormulas=s.Xbt))},fromJson:function(n,t,i,r){var e,f,e=this,f;i&&i.incrementalLoading||(e.clearCustomFunctions(),e.clearCustomNames()),r&&(e.nameFunctionsFromJSON(n,t,i),e.formulaFromJSON(n,t,i))},wh:function(n,t,o){var u,i,r,s,c,i,a,e,f,l,h,v,h,e,d,u=this,i=u.Amt;g.GC$.isEmptyObject(i)||(n.lossless.customFunctions=i),r=o&&o.newWorkSheetName,s=[],c=[],i=u.getCustomNames(),a=k(u),e=u.b3(),f=e.rT,l={},u.parent&&(h=u.parent.yC,l=h&&h.getUsedCustomNames()||{}),i&&a&&!u.NMi&&(!y(r)&&e&&f&&(f.Wbt=r),v=!o||!1!==o.includeUnusedNames,C(i,function(n,t){var i,r,e,t,f,i,t,i=t.getName(),r=t.getExpression(),e=t.isReadOnly(),t=t.getComment();i.toUpperCase()!==J&&r&&(v||l[i])&&(i={name:i,comment:t,isReadOnly:e,formula:f=a.unparse(u.Uw(),r,0,0,!1,!0,1)},o&&o.includeCalcModelCache&&!u.ctr&&(t=(0,w.exprToJSON)(r),s.push(t),i.e=s.length-1),c.push(i))}),0<c.length&&(n.lossless.definedNames=c),0<s.length&&(n.lossless.nExpr=s),delete f.Wbt),(h=o&&!1===o.includeFormulas)||((e=u.oMt)&&(f=e.rT,y(r)||(f.Wbt=r),e.wh(n,o),delete f.Wbt),d=[u.iMt,u.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){xn(d,t,n,f,r)})),!h&&g.Util.ko(o)&&(o&&o.includeCalcModelCache&&!u.ctr&&(n.lossless.tree=(0,w.mbt)(u.b3())),f=u.Uw(),n.lossless.referenceSheetNames=f&&f.getReferenceSheetNames(),rn(u,n.lossless))},yh:function(n,t,i,r){var e,f,o,u,s,c,a,e=this,f=e.parent,u=g.Util.wo(i,e.parent&&e.parent.v2),s=i&&!i.fullRecalc,c=e.Uw();e.suspendPaint(),f&&f.Lp&&((o=f.Lp).suspend(),o.lb=s),(a=g.Util.Mo(i))||(e.clearCustomFunctions(),e.clearCustomNames()),u&&(c.G3=!0,e.nameFunctionFromSJSFormat(n,t,i),e.formulaFromSJSFormat(n,t,i,r),r?hn(f,e,n,c,t,i):i.incrementLoadTask.addTask(hn,[f,e,n,c,t,i])),r?Rn(o,i,c,u,s,e):i.incrementLoadTask.addTask(function(n,t,i,r,e,f){Rn(n,t,i,r,e,f)},[o,i,c,u,s,e])},setName:function(n){var t,i,r;_n(this),(r=(i=k(t=this.b3())).MX.asyncManager).changeSourceName(n.oldName,n.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()},canAddingSpan:function(n){var t,i,r,e,f,o,t=this,i=n.sheetArea,r=n.row,e=n.col,f=n.rowCount,o=n.colCount;3!==i&&!y(i)||t.mT(r,e,f,o,!1)||(n.isAllow=!1)}}),g.Y8.ch("calc",{isInvalidFormula:function(t){var n,i,n=E,i=b;try{t.allowDynamicArray&&(y(h.SheetParserContext.wbt)&&(h.SheetParserContext.wbt=new g.Worksheet),(n=h.SheetParserContext.wbt).getCalcService())&&(i=n.getCalcService().allowDynamicArray,n.getCalcService().allowDynamicArray=!0),(0,h.formulaToExpression)(n,t.value)}catch(n){t.isInvalid=!0}finally{y(n)||y(i)||!n.getCalcService()||n.getCalcService().allowDynamicArray===i||(n.getCalcService().allowDynamicArray=i)}}})},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();
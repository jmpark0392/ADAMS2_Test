/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,e)),n.exports}i={"./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js":function(t,n,i){var r,e,o,u;function s(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},e[t].call(n.exports,n,n.exports,s)),n.exports}e={"./dist/src/calculation/calcSource.js":function(t,n,i){"use strict";var r,f,a,e,o,u,s;function c(){this.row=[],this.field=[]}function h(t,n){var t=s.call(this,t)||this;return t.nM=n,t.MEt={},t}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,f=i("CalcEngine"),a=i("./dist/src/dataSource/utils.js"),c.prototype.parseRowIndex=function(t,n,i){var r=n.num;return n.relative||(-1===n.num?r=t-1:r--),i*n.relative+r},c.prototype.getValueImp=function(t){var n,i,r,e,o,u,s,c,n=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(i=[],0===this.row.length)for(r=0;r<n;r++)i.push(this.field.getValue(r));for(e=0;e<this.row.length;e++)if(2===(o=this.row[e]).length)for(u=this.parseRowIndex(n,o[0],t),s=this.parseRowIndex(n,o[1],t),c=u;c<=s;c++)i.push(this.field.getValue(c));else if(o.type)if("key"===o.type)r=this.table.mEt(o.value),i=i.concat(this.field.getValues(r));else for(c="odd"===o.type?1:0;c<n;c+=2)i.push(this.field.getValue(c));else r=this.parseRowIndex(n,o,t),i.push(this.field.getValue(r));if(1===i.length)i=i[0];else if(0===i.length)return null;return(0,a.isArray)(i)&&(i=(0,a.isArray)(i[0])?new f.CalcArray(i):new f.CalcArray([i])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=i),i},c.prototype.getValuesImp=function(t,n,i,r,e,o){var t=this.field.getValues(t,n,i,r,e,o);return(0,a.isArray)(t[0])?new f.CalcArray(t):new f.CalcArray([t])},c.prototype.getValue=function(t,n,i,r,e,o){return this.pEt(),(0,a.isArray)(t)?this.getValuesImp(t,n,i,r,e,o):this.getValueImp(t)},c.prototype.pEt=function(){this.field=this.table.rRt(this.Pq)},n.DataManagerReference=c,s=f.CalcSource,r(h,s),h.prototype.yEt=function(){return this._allFieldNames},h.prototype.wEt=function(t,n){2===arguments.length?this.MEt[t]=n:1===arguments.length&&delete this.MEt[t]},h.prototype.pe=function(t,n,i,r,e,o,u){this.DJ=t,this.ak=n,this.pwn=i,this.GOt=r,this.obe=e,this.abe=o,this.R6t=u},h.prototype.getField=function(t){var n=this.DJ,i=this.ak,r=this.pwn,e=this.obe,o=this.abe,u=this.R6t;return t.getValue(n,i,r,e,o,u)},h.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n.DataManagerCalcSource=h},"./dist/src/calculation/functions/functions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,a,h,l;function d(){(0,r.addScopeCustomFunctions)(),(0,e.addParentCustomFunctions)(),(0,o.addChildrenCustomFunctions)(),(0,u.addOnlyChildrenCustomFunctions)(),(0,s.addLevelCustomFunctions)(),(0,c.addLevelRowNumberCustomFunctions)(),(0,f.addQueryFunction)(),(0,a.addWindowOverFunctions)(),(0,h.addWindowFunctions)(),(0,l.addTriggerFieldValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,r=i("./dist/src/calculation/functions/scope.js"),e=i("./dist/src/calculation/functions/hierarchyParent.js"),o=i("./dist/src/calculation/functions/hierarchyChildren.js"),u=i("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),s=i("./dist/src/calculation/functions/hierarchyLevel.js"),c=i("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),f=i("./dist/src/calculation/functions/query.js"),a=i("./dist/src/calculation/functions/windowOvers/windowOvers.entry.js"),h=i("./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js"),l=i("./dist/src/calculation/functions/triggerFieldValue.js"),n.addCustomFunctions=d},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,i){"use strict";var s,c,r,e;function o(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new r.CalcFunction(e,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,i,r){var e,o,n,u,e=[],o=t.source.nM,n=t.source.DJ;return o.CEt()&&(u=o.SEt(n),!(0,c.isNullOrUndefined)(u))&&0<i&&!(0,c.isNullOrEmpty)(r)&&((0,c.traversalTree)(u,{invoking:function(t){var n,n,n;return 0===--i?(n=t.lp,n=o._dataSource.TEt(n),n=o._getValueByField(r,n),e.push(n),{cancelDeepRecursion:!0}):0===t.children.length?{cancelDeepRecursion:!0}:void 0},invoked:function(){i++}}),t.source.DJ=n),new s.CalcArray([e])},s.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,s=i("CalcEngine"),c=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="CHILDREN",n.addChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}(t.prototype=new o.CalcFunction(u)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.level},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVEL",n.addLevelCustomFunctions=s},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}(t.prototype=new o.CalcFunction(u)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=s},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,i){"use strict";var u,s,r,e;function o(){function t(){this.R9t=[{J6t:5}]}(t.prototype=new r.CalcFunction(e,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var i,r,e,o,i=[],r=t.source.nM,e=t.source.DJ;return r.CEt()&&(o=r.SEt(e),(0,s.isNullOrUndefined)(o)||(0,s.isNullOrEmpty)(n)||((0,s.traversalTree)(o,function(t){var t,t,t;0===t.children.length&&(t=t.lp,t=r._dataSource.TEt(t),t=r._getValueByField(n,t),i.push(t))}),t.source.DJ=e)),new u.CalcArray([i])},u.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,u=i("CalcEngine"),s=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,i){"use strict";var r,u,e,o;function s(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new e.CalcFunction(o,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var r,e,o,o,n,o,n,r=t.source.nM,e=t.source.DJ;if(r.CEt()&&(o=r.SEt(e),!(0,u.isNullOrUndefined)(o))&&0<n&&!(0,u.isNullOrEmpty)(i)&&!(o=c(o,n)).isRoot)return n=o.lp,o=r._dataSource.TEt(n),n=r._getValueByField(i,o),t.source.DJ=e,n},r.Functions.defineGlobalCustomFunction(o,new t)}function c(t,n){return 0===n||t.isRoot?t:c(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,r=i("CalcEngine"),u=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/utils.js"),o="PARENT",n.addParentCustomFunctions=s},"./dist/src/calculation/functions/query.js":function(t,n,i){"use strict";var f,a,r;function e(){var t;f.Functions.findGlobalFunction(r)||((t=new f.Functions.AsyncFunction(r,1,3)).isContextSensitive=function(){return!0},t.evaluateAsync=function(r,e,o,u){var t,s,n,t;function c(){var t,t,t,t,t,t=s.xEt(e,o,u);t&&(t.QJe=void 0),null!=(t=null==(t=null==(t=r.ctx)?void 0:t.Xkt)?void 0:t.node)&&t.WK?(t=s.IEt(e,o,u))&&(u?r.setAsyncResult(t[0]):r.setAsyncResult(new f.CalcArray(t))):s.IEt(e,o,u,c,!0)}function i(t){var n,i,n=s.IEt(e,o,u,c);if(n){if(u){if(i=n[0],t)return i}else if(i=new f.CalcArray(n),t)return i;r.setAsyncResult(i)}}if(t=r.ctx.source,t=(n=(s=t instanceof a.DataManagerCalcSource?t.nM.QOt:r.ctx.source.Mf.parent.dataManager()).xEt(e,o,u)).table){if(t.length())return i(!0);t.NEt().then(function(){i()})}},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},f.Functions.defineGlobalCustomFunction(r,t))}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,f=i("CalcEngine"),a=i("./dist/src/calculation/calcSource.js"),r="QUERY",n.addQueryFunction=e},"./dist/src/calculation/functions/scope.js":function(t,n,i){"use strict";var r,e,o,u,s;function c(){function t(){}function n(){}(t.prototype=new o.CalcFunction(u,2,2)).isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,i){return t.source.ak=n.start,t.source.DJ=n.context,i},r.Functions.defineGlobalCustomFunction(u,new t),(n.prototype=new o.CalcFunction(s,0,255)).isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){for(var n,i,r,e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return r={start:t.source.ak,context:t.source.DJ},e=t.source.MEt,t.source.ak=0,t.source.DJ=f(e.groupContext,n),r},r.Functions.defineGlobalCustomFunction(s,new n)}function f(t,n){var n=a(t.groupOptions.slice(0,t.path.length),n);return h(t.path,n)?t.entireScope:l(t.path,n)}function a(t,n){var i,r;if(n&&0<n.length){for(i=-1,t.reverse(),r=0;r<t.length;r++)if(t[r].field!==n[r]){(0,e.isNullOrUndefined)(n[r])&&n.length<=r&&(i=t.length-r-1);break}return i}return-1}function h(t,n){return-1===n||t.length-1<=n}function l(t,n){var i,r=[];return d(t[n],r),r}function d(t,n){var i,r,e,o,u,s,c,f,i=n.length,r=t.recordRowNumbers;if(r)for(e=0,o=r.length;e<o;e++)n[i+e]=r[e];else for(s=0,c=u=t.children;s<c.length;s++)d(f=c[s],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="CALCULATE",s="REMOVEFILTERS",n.addScopeCustomFunctions=c},"./dist/src/calculation/functions/triggerFieldValue.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}(t.prototype=new o.CalcFunction(n.TRIGGERFIELDVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var t=t.source.nM._dataSource,r=t.getFieldValue(n,0);return(0,e.isUndefined)(r)&&i?t.getFieldOriginalValue(n,0):r},r.Functions.defineGlobalCustomFunction(n.TRIGGERFIELDVALUE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addTriggerFieldValueCustomFunctions=n.TRIGGERFIELDVALUE=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),n.TRIGGERFIELDVALUE="TRIGGERFIELDVALUE",n.addTriggerFieldValueCustomFunctions=u},"./dist/src/calculation/functions/utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=void 0;var i=i("./dist/src/dataManager.common.js");n.CalcFunction=i.CalcFunction},"./dist/src/calculation/functions/windowFunctions/cumeDist.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.CUMEDIST)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,O,S,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.isOrderValid,s=t.reader,c=r-i,f=u&&1===o.length,a=u&&o[0].field,h=function(t){return s(a,n[t])},l=function(t,n){return s(o[n].field,t)},d=function(t){return n[t]},v=i;v<r;v++)if(u){if(p=n[v],w=void 0,m=n[b=v+1],f)(w=s(a,p))===s(a,m)&&(b=(-1!==(j=C(h,w,b,r-1))?j:b)+1);else{for(w=[],g=!(y=void 0),_=0;_<o.length;_++){if(a=o[_].field,(y=s(a,p))!==s(a,m)){g=!1;break}w.push(y)}g&&(b=(-1!==(j=F(d,l,w,b,r-1))?j:b)+1)}for(O=(b-i)/c,S=b-v;0<S;)S--,e.push(O);v=b-1}else e.push(1)})},r.Functions.defineGlobalCustomFunction(e.CUMEDIST,new t)}function C(t,n,i,r){for(var e,o,u,s,c,e=i,o=r,u=-1;e<=o;)n===(c=t(s=Math.floor((e+o)/2)))?(e=s+1,u=s):o=s-1;return u}function F(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=-1,c=i.length-1;o<=u;){for(a=t(f=Math.floor((o+u)/2)),h=!0,l=c;0<=l;l--)if(n(a,l)!==i[l]){h=!1;break}h?(o=f+1,s=f):u=f-1}return s}Object.defineProperty(n,"__esModule",{value:!0}),n.addCumeDistCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addCumeDistCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/denseRank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.DENSERANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.reader,s=t.isOrderValid,c=0,h=!1;for(s&&((l=1===o.length)?d=o[0].field:f=[]),v=i;v<r;v++){if(s)if(p=n[v],l)(a=u(d,p))===f&&v!==i||(c+=1,f=a);else{for(a=[],w=o.length-1;0<=w;w--)b=u(o[w].field,p),a.unshift(b),b!==f[w]&&(h=!0);!h&&v!==i||(h=!1,c+=1,f=a)}else c=1;e.push(c)}})},r.Functions.defineGlobalCustomFunction(e.DENSERANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addDenseRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addDenseRankCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js":function(t,n,i){"use strict";var r,w,e,b,i;function o(){function t(){}(t.prototype=new e.CalcFunction(e.FIRSTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.first,1)},r.Functions.defineGlobalCustomFunction(e.FIRSTVALUE,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.LASTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.last,1)},r.Functions.defineGlobalCustomFunction(e.LASTVALUE,new t)}function s(){function t(){}(t.prototype=new e.CalcFunction(e.NTHVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i){return c(t,n,b.nth,i)},r.Functions.defineGlobalCustomFunction(e.NTHVALUE,new t)}function c(t,n,d,v){var i,p=t.source.nM.Cve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,t,s,c,f,a,h,l,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.frame,u=t.evaluateWindowIndexes,t=t.buildFrameGroups;if((0,w.isNumber)(v)&&0<v)for(v=Math.floor(v),s={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},c=t(n,i),f=i;f<r;f++)u(o,i,f,n,s,c),-1===s.startIndex&&-1===s.endIndex?e.push(null):d===b.first?e.push(p(n[s.startIndex])):d===b.last?e.push(p(n[s.endIndex])):!((a=s.startIndex+v-1)<=s.endIndex)||void 0!==s.gapStartIndex&&void 0!==s.gapEndIndex&&(h=s.gapStartIndex-s.startIndex)<v&&(a=void 0!==s.currentIndex?1==(l=v-h)?s.currentIndex:l-1+s.gapEndIndex:v-h+s.gapEndIndex,s.endIndex<a)?e.push(null):e.push(p(n[a]))})}Object.defineProperty(n,"__esModule",{value:!0}),n.addNthValueCustomFunctions=n.addLastValueCustomFunctions=n.addFirstValueCustomFunctions=void 0,r=i("CalcEngine"),w=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),(i=b=b||{})[i.first=0]="first",i[i.last=1]="last",i[i.nth=2]="nth",n.addFirstValueCustomFunctions=o,n.addLastValueCustomFunctions=u,n.addNthValueCustomFunctions=s},"./dist/src/calculation/functions/windowFunctions/leadLag.js":function(t,n,i){"use strict";var r,l,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.LEAD,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r)},r.Functions.defineGlobalCustomFunction(e.LEAD,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.LAG,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r,!0)},r.Functions.defineGlobalCustomFunction(e.LAG,new t)}function s(t,n,c,f,a){var i,h=t.source.nM.Cve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,n=t.indexes,i=t.begin,r=t.length,e=t.result;if(c=(0,l.isNullOrUndefined)(c)?1:c,(0,l.isNumber)(c)&&0<=c)for(c=Math.floor(c),f=(0,l.isNullOrUndefined)(f)?null:f,o=i;o<r;o++)s=u=void 0,(s=a?i<=(u=o-c):(u=o+c)<r)?e.push(h(n[u])):e.push(f)})}Object.defineProperty(n,"__esModule",{value:!0}),n.addLagCustomFunctions=n.addLeadCustomFunctions=void 0,r=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addLeadCustomFunctions=o,n.addLagCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/nTile.js":function(t,n,i){"use strict";var r,a,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.NTILE,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,f){return(0,e.expandContext)(t,function(t){var n,i,r,t,e,o,u,s,c,n=t.begin,i=t.length,r=t.result;if((0,a.isNumber)(f)&&0<f&&f<i)for(t=i-n,u=(e=Math.floor(t/f))+(0<(o=t%f)?1:0),o--,s=n,c=1;s<i;s++)r.push(c),0===--u&&(u=e+(0<o?1:0),o--,c++);else for(s=n;s<i;s++)r.push(s-n+1)})},r.Functions.defineGlobalCustomFunction(e.NTILE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addNTileCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addNTileCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/percentRank.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}(t.prototype=new o.CalcFunction(o.WPERCENTRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.evaluateRank)(t,function(t,n){return 1===n?0:(t-1)/(n-1)})},r.Functions.defineGlobalCustomFunction(o.WPERCENTRANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWPercentRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWPercentRankCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/rank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return u(t)},r.Functions.defineGlobalCustomFunction(e.WRANK,new t)}function u(t,j){return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.isOrderValid,s=t.reader,c=1,h=!1,l=r-i,d=!1;for(u&&((d=1===o.length)?v=o[0].field:f=[]),p=i;p<r;p++){if(u)if(w=n[p],d)(a=s(v,w))===f&&p!==i||(c=p-i+1,j&&(c=j(c,l)),f=a);else{for(a=[],b=o.length-1;0<=b;b--)m=s(o[b].field,w),a.unshift(m),m!==f[b]&&(h=!0);!h&&p!==i||(h=!1,c=p-i+1,j&&(c=j(c,l)),f=a)}e.push(c)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateRank=n.addWRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWRankCustomFunctions=o,n.evaluateRank=u},"./dist/src/calculation/functions/windowFunctions/rowNumber.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.ROWNUMBER)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,n=t.begin,i=t.length,r=t.result,e=n;e<i;e++)r.push(e-n+1)})},r.Functions.defineGlobalCustomFunction(e.ROWNUMBER,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addRowNumberCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/util.js":function(t,n,i){"use strict";var v,i;function e(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function r(t,n,i){return t.map(function(t){return n(t.field,i)})}function o(t,n){if(t!==n){if((0,v.isNullOrUndefined)(t)||(0,v.isNullOrUndefined)(n)||t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1}return!0}function u(t,n,i){var r,i,r=t.DJ;return t.DJ=i,i=e(t,n),t.DJ=r,i}function s(t,n){var i,t,r,e,o,u,s,c,f,a,h,l,d;if(!(0,v.isNullOrUndefined)(t.source.MEt)&&!(0,v.isNullOrUndefined)(t.source.MEt.extendContext))return i=t.source.DJ,r=(t=t.source.MEt.extendContext).begin,e=t.evaluator,o=i.length,u=!1,c=e.options.windowFrame,f=e.options.orders,a=!(s=void 0,v.isNullOrUndefined)(f)&&0<f.length,h=function(t,n){return e.Qhe(t).getValue(n)},l=e.Khe.bind(e),d=e.ube.bind(e),s=(0,v.isNullOrUndefined)(t.valueCache)?t.valueCache=[]:(u=!0,t.valueCache),u||n({indexes:i,begin:r,length:o,result:s,frame:c,orders:f,isOrderValid:a,reader:h,evaluateWindowIndexes:l,buildFrameGroups:d}),s[0]}Object.defineProperty(n,"__esModule",{value:!0}),n.expandContext=n.evaluateExpressionValue=n.isEqualValues=n.getOrderByValues=n.evaluateExpression=n.CUMEDIST=n.DENSERANK=n.NTHVALUE=n.LASTVALUE=n.FIRSTVALUE=n.LAG=n.LEAD=n.NTILE=n.WPERCENTRANK=n.WRANK=n.ROWNUMBER=n.CalcFunction=void 0,v=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.ROWNUMBER="ROWNUMBER",n.WRANK="W_RANK",n.WPERCENTRANK="W_PERCENTRANK",n.NTILE="NTILE",n.LEAD="LEAD",n.LAG="LAG",n.FIRSTVALUE="FIRSTVALUE",n.LASTVALUE="LASTVALUE",n.NTHVALUE="NTHVALUE",n.DENSERANK="DENSERANK",n.CUMEDIST="CUMEDIST",n.evaluateExpression=e,n.getOrderByValues=r,n.isEqualValues=o,n.evaluateExpressionValue=u,n.expandContext=s},"./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,a;function h(){(0,r.addRowNumberCustomFunctions)(),(0,e.addWRankCustomFunctions)(),(0,o.addDenseRankCustomFunctions)(),(0,u.addWPercentRankCustomFunctions)(),(0,s.addCumeDistCustomFunctions)(),(0,f.addNTileCustomFunctions)(),(0,c.addLeadCustomFunctions)(),(0,c.addLagCustomFunctions)(),(0,a.addFirstValueCustomFunctions)(),(0,a.addLastValueCustomFunctions)(),(0,a.addNthValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowFunctions=void 0,r=i("./dist/src/calculation/functions/windowFunctions/rowNumber.js"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/denseRank.js"),u=i("./dist/src/calculation/functions/windowFunctions/percentRank.js"),s=i("./dist/src/calculation/functions/windowFunctions/cumeDist.js"),c=i("./dist/src/calculation/functions/windowFunctions/leadLag.js"),f=i("./dist/src/calculation/functions/windowFunctions/nTile.js"),a=i("./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js"),n.addWindowFunctions=h},"./dist/src/calculation/functions/windowOvers/ascDesc.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERASC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!0)},r.Functions.defineGlobalCustomFunction(e.ORDERASC,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERDESC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!1)},r.Functions.defineGlobalCustomFunction(e.ORDERDESC,new t)}function s(t,n,i){return{field:(0,e.getFieldOption)(t,n),ascending:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderDescCustomFunctions=n.addOrderAscCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderAscCustomFunctions=o,n.addOrderDescCustomFunctions=u},"./dist/src/calculation/functions/windowOvers/orderBy.js":function(t,n,i){"use strict";var r,s;function e(){function t(){}(t.prototype=new s.CalcFunction(s.ORDERBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,o,u,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)u=void 0,u=c(o=arguments[r])?(0,s.evaluateExpression)(n,o):{field:(0,s.getFieldOption)(n,o),ascending:!0},i.push(u);return i},r.Functions.defineGlobalCustomFunction(s.ORDERBY,new t)}function c(t){var t=(0,s.getExprFunctionName)(t);return t===s.ORDERASC||t===s.ORDERDESC}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderByCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/partitionBy.js":function(t,n,i){"use strict";var r,u;function e(){function t(){}(t.prototype=new u.CalcFunction(u.PARTITIONBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,o,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)i.push({field:(0,u.getFieldOption)(n,o=arguments[r]),ascending:!0});return i},r.Functions.defineGlobalCustomFunction(u.PARTITIONBY,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addPartitionByCustomFunctions=void 0,r=i("CalcEngine"),u=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addPartitionByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js":function(t,n,i){"use strict";var r,s,c,f,u,i;function e(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMERANGE,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.RANGE},t,n,i,e,s.WindowOverFrameType.RANGE,r)},r.Functions.defineGlobalCustomFunction(f.FRAMERANGE,new t)}function o(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEROWS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.ROWS},t,n,i,e,s.WindowOverFrameType.ROWS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEROWS,new t)}function a(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEGROUPS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.GROUPS},t,n,i,e,s.WindowOverFrameType.GROUPS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEGROUPS,new t)}function h(t,n,i,r,e,o,u){var i,i,i=(0,f.unparseExpression)(n,i);return t.begin=l(i,s.WindowOverFramePreceding.CurrentRow,s.WindowOverFramePreceding.UnBounded,o,e),v(r)?t.exclude=p(r):((0,c.isNullOrUndefined)(r)||(i=(0,f.unparseExpression)(n,r),t.end=l(i,s.WindowOverFrameFollowing.CurrentRow,s.WindowOverFrameFollowing.UnBounded,o,e)),v(u)&&(t.exclude=p(u))),d(t,e,o),t}function l(t,n,i,r,e){var i,t,i,o;return"[@]"===t?{type:u.current,option:{type:n}}:"-1"===t?{type:u.unbounded,option:{type:i}}:(i=/^\[@([-\+])(\d+(\.\d+)?)\]$/.exec(t))&&(t=i[1],i=Number(i[2]),o=void 0,"-"===t?o=s.WindowOverFramePreceding.NPreceding:"+"===t&&(o=s.WindowOverFrameFollowing.NFollowing),r===s.WindowOverFrameType.ROWS||r===s.WindowOverFrameType.GROUPS?i=Math.floor(i):e&&("-"===t?o=s.WindowOverFrameFollowing.NFollowing:"+"===t&&(o=s.WindowOverFramePreceding.NPreceding)),0!==i)?{type:u.range,value:Number(t+i),option:{type:o,offset:i}}:{type:u.current,option:{type:n}}}function d(t,n,i){var r=t.begin,e=t.end,o=!1;e?(n&&i===s.WindowOverFrameType.RANGE?(r.type===u.unbounded||r.type===u.current&&(e.type===u.unbounded||e.type===u.current||e.type===u.range&&e.value<=0)||r.type===u.range&&(e.type===u.unbounded||0<=r.value&&e.type===u.current||e.type===u.range&&r.value>=e.value))&&(o=!0):(r.type===u.unbounded||r.type===u.current&&(e.type===u.unbounded||e.type===u.current||e.type===u.range&&0<=e.value)||r.type===u.range&&(e.type===u.unbounded||r.value<=0&&e.type===u.current||e.type===u.range&&r.value<=e.value))&&(o=!0),t.begin=t.begin.option,t.end=t.end.option,o||(t.begin.offset=-1,t.end.offset=-1)):t.begin=t.begin.option}function v(t){return("number"==typeof t||t&&2===t.type&&"number"==typeof t.value)&&((t=t.value?t.value:t)===s.WindowOverFrameExcludeMode.current||t===s.WindowOverFrameExcludeMode.group||t===s.WindowOverFrameExcludeMode.none||t===s.WindowOverFrameExcludeMode.ties)}function p(t){return"number"==typeof t?t:t.value}Object.defineProperty(n,"__esModule",{value:!0}),n.addFrameGroupsCustomFunctions=n.addFrameRowsCustomFunctions=n.addFrameRangeCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/dataSource/dataSource.interface.js"),c=i("./dist/src/dataSource/utils.js"),f=i("./dist/src/calculation/functions/windowOvers/util.js"),(i=u=u||{})[i.unbounded=-1]="unbounded",i[i.current=0]="current",i[i.range=1]="range",n.addFrameRangeCustomFunctions=e,n.addFrameRowsCustomFunctions=o,n.addFrameGroupsCustomFunctions=a},"./dist/src/calculation/functions/windowOvers/util.js":function(t,n,i){"use strict";var r,i;function e(t,n){return t.getCalcService().unparse(t,n,0,0)}function o(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function u(t,n){try{return t.getCalcService().parse(t,n,0,0)}catch(t){return null}}function s(t,n,i){t.wEt("windowFrameOrder",!1===(i&&0<i.length&&i[0].ascending));var i=t.getCalcService().evaluateExpression(t,n,{row:0,col:0});return t.wEt("windowFrameOrder"),i}function c(t,n){var i,n,i=e(t,n);return 14===n.type?(i=i.replace(/[\[\]]/g,""),(n=t.nM.awe(i))&&(i=n)):i="=".concat(i),i}function f(t){return(0,r.isNullOrUndefined)(t)?null:t.functionName||t.function&&t.function.name}function a(t){return f(t)===n.PARTITIONBY}function h(t){return f(t)===n.ORDERBY}function l(t){var t=f(t);return t===n.FRAMERANGE||t===n.FRAMEROWS||t===n.FRAMEGROUPS}function d(t){return f(t)===n.WINDOWDEF}function v(t,n,i,r){var e,o,u;return a(n)?(e=p(t,n),h(i)?(o=p(t,i),l(r)&&(u=w(t,r,o))):l(i)?u=w(t,i):b(i)&&l(r)&&(u=w(t,r,o))):h(n)?(o=p(t,n),l(i)&&(u=w(t,i,o))):l(n)?u=w(t,n):b(n)&&(h(i)?(o=p(t,i),l(r)&&(u=w(t,r,o))):l(i)&&(u=w(t,i))),{partitions:e,orders:o,windowFrame:u}}function p(t,n){var i=o(t,n);return i.formula=e(t,n),i}function w(t,n,i){var i=s(t,n,i);return i.formula=e(t,n),i}function b(t){return t&&3===t.type}Object.defineProperty(n,"__esModule",{value:!0}),n.isStringExpression=n.getOverOptions=n.isWindowDef=n.isWindowFrame=n.isOrderBy=n.isPartitionBy=n.getExprFunctionName=n.getFieldOption=n.evaluateFrameExpression=n.parseFormula=n.evaluateExpression=n.unparseExpression=n.WINDOWDEF=n.WINDOWOVERDECONSTRUCT=n.FRAMEGROUPS=n.FRAMEROWS=n.FRAMERANGE=n.ORDERDESC=n.ORDERASC=n.ORDERBY=n.PARTITIONBY=n.WINDOWOVER=n.CalcFunction=void 0,r=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.WINDOWOVER="WINDOW",n.PARTITIONBY="PARTITIONBY",n.ORDERBY="ORDERBY",n.ORDERASC="ORDERASC",n.ORDERDESC="ORDERDESC",n.FRAMERANGE="FRAMERANGE",n.FRAMEROWS="FRAMEROWS",n.FRAMEGROUPS="FRAMEGROUPS",n.WINDOWOVERDECONSTRUCT="WINDOWOVERDECONSTRUCT",n.WINDOWDEF="WINDOWDEF",n.unparseExpression=e,n.evaluateExpression=o,n.parseFormula=u,n.evaluateFrameExpression=s,n.getFieldOption=c,n.getExprFunctionName=f,n.isPartitionBy=a,n.isOrderBy=h,n.isWindowFrame=l,n.isWindowDef=d,n.getOverOptions=v,n.isStringExpression=b},"./dist/src/calculation/functions/windowOvers/windowOver.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWOVER,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var o=t.Whe.D5;return o||(t.Whe.D5=o=u(t.source,t.Whe)),t.source.nM._getValueByField(o,t.source.DJ)},r.Functions.defineGlobalCustomFunction(e.WINDOWOVER,new t)}function u(t,n){var t=(0,e.unparseExpression)(t,n);return"="===t[0]?t:"="+t}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js":function(t,n,i){"use strict";var r,a;function e(){function t(){}(t.prototype=new r.Functions.Function(a.WINDOWOVERDECONSTRUCT,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var t,o,u,s,c,u,i,r,f,e,t=t.source,o=(0,a.unparseExpression)(t,n),u=(0,a.getOverOptions)(t,i,r,e),s=u.partitions,c=u.orders,u=u.windowFrame,i=h(i,t)||h(r,t)||h(e,t)||{},r={windowExpression:n,windowFormula:o,partitions:s||i.partitions,orders:c||i.orders,windowFrame:u||i.windowFrame,formulaFromWindowChaining:void 0,windowDefineName:i.windowDefineName},f;return 0<Object.keys(i).length&&(e="=".concat(a.WINDOWOVER,"(").concat(o),r.partitions&&(e+=",".concat(r.partitions.formula)),r.orders&&(e+=",".concat(r.orders.formula)),r.windowFrame&&(e+=",".concat(r.windowFrame.formula)),r.formulaFromWindowChaining=e+=")"),r},r.Functions.defineGlobalCustomFunction(a.WINDOWOVERDECONSTRUCT,new t)}function h(t,n){var i,i,i,t,i,i,i,r,e,i,n;if((0,a.isStringExpression)(t))return t=t.value,(i=null==(i=null==(i=null==(i=n.nM._dataSource)?void 0:i.options)?void 0:i.schema)?void 0:i.window)&&i[t]&&(i=i[t])&&(i=(0,a.parseFormula)(n,i),(0,a.isWindowDef)(i))?(r=i.arguments[0],e=i.arguments[1],i=i.arguments[2],(n=(0,a.getOverOptions)(n,r,e,i)).windowDefineName=t,n):{windowDefineName:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDeconstructCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDeconstructCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/windowOverDefine.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWDEF,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r){return(0,e.getOverOptions)(t.source,n,i,r)},r.Functions.defineGlobalCustomFunction(e.WINDOWDEF,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDefineCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDefineCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOvers.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f;function a(){(0,r.addWindowOverCustomFunctions)(),(0,f.addWindowOverDefineCustomFunctions)(),(0,c.addWindowOverDeconstructCustomFunctions)(),(0,e.addPartitionByCustomFunctions)(),(0,o.addOrderByCustomFunctions)(),(0,u.addFrameRangeCustomFunctions)(),(0,u.addFrameRowsCustomFunctions)(),(0,u.addFrameGroupsCustomFunctions)(),(0,s.addOrderAscCustomFunctions)(),(0,s.addOrderDescCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverFunctions=void 0,r=i("./dist/src/calculation/functions/windowOvers/windowOver.js"),e=i("./dist/src/calculation/functions/windowOvers/partitionBy.js"),o=i("./dist/src/calculation/functions/windowOvers/orderBy.js"),u=i("./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js"),s=i("./dist/src/calculation/functions/windowOvers/ascDesc.js"),c=i("./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js"),f=i("./dist/src/calculation/functions/windowOvers/windowOverDefine.js"),n.addWindowOverFunctions=a},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,i){"use strict";var i,h,l,r;function d(i,r,e){return function(t){var n=[];return n.push(t.kEt(t.mEt(i),r||t._dataSource.DEt,e)),n}}function e(){}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,i=i("Common"),h=null,l=i.Common.zf.fJ,e.parseParam=function(o,u,s,c){for(var f,a,t,n,f=Object.keys(c.tables),a=new e,t=function(t){var t,n,i,r,e,t=f[t];o===t?(a.getValue=function(t){var t;return a.QJe||(t=t.ASt(h,h,u,s),a.QJe=t)},a.table=c.tables[t]):l(o,t)&&(a.table=c.tables[t],n=o[t.length],i=o.substr(t.length+1),"#"===n?(r=parseInt(i,10),a.getValue=function(t){var n;return a.QJe||((n=[]).push(t.kEt(r,u||t._dataSource.DEt,s)),a.QJe=n)}):"/"===n?a.getValue=function(t){var t;return a.QJe||(t=d(i,u,s)(t),a.QJe=t)}:"?"===n?1===(e=i.split("=",2)).length?a.getValue=function(t){var t;return a.QJe||(t=d(i,u,s)(t),a.QJe=t)}:a.getValue=function(t){var t;return a.QJe||(t=t.ASt(e[1],e[0],u,s),a.QJe=t)}:delete a.table)},n=0;n<f.length;n++)t(n);return a},n.QueryFunctionSolver=e},"./dist/src/calculation/tokenResolver.js":function(t,n,i){"use strict";var r,e,c,h,f,o,u,s,a;function l(t){var n=s.call(this,14)||this;return n.value=t,n}function d(t){return a.call(this,t)||this}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,e=i("CalcEngine"),c=i("./dist/src/calculation/calcSource.js"),h=i("./dist/src/dataSource/utils.js"),s=e.Expression,r(l,s),l.prototype.Iwt=function(t,n){var i;this.value instanceof c.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},f=l,a=e.TokenResolver,r(d,a),d.prototype.resolveToken=function(t,n,i,r,e){var i,o,t,t,i,u,s,i=i[r],o=i.Awt,t=t.source,t=t&&t.nM;if(t&&0===i.uit&&"["===o[0]&&"]"===o[o.length-1]&&(i=new c.DataManagerReference,-1!==(u=this.EEt(i,o,1)))&&(i.rowString=o.substring(1,u),-1!==(u=this.jEt(i,o,u))))return i.table=t,i.Pq=i.field,i.field=t.bEt(i.field),{expr:s=new f(i),index:r+1}},d.prototype.EEt=function(t,e,n){var o,i,r,u,s;function c(t,n){for(var i=n?t+1:t;"0"<=e[i]&&e[i]<="9";)i++;for(;" "===e[i];)i++;return{value:parseInt(e.substring(t,i),10),end:i}}function f(t){for(var n=t;n<e.length&&"["!==e[n]&&"]"!==e[n]&&","!==e[n];)n++;return{type:"key",value:e.substring(t,n).trim(),end:n}}function a(t){var n,i,r,i,n=e[t],i=e[t+1];return"@"===n?(o=!0,"+"===i||"-"===i?(r=c(t+1,!0)).end<=t+1?-1:{num:r.value,end:r.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===n?(r=c(t+1)).end>t+1?{num:r.value,end:r.end,relative:!1}:"last"===e.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===e.substr(t+1,3)?{type:"odd",end:t+4}:"even"===e.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"!==n||(i=f(t+1)).end>=e.length?-1:i}for(o=!1,i=null;n<e.length&&"["!==(r=e[n])&&"]"!==r;)if(i||"@"!==r&&"#"!==r&&"$"!==r){if(","===r&&i)i=!1;else if(" "!==r)break;n++}else{if(-1===(u=a(n)))return-1;if(":"!==e[u.end]||(0,h.isNullOrUndefined)(u.num))t.row.push(u),n=u.end;else{for(n=u.end+1;" "===e[n];)n++;if(-1===(s=a(n))||(0,h.isNullOrUndefined)(s.num))return-1;t.row.push([u,s]),n=s.end}i=!0}return t.gEt=o,!1===i?-1:n},d.prototype.jEt=function(t,i,n){var r,e,o;function u(t){for(var n=t;"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}function s(t){for(var n=t;"."!==i[n]&&"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}for(r=null;n<i.length;)if("["!==(e=i[n])||r){if("]"===e)break;if(" "===e)n++;else if("."===e&&r)n++,r=!1;else{if("."===e||r)return-1;o=s(n),t.field.push(o.str),n=o.end,r=!0}}else{if((o=u(n+1)).end<=n+1)return-1;t.field.push(o.str),n=o.end+1,r=!0}return n===i.length-1?n:-1},d.prototype.unparse=function(t,n,i,r){var e,o,u,s,c,f;if(14!==i.type)return!1;if(r.push("["),0<(e=i.value.rowString).length&&r.push(e),0<(o=i.value.Pq).length)for(u="@"===e||""===e,s=0,c=o.length;s<c;s++)f=o[s],!u||-1<f.indexOf(" ")?r.push("[".concat(f,"]")):r.push(f),s<c-1&&r.push(".");return r.push("]"),!0},n.DataManagerTokenResolver=d},"./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js":function(t,n,i){"use strict";var r,e,o,u,s;function c(t){this.QSt={},this.N3=t}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerProxy=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),c.prototype.getTable=function(t){var n,i;if(!(0,e.isNullOrUndefined)(t)){if(this.QSt[t])return this.QSt[t];if((n=this.N3.tables)[t])return this.QSt[t]=new u.ReportTable({dataManagerTable:n[t]}),this.QSt[t];for(i in t=t.toUpperCase(),n)if(n.hasOwnProperty(i)&&i.toUpperCase()===t)return this.QSt[t]=new u.ReportTable({dataManagerTable:n[i]}),this.QSt[t];return(0,o.isFormulaInWhitelist)(t)?(this.QSt[t]=this.generateFormulaTableByFormula(t),this.QSt[t]):void 0}},c.prototype.getCalcService=function(){var t=this.N3.Lp;return t.allowDynamicArray=!0,t},c.prototype.getTables=function(){return this.QSt},c.prototype.getRelationshipsByTable=function(t){var n,i,n=this.N3.relationships;return t&&(i=t.table(),n=n.filter(function(t){return t.sourceTable===i||t.targetTable===i})),n},c.prototype.generateFormulaTableByFormula=function(t){var n,i,n,n=this.getCalcService(),i=new r.CalcSource(n),n=(0,o.getFormulaResult)(n,i,t.replace(/__\d+__\d+/g,""));return new u.ReportTable({formulaTable:{name:t,formulaResult:n}})},c.prototype.clearTableDataCache=function(){var t,n,t=this.QSt;for(n in t)t.hasOwnProperty(n)&&t[n].clearTableDataCache()},n.DataManagerProxy=c},"./dist/src/data-manager-report/data-manager-proxy/report-table.js":function(t,n,i){"use strict";var s,r;function e(t){var i,n,t,i=this,n=t.dataManagerTable,t=t.formulaTable;n?(this._le=n,this.sbe={}):this.jle=t,this.jle&&(this.Ele=this.jle.formulaResult.map(function(t){var n={};return n[i.jle.name]=t,n}))}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTable=void 0,s=i("./dist/src/dataManager.entry.js"),Object.defineProperty(e.prototype,"name",{get:function(){return(this._le||this.jle).name},enumerable:!1,configurable:!0}),e.prototype.table=function(){return this._le},e.prototype.getFields=function(){return this._le.ltt()},e.prototype.getData=function(t){var n,i,r,e;if(this.jle)if(t)for(n=[],i=0,r=t;i<r.length;i++)e=r[i],n.push(this.Ele[e]);else n=this.Ele;else n=this._le.getDataSync(t);return n},e.prototype.length=function(){return this.jle?this.Ele.length:this._le.length()},e.prototype.getValueByField=function(t,n,i){var r,e,o,u;return this.jle?(0,s.formatCalcError)(this.jle.formulaResult[n]):(r=void 0,(e=this.sbe[t])&&e.hasOwnProperty(n)?r=e[n]:((o=this._le.columns)[u=t]&&"string"==typeof o[t].value&&(u=o[t].value),r=this._le._getValueByField(u,n),(e=e||(this.sbe[t]={}))[n]=r),t.startsWith("=")&&!i?(0,s.formatCalcError)(r):r)},e.prototype.hasField=function(n){return this.jle?n===this.jle.name:(n=n.toUpperCase(),0<Object.keys(this._le.columns).filter(function(t){return t.toUpperCase()===n}).length)},e.prototype.getFieldByNameIgnoreCase=function(t){return this.jle?{fieldName:this.name}:this._le.Ole(t)},e.prototype.reset=function(){this.jle||(this._le.XOt={})},e.prototype.clearTableDataCache=function(){this.sbe={}},n.ReportTable=e},"./dist/src/data-manager-report/data-manager-report.js":function(t,n,i){"use strict";var n,r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/dataManager.js"),e=i("./dist/src/data-manager-report/tree-data-generator/index.js"),(o=n.Common.lt.Dh)(r.DataManager.prototype,{generateTreeData:function(t){var n;new e.TreeDataGenerator(this,t).generateTreeData()}})},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js":function(t,n,i){"use strict";var x,T,D,r;function e(t,n,i,r,e){this.N3=t,this.DJ=n,this.Rle=i,this.Lle=r,this.Ble=e}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportCrossHelper=void 0,x=i("./dist/src/dataManager.entry.js"),T=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),D=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.processCrossCells=function(t){var u=this;try{t.forEach(function(t){var n,o,i,n=t.leftParent.data.groups,o=t.upParent.data.groups,i=u.Fle(t);i?i.data.groups.forEach(function(i){var r,e,r=[],e=[];n.forEach(function(t){t===i&&r.push(t);for(var n=t.leftParent||t.upParent;n;){if(n===i)return void r.push(t);if(n.cellNode===i.cellNode)return;n=n.leftParent||n.upParent}}),o.forEach(function(t){t===i&&e.push(t);for(var n=t.upParent||t.leftParent;n;){if(n===i)return void e.push(t);if(n.cellNode===i.cellNode)return;n=n.upParent||n.leftParent}}),u.Ple(t,r,e)}):u.Ple(t,n,o)})}catch(t){}},e.prototype.Fle=function(t){for(var n,i,n=t.leftParent;n;){for(i=t.upParent;i;){if(i===n)return n;i=i.upParent||i.leftParent}n=n.leftParent||n.upParent}return null},e.prototype.Ple=function(i,t,n){var o,u,s,c,f,r,e,a,h,l,d,v,p,w,l,l,o=this,u=i.indexOfLeftParentChildren,s=i.indexOfUpParentChildren,c={},f=[],r,e=this.Rle.getRelationshipsMap()[i.relationshipMapKey];for(t.forEach(function(i,r){var t,e;i.crossChildren[u]||(i.crossChildren[u]=[]),t=i.valuePath,c[t]||(c[t]={}),e=c[t],n.forEach(function(t,n){t.crossChildren[s]||(t.crossChildren[s]=[]);var n={vg:i,hg:t,vIndex:r,hIndex:n,crossChildren:[],crossRecordRowNumbers:[]};e[t.valuePath]=n,f.push(n)})}),e&&e.forEach(function(t,r){var n,e,n=o.Lle.generateParentPaths(i.leftParent,t),e=o.Lle.generateParentPaths(i.upParent,t);n.forEach(function(i){e.forEach(function(t){var n=c[i],n=null==n?void 0:n[t];n&&n.crossRecordRowNumbers.push(r)})})}),a=0,h=f;a<h.length;a++)d=(l=h[a]).vg,v=l.hg,p=l.vIndex,w=l.hIndex,l=l.crossRecordRowNumbers,l=this.Ule(d,v,l,i),d.crossChildren[u][w]=l,v.crossChildren[s][p]=l},e.prototype.Ule=function(t,n,i,r,e){var o,u,s,s,c,f,o,o=this.N3;return t&&n||(s=(s=(u=t||n)&&u.cellNode)&&s.relationshipMapKey,c=r.relationshipMapKey,void 0!==s&&c!==s&&i&&i.length&&(f=(0,T.getTableNameByCellNode)(r),o=o.getTable(f))&&e&&(i=this.Lle.zle(r,i,o,e,c,s,u))),"No"===r.templateCell.expansionDirection?this.Vle(t,n,i,r):this.Yle(t,n,i,r)},e.prototype.Vle=function(t,n,i,r){var e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,b;if(r.templateCell.dataColumn?(u=r.templateCell.dataColumn.tableName,s=r.templateCell.dataColumn.columnName):r.templateCell.formula&&"No"!==r.templateCell.expansionDirection&&(0,T.isFormulaInWhitelist)(r.templateCell.formula)&&(u=(0,T.getTableNameByCellNode)(r),s=r.templateCell.formula),c=[],f={},(0,x.isNullOrUndefined)(u))e=r.templateCell.value;else{if(!(o=this.N3.getTable(u)))return[];D.DataManagerReportSortHelper.parseSortOptionsToSorts(r.templateCell),a=(this.Rle.getTableNameCacheFromParent(r)||u).toUpperCase(),h=this.Rle.getRelationshipsMap()[r.relationshipMapKey],i.forEach(function(t){var t=h[t]&&h[t][a];void 0===t||f[t]||(c.push(t),f[t]=!0)}),l=c.map(function(t){return o.getValueByField(s,t)}),e=this.Zle(l,r)}for(d={value:e,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:i,cellNode:r,state:"normal",Qle:f},0!==c.length||(0,x.isNullOrUndefined)(u)||(d.defaultFormula=(0,T.generateDefaultFormulaByTemplateCell)(r.templateCell),d.state="new"),v=0,p=r.children;v<p.length;v++)m=b=void 0,(w=p[v]).leftParent===r?b=d:w.upParent===r&&(m=d),b=this.Ule(b,m,i,w,o),d.childrenArray.push(b);return r.data.groups.push(d),[d]},e.prototype.Yle=function(h,l,d,v){var u,t,n,t,p,w,s,n,b,t,m,i,r,e,o,c,f,a,j,y,g,_,t,n,t,O,S,C,F,R,I,N,E,M,E,u=this,p=[],w=v.templateCell,s=w.dataSetting,n=s.type;if(w.dataColumn?(t=w.dataColumn.tableName,m=w.dataColumn.columnName):w.formula&&"No"!==w.expansionDirection&&(0,T.isFormulaInWhitelist)(w.formula)&&(t=(0,T.getTableNameByCellNode)(v),m=w.formula),(0,x.isNullOrUndefined)(t))p.push({value:w.value,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"normal",sortValues:[v.templateCell.value],Qle:{}});else{if(!(b=this.N3.getTable(t)))return[];if(D.DataManagerReportSortHelper.parseSortOptionsToSorts(w),i=(this.Rle.getTableNameCacheFromParent(v)||t).toUpperCase(),r=this.Rle.getRelationshipsMap()[v.relationshipMapKey],e=[],o=[],c={},f=[],!d){for(a=r.length,j=[],y=0;y<a;)j.push(y++);d=j}d.forEach(function(t){var n,n,n=null==(n=r[t])?void 0:n[i];void 0!==n&&(e.push(n),c[n]||(o.push(n),c[n]=!0),f[n]||(f[n]=[]),f[n].push(t))}),0===d.length?p.push({value:void 0,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"new",sortValues:[],Qle:{},defaultFormula:(0,T.generateDefaultFormulaByTemplateCell)(w)}):"Group"===n?(e.forEach(function(c,f){for(var t,a,n,n,i,r,e,o,n=b.getValueByField(m,c),n=[{value:n,advancedGroupSortName:n}],i=function(n){var t,i,t,r,e,o,u,s,i=n.advancedGroupSortName+"",t=p.find(function(t){return t.value===n.value});if(t)t.recordRowNumbers.push(d[f]),t.Qle[c]||(t.Qle[c]=!0);else{if(r=[],null!=(a=w.Kle)&&a.length)for(e=0,o=w.Kle;e<o.length;e++)u=o[e],(s=void 0,x.isNullOrUndefined)(u.column)||(s=b.getValueByField(u.column,c)),r.push(s);p.push({value:n.value,Jle:i,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[d[f]],cellNode:v,state:"normal",sortValues:r,Qle:((t={})[c]=!0,t)})}},r=0,e=n=null!=(t=s.bins)&&t.length?u.Lle.getAdvancedGroupValue(b,c,s):n;r<e.length;r++)i(o=e[r])}),null!=(t=s.bins)&&t.length&&(g={},_={},p.forEach(function(t){_[t.Jle]=!0}),s.bins.forEach(function(t,n){var n,i;g[t.caption]=n,n=t.caption,_[t.caption]||!0!==t.alwaysVisible||p.push(i={value:n,Jle:n,recordRowNumbers:[],childrenArray:[],leftParent:h,upParent:l,crossChildren:[],state:"new",cellNode:v,sortValues:[],Qle:{}})}),p.sort(function(t,n){var i,r;return g[t.Jle+""]-g[n.Jle+""]}))):"List"===n?o.forEach(function(t,n){var i,i,r,e,o,u,s,c,r=b.getValueByField(m,t),e=[];if(null!=(i=w.Kle)&&i.length)for(o=0,u=w.Kle;o<u.length;o++)s=u[o],(c=void 0,x.isNullOrUndefined)(s.column)||(c=b.getValueByField(s.column,t)),e.push(c);p.push({value:r,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:f[t],cellNode:v,state:"normal",sortValues:e,Qle:((i={})[t]=!0,i)})}):(t=o.map(function(t){return b.getValueByField(m,t)}),n=w.dataSetting,t=(0,T.calc)(t,n.aggregation),p.push({value:t,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:d,cellNode:v,state:"normal",sortValues:[t],Qle:c}))}for(O=0,S=p;O<S.length;O++)for(F=(C=S[O]).recordRowNumbers,R=0,I=v.children;R<I.length;R++)M=E=void 0,(N=I[R]).leftParent===v?E=C:N.upParent===v&&(M=C),E=this.Ule(E,M,F,N,b),C.childrenArray.push(E);return null!=(n=this.Ble)&&n.sortGroupsBySortCondition(p,v,null==(t=this.DJ)?void 0:t.cellNodeGetter),p.forEach(function(t){v.data.groups.push(t)}),p},e.prototype.Zle=function(t,n){var n,i,n=n.templateCell.dataSetting;return n&&"Group"===n.type?(i=[],t.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),1<i.length?i:i[0]):"List"===n.type?t.map(function(t){return t}):(0,T.calc)(t,n&&n.aggregation||"Sum")},n.DataManagerReportCrossHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js":function(t,n,i){"use strict";var l,E,P,g,r;function e(t,n,i,r){this.N3=t,this.DJ=n,this.Xle=new l.CalcSource(t.getCalcService()),this.$le={},this.XVe={},this.Ble=r,this.Rle=i}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportGroupHelper=void 0,l=i("CalcEngine"),E=i("./dist/src/dataManager.entry.js"),P=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),g=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.generateCellNodeTreeData=function(n,t,i,r,e,o,u){var s,c,f,a,h,f,c,l,d,v,p,w,b,m,j,y,s,y,f=this.N3,h=(0,P.getTableByCellNode)(f,n),f=[],c={};for(n.templateCell.dataColumn?a=n.templateCell.dataColumn.columnName:n.templateCell.formula&&(0,P.isFormulaInWhitelist)(n.templateCell.formula)?a=n.templateCell.formula:f.push({value:n.templateCell.value,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:t,upParent:i,crossChildren:[],state:"normal",cellNode:n,sortValues:[],valuePath:this.the(t,i)+"/"+n.templateCell.value}),h||0!==f.length||f.push({value:void 0,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:t,upParent:i,crossChildren:[],state:"new",cellNode:n,sortValues:[],valuePath:this.the(t,i)+"/",defaultFormula:(0,P.generateDefaultFormulaByTemplateCell)(n.templateCell)}),g.DataManagerReportSortHelper.parseSortOptionsToSorts(n.templateCell),l=this.Rle&&this.Rle.generateRelationshipMapKeyByCellNode(n),v=f=(d=0)===f.length?this.Qqn(c,n,h,a,l,t,i,r,e,o,u):f;d<v.length;d++)for(w=(p=v[d]).recordRowNumbers,b=0,m=n.children;b<m.length;b++)(j=m[b]).leftParent&&j.upParent?p.childrenArray.push([]):(s=y=void 0,j.leftParent?y=p:j.upParent&&(s=p),y=this.generateCellNodeTreeData(j,y,s,w,h,l,u),p.childrenArray.push(y),null!=(s=j.slices)&&s.forEach(function(t){delete t.groupMapCache,delete t.groupsCache}));return null!=(c=this.Ble)&&c.sortGroupsBySortCondition(f,n,this.DJ&&this.DJ.cellNodeGetter),f.forEach(function(t){return n.data.groups.push(t)}),f},e.prototype.clearCache=function(t){t&&(this.Xle=null,this.$le=void 0,this.XVe=void 0)},e.prototype.Qqn=function(t,r,n,i,e,o,u,s,c,f,a){var h,l,d,v,h,p,w,l,b,m,j,l,y,g,b,_,O,S,d=[],v={},h=null==(h=this.Rle)?void 0:h.getRelationshipsMap(),p=r.templateCell,w=p.dataSetting;if(e&&h&&h[e]||s)if(l=0===(null==(l=null==h?void 0:h[e])?void 0:l.length),b=!c&&s&&0===s.length,l||b?s=void 0:void 0!==f&&e!==f&&s&&s.length&&(s=this.zle(r,s,n,c,e,f,o||u)),m=s?s.length:e?h[e].length:0,j=this.the(o,u),w&&"Summary"===w.type)d=this.nhe(r,n,i,s,e,o,u,j);else{if(0===m)l={value:void 0,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"new",cellNode:r,sortValues:[],valuePath:j+"/",defaultFormula:(0,P.generateDefaultFormulaByTemplateCell)(p)},d.push(l);else{for(y=0;y<m;y++)g=s?s[y]:y,this.ehe(d,t,v,r,n,i,g,e,o,u,j,a);"No"===p.expansionDirection&&(_=(b=d[0])&&Array.isArray(b.value))&&(b.Jle=b.Jle.toString(),b.valuePath+=b.value.toString())}w&&"Group"===w.type&&w.bins&&w.bins.length&&(O={},S={},d.forEach(function(t){S[t.Jle]=!0}),w.bins.forEach(function(t,n){var n,i;O[t.caption]=n,n=t.caption,S[t.caption]||!0!==t.alwaysVisible||d.push(i={value:n,Jle:n,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"new",cellNode:r,sortValues:[],valuePath:j+"/"+n})}),d.sort(function(t,n){var i,r;return O[t.Jle+""]-O[n.Jle+""]}))}return d},e.prototype.ehe=function(c,f,a,h,t,n,l,i,d,v,p,w){var b,r,e,r,n,m,o,r,e,r,j,e,y,i,g,u,s,_,O,S,C,e,F,R,I,N,b=this,o,r=(null==(r=this.Rle)?void 0:r.getTableNameCacheFromParent(h))||(null==t?void 0:t.name),e=null==(e=this.Rle)?void 0:e.getRelationshipsMap(),r=r.toUpperCase(),j=e?e[i][l][r]:l;if(void 0!==j||e&&e[i][l].hasOwnProperty(r)){if(e=t.getValueByField(n,j),y=[{value:e,advancedGroupSortName:e}],i=h.templateCell.dataSetting,g=[],null!=(r=h.templateCell.Kle)&&r.length)for(u=0,s=h.templateCell.Kle;u<s.length;u++)S=(_=s[u]).column,C=_.formula,(O=void 0,E.isNullOrUndefined)(S)?(0,E.isNullOrUndefined)(C)||(O=t.getValueByField(C,j)):O=t.getValueByField(_.column,j),g.push(O);for(i&&"Group"===i.type&&(null!=(n=i.bins)&&n.length||i.formula)&&(y=this.getAdvancedGroupValue(t,j,i),e=(e=h.templateCell.Hle)||(h.templateCell.Hle=[]),F=(F=e[j])||(e[j]=[]),y.forEach(function(t){var t=t.value+"";-1===F.indexOf(t)&&F.push(t)})),R=i&&"List"===i.type,I=function(t){var t,n,i,u,r,e,o,s,t=y[t],n=t.value,i=t.advancedGroupSortName,u=f[n];u&&!R||(r=!0,R&&(u=a[j])&&(r=!1),"No"===h.templateCell.expansionDirection&&(u=c[0])&&(r=!1,e=u.value,o=u.Jle,Array.isArray(e)||(e=[u.value]),Array.isArray(o)||(o=[u.Jle]),u.Qle[j]||(e.push(t.value),o.push(t.advancedGroupSortName)),u.value=e,u.Jle=o,u.valuePath=p+"/",f[n]=u),r&&(u={value:t.value,Jle:i,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:d,upParent:v,crossChildren:[],state:"normal",cellNode:h,valuePath:p+"/"+t.value+(R?"/"+j:""),sortValues:g,slices:[]},c.push(u),f[n]=u,R)&&(a[j]=u)),null!=(m=h.slices)&&m.length&&(s=u.value,h.slices.forEach(function(t,n){var i,r,e,i,r,o,i=t.groupsCache,r=t.groupMapCache,e=(e=(i=i||(t.groupsCache={}))[s+""])||(i[s+""]=[]),i=(i=(r=r||(t.groupMapCache={}))[s+""])||(r[s+""]={}),r=t.templateCell.dataColumn.tableName,o=t.templateCell.dataColumn.columnName;b.ehe(e,i,a,t,b.N3.getTable(r),o,j,void 0,void 0,void 0,""),void 0===u.slices[n]&&(u.slices[n]={childrenArray:[e]})})),u.recordRowNumbers.push(l),null!=w&&w.ignoreMultipleTableJoinCache||u.Qle[j]||(u.Qle[j]=!0)},N=0;N<y.length;N++)I(N)}},e.prototype.the=function(t,n){var i,r,t,i="";return t?(r=(0,E.isNullOrUndefined)(t.value)?"":t.value,i=void 0!==t.valuePath?t.valuePath:r.toString()):n&&(t=(0,E.isNullOrUndefined)(n.value)?"":n.value,i=void 0!==n.valuePath?n.valuePath:t.toString()),i},e.prototype.nhe=function(t,n,i,r,e,o,u,s){for(var c,c,f,a,h,l,d,v,p,w,b,m,j,c,c,y,f=t.templateCell.dataSetting,a=null==(c=this.Rle)?void 0:c.getRelationshipsMap(),h=(r||a[e]).length,l=[],d=[],v={},p,w=((null==(c=this.Rle)?void 0:c.getTableNameCacheFromParent(t))||(null==n?void 0:n.name)).toUpperCase(),b=0;b<h;b++)m=r?r[b]:b,j=a?a[e][m][w]:m,l.push(m),v[j]||(d.push(j),v[j]=!0);return c=d.map(function(t){return n.getValueByField(i,t)}),c=(0,P.calc)(c,(null==f?void 0:f.aggregation)||"Sum"),[y={value:c=(0,E.isNullOrUndefined)(c)?0:c,Jle:"",recordRowNumbers:l,Qle:v,childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"normal",cellNode:t,valuePath:s+"/"+c,sortValues:[],slices:[]}]},e.prototype.zle=function(t,i,n,r,e,o,u){var s,s,c,f,a,o,h,s,l,t,d,t,v,p,v,w,b,m,j,y,g,_,O,S,C,F,R,I,I,N,E,M,x,T,D,s=this.Rle.getRelationshipsMap(),c=s[e],f=s[o],a=r.name,o=null==(s=t.templateCell.ihe)?void 0:s.condition,h=[],s=u.cellNode,l=u.valuePath,t="".concat(e,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col),d=this.$le[t];if(d=d||(this.$le[t]=[]),t=null==c?void 0:c[0],v=n.name.toUpperCase(),p=a.toUpperCase(),v=(null==t?void 0:t.hasOwnProperty(v))&&t.hasOwnProperty(p),o){if(v){if((w=this.rhe(e,a=p))&&f){for(b=[],m=[],j=[],y=0,g=i;y<g.length;y++)if(!j[O=f[_=g[y]][a]]&&(S=w[O]))for(j[O]=!0,C=0,F=S;C<F.length;C++)m[R=F[C]]||(null!=(I=d[R])&&I[l]?b.push(R):(void 0===(I=h[R])&&(I=this.ohe(c[R],u),h[R]=I),I&&(b.push(R),m[R]=!0,d[R]||(d[R]={}),d[R][l]=!0)));return b}}else if(n===r){if(N=[],c)return E=this.Rle.getTableNameCacheFromParent(s),M=(0,P.toUpperCase)(E||r.name),c.forEach(function(t,n){-1!==i.indexOf(t[M])&&N.push(n)}),N}else if(n!==r)return null}else if(n===r){if(b=[],f){for(E=this.Rle.getTableNameCacheFromParent(s),x=(0,P.toUpperCase)(E||r.name),T=0,D=i;T<D.length;T++)_=D[T],b.push(f[_][x]);return b}}else if(n!==r)return null;return i},e.prototype.rhe=function(t,n){var i,r,e,o,u,s,c,f,a,i=n+"__TO__"+t;if(this.XVe[i])return this.XVe[i];if(e=(r=this.Rle.getRelationshipsMap())[t]){for(o=[],c=s=u=void 0,n=n.toUpperCase(),f=0,a=e.length;f<a;f++)(c=o[s=(u=e[f])[n]])||(o[s]=c=[]),c.push(f);return this.XVe[i]=o}},e.prototype.getAdvancedGroupValue=function(t,n,i){var r,e,o,i,o,u,s,c,f,a,h,h,h,r=this.N3,e=[],o=i.formula,i=i.bins;if(o)(o=o.trim()).startsWith("=")||(o="="+o),o=t.getValueByField(o,n),e.push({value:o,advancedGroupSortName:o});else if(i)for(u=0,s=i;u<s.length;u++)if(f=(c=s[u]).caption,a=c.groupBy){if("string"==typeof a)if((h=r.getCalcService().parse(this.Xle,a,0,0)).type===l.ExpressionType.name){if(h=(0,P.fieldExpressionToField)(h.value),e.push({value:t.getValueByField(h,n),advancedGroupSortName:f}),!1!==c.stopIfTrue)break}else if((h=t.getValueByField(a,n,!0))&&!(h instanceof l.CalcError)&&(e.push({value:f,advancedGroupSortName:f}),!1!==c.stopIfTrue))break}else if(0===e.length&&(e.push({value:c.caption,advancedGroupSortName:c.caption}),!1!==c.stopIfTrue))break;return e},e.prototype.ohe=function(t,n,i){var r,e,o,u,s,c,r,r,i,f,r,e=n.cellNode,o=this.Rle.getTableNameCacheFromParent(e)||(0,P.getTableNameByCellNode)(e,!0)||e.templateCell.value+"";return o=o.toUpperCase(),u=this.N3.getTable(o),s=t[o],c=!1,r=null==(r=this.Rle)?void 0:r.getRelationshipsMap(),null!=i&&i.relationshipMapKey&&r[i.relationshipMapKey]&&(r=r[i.relationshipMapKey][0])&&(i=(this.Rle.getTableNameCacheFromParent(i)||(0,P.getTableNameByCellNode)(i,!0)||i.templateCell.value+"").toUpperCase(),c=!(r.hasOwnProperty(o)&&r.hasOwnProperty(i))),void 0===s&&!t.hasOwnProperty(o)&&u?c:!(!(f=n.Qle)[s]&&u)&&(!(r=n.leftParent||n.upParent)||this.ohe(t,r,e))},e.prototype.generateParentPaths=function(i,t){var r,n,e,o,n,u,e,s,c,f,a,h,s,s,l,d,v,r=[],n=i.templateCell,e=n.dataColumn,o=n.dataSetting,n=n.expansionDirection,u=this.Rle.getTableNameCacheFromParent(i)||(null==e?void 0:e.tableName),e=null==e?void 0:e.columnName,s=null==u;return s&&(e=i.templateCell.formula||i.templateCell.value+"",u=(0,P.getTableNameByCellNode)(i,!0)||i.templateCell.value+""),u=null==u?void 0:u.toUpperCase(),c=t[u],(0,E.isNullOrUndefined)(c)?r=s?["/"+i.templateCell.value]:(s=i.data.groups.map(function(t){return"/"+t.value}),s=o&&"List"===o.type?s.map(function(t,n){return"".concat(t,"/").concat(i.data.groups[n].recordRowNumbers[0])}):s):(f=void 0,(f=i.templateCell.Hle?i.templateCell.Hle[c]||[]:(a=void 0,[a="No"===n?null==(s=(h=i.data.groups).filter(function(t){return t.Qle[c]})[0])?void 0:s.value.toString():this.N3.getTable(u).getValueByField(e,c)])).forEach(function(t){r.push("/"+t)}),o&&"List"===o.type&&r.forEach(function(t,n){r[n]+="/".concat(c)})),i.leftParent?(l=this.generateParentPaths(i.leftParent,t),d=[],l.forEach(function(n){r.forEach(function(t){d.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),d):i.upParent?(l=this.generateParentPaths(i.upParent,t),v=[],l.forEach(function(n){r.forEach(function(t){v.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),v):r},n.DataManagerReportGroupHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js":function(t,n,i){"use strict";var K,S,R,o,u,s,r;function e(t,n){var i,r,e;if(this.hhe={},this.tTe=[],this.N3=t,this.DJ=n,this.Xle=new o.CalcSource(t.getCalcService()),this.vhe={},this.mhe=[],this.ghe={},null!=n&&n.parameter){for(e in i={},r=n.parameter)r.hasOwnProperty(e)&&(i[e.toUpperCase()]=r[e]);this.ghe=i}}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportJoinHelper=void 0,K=i("./dist/src/dataManager.entry.js"),S=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),R=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),o=i("CalcEngine"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),s=/\[@([^\]]+\.[^\]]+)\]/i,e.prototype.generateJoinRelationIndexMap=function(t){var t,t,t,t=this.phe(t),t=this.bhe(t),t=this.yhe(t);this.whe(t)},e.prototype.clearCache=function(t){this.vhe={},t&&(this.Xle=null,this.hhe={},this.tTe=[])},e.prototype.setNodeTableCache=function(t,n,i){void 0===this.mhe[t]&&(this.mhe[t]=[]),this.mhe[t][n]=i},e.prototype.Mhe=function(t,n){return this.mhe[t]&&this.mhe[t][n]},e.prototype.getTableNameCacheFromParent=function(t){var n,i,r,e,n=t.relationshipMapKey,i=this.Mhe(t.templateCell.row,t.templateCell.col);if(i)return i;for(r=t.leftParent&&t.upParent,e=t.leftParent||t.upParent;!r&&e&&e.relationshipMapKey===n;){if(i=this.Mhe(e.templateCell.row,e.templateCell.col))return i;r=t.leftParent&&t.upParent,e=e.leftParent||e.upParent}},e.prototype.getRelationshipsMap=function(){return this.hhe},e.prototype.relationshipGraphs=function(t){if(!t)return this.tTe;this.tTe=t},e.prototype.getRelationshipGraphTableIndex=function(t){var n,i,r,n=this.relationshipGraphs(),i=t&&t.name;if(n&&void 0!==i)for(i=i.toUpperCase(),r=0;r<n.length;r++)if(n[r].tables.find(function(t){return t.name.toUpperCase()===i}))return r;return-1},e.prototype.generateRelationshipMapKeyByCellNode=function(t){var n,i,r,e,o,u,o,n,s,c,i,f,a,h,a,h,l,i,f,f,h;if(t)return t.relationshipMapKey||(e=t.leftParent||t.upParent,o=t.leftParent&&t.upParent,u=(0,R.getTableNameByCellNode)(t,!(r=""))||t.templateCell.value+"",r=o?(o=u,this.Che(t),s=void 0,(n=(null==(n=t.templateCell.filter)?void 0:n.condition)||t.templateCell.ihe)&&(c=t.templateCell.ihe.condition,s=this.She(c),o=this.The(s,o,t)),i=this.Ahe(t.leftParent),f=this.Ahe(t.upParent),i||f?i&&f?(a=this.generateRelationshipMapKeyByCellNode(t.leftParent),h=this.generateRelationshipMapKeyByCellNode(t.upParent),"".concat(a,"__CROSS__").concat(o,"__CROSS__").concat(h)):(a=void 0,h=this.generateRelationshipMapKeyByCellNode(t.leftParent),l=this.generateRelationshipMapKeyByCellNode(t.upParent),f=f?l:h,a=-1<(i=i?h:l).indexOf(u)?i:-1<f.indexOf(u)?f:h||l||u,n?this.The(s,a,t):a):o):(this.Che(t),(null!=(i=t.templateCell.filter)&&i.condition||t.templateCell.ihe)&&(e&&!(r=e.relationshipMapKey)&&(e.relationshipMapKey=r=this.generateRelationshipMapKeyByCellNode(e)),c=t.templateCell.ihe.condition,f=this.She(c),r=this.The(f,r=r||u,t)),r||(this.Ahe(e)?-1<(h=this.generateRelationshipMapKeyByCellNode(e)).indexOf(u)?h:"".concat(h,"__AND__").concat(u):u)),t.relationshipMapKey=r)},e.prototype.The=function(t,i,r){var n,e,o,t,n=this,e=t.rules,o=t.relation,t=t.conditions;return e.forEach(function(t){var n,n,n;i=(0,K.isNullOrUndefined)(t.formula)?"Cell"===t.value.type||"DataColumn"===t.value.type?"object"==typeof t.value.data&&t.value.data.tableName?(0,R.toUpperCase)(i+"__"+o+"__"+(0,K.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.tableName,t.value.data.columnName)):"object"==typeof t.value.data&&t.value.data.formulaTableName?(0,R.toUpperCase)(i+"__"+o+"__"+(0,K.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.formulaTableName)):(0,R.toUpperCase)(i+"__"+o+"__"+(0,K.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,R.toUpperCase)(i+"__"+o+"__"+(0,K.combineName)(r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,R.toUpperCase)(i+"__"+o+"__"+t.formula)}),t&&t.forEach(function(t){i=n.The(t,i,r)}),i},e.prototype.phe=function(t){var n=[];return(0,R.traverse)(t,n),n},e.prototype.bhe=function(t){var o,n,o=this,n=[];return t.forEach(function(t){var e=[];t.forEach(function(t){var n,i,r,i=t.templateCell;o.Che(t),null!=(n=i.ihe)&&n.condition&&(r=o.She(i.ihe.condition)),e.push({reportDataTableRelation:r,currentNode:t})}),n.push(e)}),n},e.prototype.parseFilterOptionToFilterConditionTree=function(t){var n,i,r,e,o,u,s,c,f,a,h,n="And",i=[],r=[];if((0,R.hasOrCondition)(t))for(n="Or",o=0,u=e=t.or;o<u.length;o++)s=u[o],(0,R.isSimpleFilterCondition)(s)?i.push(this.Ihe(s)):r.push(this.parseFilterOptionToFilterConditionTree(s));else if((0,R.hasAndCondition)(t))for(f=0,a=c=t.and;f<a.length;f++)h=a[f],(0,R.isSimpleFilterCondition)(h)?i.push(this.Ihe(h)):r.push(this.parseFilterOptionToFilterConditionTree(h));else i.push(this.Ihe(t));return{rules:i,conditions:r,relation:n}},e.prototype.Ihe=function(t){var n,i,i;return t.operator||void 0===t.formula?((0,K.isNullOrUndefined)(t.value)||(i=t.value,n={type:(0,R.getValueType)(i),data:i}),(0,K.isNullOrUndefined)(t.cell)||(n={type:"Cell",data:i="string"==typeof(i=t.cell)&&i.startsWith("=")?i.substring(1):i}),(0,K.isNullOrUndefined)(t.dataColumn)||(n={type:"DataColumn",data:i=t.dataColumn}),(0,K.isNullOrUndefined)(t.parameter)||(n={type:"Parameter",data:i=t.parameter}),(0,K.isNullOrUndefined)(t.formula)||(n={type:"Formula",data:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}),{tableName:t.tableName,column:t.column,operator:t.operator,value:n}):{formula:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}},e.prototype.She=function(t){var n,i,r,e,o,n=this.xhe(t.rules),i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)o=e[r],i.push(this.She(o));return{rules:n,conditions:i,relation:t.relation}},e.prototype.xhe=function(t){var o,u,s,o=this,u=[],s=this.N3;return t.forEach(function(t){var n,i,n,r,e,e;(0,K.isNullOrUndefined)(t.formula)?("Cell"===(i={tableName:t.tableName,column:t.column,operator:t.operator,value:{type:t.value.type,data:t.value.data}}).value.type&&"string"==typeof i.value.data&&R.cellNameReg.test(i.value.data)&&o.DJ.cellNodeGetter&&((r=(n=o.DJ.cellNodeGetter(i.value.data))&&n.templateCell)?r.formula&&"No"!==r.expansionDirection&&(0,R.isFormulaInWhitelist)(r.formula)?(e=(0,R.getFormulaResult)(s.getCalcService(),o.Xle,r.formula),i.value.data={formulaResult:e,formulaString:r.formula,formulaTableName:(0,R.getTableNameByCellNode)(n)}):r.dataColumn?i.value.data=r.dataColumn:i.value.data=r.value:i.value.data=""),"Parameter"===i.value.type&&"string"==typeof i.value.data&&o.ghe&&(e=o.ghe[i.value.data.toUpperCase()],i.value.type=(0,R.getValueType)(e),i.value.data=e),"Formula"===i.value.type&&"string"==typeof i.value.data&&(i.value.data=(0,R.lbe)(o.N3.getCalcService(),o.Xle,i.value.data,o.ghe)),u.push(i)):((n=t.formula.trim()).startsWith("=")||(n="="+n),u.push({formula:n}))}),u},e.prototype.yhe=function(t){var e,n,e=this,n=[];return t.forEach(function(t){var r=[];t.forEach(function(t){var n,i,n,n=t.reportDataTableRelation;n&&(i=e.Nhe(n,t.currentNode)),n={currentNode:t.currentNode,relations:i},r.push(n),e.hbe(t.currentNode)}),n.push(r)}),n},e.prototype.hbe=function(t){var n,i,t,r,e,n=this,t=t.templateCell;"Group"===(null==(i=null==t?void 0:t.dataSetting)?void 0:i.type)&&void 0!==(r=t.dataSetting.formula)&&(t.dataSetting.formula=(0,R.lbe)(this.N3.getCalcService(),this.Xle,t.dataSetting.formula,this.ghe)),u.DataManagerReportSortHelper.parseSortOptionsToSorts(t),null!=t&&t.Kle&&(e=t.Kle).forEach(function(t){void 0!==t.formula&&(t.formula=(0,R.lbe)(n.N3.getCalcService(),n.Xle,t.formula,n.ghe))})},e.prototype.Nhe=function(t,n){var i,r,e,o,i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)o=e[r],i.push(this.Nhe(o,n));return{rules:this.khe(t.rules,n),relation:t.relation,conditions:i}},e.prototype.khe=function(t,n){var r,e,o,r=this,e=[],o=(0,R.getTableNameByCellNode)(n);return t.forEach(function(t){var n,i,n,t,n,t,i=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,K.isNullOrUndefined)(i)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,K.isNullOrUndefined)(t.value.data)?e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?e.push({type:"Join",relationHostTable:null!=(n=t.tableName)?n:o,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&e.push({type:"Join",relationHostTable:o,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(i.startsWith("=")||(i="="+i),(n=(i=(0,R.lbe)(r.N3.getCalcService(),r.Xle,i,r.ghe)).match(s))?(n=(t=n[1].split("."))[0],t=t[1],e.push({type:"Join",formula:i,relationHostTable:o,relationTargetTable:n,relationTargetColumn:t})):e.push({type:"Static",formula:i}))}),e},e.prototype.whe=function(t){var s,c,s=this,c=this.N3;t.forEach(function(t){t.forEach(function(t){var n,i,r,e,o,u,n=t.currentNode,i=(0,R.getTableByCellNode)(c,n),r=t.relations&&(t.relations.rules.length||t.relations.conditions.length),e=n.leftParent&&n.upParent&&"V"===s.currentTreeDirection,o=(0,R.isCellInCrossCell)(n)&&"V"===s.currentTreeDirection;r?(u=s.generateRelationshipMapKeyByCellNode(n),s.hhe[u]&&0!==s.hhe[u].length&&!o||(s.hhe[u]=s.Dhe(t.relations,n))):e?(u=s.generateRelationshipMapKeyByCellNode(n),s.hhe[u]&&0!==s.hhe[u].length||(s.hhe[u]=s.dbe(n))):i&&s._he(i,n)})})},e.prototype.Dhe=function(t,n){var i,r,t,e,o,u,s,c,f,a,h,l,d,v,p,a,l,h,w,b,m,j,j,y,g,_,O,S,C,F,j,i=t.rules,r=t.relation,t=t.conditions;if((0,R.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection)return[];for(e=this.N3,o=[],u=[],s=0,c=i;s<c.length;s++)"Join"===(f=c[s]).type?(a=f.relationHostTable,h=f.relationHostColumn,l=f.relationTargetTable,d=f.relationTargetColumn,v=f.relationCondition,p=f.formula,a=e.getTable(a),l=e.getTable(l),a&&l&&(h=this.buildTableRelationshipMap(a,h,p||v,l,d),o.push({sourceTable:a,targetTable:l,sourceFieldIndexMap:h.sourceFieldIndexMap,targetFieldIndexMap:h.targetFieldIndexMap}))):u.push(f);if(b=!1,n.leftParent&&n.upParent&&"V"===this.currentTreeDirection?o.length?b=!0:w=this.dbe(n):(m=(0,R.getTableByCellNode)(e,n))&&(j="H"===this.currentTreeDirection?n.upParent:n.leftParent,w=(j=this.hhe[j&&j.relationshipMapKey])&&j[0]&&j[0].hasOwnProperty(m.name.toUpperCase())?j:this._he(m,n,!0)),o.length?("And"!==r&&void 0!==r||(o=this.Ehe(o)),y=this.Ohe(o,n,r,i.filter(function(t){return"Join"===t.type})),b&&(w=[].concat(y))):y=w,u.length&&(y=this.Rhe(y,u,n,r,!!o.length,w)),_=i.length?[y]:[],null!=t&&t.length)for(O=void 0,S=0,C=t;S<C.length;S++)F=C[S],O=this.Dhe(F,n),_.push(O);return"And"===r||void 0===r?(j=(0,R.getTableNameByCellNode)(n),g=this.Lhe(_,j)):"Or"===r&&(g=this.Bhe(_,n)),g},e.prototype.dbe=function(t){var n,i,r,i,n,r;return(!t.leftParent||!t.upParent||"H"!==this.currentTreeDirection)&&(t.templateCell.dataColumn||!(0,K.isNullOrUndefined)(t.templateCell.formula)&&(0,R.isFormulaInWhitelist)(t.templateCell.formula))&&(n=this.getRelationshipsMap(),i=t.leftParent.relationshipMapKey,r=t.upParent.relationshipMapKey,i=n&&n[i]||[],n=n&&n[r]||[],i[0])&&n[0]?(r=(0,R.getTableNameByCellNode)(t),this.vbe(i,n,r)):[]},e.prototype.vbe=function(t,n,i){var r,e,o,o,u,s,e,c,r=Object.keys(t[0]),e=Object.keys(n[0]);return-1===r.indexOf(i)&&-1===e.indexOf(i)?(o=this.N3.getTable(i))?this.gbe(o):[]:(u=(o=r.length>e.length?t:n)===t?n:t,(c=1===(e=(s=r.length>e.length?r:e)===r?e:r).length&&-1<s.indexOf(e[0]))?this.Lhe([t,n],i):this.mbe(o,u,i))},e.prototype.mbe=function(r,u,t){var s,n,i,c,e,o,f,a,h,n,s=[],n=Object.keys(r[0]),i=Object.keys(u[0]),c=(0,R.getArraySameItems)(n,i);if(c.length)for(h in e=c[0],o={},f={},r.forEach(function(t,n){var t=t[e];o[t]||(o[t]=[]),o[t].push(n)}),u.forEach(function(t,n){var t=t[e];f[t]||(f[t]=[]),f[t].push(n)}),a=function(t){var n,i;o.hasOwnProperty(t)&&f[t]&&(n=o[t],i=f[t],n.forEach(function(t){var o=r[t];i.forEach(function(t){for(var n,i,r,e,t,t,n=u[t],i=!0,r=1;r<c.length;r++)if(e=c[r],o[e]!==n[e]){i=!1;break}i&&(t=Object.assign({},o),t=Object.assign(t,n),s.push(t))})}))},o)a(h);else(n=this.N3.getTable(t))&&(s=this.gbe(n));return s},e.prototype.Rhe=function(i,t,n,r,p,w){var e,o,b,m,j,y,u,s,c,f,a,h,l,d,v,g,_,O,e=n.templateCell.dataColumn.tableName.toUpperCase(),o=this.N3;if(i=[].concat(i),b=o.getTable(e),m=this.getTableNameCacheFromParent(n)||e,j=[],y=[],t.forEach(function(e){var o,t,u,n,s,c,f,a,h,l,n,d,v,o=e.field,t=e.operator,u=e.value,n=e.formula,s=e.valueType,f=!1,l=!1;(0,K.isNullOrUndefined)(t)?(0,K.isNullOrUndefined)(n)||(o=n,l=!0):"object"!=typeof u?c=S.ValueComparatorFactory.createComparator(t):(u instanceof Date||"Date"===s)&&(c=S.ValueComparatorFactory.createDateComparator(t),u=new Date(u),a=u.setHours(0,0,0,0),h=u.setHours(23,59,59,59),u=u.getTime(),f=!0),void 0!==o&&!b.hasField(o)&&-1<o.indexOf("@")&&!o.startsWith("=")&&(o="="+o),(c||l)&&(n=void 0,"And"===r||void 0===r?n=j[j.length-1]||i:"Or"===r&&(n=(n=y[y.length-1])||(p?w:i)),d=[],v=[],n.forEach(function(t){var n,i,r,n=!1,i=null==t?void 0:t[m];null!=i&&(r=null!=(r=b.getValueByField(o,i))?r:"",n=l?r:f?(r=new Date(r).getTime(),c(r,u,a,h)):("Formula"===s&&(u=b.getValueByField(e.value,i)),c(r,u))),(n?d:v).push(t)}),j.push(d),y.push(v))}),"And"===r||void 0===r)return j[j.length-1];if("Or"===r){for(u=[],s=0,c=j;s<c.length;s++)f=c[s],u=u.concat(f);if(p){for(a={},h=0,l=i;h<l.length;h++)v=(d=l[h])[e],(0,K.isNullOrUndefined)(v)||(a[v]=!0);for(g=0,_=u;g<_.length;g++)v=(O=_[g])[e],(0,K.isNullOrUndefined)(v)||a[v]||i.push(O);return i}return u}},e.prototype.Ehe=function(t){for(var n,i,r,e,o,u,s,n=[],i=[],r=[];t.length;){for(o=[e=t[0]],r=[0],u=1,s=t.length;u<s;u++)e.targetTable===t[u].targetTable&&(o.push(t[u]),r.push(u));for(n.push(e),1<o.length&&i.push(o),u=r.length-1;-1<u;u--)t.splice(r[u],1)}return this.Fhe(i),n},e.prototype.Fhe=function(t){for(var n,i,r,e,o,u,s,c,f,n=0,i=t;n<i.length;n++){for(o=(e=(r=i[n])[0]).sourceFieldIndexMap,u=e.targetFieldIndexMap,s=1,c=r.length;s<c;s++){for(f in o)o.hasOwnProperty(f)&&(o[f]=(0,R.getArraySameItems)(o[f],r[s].sourceFieldIndexMap[f]));for(f in u)u.hasOwnProperty(f)&&(u[f]=(0,R.getArraySameItems)(u[f],r[s].targetFieldIndexMap[f]))}e.sourceFieldIndexMap=o,e.targetFieldIndexMap=u}},e.prototype.buildTableRelationshipMap=function(i,t,r,e,o){var n,u,n,s,c,f,a,h,u,u,l,d,v,p,w,b,m,j,y,u,g,_,u,n=(0,K.isNullOrUndefined)(t)?t:i.getFieldByNameIgnoreCase(t),u=(0,K.isNullOrUndefined)(o)?o:e.getFieldByNameIgnoreCase(o);if(n&&(t=n.fieldName),u&&(o=u.fieldName),n=(0,R.toUpperCase)("".concat(i.name,"__").concat(t,"__").concat(r,"__").concat(e.name,"__").concat(o)),this.vhe[n])return this.vhe[n];function O(t,n,i){t[n]?t[n].push(i):t[n]=[i]}if(s=[],c=[],f=[],a=i.length(),h=e.length(),r.startsWith("=")){for(u="".concat(e.name,".").concat(o),u="\\[@".concat(u,"\\]"),l=new RegExp(u,"i"),d=function(t,n){var t=r.replace(l,'"'.concat(t,'"'));return i.getValueByField(t,n)},(v=e.hasField(o))||o.startsWith("=")||(o="="+o),p=0;p<h;p++)w=e.getValueByField(o,p),(0,K.isNullOrUndefined)(w)||O(f,w,p);for(b=Object.keys(f),m=function(n){var i=[];b.forEach(function(t){d(t,n)&&f[t].forEach(function(t){return i.push(t)})}),(s[n]=i).forEach(function(t){O(c,t,n)})},j=0;j<a;j++)m(j)}else{for(y=S.ValueComparatorFactory.createComparator(r),u=i.hasField(t),v=e.hasField(o),u||t.startsWith("=")||(t="="+t),v||o.startsWith("=")||(o="="+o),j=0;j<a;j++)w=i.getValueByField(t,j),(0,K.isNullOrUndefined)(w)||O(f,w,j);for(g=Object.keys(f),m=void 0,m="Equal"===r?function(n){var t,i,t,t=e.getValueByField(o,n);(0,K.isNullOrUndefined)(t)||(i=[],(t=f[t])&&t.forEach(function(t){return i.push(t)}),(c[n]=i).forEach(function(t){O(s,t,n)}))}:function(n){var i,r,i=e.getValueByField(o,n);(0,K.isNullOrUndefined)(i)||(r=[],g.forEach(function(t){y(t,i)&&f[t].forEach(function(t){return r.push(t)})}),(c[n]=r).forEach(function(t){O(s,t,n)}))},_=0;_<h;_++)m(_)}return u={sourceTable:i,targetTable:e,sourceFieldIndexMap:s,targetFieldIndexMap:c},this.vhe[n]=u},e.prototype.Ohe=function(t,L,V,n){var G,B,q,i,U,r,e,o,o,e,u,s,c,f,a,r,h,c,f,a,H,W,l,d,v,p,w,b,m,f,o,j,y,g,G=this,B=[],q=L.upParent&&L.leftParent,i=L.upParent||L.leftParent,U="";if(i&&(U=this.generateRelationshipMapKeyByCellNode(i),q))if(e=L.upParent,o=L.leftParent,o=this.generateRelationshipMapKeyByCellNode(o),e=this.generateRelationshipMapKeyByCellNode(e),u=this.hhe[o],s=this.hhe[e],u&&s&&u[0]&&s[0])c=Object.keys(u[0]),f=Object.keys(s[0]),a=c.length,r=f.length,h=[],t.forEach(function(t){var n=t.sourceTable.name.toUpperCase(),t=t.targetTable.name.toUpperCase();-1===h.indexOf(n)&&h.push(n),-1===h.indexOf(t)&&h.push(t)}),c=(0,R.getArraySameItems)(c,h).length,f=(0,R.getArraySameItems)(f,h).length,U=(a=a<r&&c||0===f)?o:e,r=(U=a&&0===c?void 0:U)===e?u:s;else{if(s&&s[0])return[];i=L.leftParent,U=this.generateRelationshipMapKeyByCellNode(i)}for(H=[],W=[],l=function(t,n){var i,r,e,o,u,s,c,f,e,u,a,h,l,d,v,p,w,b,m,j,y,g,_,A,O,S,C,F,R,I,N,E,M,x,k,T,D,P,e=t.sourceTable,o=t.sourceFieldIndexMap,u=t.targetTable,s=t.targetFieldIndexMap,c=e.name.toUpperCase(),f=u.name.toUpperCase();if(B=W[W.length-1]||B,o&&s){if(e=G.hhe[U],U&&e||W.length){if(a=f,h=s,l=c,(B=(u=B).length&&"And"===V?B:e)[0]&&!B[0].hasOwnProperty(a)&&(h=o,l=f,!B[0].hasOwnProperty(a=c)))return B=u,n||H.push(t),!1;for(v=[],p=0,w=(d=[].concat(B)).length;p<w;p++)v[b=d[p][a]]||(v[b]=[]),v[b].push(p);if(m=[],j=L.templateCell.row,y=L.templateCell.col,l=l.toUpperCase(),g=(0,K.combineName)(l,j,y),_=h.length,A=G.pbe(d,a,l,h)){for(O=0;O<_;O++)if(void 0!==(S=h[O])&&void 0!==(C=v[O]))if(R=F=0,I=S.length)for(N=0;N<I;N++)for(F=S[N],E=0,M=C.length;E<M;E++)R=C[E],(x=Object.assign({},d[R])).hasOwnProperty(l)?(x[g]=F,G.setNodeTableCache(j,y,g)):x[l]=F,m.push(x);else for(E=0,M=C.length;E<M;E++)R=C[E],(x=Object.assign({},d[R])).hasOwnProperty(l)?(x[g]=void 0,G.setNodeTableCache(j,y,g)):x[l]=void 0,m.push(x);B=m}}else{if(U&&!e&&q)return!0;for(O in B=[],s)if(s.hasOwnProperty(O))if((k=s[O]).length)for(T=0,D=s[O];T<D.length;T++)P=D[T],B.push(((i={})[f]=+O,i[c]=P,i));else B.push(((r={})[f]=+O,r[c]=void 0,r))}W.push(B)}},d=0,v=t;d<v.length&&!l(p=v[d]);d++);for(w=0,b=H;w<b.length&&!l(m=b[w],!0);w++);return"And"===V||void 0===V?B=this.Phe(W[W.length-1],n,L,"And"):"Or"===V&&(B=this.Phe(this.Bhe(W,L),n,L,"Or")),q&&B&&r&&B[0]&&r[0]&&(f=Object.keys(B[0]),o=Object.keys(r[0]),j=(0,R.getArraySameItems)(f,o),y=[],B.forEach(function(n,t){for(var i,r,e,o,u,i=j.map(function(t){return n[t]}),r=y,e=0,o=i;e<o.length;e++)r[u=o[e]]||(r[u]=[]),r=r[u];r.push(t),j.forEach(function(t){delete n[t]})}),g=[],r.forEach(function(e){for(var t,n,i,r,o,t=j.map(function(t){return e[t]}),n=y,i=0,r=t;i<r.length;i++)o=r[i],n=n&&n[o];n&&n.forEach(function(t){var n,i,r,n=B[t],i=Object.assign({},e);for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);g.push(i)})}),B=g,"And"===V||void 0===V?B=this.Phe(g,n,L,"And"):"Or"===V&&(B=this.Phe(g,n,L,"Or"))),B},e.prototype.pbe=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,l,d,e={},o=0,u=t;o<u.length;o++)c=(s=u[o])[n],f=s[i],void 0!==c&&void 0!==f&&(e[c]||(e[c]={}),e[c][f]=!0);for(c in r)if(r.hasOwnProperty(c))for(a=r[c],h=e[c],l=0,d=a;l<d.length;l++)if(f=d[l],void 0===h||!h[f])return!0;return!1},e.prototype.Phe=function(t,n,i,r){var a,h,e,a=this;return t&&(h=this.getTableNameCacheFromParent(i),e=n.map(function(t){var r,e,n,i,o,t,u,s,c,f,r=t.relationHostColumn,e=t.relationTargetColumn,n=t.relationCondition,i=t.relationHostTable,o=t.relationTargetTable,t=t.formula;return(0,K.isNullOrUndefined)(t)?(u=S.ValueComparatorFactory.createComparator(n),i=i.toUpperCase(),o=o.toUpperCase(),s=a.N3.getTable(i),c=a.N3.getTable(o),f=(h||i).toUpperCase(),function(t){var n=t[f],i=t[o];return!!(void 0===n&&t.hasOwnProperty(f)||void 0===i&&t.hasOwnProperty(o))||u(s.getValueByField(r,n),c.getValueByField(e,i))}):null}),"And"===r?t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if((r=i[n])&&!r(t))return!1;return!0}):"Or"===r&&(t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if(!(r=i[n])||r(t))return!0;return!1}))),t},e.prototype.Lhe=function(r,e){var t,o,n,i,u,s,c,f,a,h,l,d,v,p;if(r.some(function(t){return t&&0===t.length}))return[];if(r.length<=1)return r[0]||[];if(void 0===e)return[];for(r.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),t=r[0],o=[],e=this.bbe(r,e),n=function(t,n){var i={};r[t].forEach(function(t){var t=t[e];void 0!==t&&(i[t]=!0)}),o.push(i)},i=0,u=r.length;i<u;i++)n(i,u);for(s=o[0],i=1,u=o.length;i<u;i++)for(f in c=o[i],s)s.hasOwnProperty(f)&&s[f]&&(c[f]||(s[f]=!1));for(a=[],h=new RegExp("^".concat(e,"(__\\d+__\\d+)?$")),l=function(n){var t=Object.keys(n),i=!0;t.forEach(function(t){var t;h.test(t)&&(t=n[t],i=i&&!(0,K.isNullOrUndefined)(t)&&s[t])}),i&&a.push(n)},d=0,v=t;d<v.length;d++)l(p=v[d]);return a},e.prototype.Bhe=function(t,n){var i,r,e,o,u,s,c,f,a,h;if((t=t.filter(function(t){return t.length})).length<=1)return t[0]||[];if(void 0===(i=(0,R.getTableNameByCellNode)(n)))return[];for(t.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),r=t[0],e={},o=0,u=r;o<u.length;o++)c=(s=u[o])[i],(0,K.isNullOrUndefined)(c)||(e[c]=!0);for(f=1,a=t.length;f<a;f++)(h=t[f]).forEach(function(t){var n=t[i];(0,K.isNullOrUndefined)(n)||e[n]||(e[n]=!0,r.push(t))});return r},e.prototype.bbe=function(t,n){var t,t,t=t.map(function(t){return Object.keys(t[0])}),t=t.reduce(function(t,n){return(0,R.getArraySameItems)(t,n)},t[0]);return-1<t.indexOf(n)?n:t[0]},e.prototype._he=function(t,n,i){var r=this.generateRelationshipMapKeyByCellNode(n);return(0,R.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection?[]:(this.hhe[r]&&!i||(this.hhe[r]=this.gbe(t)),this.hhe[r])},e.prototype.gbe=function(t){for(var n,i,r,e,o,n=[],i=t.name.toUpperCase(),r=0,e=t.length();r<e;r++)(o={})[i]=r,n.push(o);return n},e.prototype.Ahe=function(t){return!!t&&(this.Che(t),!!t.templateCell.ihe||this.Ahe(t.leftParent)||this.Ahe(t.upParent))},e.prototype.Che=function(t){var n,i,t,r,i,t,n=t.templateCell,i=n.filter&&n.filter.condition;n.ihe||(t=this.nTe(t),i&&t.push(i),t.length&&(i=(0,R.deepCloneFilterCondition)(r={and:t}),t=this.parseFilterOptionToFilterConditionTree(i),n.ihe={condition:t}))},e.prototype.nTe=function(t){var n,i,r,e,i,o,u,s,c,f,a,n,h,r=[],e=[],i=this.N3,o=(0,R.getTableByCellNode)(i,t),u=null==o?void 0:o.table();return t.leftParent&&(c=null==(s=(0,R.getTableByCellNode)(i,t.leftParent))?void 0:s.table())!==u&&(f=this.getRelationshipGraphTableIndex(o),a=this.getRelationshipGraphTableIndex(s),n=null==(n=this.relationshipGraphs()[a])?void 0:n.tableToTableRelationPath,f===a)&&n&&(h=n[u.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),t.upParent&&(c=null==(s=(0,R.getTableByCellNode)(i,t.upParent))?void 0:s.table())!==u&&(f=this.getRelationshipGraphTableIndex(o),a=this.getRelationshipGraphTableIndex(s),n=null==(i=this.relationshipGraphs()[a])?void 0:i.tableToTableRelationPath,f===a)&&n&&(h=n[u.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),r},n.DataManagerReportJoinHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js":function(t,n,i){"use strict";var r,l,d,c,v,e;function o(t){this.N3=t,this.Xle=new r.CalcSource(t.getCalcService())}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportSortHelper=void 0,r=i("CalcEngine"),l=i("./dist/src/dataManager.entry.js"),d=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),c=void 0,v="number",o.prototype.sortGroupsBySortCondition=function(f,a,h){var n,s,i,t,r,n=a.templateCell.Kle,s=[];if(n){for(n.forEach(function(t,n){var i,r,e,o,u,s,c,u;if(!(0,l.isNullOrUndefined)(t.cell)&&d.cellNameReg.test(t.cell)&&(i=h(t.cell)))if((r=(0,d.wbe)(i,a))||i===a)for(e=0,o=f;e<o.length;e++)s=(s=(u=o[e]).sortValues)||(u.sortValues=[]),c=void 0,i===a?c=u.value:(u=(0,d.ybe)(u,i))&&(c=u[0].value),s[n]=c;else t.order=void 0}),t=function(u){var r,t,o,r=n[u];r&&r.order&&(r.list&&r.list.length?(t=r.list,o={},t.forEach(function(t,n){return o[t]=n}),i=function(t,n){var e,i,t,e=!1,i,t=function(t,n){var i,r,t,n,i=t.sortValues[u],r=n.sortValues[u];return s[u+1]&&i===r?(e=!0,s[u+1](t,n)):(t=o[i+""],n=o[r+""],t!==c&&n!==c?t-n:t!==c?-1:n!==c?1:i===r?0:r<i?1:-1)}(t,n);return!e&&"desc"===r.order?-t:t},s[u]=i):(0,l.isNullOrUndefined)(r.cell)&&(0,l.isNullOrUndefined)(r.column)&&(0,l.isNullOrUndefined)(r.formula)||(i=function(t,n){var e,o,i,t,e=!1,o="desc"===r.order,i,t=function(t,n){var i,r,t,n,i=t.sortValues[u],r=n.sortValues[u];return s[u+1]&&i===r?(e=!0,s[u+1](t,n)):(t=(0,l.isNullOrUndefined)(i)||""===i||typeof i==v&&isNaN(i),n=(0,l.isNullOrUndefined)(r)||""===r||typeof r==v&&isNaN(r),t||n?t&&n?0:t&&!n?o?-1:1:!t&&n?o?1:-1:void 0:i===r?0:(0,d.isGreaterThan)(r,i)?-1:1)}(t,n);return!e&&o?-t:t},s[u]=i))},r=n.length-1;-1<r;r--)t(r);i&&(f.sort(i),this.Mbe(f,a))}},o.parseSortOptionsToSorts=function(t){var n;null!=(n=t.sorts)&&n.length&&!t.Kle&&(t.Kle=t.sorts.map(function(t){var n,i,n,t,n=(0,l.isNullOrUndefined)(t.desc),i=n?t.asc:t.desc,n={order:n?"asc":"desc",list:t.list};return(i=(i=(0,l.isNullOrUndefined)(i)?"":i).trim()).startsWith("=")?(t=i.substring(1),d.cellNameReg.test(t)?n.cell=t:n.formula=i):n.column=i,n}))},o.prototype.Mbe=function(r,e){var o=this;e.children.forEach(function(t){var n,n,i,n=null==(n=t.data)?void 0:n.groups;null!=n&&n.length&&(i=t.leftParent===e,n.sort(function(t,n){var t,n,t=i?t.leftParent:t.upParent,n=i?n.leftParent:n.upParent;return r.indexOf(t)-r.indexOf(n)})),o.Mbe(n,t)})},n.DataManagerReportSortHelper=o},"./dist/src/data-manager-report/tree-data-generator/index.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n){var i=this;this.generateTreeDataInternal=function(t){var t,n,t=t.root;try{i.Rle.generateJoinRelationIndexMap(t),n=i.Lle.generateCellNodeTreeData(t)}catch(t){n=[]}finally{t.data.groups=n}},this.Uhe=new s.DataManagerProxy(t),this.DJ=n,this.Rle=new e.DataManagerReportJoinHelper(this.Uhe,n),this.Ble=new o.DataManagerReportSortHelper(this.Uhe),this.Lle=new u.DataManagerReportGroupHelper(this.Uhe,n,this.Rle,this.Ble),this.Hhe=new r.DataManagerReportCrossHelper(this.Uhe,n,this.Rle,this.Lle,this.Ble)}function h(t,n){var i,i;t.templateCell.dataColumn&&void 0!==t.templateCell.dataColumn.tableName&&(n[t.templateCell.dataColumn.tableName.toUpperCase()]=!0),(i=t.templateCell.filter)&&i.condition&&l(i.condition,n),null!=(i=t.children)&&i.forEach(function(t){h(t,n)})}function l(t,n){var i,r,e,o,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)l(e=r[i],n);if(t.or)for(o=0,u=t.or;o<u.length;o++)l(s=u[o],n)}}function d(t,n){n=n.toUpperCase();for(var i=0;i<t.length;i++)if(t[i].tables.find(function(t){return t.name.toUpperCase()===n}))return i;return-1}function v(t){var n,r,u,i,e,o,s,c,n=t.tables,r=t.relationships;if(n.length&&r.length){for(i in u={},n.forEach(function(t){var i,e,o,n,i=t.table(),e=i.name.toUpperCase();u[e]||(u[e]={}),o=u[e],(n=r.filter(function(t){return t.targetTable===i||t.sourceTable===i}).map(function(t){var n=t.sourceTable===i?t.targetTable:t.sourceTable;return{table:n,relationship:t,tableName:n.name.toUpperCase()}})).forEach(function(t){var n,i,r;if(t.tableName!==e){for(n in u)u.hasOwnProperty(n)&&n!==e&&n!==t.tableName&&(i=u[n])[e]&&((r=[].concat(i[e])).push(t.relationship),!i[t.tableName]||i[t.tableName].length>r.length)&&(i[t.tableName]=r);o[t.tableName]||(o[t.tableName]=[t.relationship])}})}),u)if(u.hasOwnProperty(i))for(o in e=u[i])if(e.hasOwnProperty(o)&&u[o])for(s in u[o])u[o].hasOwnProperty(s)&&s!==i&&(c=e[o].concat(u[o][s]),!u[i][s]||u[i][s].length>c.length)&&(u[i][s]=c);Object.values(u).forEach(function(t){Object.values(t).forEach(function(t){t.reverse()})}),t.tableToTableRelationPath=u}}Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0,r=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js"),e=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),f=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),a.prototype.generateTreeData=function(){var t,n,i,t,t,t=this.DJ,n=t.crossCells,i=t.verticalExpansionTrees,t=t.horizontalExpansionTrees;this.zhe();try{this.eTe()}catch(t){}this.Rle.currentTreeDirection="H",t.forEach(this.generateTreeDataInternal),this.Rle.currentTreeDirection="V",i.forEach(this.generateTreeDataInternal),(t=n.filter(function(t){return!n.includes(t.leftParent)&&!n.includes(t.upParent)})).length&&this.Hhe&&this.Hhe.processCrossCells(t),this.Rle.clearCache(!0),this.Lle.clearCache(!0),this.Uhe.clearTableDataCache(),this.Sbe()},a.prototype.zhe=function(){this.Rle.clearCache(),this.Lle.clearCache()},a.prototype.getUsedTableRelationshipGraphsForUT=function(){return this.eTe(),this.Rle.relationshipGraphs()},a.prototype.eTe=function(){for(var t,s,c,n,i,t,t=this.Uhe,s=[].concat(t.getRelationshipsByTable()),c=[],n=this.Tbe(),i=function(){var t,n,i,r,e,n,i,r,e,o,u,n,t=s.shift(),n=t.sourceTable,i=t.targetTable,r=n.name.toUpperCase(),e=i.name.toUpperCase(),n=new f.ReportTable({dataManagerTable:n}),i=new f.ReportTable({dataManagerTable:i}),r=d(c,r),e=d(c,e);-1===r&&-1===e?c.push(o={relationships:[t],tables:[n,i]}):-1===r&&-1!==e?(c[e].relationships.push(t),c[e].tables.push(n)):-1!==r&&-1===e?(c[r].relationships.push(t),c[r].tables.push(i)):(r===e&&-1===c[r].relationships.indexOf(t)?c[r]:(u=c[e],(n=c.splice(r,1))[0].relationships.forEach(function(t){u.relationships.push(t)}),n[0].tables.forEach(function(t){u.tables.push(t)}),u)).relationships.push(t)};s.length;)i();(t=c.filter(function(t){return t.tables.map(function(t){return t.name.toUpperCase()}).some(function(t){return n[t]})})).forEach(function(t){v(t)}),this.Rle.relationshipGraphs(t)},a.prototype.Tbe=function(){var t,n,n={};return this.DJ&&(this.DJ.horizontalExpansionTrees.forEach(function(t){h(t.root,n)}),this.DJ.verticalExpansionTrees.forEach(function(t){h(t.root,n)}),null!=(t=this.DJ.crossCells))&&t.forEach(function(t){h(t,n)}),n},a.prototype.Sbe=function(){var n,t,i,r,t,n=this,t=this.DJ,i=t.verticalExpansionTrees,r=t.horizontalExpansionTrees,t=t.crossCells;r.forEach(function(t){n.Abe(t.root)}),i.forEach(function(t){n.Abe(t.root)}),t&&t.forEach(function(t){n.Abe(t)})},a.prototype.Abe=function(t){var n,i,n=this;t&&(t.nM=void 0,(i=t.templateCell)&&(i.ihe=void 0,i.Kle=void 0,i.Hle=void 0,this.cCe(t)),t.children.forEach(function(t){n.Abe(t)}))},a.prototype.cCe=function(t){var t=t.data.groups;t&&t.length&&t.forEach(function(t){t.Qle=void 0,t.Jle=void 0,t.sortValues=void 0})},n.TreeDataGenerator=a},"./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/data-manager-report/tree-data-generator/utils/utils.js":function(A,t,n){"use strict";var e,o,n,u,s,c,f,a,h,i;function l(t,n,i){var r=e(e([],i=void 0===i?[]:i,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){l(t,n,r)}):n.push(r)}function r(t,n){var i,n,r,i=0;switch(n){case"Avg":i=!t.length||c(t[0])?0:t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)/t.length;break;case"Count":i=t.length;break;case"Max":i=void 0,t.length&&(t.sort(function(t,n){return t<n?1:-1}),i=t[0]);break;case"Min":i=void 0,t.length&&(t.sort(function(t,n){return n<t?1:-1}),i=t[0]);break;case"None":i=0;break;case"Sum":i=c(t[0])?0:t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)}return n=15,"number"==typeof i&&-10<i&&i<10&&(1<(r=i.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(n=14),u(i,o.Functions.CALC_PRECISION||n)}function d(t,n){return t&&t.length&&n&&n.length?t.filter(function(t){return-1<n.indexOf(t)}):[]}function v(t,n){var i;return t&&0!==t.length?n&&0!==n.length?(i=[].concat(t),n.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),i):t:n||[]}function p(t){return t.toUpperCase()}function w(t){return!(!(t=t.replace(/__\d+__\d+/g,"").slice(t.indexOf("=")+1,t.length).trim()).startsWith("{")||!t.endsWith("}"))}function b(t,n,i){var n,t,r,i,e,o,u,s,c,f,t=t.parse(n,i,0,0),r=[],i=null==(n=null==t?void 0:t.value)?void 0:n.array;if(i)for(e=0,o=i;e<o.length;e++)for(s=0,c=u=o[e];s<c.length;s++)f=c[s],r.push(f);return r}function m(t,n){var i=n.nM;return i||(n.templateCell.dataColumn?i=t.getTable(n.templateCell.dataColumn.tableName):n.templateCell.formula&&w(n.templateCell.formula)&&(i=t.getTable("".concat(n.templateCell.formula,"__").concat(n.templateCell.row,"__").concat(n.templateCell.col))),n.nM=i),i}function j(t,n){var i="";return t.templateCell.dataColumn?i=t.templateCell.dataColumn.tableName:t.templateCell.formula&&(n||w(t.templateCell.formula))&&(i="".concat(t.templateCell.formula,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col)),i.toUpperCase()}function y(t){var t=t.match(i);return t&&t[1]}function g(t){return t&&t.and}function _(t){return t&&t.or}function O(t){return t&&!t.or&&!t.and}function S(t){var n;switch(typeof t){case"string":return"String";case"boolean":return"Boolean";case"number":return"Number"}if(isNaN(t)&&!isNaN(Date.parse(t)))return"Date"}function C(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function F(t){var n,i,n=Array.isArray(t)?[]:{};for(i in t)t.hasOwnProperty(i)&&(n[i]="and"===i||"or"===i?F(t[i]):t[i]);return n}function R(t){return!!t&&(!(!t.leftParent||!t.upParent)||R(t.leftParent||t.upParent))}function I(t,n){return!(!t||!n)&&(t===n||I(t.leftParent,n)||I(t.upParent,n))}function N(t,n){var i,r,e,o;if(t&&t.childrenArray&&t.childrenArray.length&&n)for(i=void 0,r=0,e=t.childrenArray;r<e.length;r++)if(i=(o=e[r])&&o[0]&&o[0].cellNode===n?o:N(o[0],n))return i}function E(t,n){var i,r,e,o,u;return t instanceof Date&&(t=s(t)),n instanceof Date&&(n=s(n)),e=(i=typeof t)===f,o=(r=typeof n)===f,u=r===a,i==r||i!==a&&!u?i===h&&o||(!e||r!==h)&&(e&&o?t.toLowerCase()>n.toLowerCase():n<t):u}function M(t,n,i,r){var r;return r&&(x(r,r=T(t,n,i)),void 0===(i=D(t,n,r))||i.startsWith("=")||(i="="+i)),i}function x(t,n){var i,r,e,o,u;if(8===n.type)void 0!==(i=t[n.value.toUpperCase()])&&("string"==(r=typeof i)?n.type=3:"boolean"==r?n.type=4:"number"==r?n.type=2:i instanceof Date&&(i=i.toString(),n.type=3),n.value=i);else{if(n.arguments)for(e=0,o=n.arguments;e<o.length;e++)x(t,u=o[e]);n.value&&x(t,n.value),n.value2&&x(t,n.value2)}}function T(t,n,i){return t.parse(n,i,0,0)}function D(t,n,i){return t.unparse(n,i,0,0)}function P(t){var t=t.newRecordDefaultValueGenerator?t.newRecordDefaultValueGenerator():void 0,n;return n=t&&void 0!==t.formula?t.formula:n}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.generateDefaultFormulaByTemplateCell=t.expressionToFormula=t.formulaToExpression=t.xbe=t.lbe=t.isGreaterThan=t.ybe=t.wbe=t.isCellInCrossCell=t.deepCloneFilterCondition=t.rowColToCellName=t.getValueType=t.isSimpleFilterCondition=t.hasOrCondition=t.hasAndCondition=t.fieldExpressionToField=t.getTableNameByCellNode=t.getTableByCellNode=t.getFormulaResult=t.isFormulaInWhitelist=t.toUpperCase=t.getArrayUnionItems=t.getArraySameItems=t.calc=t.traverse=t.cellNameReg=t.formulaWhitelist=void 0,o=n("CalcEngine"),n=n("Common"),u=n.Common.st.E8,s=n.Common.ct.o0,c=n.Common.ct.W0,f="string",a="number",h="boolean",t.formulaWhitelist=[],t.cellNameReg=/^([A-Z]+)(\d+)$/,t.traverse=l,t.calc=r,t.getArraySameItems=d,t.getArrayUnionItems=v,t.toUpperCase=p,t.isFormulaInWhitelist=w,t.getFormulaResult=b,t.getTableByCellNode=m,t.getTableNameByCellNode=j,i=/\[@(.*?)\]/,t.fieldExpressionToField=y,t.hasAndCondition=g,t.hasOrCondition=_,t.isSimpleFilterCondition=O,t.getValueType=S,t.rowColToCellName=C,t.deepCloneFilterCondition=F,t.isCellInCrossCell=R,t.wbe=I,t.ybe=N,t.isGreaterThan=E,t.lbe=M,t.xbe=x,t.formulaToExpression=T,t.expressionToFormula=D,t.generateDefaultFormulaByTemplateCell=P},"./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ValueComparatorFactory=void 0,r.createComparator=function(t){switch(t){case"Equal":return function(t,n){return t+""==n+""};case"NotEqual":return function(t,n){return t+""!=n+""};case"GreaterThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>=t.ruleValue};case"GreaterThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>t.ruleValue};case"LessThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<=t.ruleValue};case"LessThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<t.ruleValue};case"StartWith":return function(t,n){return(t+"").startsWith(n+"")};case"NotStartWith":return function(t,n){return!(t+"").startsWith(n+"")};case"EndWith":return function(t,n){return(t+"").endsWith(n+"")};case"NotEndWith":return function(t,n){return!(t+"").endsWith(n+"")};case"Contains":return function(t,n){return-1<(t+"").indexOf(n+"")};case"NotContains":return function(t,n){return-1===(t+"").indexOf(n+"")};case"In":return function(t,n){return-1<(n+"").indexOf(t+"")};case"NotIn":return function(t,n){return-1===(n+"").indexOf(t+"")};default:return function(){return!0}}},r.parseValue=function(t,n){return"number"==typeof t?isNaN(n)?{recordValue:t+"",ruleValue:n+""}:{recordValue:t,ruleValue:+n}:isNaN(t)?{recordValue:t+"",ruleValue:n+""}:"number"==typeof n?{recordValue:+t,ruleValue:n}:{recordValue:t,ruleValue:n}},r.createDateComparator=function(t){switch(t){case"Equal":case"Contains":case"In":return function(t,n,i,r){return i<=t&&t<=r};case"NotEqual":case"NotContains":case"NotIn":return function(t,n,i,r){return r<t||t<i};case"GreaterThanOrEqual":case"StartWith":case"NotEndWith":return function(t,n,i,r){return i<=t};case"GreaterThan":return function(t,n,i,r){return r<t};case"LessThanOrEqual":case"NotStartWith":case"EndWith":return function(t,n,i,r){return t<=r};case"LessThan":return function(t,n,i,r){return t<i};default:return function(){return!0}}},n.ValueComparatorFactory=r},"./dist/src/dataManager.common.js":function(t,i,n){"use strict";var r,e,o,n,n,u,s,c;function f(){return null!==c&&c.apply(this,arguments)||this}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(i,"__esModule",{value:!0}),i.CalcFunction=i.sR=i.SR=void 0,e=n("CalcEngine"),o=n("Common"),n=n("./dist/src/res.en.js"),i.SR={en:n.resource},n=new o.Common.ResourceManager(i.SR,"DataManager"),i.sR=n.getResource.bind(n),c=e.Functions.Function,r(f,c),f.prototype.description=function(){var t=this,n=(0,i.sR)().zve;return t.IDt||(n?n[t.name]:c.prototype.description.call(this))},i.CalcFunction=f},"./dist/src/dataManager.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.entry.js"),n),e(i("./dist/src/table/table.entry.js"),n),e(i("./dist/src/viewField/viewField.entry.js"),n),e(i("./dist/src/view/view.entry.js"),n),e(i("./dist/src/interfaces/interface.js"),n),e(i("./dist/src/interfaces/styleOptions.js"),n),e(i("./dist/src/interfaces/validatorOptions.js"),n),e(i("./dist/src/interfaces/conditionalFormatOptions.js"),n),e(i("./dist/src/dataManager.js"),n),e(i("./dist/src/dataManager.common.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js"),n),e(i("./dist/src/data-manager-report/data-manager-report.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/index.js"),n),e(i("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,i){"use strict";var r,e,o,y,u,s,c,f,a,h,l,d;function g(t){var t=t.split(/\s*=\s*/);return 2===t.length?[t[0].split("."),t[1].split(".")]:[]}function v(t,n){this.rV={},this.tables={},this.relationships=[],this.OEt={},n=n||new r.CalcService,this.updateCalcService(n),(0,s.addCustomFunctions)(),t&&this.Ibe(t)}function p(t){return t instanceof o.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,r=i("CalcEngine"),e=i("./dist/src/table/table.js"),o=i("./dist/src/view/view.js"),y=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/dataSource/dataSource.js"),s=i("./dist/src/calculation/functions/functions.entry.js"),c=i("./dist/src/calculation/tokenResolver.js"),f=i("./dist/src/calculation/queryFunctionResolver.js"),a=i("./dist/src/relationship.js"),h=null,l=r.Convert.LE,v.prototype.Ibe=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,h,l,d,v,p,w,b,m,j,n,i=0,r=(0,y.keys)(t.tables);i<r.length;i++){if(e=r[i],u={},s=(o=t.tables[e]).fields)for(c in s)s.hasOwnProperty(c)&&(f=s[c],u[c]={name:f.name,dataType:f.dataType,spread:f.spread});if(a={schema:{columns:u}},(h=o.dimensions)&&(a.schema.dimensions=h),o.measures&&0<Object.keys(o.measures).length&&(a.schema.measures=(0,y.clone)(o.measures,!0)),o.source)a.remote={read:{url:o.source}};else{if(!o.localSource)continue;a.data=o.localSource}if(h=this.addTable(e,a),o.primaryKey&&h.primaryKey(o.primaryKey),l=o.relationships)for(d in l)if(l.hasOwnProperty(d)){if(m=b=w=p=void 0,(v=l[d]).on){if(0===(j=g(v.on)).length)continue;p=j[0][0],b=j[0][1],w=j[1][0],m=j[1][1]}else{if(!(v.with&&v.source&&o.primaryKey))continue;p=e,b=o.primaryKey,w=v.source,m=v.with}this.addRelationship(this.tables[p],b,d,this.tables[w],m,w+"_"+m)}}this.queries=t.queries},v.prototype.addTable=function(t,n){this.RTe(t);var n=new e.Table(t,n);return(this.tables[t]=n).REt(this),n},v.prototype.removeTable=function(t){for(var n,i,r,n=this.tables[t],i=this.relationships,r=i.length-1;0<=r;r--)i[r].sourceTable!==n&&i[r].targetTable!==n||(i[r].VP(),i.splice(r,1));n.REt(h),delete this.tables[t],this.RTe(t)},v.prototype.addRelationship=function(t,n,i,r,e,o){var t=new a.Relationship(t,n,i,r,e,o);return this.relationships.push(t),t},v.prototype.removeRelationship=function(t){for(var n,i,n=this.relationships,i=0;i<n.length;i++)if(n[i].sourceRelationshipName===t){n[i].VP(),n.splice(i,1);break}},v.prototype.updateCalcService=function(t){for(var n,i,r,e,o,n,i=!0,r=0,e=t.getResolvers();r<e.length;r++)if((o=e[r])instanceof c.DataManagerTokenResolver){i=!1;break}i&&t.addResolver(new c.DataManagerTokenResolver(8e3)),this.Lp=t},v.prototype.xEt=function(t,n,i){var r,e,o;return l(t)?t=t.getValueByIndex(0):(0,y.isString)(t)||(t=""+t),(0,y.isString)(n)?n=[n]:l(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),r=1<(null==n?void 0:n.length)?n.join(","):null==n?void 0:n[0],o=(o=(e=(e=this.OEt[t])||(this.OEt[t]={}))[r])||(e[r]=f.QueryFunctionSolver.parseParam(t,n,i,this))},v.prototype.IEt=function(t,n,i,r,e){var t,n,t=this.xEt(t,n,i);return e?t.table._dataSource.unbind(u.ONCHANGE,r):r&&t.table&&t.table._dataSource.bind(u.ONCHANGE,r),n=0===(n=t.getValue?t.getValue(t.table):[[]]).length?[[]]:n},v.prototype.RTe=function(t){var n=this.OEt;n&&delete n[t]},v.prototype.toJSON=function(){var t,n,i,r,t=this.tables,n=[];for(i in t)t.hasOwnProperty(i)&&n.push(t[i].toJSON());return{tables:n,relationships:r=this.relationships.map(function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}}),queries:this.queries}},v.prototype.fromJSON=function(t){var o,n,i,i,r,e,u,s,c,f,o=this,n=this.tables={},i=t.tables,i=Promise.all(i.map(function(t){var n,i,r,e,n,n=t.dataSourceOption.schema,i=n&&n.columns;if(i)for(r in i)i.hasOwnProperty(r)&&(e=i[r])&&"date"===e.dataType&&Array.isArray(e.lookup)&&(e.lookup=e.lookup.map(function(t){return new Date(t)}));return(n=o.addTable(t.name,t.dataSourceOption)).BEt=!0,n.fromJSON(t)}));for(this.relationships=[],e=0,u=r=t.relationships;e<u.length;e++)c=n[(s=u[e]).sourceTableName],f=n[s.targetTableName],this.addRelationship(c,s.sourceFieldName,s.sourceRelationshipName,f,s.targetFieldName,s.targetRelationshipName);return t.queries&&(this.queries=t.queries),i},n.DataManager=v,n.isView=p},"./dist/src/dataSource/dataReader/basicReader.js":function(t,n,i){"use strict";var e,o,r;function u(t){var n,i,r,t,n=this;n.LEt=t,(0,e.isNullOrUndefined)(t)||(n.Pq=t.Pq,i=t.dataPath,r=t.countPath,t=t.parse,(0,e.isFunction)(i)?n.FEt=i:n.FEt=function(t){return(0,e.isString)(i)&&i?(0,e.q$)(t,i):t},(0,e.isFunction)(r)?n.PEt=r:n.PEt=function(t){return(0,e.isString)(r)&&r?parseInt((0,e.q$)(t,r),10):o},(0,e.isFunction)(t)&&(n.parse=t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,e=i("./dist/src/dataSource/utils.js"),o=void 0,u.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},u.prototype.read=function(t){return Promise.resolve(this.FEt(t))},u.prototype.readSync=function(t){return this.FEt(t)},u.prototype.total=function(t){return this.PEt(t)},n.BasicReader=u},"./dist/src/dataSource/dataReader/columnJsonReader.js":function(t,n,i){"use strict";var r,e,h,o,u,s;function c(t){var n,f,a,n=s.call(this,t)||this,f=n,a=t.dataPath;return(0,h.isFunction)(a)?f.FEt=a:f.FEt=function(t){var n,i,r,e,o,u,s,c;for(t=(0,h.isString)(a)?(0,h.q$)(t,a):t,n=f.Pq=f.Pq||(0,h.keys)(t),i=f.GEt=[],r=t[n[0]].length,e=0;e<r;e++){for(o={},u=0,s=n;u<s.length;u++)o[c=s[u]]=t[c][e];i.push(o)}return i},n}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),h=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(e){var o=this;return new Promise(function(t,n){var i,r;(0,h.isNullOrUndefined)(e)&&n("value cannot be null or empty"),i=o.Pq=o.Pq||(0,h.keys)(e),(r=(0,h.reduce)(i,function(t,n){return t&&(0,h.isArray)(e[n])},!0))||n("The value of each property in column JSON should be an array"),t(e)})},n.ColumnJsonReader=c},"./dist/src/dataSource/dataReader/csvReader.js":function(t,n,i){"use strict";var r,e,l,o,u,s;function c(t){var n=s.call(this,t)||this;return n.UEt=t.delimiter||['"'],n.HEt=t.separator||",",n}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),l=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,n=this,i=n.UEt,r=n.HEt,e=t.split(""),o=0,u=e.length,s=[];o<u;){for(a=[];o<u&&"\r"!==e[o]&&"\n"!==e[o];){if(c=f=o,-1<(0,l.indexOf)(i,e[o])){for(c=f=++o;o<u;){if(-1<(0,l.indexOf)(i,e[o])){if(-1===(0,l.indexOf)(i,e[o+1]))break;e[++o]=""}f=++o}for(-1<(0,l.indexOf)(i,e[o])&&++o;o<u&&"\r"!==e[o]&&"\n"!==e[o]&&r!==e[o];)++o}else for(;o<u&&"\r"!==e[o]&&"\n"!==e[o]&&r!==e[o];)f=++o;a.push(e.slice(c,f).join("")),r===e[o]&&++o}"\r"!==e[o]&&"\n"!==e[o]||++o,0<a.length&&s.push(a)}return h=s.shift(),n.GEt=(0,l.isNullOrUndefined)(n.Pq)?(0,l.map)(s,function(t){return(0,l.zipObject)(h,t)}):(0,l.map)(s,function(t){return(0,l.pick)((0,l.zipObject)(h,t),n.Pq)}),n.Pq=n.Pq||h,Promise.resolve(n.GEt)},n.CsvReader=c},"./dist/src/dataSource/dataReader/jsonReader.js":function(t,n,i){"use strict";var r,i,e,o,u;function s(t){return u.call(this,t)||this}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,i=i("./dist/src/dataSource/dataReader/basicReader.js"),u=i.BasicReader,r(s,u),n.JsonReader=s},"./dist/src/dataSource/dataReader/xmlReader.js":function(t,n,i){"use strict";var r,e,o,u,s,c;function f(t){var i,r,e,i=c.call(this,t)||this,r=i,e=t.dataPath;return(0,o.isFunction)(e)?r.FEt=e:r.FEt=function(t){var n;return t=(0,o.isString)(e)?(0,o.q$)(t,e):t,(0,o.isNullOrUndefined)(t)||((n=r.Pq)?t=t.map(function(t){return(0,o.pick)(t,n)}):i.Pq=(0,o.keys)(t[0])),t},i}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),o=i("./dist/src/dataSource/utils.js"),c=e.BasicReader,r(f,c),f.prototype.parse=function(t){var n,t,t,n,t=(new DOMParser).parseFromString(t.trim(),"text/xml"),t=this.documentToJSObject(t);return Promise.resolve(t)},f.prototype.documentToJSObject=function(t){for(var n,i,r,e,n={},i=t.children,r=0,e=i.length;r<e;r++)this.elementToJSObject(i[r],n);return n},f.prototype.elementToJSObject=function(t,n){var i,r,e,o,u,s,c,f,i=t.children,r=i.length,e=t.nodeName;if(0===r)n[e]=t.textContent;else{for(o={},void 0!==(u=n[e])?Array.isArray(u)?n[e].push(o):n[e]=[u,o]:n[e]=o,s=t.attributes,c=0;c<s.length;c++)o[(f=s[c]).nodeName]=f.nodeValue;for(c=0;c<r;c++)this.elementToJSObject(i[c],o)}},n.XmlReader=f},"./dist/src/dataSource/dataSource.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.js"),n),e(i("./dist/src/dataSource/dataSource.interface.js"),n),e(i("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";var i,r,e,o,u,s,s,s,s,s;Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerWhenType=n.FrameExcludeTies=n.FrameExcludeGroup=n.FrameExcludeCurrentRow=n.FrameExcludeNoOthers=n.OrderDesc=n.OrderAsc=n.WindowOverFrameExcludeMode=n.WindowOverFrameType=n.WindowOverFrameFollowing=n.WindowOverFramePreceding=void 0,(s=i=n.WindowOverFramePreceding||(n.WindowOverFramePreceding={}))[s.UnBounded=-2]="UnBounded",s[s.NPreceding=-1]="NPreceding",s[s.CurrentRow=0]="CurrentRow",(s=r=n.WindowOverFrameFollowing||(n.WindowOverFrameFollowing={}))[s.UnBounded=2]="UnBounded",s[s.NFollowing=1]="NFollowing",s[s.CurrentRow=0]="CurrentRow",(s=e=n.WindowOverFrameType||(n.WindowOverFrameType={}))[s.ROWS=0]="ROWS",s[s.RANGE=1]="RANGE",s[s.GROUPS=2]="GROUPS",(s=o=n.WindowOverFrameExcludeMode||(n.WindowOverFrameExcludeMode={}))[s.none=0]="none",s[s.current=1]="current",s[s.group=2]="group",s[s.ties=3]="ties",n.OrderAsc="ASC",n.OrderDesc="DESC",n.FrameExcludeNoOthers="none",n.FrameExcludeCurrentRow="current",n.FrameExcludeGroup="group",n.FrameExcludeTies="ties",(s=u=n.TriggerWhenType||(n.TriggerWhenType={})).onNew="onNew",s.onNewAndUpdate="onNewAndUpdate"},"./dist/src/dataSource/dataSource.js":function(A,y,t){"use strict";var n,g,h,i,r,e,f,o,u,s,c,_,a,m,j,l,O,S,d,C,v,p,k,F,L,w,V;function R(t){return"".concat(p).concat(t)}function b(t){return"string"==typeof t&&-1<t.indexOf(p)}function I(t){return b(t)?j:t}function G(t,n){var i=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(i=n.data):i=n.value,i}function N(t,n){var i,r,e,i={};for(r in t)t.hasOwnProperty(r)&&(e=n[r],i[r]=(0,_.isNullOrUndefined)(e)?t[r]:e);return i}function E(t,n,i,r,e){var o,u,s,c,f,a,h;for("string"==typeof i?o=u=i:(o=i.childrenField1||"children",u=i.childrenField2||"children"),s=t[o]||[],c=n[u]||[],f=0;f<s.length;f++)a=s[f],h=c[f],r&&r(a,h,t,n),E(a,h,i,r,e),e&&e(a,h,t,n)}function M(t,n){var i,r,e,o,u;if((0,_.isNullOrUndefined)(t)||(0,_.isNullOrUndefined)(n))return t===n;if(i=(0,_.keys)(t),r=(0,_.keys)(n),i.length===r.length){for(e=0,o=i;e<o.length;e++)if(t[u=o[e]]!==n[u])return;return 1}}function x(t,n){var t;return g(g({},t),{value:null!=(t=t.value)?t:n})}function B(t,n){for(var i,r,e,o,i=[],r=0;r<n;r++){for(o in e={},t)t.hasOwnProperty(o)&&(e[o]=t[o].data[r]);i[r]=e}return i}function T(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function q(t){var n,n,t,i,i,i,i,i,n=null==(n=t.schema)?void 0:n.type,t=t.remote;n&&t&&((i=t.read)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.update)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.delete)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.create)&&"object"==typeof i&&(i.dataType=T(n)),i=t.batch)&&"object"==typeof i&&(i.dataType=T(n))}function U(){}function D(t){var n,i,n=V.call(this)||this;return n.R1t=[],(i=n)._data=t.data,i.zEt=t.isRoot,i.VEt=t.getData,i.YEt=t.getFieldData,i.ZEt=t.idField,i.WEt=!(0,_.isNullOrUndefined)(t.idField),i.QEt=t.sequenceField,i.KEt=!(0,_.isNullOrUndefined)(t.sequenceField),Object.defineProperty(i,"data",{get:function(){return i.VEt(i.lp)}}),Object.defineProperty(i,"isRoot",{get:function(){return i.zEt}}),Object.defineProperty(i,"id",{get:function(){var t;return i.WEt?(t=i.YEt(i.ZEt,i.lp),(0,_.isNullOrUndefined)(t)?t=i._id:i._id!==t&&(i._id=t),t):i._id},set:function(t){i._id=t,(0,_.isNullOrUndefined)(i.JEt)&&(i.JEt=t)}}),Object.defineProperty(i,"parentId",{get:function(){return(0,_.isNullOrUndefined)(i.parent)?j:i.parent.id}}),Object.defineProperty(i,"parent",{get:function(){return i.sft},set:function(t){i.setParent(t),(0,_.isNullOrUndefined)(i.XEt)&&!(0,_.isNullOrUndefined)(t)&&(i.XEt=t.id)}}),Object.defineProperty(i,"level",{get:function(){return i.YAt},set:function(t){i.YAt=t}}),Object.defineProperty(i,"children",{get:function(){return i.R1t},set:function(t){i.R1t=t}}),Object.defineProperty(i,"sequence",{get:function(){return i.KEt?i.YEt(i.QEt,i.lp):i.qEt},set:function(t){i.qEt=t,(0,_.isNullOrUndefined)(i.$Et)&&(i.$Et=t)}}),n}function P(t){this.JFe=[],this.tjt={},this.njt=[],this.ejt=!0,this.Mue=!1,this.Kyn=0;var n=this;Object.defineProperty(this,"options",{get:function(){return n.LEt},set:function(t){n.setDataSourceOptions(t)}}),n._events={},n.options=g({data:m,batch:!1},t),this.ijt(t.remote,t.data),n.bind([l,S,d,y.ONCHANGE,O],t),this.rjt(t.schema),n.ajt()}n=this&&this.__extends||(w=function(t,n){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}w(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),g=this&&this.__assign||function(){return(g=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},h=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(y,"__esModule",{value:!0}),y.DataSource=y.HierarchyNode=y.ONCHANGE=y.REMOVE_COLUMN=y.UPDATE_COLUMN=y.ADD_COLUMN=y.GET_COLUMNS=y.RECOVER_DELETE=y.DELETE=y.UPDATE=y.INSERT=y.CREATE=void 0,i=t("./dist/src/dataSource/dataSource.interface.js"),r=t("./dist/src/dataSource/dataTransport/localDataTransport.js"),e=t("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),f=t("./dist/src/dataSource/event.js"),o=t("./dist/src/dataSource/dataReader/jsonReader.js"),u=t("./dist/src/dataSource/dataReader/columnJsonReader.js"),s=t("./dist/src/dataSource/dataReader/csvReader.js"),c=t("./dist/src/dataSource/dataReader/xmlReader.js"),_=t("./dist/src/dataSource/utils.js"),a=t("Common"),m=null,j=void 0,y.CREATE="create",y.INSERT="insert",y.UPDATE="update",y.DELETE="delete",y.RECOVER_DELETE="recover_delete",y.GET_COLUMNS="getColumns",y.ADD_COLUMN="addColumn",y.UPDATE_COLUMN="updateColumn",y.REMOVE_COLUMN="removeColumn",l="onBeforeSend",O="onFailed",S="onBeforeEnd",d="onReady",C="user cancel the request at step ",y.ONCHANGE="onChange",v=Number.NaN,p="__HIERARCHY__",n(D,V=U),D.prototype.sjt=function(){return this.qEt},D.prototype.setParent=function(t,n){var i=!(0,_.isNullOrUndefined)(this.parent);i&&this.parent.cjt(this),this.sft=t,(0,_.isNullOrUndefined)(t)?i&&(this.level=v):(this.level=t.level+1,(0,_.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},D.prototype.updateChildrenLevel=function(){var n=this.level;this.children.forEach(function(t){t.level=n+1,t.updateChildrenLevel()})},D.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},D.prototype.demote=function(n,t){this.parent=n,(t=!1!==t)?this.updateChildrenLevel():this.children.forEach(function(t){t.parent=n})},D.prototype.getCurrentIndex=function(){return this.parent&&this.parent.children.indexOf(this)},D.prototype.getPrevSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()-1]},D.prototype.getNextSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()+1]},D.prototype.ljt=function(t,n){this.children.splice(n,0,t)},D.prototype.fjt=function(t){this.children.push(t)},D.prototype.cjt=function(t){var t=this.children.indexOf(t);this.children.splice(t,1)},D.prototype.getChildrenIndexes=function(t){var n=[];return(0,_.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:j),n},D.prototype.getChildrenCount=function(){var t=0;return(0,_.traversalTree)(this,{invoked:function(){t++}}),t},D.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},F=D,y.HierarchyNode=F,P.prototype.setDataSourceOptions=function(t,n){var i,r,e,o,u,r,s,r,c,f,i=this;if(q(t),r=i.LEt,i.LEt=t,!(u=(e=r&&r.remote&&r.remote.read&&((0,_.isFunction)(r.remote.read)?r.remote.read:r.remote.read.url))!==(o=t&&t.remote&&t.remote.read&&((0,_.isFunction)(t.remote.read)?t.remote.read:t.remote.read.url)))&&t&&r&&!t.remote&&t.data&&t.data!==r.data&&(u=!0),i.ijt(t.remote,t.data),r=r&&r.schema,s=t&&t.schema,(r=r&&s&&(r.type!==s.type||r.dataPath!==s.dataPath||r.countPath!==s.countPath))&&i.rjt(t.schema),(c=i.ojt)&&(u||r))return i.ajt(f={isDataSourceChanged:u}),i.load().then(function(t){return n&&n(f),Promise.resolve(t)}).catch(function(){n&&n(f)})},P.prototype.ijt=function(t,n){this.hjt=t?new e.RemoteDataTransport(t):new r.LocalDataTransport({data:n||[]})},P.prototype.rjt=function(t){var n,i;"json"===(i=(t=t||{}).type||"json")?n=new o.JsonReader(t):"columnJson"===i?n=new u.ColumnJsonReader(t):"csv"===i?n=new s.CsvReader(t):"xml"===i&&(n=new c.XmlReader(t)),this.djt=n},P.prototype.ajt=function(t){this._data={},this.vjt=0,this.DEt=[],t&&t.isDataSourceChanged&&(this.LEt&&this.LEt.schema&&delete this.LEt.schema.columns,this.JFe=[],delete this._Be)},P.prototype.mjt=function(t,n,i){var r,e,o,u,s,r=this,e={};for(o in r._data)r._data.hasOwnProperty(o)&&(u=r._data[o],0!==n?(s=u.data.splice(t,n),e[o]={data:s}):t>=u.data.length?u.data[t]=i[o]:u.data.splice(t,0,i[o]));return r.vjt=r.vjt-n,i&&r.vjt++,B(e,n)},P.prototype.gjt=function(t,n){var i,r,e,o,i=this,r={};for(e in i._data)i._data.hasOwnProperty(e)&&(o=i._data[e],r[e]={data:o.data.slice(t,n)});return B(r,n-t)},P.prototype.pjt=function(t,n,i){var r,e;if(!(0,_.isNullOrUndefined)(n))if(r=this,i)for(e in n)Object.prototype.hasOwnProperty.call(r._data,e)&&(r._data[e].data[t]=n[e]);else for(e in r._data)r._data.hasOwnProperty(e)&&(r._data[e].data[t]=n[e])},P.prototype.bjt=function(t){var n,i,r,n=this,i={};for(r in n._data)n._data.hasOwnProperty(r)&&(i[r]=n._data[r].data[t]);return i},P.prototype.KFe=function(t){return this._data[t].data},P.prototype.XFe=function(t,n){this._data[t]&&(this._data[t].data=n)},P.prototype.yjt=function(t){var t,n,i;return!(!t||!t.reload)||(n=(t=this).wjt,0===(i=t.vjt))||((0,_.isNullOrUndefined)(n),!1)},P.prototype.Mjt=function(t,n){var i,r,i=this.tjt;return i[t]||(r=void 0,n?r=a.Common.ct.yU(t,n):(r=a.Common.ct.dJ(t),(0,_.isNullOrUndefined)(r)&&(r=new Date(t)),isNaN(r)&&(r=new Date(t.replace(" ","T")))),i[t]=r),i[t]},P.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},P.prototype.Sjt=function(t,n){return+(t=(t=n?t.replace(n,"."):t).replace(/,/g,""))||0},P.prototype.Nbe=function(t){return t.toString()},P.prototype.Tjt=function(t,n,i,r){var e=t;return"rowOrder"===n?t:(r&&n&&"boolean"!==n&&(e+=""),"date"===n?"NULL"===e||""===e?null:this.Mjt(e,i):"boolean"===n?this.Cjt(e,i):"number"===n?this.Sjt(e,i):"string"===n?this.Nbe(e):t)},P.prototype.Ajt=function(t,n){var i="number"==typeof t;return(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(t)||"string"!=typeof t&&!i?t:this.Tjt(t,n.dataType,n.dataPattern,i)},P.prototype.Ijt=function(t,n){var i,r,e,o;for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&(o="number"==typeof(e=n[i]),(0,_.isNullOrUndefined)(e)||"string"!=typeof e&&!o||(n[i]=this.Tjt(e,r.dataType,r.dataPattern,o)))},P.prototype.xjt=function(t,n,i){for(var r,e,o,u,r=this._data[t].data,e=0;e<r.length;e++)u="number"==typeof(o=r[e]),(0,_.isNullOrUndefined)(o)||"string"!=typeof o&&!u||(r[e]=this.Tjt(o,n,i,u));this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},P.prototype.Njt=function(t,n){var i,r;t===n||(0,_.isNullOrEmpty)(n)||((i=this).qFe(t,n),r=i.kjt(t),i.Djt(t,(0,_.isNullOrEmpty)(r)?t:r,n))},P.prototype.qFe=function(n,t){var i,r,i=this,r=i.DEt.findIndex(function(t){return t===n});-1<r&&i.DEt.splice(r,1,t),i._data[t]=i._data[n],delete i._data[n]},P.prototype.kbe=function(){var t,n,i,r,n=this,i=null==(t=n.LEt.schema)?void 0:t.columns;if(i)for(r in i)if(n._be(i[r].trigger))return!0;return!1},P.prototype._be=function(t){var n=this;return t&&t.formula&&(0,_.isFormula)(t.formula)&&(t.when===i.TriggerWhenType.onNew||t.when===i.TriggerWhenType.onNewAndUpdate&&!(0,_.isNullOrEmpty)(t.fields)&&(-1<t.fields.indexOf("*")||t.fields.split(",").map(function(t){return t.trim()}).every(function(t){return-1<n.DEt.indexOf(t)})))},P.prototype.Dbe=function(t){var n,n,i,t,i=this,t=null==(n=null==(n=i.LEt.schema)?void 0:n.columns[t])?void 0:n.trigger;if(i._be(t))return t},P.prototype.jbe=function(t,n){var i,r,e,o,u,s,r=this,o=null==(i=r.LEt.schema)?void 0:i.columns;if(!(0,_.isNullOrUndefined)(o))for(u in o)!o.hasOwnProperty(u)||!(s=r.Dbe(u))||t&&t!==s.when||((e=e===j?{}:e)[u]=n?s.formula:s);return e},P.prototype.gCe=function(t){var n,n,n,i,i;return"formula"===(null==(n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t])?void 0:n.dataType)},P.prototype.Obe=function(){var t,n,i,r,e,o,t,n=this.LEt.schema,r={};if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in i=n.columns)i.hasOwnProperty(e)&&"formula"===(o=i[e]).dataType&&(r[e]=o.value);return r},P.prototype.Ebe=function(t){var n,n,n,n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t];return"formula"===(null==n?void 0:n.dataType)&&(null==n?void 0:n.value)},P.prototype.$Fe=function(){var r,e,r={},e={};return this.njt.concat([this.zjt]).forEach(function(t){var n,i,i,n,i="".concat(t.id),n="".concat(t.parentId);r[i]=n,e[i]=null==(i=null!=(n=t.children)?n:[])?void 0:i.map(function(t){return"".concat(t.id)})}),{orderCache:e,relationShipCache:r}},P.prototype.tBe=function(t){var r,e,o,u,r=t.orderCache,e=t.relationShipCache,o={},u=this;u.njt.concat([this.zjt]).forEach(function(t){var n="".concat(t.id);o[n]=t}),u.njt.forEach(function(t){var n,i,n,i,n="".concat(t.id),i="".concat(t.parentId),n=e[n];(n&&n!==i||!t.parent)&&((i=o[n])||n!==u.zjt.id||(i=u.zjt),t.setParent(i))}),u.njt.concat([this.zjt]).forEach(function(t){var n,n,i,n="".concat(t.id),i=r[n];(null!=(n=t.children)?n:[]).sort(function(t,n){return i.indexOf("".concat(t.id))-i.indexOf("".concat(n.id))})}),u.zjt.updateChildrenLevel(),"Custom"===u.Fjt()&&u.g7t()},P.prototype.kjt=function(t){var n,i=this.LEt.schema,r,i,e;if(!((0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i.columns)||(i=(r=i.columns)[t],(0,_.isNullOrUndefined)(i))||(e=i.dataName,(0,_.isNullOrEmpty)(e))))return e},P.prototype.Djt=function(t,n,i){var r=this,e=r.LEt.schema,r,e;(0,_.isNullOrUndefined)(e)&&(r.LEt.schema=e={}),r=e.columns,(0,_.isNullOrUndefined)(r)&&(e.columns=r={}),e=r[t],(0,_.isNullOrUndefined)(e)&&(r[t]=e={}),(0,_.isNullOrEmpty)(e.dataName)&&(e.dataName=n),(0,_.isNullOrEmpty)(i)||(r[i]=r[t],delete r[t])},P.prototype.Rbe=function(t){var n,i,r,e,o,n=this,i,r=n.Bjt()[1];for(e in t)o=t[e],t[e]=n.Ajt(o,r[e])},P.prototype._jt=function(t){var n=this;return t=n.Ejt(t,{isServerToClient:!0}),n.Rbe(t),t},P.prototype.jjt=function(t){var n=this;return t=(0,_.clone)(t,!0),n.Ojt(t),t=n.Ejt(t)},P.prototype.Ejt=function(t,n){var i,r,e,n,o,u,s,r=(i=this).LEt.schema,e=(n=n||{}).isServerToClient,n=n.isClone;if(!(0,_.isNullOrUndefined)(t)&&!(0,_.isNullOrUndefined)(r)&&!(0,_.isNullOrUndefined)(r.columns)){for(s in o=r.columns,u=[],o)(0,_.isNullOrUndefined)(o[s].dataName)||o[s].dataName===s||u.push(e?[o[s].dataName,s]:[s,o[s].dataName]);0<u.length&&(t=n?(0,_.clone)(t,!0):t,(0,_.isArray)(t)?t.forEach(function(t){i.Rjt(u,t)}):(0,_.isObject)(t)&&i.Rjt(u,t))}return t},P.prototype.Rjt=function(t,i){t.forEach(function(t){var n=t[0],t=t[1];i[t]=i[n],delete i[n]})},P.prototype.Bjt=function(){var t,n,i,r,e,o,t,n=this.LEt.schema;if((0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(n.columns))return[{},{}];for(o in r={},e={},i=n.columns)i.hasOwnProperty(o)&&((0,_.isNullOrUndefined)(i[o].dataName)||(r[i[o].dataName]=o),i[o].dataType||i[o].dataPattern)&&(e[o]={dataType:i[o].dataType,dataPattern:i[o].dataPattern});return[r,e]},P.prototype.nBe=function(i){var a,h,r,t,n,a=this;if(a.JFe=[],a.eBe(),0<(i=i.slice()).length)for(n in r=a.LEt.schema.columns,h={},t=function(n){var t;r.hasOwnProperty(n)&&(t=r[n],h[n]=t,(0,_.isNullOrUndefined)(t.value)&&(t.value=n),(0,_.isNullOrUndefined)(t.name)&&(t.name=n),(0,_.isNullOrEmpty)(t.dataName)||(h[t.dataName]=t),"formula"===t.dataType?(t.name=n,i.push(n)):i.some(function(t){return(t.field||t)===n})||(t.iBe=!0))},r)t(n);i.forEach(function(t){var n,i,r,e,o,u,s,c,f,n=t.field||t,i=t.dataType,r=a.rBe(),e="object"==typeof t,o=e?Object.keys(t):[];if(t=e&&0<o.length?t:{},h[n]){for(u=0,s=o;u<s.length;u++)f=t[c=s[u]],h[n][c]===f||(0,_.isNullOrEmpty)(f)||(h[n][c]=f);h[n].Kyn=r}else a.LEt.schema.columns[n]=g(g({},t),{Kyn:r,name:n,value:n,dataType:i});a.JFe.push({key:r})}),a.Lbe()},P.prototype.rBe=function(){return this.Kyn++},P.prototype.oBe=function(){var t=this,n=t.LEt;return!t.MOt()&&n.remote.getColumns&&("function"==typeof n.remote.getColumns||!(0,_.isNullOrEmpty)(n.remote.getColumns.url))},P.prototype.aBe=function(){var t;return this.oBe()},P.prototype.eBe=function(){var t=this,n=t.LEt.schema;(0,_.isNullOrUndefined)(n)&&(n=t.LEt.schema={}),(0,_.isNullOrUndefined)(n.columns)&&(n.columns={})},P.prototype.iCe=function(t){var n=this;return n.eBe(),!n.gCe(t)},P.prototype.uBe=function(t){var n,i,t,r,e,t,n=this,i=t.source,t=t.name;i&&(r=n.LEt.schema.columns,delete n.LEt.schema.columns[t],delete n._data[t],n.DEt.splice(n.DEt.indexOf(t),1),n.X7t()?(e=i.columnStatus.key,-1<(t=n.JFe.findIndex(function(t){return t.key===e}))&&n.JFe.splice(t,1),n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})):i.postData&&n.sBe()?n.rOt({body:i.postData},y.REMOVE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})}):n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)}))},P.prototype.cBe=function(i,r,e,t){var o=this;o.eBe(),i=g(g({},i),{Kyn:o.rBe()}),r=r||[],o.fBe(i,r,function(t){var n;t.source=t.source||{},o.lBe(i),o.iCe(i.name)&&(o.Lbe(),0<r.length)&&(n=o._data[i.name])&&(n.data=r),o.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:i}),e&&e(t)},t)},P.prototype.lBe=function(t){var n,i;this.LEt.schema.columns[t.name]=g({},t)},P.prototype.hBe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,p,w;if((0,_.isNullOrUndefined)(n)||0===n.length)return[];for(o={},u=0,s=e=(r=this).Ljt();u<s.length;u++)c=s[u],(f=r._data[c])&&f.data&&0<f.data.length&&(o[c]=f.data);for(a=Object.keys(o),h=[],l=0;l<n.length;l++){for((i={})[t.name]=n[l],d=i,v=0,p=a;v<p.length;v++)d[w=p[v]]=o[w][l];h.push(d)}return h},P.prototype.fBe=function(t,n,i,r){var e,o,u,e=this,o=!(0,_.isNamedFormulaColumn)(t);e.X7t()?(e.JFe.push({key:t.Kyn,status:1,column:g({},t),originalColumnData:n.slice()}),u={columnStatus:g({},e.JFe[e.JFe.length-1])},i&&i({type:y.ADD_COLUMN,success:!0,source:u})):o&&e.sBe()?(u={postData:{column:g(g({},t),{field:t.dataName||t.value})}},i&&i({type:y.ADD_COLUMN,success:!0,source:u}),e.dBe(t,e.hBe(t,n),m,r)):i&&i({type:y.ADD_COLUMN,success:!0})},P.prototype.dBe=function(t,n,i,r){var e;this.rOt({body:{column:g(g({},t),{field:t.dataName||t.value}),data:n}},y.ADD_COLUMN).then(function(){i&&i({type:y.ADD_COLUMN,success:!0})}).catch(function(t){r&&r({type:y.ADD_COLUMN,success:!1,reason:t})})},P.prototype.vBe=function(t){var n,i,t,r,e,t,n=this,i=t.source,t=t.name;i&&(i.column&&(n.LEt.schema.columns[t]=i.column),i.data&&(n._data[t]=i.data),i.name&&n.DEt.splice(i.nameIndex,0,i.name),r=i.column,n.X7t()?(e=r.Kyn,-1<(t=n.JFe.findIndex(function(t){return t.key===e}))?n.JFe[t]=i.columnStatus:n.JFe.push(i.columnStatus),n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})):i.postData&&n.sBe()?n.dBe(r,function(){n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})}):n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)}))},P.prototype.gBe=function(r,e,t){var n,n,o,u,o=this;o.eBe(),u=null==(n=null==(n=o.LEt.schema)?void 0:n.columns)?void 0:n[r],o.mBe(r,function(t){var n,i,n=t.source=t.source||{};n.column=g({},o.LEt.schema.columns[r]),o.pBe(r),o.iCe(r)&&(n.data=o._data[r],delete o._data[r],i=o.DEt.findIndex(function(t){return t===r}),n.name=o.DEt[i],n.nameIndex=i,o.DEt.splice(i,1)),o.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},u)}),e&&e(t)},t)},P.prototype.pBe=function(t){var n,i;delete this.LEt.schema.columns[t]},P.prototype.mBe=function(t,n,i){var r,e,o,o,u,s,c,t,r=this,e=r.LEt.schema.columns[t],o=!e.iBe,o=!r.gCe(t)&&o;e.isPrimaryKey&&i&&i({type:y.REMOVE_COLUMN,success:!1}),r.X7t()?(u=e.Kyn,c=void 0,-1<(s=r.JFe.findIndex(function(t){return t.key===u}))&&(c={columnStatus:g({},r.JFe[s])},1===r.JFe[s].status?r.JFe.splice(s,1):(2!==r.JFe[s].status&&(r.JFe[s].originalColumn=g({},e),o)&&(r.JFe[s].originalColumnData=r._data[t].data.slice()),r.JFe[s].status=3)),n&&n({type:y.REMOVE_COLUMN,success:!0,source:c})):o&&r.sBe()?(c={postData:t={column:{field:e.dataName||e.value}}},n&&n({type:y.REMOVE_COLUMN,success:!0,source:c}),r.rOt({body:t},y.REMOVE_COLUMN).catch(function(t){i&&i({type:y.REMOVE_COLUMN,success:!1,reason:t})})):n&&n({type:y.REMOVE_COLUMN,success:!0})},P.prototype.bBe=function(t){var n,t,i,r,e,o,n=this,t=t.source;t&&(i=t.originalColumn,r=t.column,t.originalColumn&&n.wBe(r.value,i,!0),t.shouldUpdateLocalField&&n.qFe(r.value,i.value),t.shouldUpdateDataType&&(n._data[i.value].data=t.data),n.X7t()?(e=i.Kyn,-1<(o=n.JFe.findIndex(function(t){return t.key===e}))&&(n.JFe[o]=t.columnStatus),n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})):t.postData&&n.sBe()?n.rOt({body:{column:t.postData.originalColumn,originalColumn:t.postData.column}},y.UPDATE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})}):n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)}))},P.prototype.yBe=function(i,r,e,t){var n,n,o,u,o=this;return o.eBe(),u=null==(n=null==(n=o.LEt.schema)?void 0:n.columns)?void 0:n[i],o.CBe(i,r,function(t){var n=t.source=t.source||{};n.originalColumn=x(u,i),n.column=x(r,i),o.iCe(i)&&o.MBe(i,r,n),o.wBe(i,r),o.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:r,originalColumn:u}),e&&e(t)},t)},P.prototype.wBe=function(t,n,i){var r,e,t,r,e=this.LEt.schema,t=e.columns[t];(0,_.isNullOrUndefined)(t)||(t.name!==n.name&&delete e.columns[t.name],e.columns[n.name]=i||n.type!==t.type?g({},n):g(g({},t),n))},P.prototype.CBe=function(t,n,i,r){var e,o,u,s,u,c,f,a,h,l,d,v,p,w,b,m,j,h,a,e=this,o=x(e.LEt.schema.columns[t],t);if(n=n.type!==o.type?x(g({},n),t):x(g(g({},o),n),t),u=!o.iBe,u=!(s=e.gCe(t))&&u,c=o.dataName,f=n.dataName,a=!(0,_.isNullOrEmpty)(c),h=!(0,_.isNullOrEmpty)(f),d=o.value!==n.value,v=o.dataType!==n.dataType,p=o.isPrimaryKey!==n.isPrimaryKey,w=o.dataPattern!==n.dataPattern,b=!((l=!1)||v||p||(0,_.isEqual)(o,n,!0,!0)),a&&h?c!==f&&(l=!0):h?o.value!==f&&(l=!0,c=o.value):a?c!==n.value&&(l=!0,f=n.value):d&&(l=!0,c=o.value,f=n.value),e.X7t())m=void 0,j=o.Kyn,-1<(h=e.JFe.findIndex(function(t){return t.key===j}))&&(m={columnStatus:g({},e.JFe[h])},1!==e.JFe[h].status&&(e.JFe[h].status=2,(0,_.isNullOrUndefined)(e.JFe[h].originalColumn))&&(u&&(v||w)&&(e.JFe[h].originalColumnData=e._data[t].data.slice()),e.JFe[h].originalColumn=g({},o)),e.JFe[h].column=g(g({},n),{Kyn:j})),i&&i({type:y.UPDATE_COLUMN,success:!0,source:m});else{if(u&&(l||v||p||b)&&e.sBe())return a={column:g(g({},n),{field:t}),originalColumn:g(g({},o),{field:c||t})},l&&(a.column.field=f),m={postData:a},i&&i({type:y.UPDATE_COLUMN,success:!0,source:m}),e.rOt({body:a},y.UPDATE_COLUMN).catch(function(t){r&&r({type:y.UPDATE_COLUMN,success:!1,reason:t})});i&&i({type:y.UPDATE_COLUMN,success:!0})}},P.prototype.MBe=function(t,n,i){var r,e,o,u,s,r=this,e=x(r.LEt.schema.columns[t],t);n=n.type!==e.type?x(g({},n),t):x(g(g({},e),n),t),o=e.value!==n.value,u=e.dataType!==n.dataType,s=e.dataPattern!==n.dataPattern,o&&(i.shouldUpdateLocalField=!0,r.qFe(e.value,n.value)),(u||s)&&(i.shouldUpdateDataType=!0,i.data=r.SBe(t).slice(),r.xjt(n.value,n.dataType,n.dataPattern))},P.prototype.Ljt=function(){var t,n,i,r,e,o,t,n=this.LEt.schema,i=[];if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in r=n.columns)r.hasOwnProperty(e)&&(o=r[e]).isPrimaryKey&&i.push(e);return i},P.prototype.Ojt=function(t){var n,i,n,r,n=this;!(0,_.isNullOrUndefined)(t)&&n.isHierarchy()&&"Level"===n.Fjt()&&(i=n.Pjt(),(0,_.isNumber)(i))&&(r=t[n=n.Gjt()],t[n]=r-i)},P.prototype.Ujt=function(i){var t,n;return this.njt.map(function(t,n){t.lp=n,i||(t.sequence=n+1);var n=t._data;return t._data=j,n})},P.prototype.Hjt=function(t){var n=this,i=n.zjt,r=n.njt=[];return(0,_.traversalTree)(i,function(t){t.level=t.parent.level+1,r.push(t)},t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:j),n.Ujt(t)},P.prototype.Vjt=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,o=this,u=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=o.Yjt(n),i=o.Yjt(i),r=o.Yjt(r),f={},a=0;a<t.length;a++)h=t[a],l=new F(o.Zjt({data:h,idField:s,sequenceField:c})),d=h[n],f[l.id=d]=l,u&&(l.sequence=h[r]);for((v=new F({isRoot:!0})).level=e-1,a=0;a<t.length;a++)d=t[a][n],p=t[a][i],l=f[d],(0,_.isNullOrUndefined)(w=f[p])?(v.id=p,l.parent=v):l.parent=w;return o.zjt=v,o.Hjt(u)},P.prototype.Wjt=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,b,o=this,u=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=o.Yjt(n),i=o.Yjt(i),r=o.Yjt(r),f=j,a=0;a<t.length;a++)((h=t[a][i])<f||f===j)&&(f=h);for(f===j&&(f=0),(l=o.zjt=new F({isRoot:!0})).level=f+e-1,d=[l],a=0;a<t.length;a++){for(v=t[a],p=new F(o.Zjt({data:v,idField:s,sequenceField:c})),w=(0,_.isNullOrEmpty)(n)?R(a):v[n],h=v[i]+e,p.id=w,u&&(p.sequence=v[r]),b=d[d.length-1];b.level>=h;)b=d.pop().parent;p.parent=b,d.push(p)}return o.Hjt(u)},P.prototype.Qjt=function(t,i,n,r,e){var e,o,u,s,c,f,a,h,o=this,u=o.njt=[],s=!(0,_.isNullOrEmpty)(r),c=i,f=r;return i=o.Yjt(i),n=o.Yjt(n),r=o.Yjt(r),(a=o.zjt=new F({isRoot:!0})).level=e-1,h=[a],(0,_.traversalTree)(((e={})[n]=t,e),{invoking:function(t){var n=new F(o.Zjt({data:t,idField:c,sequenceField:f}));n.id=(0,_.isNullOrEmpty)(i)?R(u.length):t[i],s&&(n.sequence=t[r]),n.parent=h[h.length-1],u.push(n),h.push(n)},invoked:function(){h.pop()}},s?r:j,n),o.Ujt(s)},P.prototype.Kjt=function(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,v,p,w,b,b,u=this,s=!(0,_.isNullOrEmpty)(e),c=n,f=e;for(n=u.Yjt(n),i=u.Yjt(i),e=u.Yjt(e),a={},h=0;h<t.length;h++)l=t[h],d=new F(u.Zjt({data:l,idField:c,sequenceField:f})),v=l[i],d.id=(0,_.isNullOrEmpty)(n)?R(h):l[n],a[v]=d,s&&(d.sequence=l[e]);for(p=u.Bjt(),(w=new F({isRoot:!0})).level=o-1,h=0;h<t.length;h++)d=a[v=t[h][i]],b=r(u.Jjt(t[h],p,h)),(0,_.isNullOrUndefined)(b=a[b])?d.parent=w:d.parent=b;return u.zjt=w,u.Hjt(s)},P.prototype.Jjt=function(u,i,t){var s=this,t={index:t};return Object.defineProperty(t,"data",{get:function(){var r,e,o,t,n,r=i[0],e=i[1],o={},t=function(t){var n,i;u.hasOwnProperty(t)&&(n=u[t],i=r[t]||t,Object.defineProperty(o,i,{get:function(){return s.Ajt(n,e[i])}}))};for(n in u)t(n);return o}}),t},P.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},P.prototype.ABe=function(t,n){var i,r,i,e,i,o,u,s,c,f,a,h,r=this,i=r.LEt.schema;if(r.isHierarchy()){if(e=i.hierarchy.type.trim(),i=null==(i=i.hierarchy.column)?void 0:i.trim(),o=r.$jt(),u=r.Ljt(),"Parent"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("Level"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("ChildrenPath"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("Custom"===e&&(t===(s=u[0])||t===i||t===o))return!0;if(!n&&r.l7t(t))return!0}return!1},P.prototype.qjt=function(t){var n,i,r,e,n,o,u,s,c,f,a,h,l,e,i=this,r=i.LEt.schema;return i.isHierarchy()&&(e=r.hierarchy.type.trim(),n=null==(n=r.hierarchy.column)?void 0:n.trim(),o=r.hierarchy.levelOffset||0,u=i.Ljt(),s=i.$jt(t),"Parent"===e?(c=u[0],t=i.Vjt(t,c,n,s,o)):"Level"===e?(c=u[0],t=i.Wjt(t,c,n,s,o)):"ChildrenPath"===e?(c=u[0],t=i.Qjt(t,c,n,s,o)):"Custom"===e&&(c=u[0],e=r.hierarchy.parse,t=i.Kjt(t,c,n,e,s,o)),i.t7t(),i.ejt=!1),t},P.prototype.t7t=function(){var t,n,i,r,e,t=this,n=t.$jt(),i=t.njt.slice();for((0,_.isNullOrEmpty)(n)||i.sort(function(t,n){return t.sjt()-n.sjt()}),r=0;r<i.length;r++)(e=i[r]).prev=i[r-1],e.next=i[r+1]},P.prototype.$jt=function(t){var n,i,r,e,o,n=this,i=n.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(Object.prototype.hasOwnProperty.call(r,e)&&"rowOrder"===(o=r[e]).dataType&&(o.n7t||n.e7t(e,t)))return o.n7t=!0,e},P.prototype.e7t=function(t,n){var i,r,e;if(!(0,_.isNullOrUndefined)(t)&&(0,_.isArray)(n)){if(0===n.length)return!0;for(t=(i=this).Yjt(t),r=0;r<n.length;r++)if(e=n[r][t],!(0,_.isNullOrUndefined)(e))return(0,_.isNumber)(e)}},P.prototype.qX=function(){var t=this;return!(!t.isHierarchy()||"Parent"===t.Fjt()&&(0,_.isNullOrUndefined)(t.$jt()))},P.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},P.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},P.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},P.prototype.Gjt=function(){return this.options.schema.hierarchy.column},P.prototype.Fjt=function(){return this.options.schema.hierarchy.type},P.prototype.o7t=function(){var t,n;return this.Ljt()[0]},P.prototype.isHierarchy=function(){var t,t,n,n=this.options.schema;return!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.hierarchy)&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.type)?void 0:t.trim())&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.column)?void 0:t.trim())&&("Custom"!==n.hierarchy.type||(0,_.isFunction)(n.hierarchy.parse)&&(0,_.isFunction)(n.hierarchy.unparse))},P.prototype.a7t=function(){return this.ejt},P.prototype.u7t=function(){this.ejt=!0},P.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},P.prototype.c7t=function(t){var n,i;return this.njt[t]},P.prototype.f7t=function(){return this.zjt},P.prototype.l7t=function(t){var n,i=this.i7t();if(!(0,_.isNullOrUndefined)(i))return i[t]},P.prototype.h7t=function(t,n){var i,t,i,i=this,t=i.l7t(t);if(!(0,_.isNullOrEmpty)(t)&&(i=i.SEt(n),!(0,_.isNullOrUndefined)(i))&&0<i.children.length)return t},P.prototype.Yjt=function(t){var n,i,r,e,n,i=this.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(e===t)return r[e].dataName||t;return t},P.prototype.d7t=function(t,n,i){var r=this;return r.v7t(i,(0,_.isNumber)(t)?r.s7t(t):t,r.s7t(n))},P.prototype.v7t=function(t,n,i){var r=this,e=r.njt,o=r.$jt(),u,s=function(t){return r.isHierarchy()?r.njt[t].sequence:r._data[o].data[t]};return t?(n=e[i].next&&e[i].next.lp,(0,_.isNullOrUndefined)(n)?(u=s(i),Math.floor(u)===u?u+=.5:u=(u+Math.ceil(u))/2):u=(s(i)+s(n))/2):(n=e[i].prev&&e[i].prev.lp,u=(0,_.isNullOrUndefined)(n)?(u=s(i))<=1?u/2:u-.5:(s(n)+s(i))/2),u},P.prototype.Cue=function(){return this.Mue},P.prototype.Sue=function(t){this.Mue=t},P.prototype.m7t=function(t,n,i,r){var e,o,u,s,c,f,n,a,h,f,l,d,f,e,o,d,l,u=this,s=u.$jt(),c=u.isHierarchy();if((0,_.isNullOrUndefined)(s)&&!c||n===i||(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(i))return!1;if(i=u.s7t(i),r=(0,_.isNumber)(r)?u.s7t(r):r,n=u.s7t(n),h=(a=u.njt)[n],f=a[i],c){if(f.parent!==h.parent)return!1;e=0,(t=(d=(l=h.parent.children).indexOf(h))<(f=l.indexOf(f)))?(e=null==(o=h.getNextSibling())?void 0:o.lp,l.splice(f+1,0,h),l.splice(d,1)):(e=n,l.splice(d,1),l.splice(f,0,h)),"Custom"===u.Fjt()&&u.g7t(e),!(0,_.isNullOrUndefined)(r)&&(o=a[r],d=h.parent===o,l=h.parent.parent===o.parent,d||l)&&(r=j)}return f=u.v7t(t,r,i),c&&(0,_.isNullOrUndefined)(s)&&(h.sequence=f),u.p7t(t,i,n),(0,_.isNullOrUndefined)(s)||u.b7t(n,((e={})[s]=f,e)),!0},P.prototype.p7t=function(t,n,i){var r,e,i,r,r=this,e;r.isHierarchy()&&(i=r.c7t((0,_.isNumber)(i)?i:r.njt.length-1),r=r.c7t(n),(0,_.isNullOrUndefined)(i.prev)||(i.prev.next=i.next),(0,_.isNullOrUndefined)(i.next)||(i.next.prev=i.prev),t?(i.prev=r,i.next=r.next,(0,_.isNullOrUndefined)(r.next)||(r.next.prev=i),r.next=i):(i.next=r,i.prev=r.prev,(0,_.isNullOrUndefined)(r.prev)||(r.prev.next=i),r.prev=i))},P.prototype.y7t=function(t,n){var i,r,e,i=this,r;if(i.isHierarchy())for(n=n||1,e=0;e<n;e++)i.w7t(e+t)},P.prototype.w7t=function(t){var n,t=this.c7t(t);(0,_.isNullOrUndefined)(t.prev)||(t.prev.next=t.next),(0,_.isNullOrUndefined)(t.next)||(t.next.prev=t.prev)},P.prototype.M7t=function(t){var n,i,i,r,e,o,u,s,e,n,c,f,a,h;if(this.isHierarchy()&&(e=(r=this).njt,o=r.Gjt(),!(u=e[t=r.s7t(t)]).parent.isRoot)){for(s=r.Fjt(),e=u.parent.children.slice(u.getCurrentIndex()+1),n=u.parent.parent,u.promote(n),"Parent"===s?r.b7t(t,((n={})[o]=I(u.parentId),n)):"Level"===s&&r.C7t(t),c=0,f=e;c<f.length;c++)(a=f[c]).parent=u,h=a.lp,"Parent"===s?r.b7t(h,((i={})[o]=u.id,i)):"Level"===s&&r.b7t(h,((i={})[o]=a.level,i));"Custom"===s&&r.g7t(t)}},P.prototype.S7t=function(t,n){this.T7t(t,n)},P.prototype.T7t=function(t,n,i){var n,n,n,r,e,o,u,i,s,i;this.isHierarchy()&&(n=!1!==n,e=(r=this).njt,o=r.Gjt(),t=i?t:r.s7t(t),i=(u=e[t]).getPrevSibling(),(0,_.isNullOrUndefined)(i)||(s=u.children.slice(),u.demote(i,n),i=r.Fjt(),n?"Parent"===i?r.b7t(t,((n={})[o]=I(u.parentId),n)):"Level"===i?r.C7t(t):"Custom"===i&&r.g7t(t):"Parent"===i?(r.b7t(t,((n={})[o]=I(u.parentId),n)),s.forEach(function(t){var t;r.b7t(t.lp,((t={})[o]=I(u.parentId),t))})):"Level"===i?r.b7t(t,((n={})[o]=e[t].level,n)):"Custom"===i&&r.g7t(t)))},P.prototype.b7t=function(t,n,i,r){this.A7t(t,n,i,r)},P.prototype.A7t=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0,N7t:!0}),i&&i({type:y.UPDATE,success:!0})},P.prototype.C7t=function(t,n,i){for(var r,e,o,u,s,c,f,e=this,o=e.njt,u=e.Gjt(),s=o[t].getChildrenIndexes().concat(t),c=0;c<s.length;c++)f=s[c],e.b7t(f,((r={})[u]=o[f].level,r),n,i)},P.prototype.g7t=function(r,e,o){var u=this,s=!!(0,_.isNullOrUndefined)(r),c=u.Gjt();(0,_.traversalTree)(u.zjt,function(t){var n,i,n,t;(s=!1===s&&r===t.lp?!0:s)&&(n=t.lp,t=u.k7t(t),(0,_.isNullOrUndefined)(t)||u.b7t(n,((n={})[c]=t,n),e,o))})},P.prototype.k7t=function(t){var n,i,r,e,i,r,n=this,i=n.Gjt(),r=n.r7t(),e,i=t.data[i],r=null==r?void 0:r(n.D7t(t));if(i!==r)return r},P.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?m:t.parent.data}}),n},P.prototype._7t=function(t,n,i,r){var e=this,t=e.c7t(t);return e.E7t(t.parent,n?t.getCurrentIndex():t.getCurrentIndex()+1,i,r)},P.prototype.j7t=function(t){var n=this,t=n.c7t(t),i=t.getPrevSibling(),n,n=(0,_.isNullOrUndefined)(i)?n.v7t(!1,j,t.lp):n.v7t(!1,i.lp,t.lp);return{sequence:n,offset:0}},P.prototype.O7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.j7t(t).sequence,(n=r._7t(t,!0,n,i)).sequence=e,r.p7t(!1,t),n},P.prototype.R7t=function(t){var n=this,t=n.c7t(t),i=t.getNextSibling(),i,i=(0,_.isNullOrUndefined)(i)?n.v7t(!0,j,t.lp):n.v7t(!0,i.lp,t.lp);return{sequence:i,offset:n.B7t(t)}},P.prototype.L7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.R7t(t).sequence,(n=r._7t(t,!1,n,i)).sequence=e,r.p7t(!0,t),n},P.prototype.F7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.j7t(t).sequence,(n=i._7t(t,!0,n)).sequence=r,i.T7t(t,!0,!0),i.p7t(!1,t),n},P.prototype.P7t=function(t){var n,t,i,r,i,i,n=this,t=n.c7t(t),i=t.children,i=0<i.length?(i=i[i.length-1],r=n.v7t(!0,j,i.lp),n.B7t(t)):(r=n.v7t(!0,j,t.lp),1);return{sequence:r,offset:i}},P.prototype.G7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.P7t(t).sequence,(n=i._7t(t,!1,n)).sequence=r,i.U7t(i.njt.length-1),i.p7t(!0,t),n},P.prototype.U7t=function(t){var n,t,i,n,t=this.c7t(t),i=t.getPrevSibling();(0,_.isNullOrUndefined)(i)||t.demote(i)},P.prototype.E7t=function(t,n,i,r){var e,o,u,s,s,e,e=this,o=e.njt,u=e.o7t(),s=e.$jt(),s=new F(e.Zjt({idField:u,sequenceField:s})),e=e.vjt+1;return(0,_.isNullOrUndefined)(null==r?void 0:r.id)?(0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i[u])?s.id=R(e):s.id=i[u]:s.id=r.id,s.lp=e-1,s.setParent(t,n),o.push(s),s},P.prototype.Xme=function(t,n){var i,r,i,i=this,r=this.f7t(),i=i.E7t(r,void 0,t,n);return i.sequence=1,i},P.prototype.H7t=function(t){var n,i,r,e,o,u,r,n,i,e=this,o=e.$jt(),u=e.Gjt(),r=e.Fjt();return"Parent"===r?((n={})[u]=I(t.parentId),n=n):"Level"===r?((i={})[u]=t.level,n=i):"Custom"===r&&(i=e.k7t(t),(0,_.isNullOrUndefined)(i)||((r={})[u]=i,n=r)),(0,_.isNullOrEmpty)(o)||((n=n||{})[o]=t.sjt()),n},P.prototype.z7t=function(t,n,i){var r,t,e,n,r=this,t=r.SEt(t);return n?(n=t.getNextSibling(),(0,_.isNullOrUndefined)(n)||(e=!1===i?n:t)):e=!1===i?t:t.getPrevSibling(),r.B7t(e)},P.prototype.B7t=function(t){var n,i,r,n=1,i=function(t){return t.children.reduce(function(t,n){return t+i(n)},t.children.length)};return(0,_.isNullOrUndefined)(t)?0:(r=i(t))+1},P.prototype.V7t=function(t){var n=this,t=n.SEt(t);return n.B7t(t)},P.prototype.Y7t=function(t){var n,i,i,n=this;n.isHierarchy()&&(i=n.o7t(),!(0,_.isNullOrUndefined)(i)&&b(t[i])&&(t[i]=j),"Parent"===n.Fjt())&&b(t[i=n.Gjt()])&&(t[i]=j)},P.prototype.Z7t=function(t,n){var i,r,i,e,o,u,s,r=this;r.isHierarchy()&&"Parent"===r.Fjt()&&(i=r.o7t(),(0,_.isNullOrUndefined)(i)||(o=(e=r.c7t(t)).children,u=e.id=e.JEt=r.Xjt(i,t),s=r.Gjt(),o.forEach(function(t){var t;t.XEt=u,r.b7t(t.lp,((t={})[s]=u,t))}),n&&(0,_.isNullOrEmpty)(n[s])&&!e.parent.isRoot&&!b(e.parentId)&&r.b7t(t,((i={})[s]=e.parentId,i))))},P.prototype.Tue=function(t){for(var n,i,r,e,o,n=[],i,r=0,e=(0,_.keys)(t);r<e.length;r++)t[o=e[r]].spread&&n.push(o);return n},P.prototype.Aue=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,r=(0,_.keys)(t);if(0===r.length)return t;for(e={},o=0,u=r;o<u.length;o++)if(c=t[s=u[o]],0<=n.indexOf(s))for(f={},i&&(i[s]=f),l=a=(h=0,_.keys)(c);h<l.length;h++)d=l[h],0<=r.indexOf(d)?(e[s+"_"+d]=c[d],i&&(f[s+"_"+d]=d)):(e[d]=c[d],i&&(f[d]=d));else e[s]=c,i&&(i[s]=s);return e},P.prototype.Iue=function(t,i){var r,n,n,e,r=this,n=r.LEt,n=n&&n.schema&&n.schema.columns;return t=n&&0<(e=r.Tue(n)).length?t.map(function(t,n){return r.Aue(t,e,0===n?i:j)}):t},P.prototype.xue=function(t){var n,i,i,i,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;return t=i&&0<(i=n.Tue(i)).length?n.Aue(t,i):t},P.prototype.Nue=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,i=(0,_.keys)(n);if(0===i.length)return t;for(r={},e=0,o=i;e<o.length;e++)if("object"==typeof(s=n[u=o[e]]))for(r[u]=c={},h=f=(a=0,_.keys)(s);a<h.length;a++)c[s[l=h[a]]]=t[l];else"string"==typeof s&&(r[u]=t[s]);return r},P.prototype.kue=function(t){var n,i,n=this,i=n.Due;return t=i?t&&n.Nue(t,i):t},P.prototype.xBe=function(t){var n,i,i,i,r,e,o,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;if(i&&0<(i=n.Tue(i)).length&&n.Due)for(r=0,e=i;r<e.length;r++)if(o=e[r],n.Due[o][t])return!0},P.prototype.load=function(f){var a,n,t,h,a=this,n=a.options.remote;return n&&n.read&&!(0,_.isFunction)(n.read)&&(0,_.isNullOrEmpty)(n.read.url)?(a.ki(d,{type:"read",success:!(t="InvalidRemoteOption"),reason:t}),Promise.resolve([])):(h=a.W7t(f),a.yjt(h)?(a.ojt=!0,a.Q7t(h).then(function(t){var t={type:"read",data:n&&n.read&&!(0,_.isFunction)(n.read)?G(n.read.adapter,t):t};return a.ki(S,t)?Promise.reject({cancel:!0,type:"read",step:l}):a.djt.parse(t.data)}).then(function(t){return a.wjt=a.djt.total(t),a.djt.read(t)}).then(function(t){var n,i,r,e,o,u,s,c;if(a._data=(!f||!f.reload)&&a._data||{},a.vjt=a.vjt||0,a.DEt=(!f||!f.reload)&&a.DEt||[],t){for(t=(0,_.isArray)(t)?t:[t],t=a.qjt(t),a.Due={},t=a.Iue(t,a.Due),n=0,r=(i=a.Bjt())[0],e=i[1],o=0,u=t.length;o<u;o++)for(s in t[o])c=t[o][s],s=r[s]||s,a._data[s]||(a._data[s]={data:[]},a.DEt.push(s)),a._data[s].data[0+o]=a.Ajt(c,e[s]);a.nBe(a.DEt),a.vjt=0+t.length,t=a.K7t(h).data,a.ki(y.ONCHANGE,{action:y.INSERT,index:0,items:t})}return a.wjt=a.vjt,a.ki(d,{type:"read",success:!0,items:t}),t}).then(function(n){return a.aBe()?a.Q7t(h,y.GET_COLUMNS).then(function(t){return(0,_.isArray)(t)&&a.nBe(t),n}):n}).catch(function(t){var t=t&&!0===t.cancel?C+t.step:a.J7t(t);return a.ki(d,{type:"read",success:!1,reason:t}),Promise.reject(t)})):Promise.resolve(a.K7t(h).data))},P.prototype.Lbe=function(t){var t,n,i,r,e,o,u,s,n=this,i=function(t){n._data[t]||(n._data[t]={data:[]},n.DEt.push(t))};if(t)for(r=0,e=t;r<e.length;r++)i(o=e[r]);else if(u=null==(t=n.options.schema)?void 0:t.columns)for(s in u)u[s].spread||"formula"===u[s].dataType||i(s)},P.prototype.$ue=function(t,n){for(var i,r,e,o,u,s,c,f,a,i=[],r=0,e=n.fields;r<e.length;r++)for(s=0,c=u=t[o=e[r]].data;s<c.length;s++)f=c[s],(a={})[n.as]=o,a[n.valueAs]=f,i.push(a);return i},P.prototype.AP=function(t){for(var n,i,r,e,o,u,s,n=[],i,r=0,e=Object.keys(t);r<e.length;r++)for(u=t[o=e[r]].data,s=0;s<u.length;s++)n[s]||(n[s]={}),n[s][o]=u[s];return n},P.prototype.loadSync=function(t,n){var i,r,n,e,n,o,u,s,c,f,a,i=this;if(i.ojt=!0,r=(0,_.isNullOrUndefined)(t)?n?i.AP(i._data):(n=i.hjt.getDataSync(),i.wjt=i.djt.total(n),i.djt.readSync(n)):i.$ue(i._data,t),i._data={},i.vjt=0,i.DEt=[],r){for(r=(0,_.isArray)(r)?r:[r],e=0,o=(n=i.Bjt())[0],u=n[1],s=0,c=r.length;s<c;s++)for(f in r[s])a=r[s][f],f=o[f]||f,i._data[f]||(i._data[f]={data:[]},i.DEt.push(f)),i._data[f].data[0+s]=i.Ajt(a,u[f]);return i.nBe(i.DEt),i.vjt=0+r.length,r=i.K7t().data,i.wjt=i.vjt,r}return[]},P.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},P.prototype.setLength=function(t){var n=this,i=n._data,n=n.wjt;(0,_.isNullOrUndefined)(n)?i&&(this.vjt=t):this.wjt=t},P.prototype.K7t=function(t){var n,i,r,e,o,u,s,n=this,i=n.X7t(),r=0,e=n.vjt,o=i?n.s7t(0):0,u=n.q7t||[];for(i||(u=[]),s=[];0<e&&o<n.vjt;)u[o]||(s.push(n.bjt(o)),e--),o++;return{data:s}},P.prototype.$7t=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,i=this,r=i.X7t(),e=0,o=i.vjt,u=r?i.s7t(0):0,s=i.q7t||[];if(0===(s=r?s:[]).length){for(c=[],f=0;f<t.length;f++)c[a=t[f]]=i.bjt(a);return{data:c}}for(h=[],l=0;0<o&&u<i.vjt;)s[u]||(-1<t.indexOf(l)&&(h[l]=i.bjt(u)),l++,o--),u++;return{data:h}},P.prototype.tOt=function(t){return(t?this.$7t(t):this.K7t()).data},P.prototype.nOt=function(t,n){var i,r,i,r,i,e,o,u,s,c,r=this,i=r.Fjt(),e=[];if(!(0,_.isNullOrUndefined)(n)&&t.length===n.length)if("Level"===i)for(o=0;o<t.length;o++)u=t[o],e.push(N(u,n[o]));else"ChildrenPath"===i&&(s=r.Yjt(r.Gjt()),c=[((i={})[s]=e,i)],E(((r={})[s]=t,r),((i={})[s]=n,i),s,function(t,n){var t,n,t=N(t,n);delete t[s],n=c[c.length-1],(0,_.isArray)(n[s])||(n[s]=[]),n[s].push(t),c.push(t)},function(){c.pop()}));return e},P.prototype.eOt=function(t){var n,i,r,e,r,o,u,n,s,c,f,a,h,i,l,d,i,e=this,r=e.Fjt();if(!(0,_.isNullOrUndefined)(t)){if(o=e.f7t(),s=e.Gjt(),"Level"===r){for(u="children",f=e.Yjt(s),(n={})[u]=[],n.data={},a=[n=n],h=0;h<t.length;h++){for(l=(i=t[h])[f],d=a[a.length-1];d.data.level>=l;)a.pop(),d=a[a.length-1];(i={data:i})[u]=[],i=i,d[u].push(i),a.push(i)}c=function(t){return t.data}}else"ChildrenPath"===r&&((r={})[u=s]=t,n=r,c=function(t){return t});E(o,n,{childrenField2:u},function(t,n){e._jt(c(n)),e.pjt(t.lp,c(n))})}},P.prototype.iOt=function(i,r,e,n){var o=this;return o.rOt({body:i},r).then(function(t){var n,t,t,n="batch"===r,t={type:r,batch:n,data:o.nOt(i,t)};return o.ki(S,t)?Promise.reject({cancel:!0,type:r,batch:n,step:S}):(i=t.data,o.eOt(i),t={type:r,success:!0,batch:n,items:(0,_.isArray)(i)?i:[i]},delete o.oOt,delete o.q7t,delete o.aOt,delete o.uOt,e&&e(t),o.ki(d,t),n?Promise.resolve(o.K7t()):j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:r,success:!1,reason:t};o.ki(O,{type:t}),n&&n(t)})},P.prototype.sOt=function(){var t,t,t=this;if(t.isHierarchy())return"Level"===(t=t.Fjt())||"ChildrenPath"===t},P.prototype.cOt=function(i,r,t,n){var e,o,e,u,s,c,f,a,h,o=this,e=o.Fjt();return r=r||o.q7t||[],"Level"===e?(u=o.f7t(),s=[],(0,_.traversalTree)(u,function(t){var t,n,t=t.lp;r[t]||(n=o.bjt(t),("create"===i||"batch"===i&&o.isInserted(t,!0))&&o.Y7t(n),n=o.jjt(n),s.push(n))}),o.iOt(s,i,t,n)):"ChildrenPath"===e?(u=o.f7t(),c=o.Gjt(),f=o.Yjt(c),h=[((e={})[f]=a=[],e)],(0,_.traversalTree)(u,{invoking:function(t){var t,n,t,t=t.lp;r[t]||(n=o.bjt(t),("create"===i||"batch"===i&&o.isInserted(t,!0))&&o.Y7t(n),delete n[c],n=o.jjt(n),0<h.length&&(t=h[h.length-1],(0,_.isArray)(t[f])||(t[f]=[]),t[f].push(n)),h.push(n))},invoked:function(t){r[t.lp]||h.pop()}}),o.iOt(a,i,t,n)):Promise.resolve(void 0)},P.prototype.fOt=function(){var t,n,i,r,e,o,u,t,s,c,f,a,r,n=this;if(n.isHierarchy()){for(i=n.njt,r=n.f7t(),e=i.reduce(function(t,n){return(t[n.JEt]=n).id=n.JEt,n.sequence=n.$Et,n.parent=m,t},((t={})[r.JEt]=r,t)),o=0;o<i.length;o++)n.isInserted(o,!0)||((u=i[o]).parent=e[u.XEt]);if(t=n.options.schema.hierarchy.levelOffset||0,r.level=t-1,"Level"===n.Fjt()){for(s=n.Gjt(),c=j,o=0;o<i.length&&!n.isInserted(o,!0);o++)a=void 0,((a=(f=n.lOt(o))?f[s]:n.Xjt(s,o))<c||c===j)&&(c=a);r.level=c+t-1}n.njt=[],r=!(0,_.isNullOrEmpty)(n.$jt()),n.Hjt(r)}},P.prototype.TBe=function(t){var n,i,t,n=this,i=t.column;return delete n.LEt.schema.columns[i.name],(0,_.isNamedFormulaColumn)(i)?-1:(delete n._data[i.name],-1<(t=n.DEt.findIndex(function(t){return t===i.name}))&&n.DEt.splice(t,1),t)},P.prototype.IBe=function(t,n){var i=this,r=t.originalColumn||t.column,t=t.originalColumnData;i.LEt.schema.columns[r.name]=(0,_.clone)(r,!0),(0,_.isNamedFormulaColumn)(r)||(i._data[r.name]={data:t.slice()},-1===i.DEt.findIndex(function(t){return t===r.name})&&((0,_.isNumber)(n)?i.DEt.splice(n,0,r.name):i.DEt.push(r.name)))},P.prototype.kBe=function(t){var n,i,n=this,i=n.TBe(t);n.IBe(t,i)},P.prototype.NBe=function(t){var n=this;switch(t.status){case 1:n.TBe(t);break;case 2:n.kBe(t);break;case 3:n.IBe(t)}},P.prototype.cancelChanges=function(){var i,t,n,r,e,o,u,s,c,i=this;if(i.hasColumnChanges())for(t=0,n=i.JFe;t<n.length;t++)r=n[t],i.NBe(r);(e=i.getHeldActions())&&0!==e.length&&(i.fOt(),i.t7t(),o=i.aOt,u=i.q7t||[],s=i.oOt||[],c=[],(0,_.forEach)(e,function(t){var n=t.sourceIndex,t=t.type;t===y.UPDATE?(i.pjt(n,o[n]),s[n]=[!!s[n]&&s[n][0],!1]):t===y.DELETE?(u[n]=j,s[n]&&s[n][0]?c.push(n):s[n]&&s[n][1]&&(i.pjt(n,o[n]),s[n]=[!1,!1]),(0,_.isNullOrUndefined)(i.wjt)||(i.wjt+=1)):t===y.INSERT&&c.push(n)}),(0,_.forEachRight)(c,function(t){i.mjt(t,1),s.splice(t,1),(0,_.isNullOrUndefined)(i.wjt)||--i.wjt}),i.clearBatchCache_())},P.prototype.getChanges=function(){var t=this.getColumnChanges(),n=this.hOt(!1);return t&&0<t.length?t.concat(n):n},P.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(t){return"delete"===t.type||"insert"===t.type})},P.prototype.jBe=function(){for(var t,n,i,r,t=this,n=0;n<t.JFe.length;n++)(r=(i=t.JFe[n]).originalColumn||i.column)&&("formula"===r.dataType||r.iBe)&&(t.JFe[n]={key:i.key})},P.prototype.submitChanges=function(s,c){var f,n,a,h,l,d,v,p,w,b,t,f=this;return f.hasCachedActions()||f.hasColumnChanges(!0)?f.sOt()?(n=(f.q7t||[]).slice(),f.cOt("batch",j,function(){for(var t=f.vjt-1;0<=t;t--)!0===n[t]&&(f.mjt(t,1),f.njt[t].parent=m,f.njt.splice(t,1));f.njt.forEach(function(t,n){t.lp=n})})):(a=f.aOt,h=f.q7t||[],l=f.oOt||[],d=f.getHeldActions(),v=[],p=y.UPDATE,(0,_.isNullOrUndefined)(d)||d.forEach(function(t){t.dataItem=f.kue(f.jjt(t.dataItem)),t.oldDataItem=f.kue(f.jjt(t.oldDataItem))}),d=d||[],w=f.getColumnChanges(!0),t=(b=w&&0<w.length)?w.concat(d):d,f.rOt({body:t},"batch").then(function(t){var n,n,i,o,r,e,u,n=b&&t,n={type:p,batch:!0,data:n?t.slice(w.length):t,columns:n?t.slice(0,w.length):j};return f.ki(S,n)?Promise.reject({cancel:!0,type:p,batch:!0,step:S}):(((i=n.data)||[]).forEach(function(t){t.succeed&&t.data&&(f._jt(t.data),t.data=f.xue(t.data))}),i.length,d.length,o=[],(0,_.forEach)(d,function(t,n){var n=i[n];n.succeed?t.type===y.UPDATE?(a&&(a[t.sourceIndex]=j),l[t.sourceIndex][1]=j):t.type===y.INSERT?(n.data&&(f.pjt(t.sourceIndex,n.data),f.Z7t(t.sourceIndex,n.data)),l[t.sourceIndex]=[],a[t.sourceIndex]=j):t.type===y.DELETE&&v.push(t.sourceIndex):o.push({localAction:t,response:n})}),(0,_.forEachRight)(v,function(t){var n,i,r,e;for(h.splice(t,1),f.mjt(t,1),a&&a.splice(t,1),l.splice(t,1),f.isHierarchy()&&(f.njt[t].parent=m,f.njt.splice(t,1)),n=0,i=o;n<i.length;n++)t<(e=(r=i[n]).localAction.sourceIndex)&&r.localAction.sourceIndex--}),f.isHierarchy()&&f.njt.forEach(function(t,n){t.lp=n}),0<o.length?(r={type:p,errorData:o},f.ki(O,{type:r})||(f.uOt=[],(0,_.forEach)(o,function(t,n){var i=t.response,t=t.localAction,r=t.sourceIndex;t.type===y.DELETE&&(h[r]=j,(0,_.isNullOrUndefined)(f.wjt)||(f.wjt+=1)),f.dOt(r,{type:t.type,success:!1,reason:i.reason}),s(r,i.reason,t.type)}))):delete f.uOt,f.jBe(),e=[],u=n.columns,(0,_.forEach)(w,function(n,t){var t,i,t=u[t];t.succeed?-1<(i=f.JFe.findIndex(function(t){return t.key===n.column.Kyn}))&&(n.type===y.REMOVE_COLUMN?f.JFe.splice(i,1):f.JFe[i]={key:f.JFe[i].key}):e.push({change:n,response:t})}),0<e.length?(r={type:p,errorColumns:e},f.ki(O,{type:r})||(f._Be={},(0,_.forEach)(e,function(t){var n,i,t,r,n=t.response,i=t.change,t=i.name;i.type===y.REMOVE_COLUMN&&-1<(r=f.JFe.findIndex(function(t){return t.key===i.column.Kyn}))&&(f.IBe(f.JFe[r]),f.JFe[r]={key:f.JFe[r].key}),f.DBe(t,{type:i.type,success:!1,reason:n.reason}),c(t,n.reason,i.type)}))):delete f._Be,Promise.resolve(f.K7t()))}).catch(function(t){var t,n,t=t&&!0===t.cancel?C+t.step:f.J7t(t),n;f.ki(O,{type:{type:p,reason:t}})})):(f.jBe(),Promise.resolve(void 0))},P.prototype.getColumnChanges=function(n){var i,r,e,t,i=this;return i.hasColumnChanges(n)?(r=function(t){return n?g(g({},t.column),{Kyn:t.key,field:t.column.dataName||t.column.value}):g({},t.column)},e=function(t){return n?g(g({},t.originalColumn),{Kyn:t.key,field:t.originalColumn.dataName||t.originalColumn.value}):g({},t.originalColumn)},t=i.JFe,(t=n?i.JFe.filter(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.iBe}):t).reduce(function(t,n){switch(n.status){case 1:t.push({type:y.ADD_COLUMN,column:r(n),data:i.hBe(n.column,n.originalColumnData)});break;case 2:t.push({type:y.UPDATE_COLUMN,column:r(n),originalColumn:e(n)});break;case 3:t.push({type:y.REMOVE_COLUMN,column:e(n)})}return t},[])):m},P.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):m},P.prototype.hOt=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,u,u,n=this,i=[],r=n.oOt||[],e=n.q7t||[],o=n.aOt,c=n.isHierarchy(),f=0;f<n.vjt;f++){if(u=r[f],!(s=null)===e[f])s={type:y.DELETE,dataItem:n.bjt(f)};else if(u&&u[0])s={type:y.INSERT,dataItem:n.bjt(f)},t&&c&&n.Y7t(s.dataItem);else if(u&&u[1]){if(a=o[f],h=n.bjt(f),!t)for(l in a=g({},a))a.hasOwnProperty(l)&&a[l]===h[l]&&(delete a[l],delete h[l]);s={type:y.UPDATE,dataItem:h,oldDataItem:a}}s&&(c&&s.type===y.INSERT&&b((u=n.c7t(f).parent).id)&&(u=u.isRoot?j:u.lp,t?s.sourceParentIndex=u:s.parentIndex=(0,_.isNumber)(u)?n.TEt(u):j),t?s.sourceIndex=f:s.index=this.TEt(f),i.push(s))}return i},P.prototype.clearBatchCache_=function(){var i,t,i=this,t=this;delete t.q7t,delete t.aOt,delete t.uOt,t.JFe=t.JFe.reduce(function(t,n){return 1!==n.status&&t.push({key:i.rBe()}),t},[])},P.prototype.hasColumnChanges=function(t){var n=this;return!!n.X7t()&&(t?n.JFe.some(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.iBe}):n.JFe.some(function(t){return t.status}))},P.prototype.hasCachedActions=function(){var t,n,t,i,r,e,o,u,s,t=this;if(t.X7t()&&(n=t.oOt,t=t.q7t,n||t)){if(t)for(i=0,r=t;i<r.length;i++)if(e=r[i])return!0;if(n)for(o=0,u=n;o<u.length;o++)if((s=u[o])&&(!0===s[0]||!0===s[1]))return!0}return!1},P.prototype.bind=function(t,n){var i,r,e,o,u,s,c,i=this;if(n)for(o=r=(e=0,_.isArray)(t)?t:[t];e<o.length;e++)u=o[e],(s=(0,_.isFunction)(n)?n:n[u])&&(c=i._events[u]=i._events[u]||new f.Event).addHandler(s,i)},P.prototype.unbind=function(t,n){var i,t,i=this;(0,_.isNullOrUndefined)(t)?((0,_.forEach)(i._events,function(t){t.removeAllHandlers()}),i._events={}):(t=i._events[t])&&(n?t.removeHandler(n,i):t.removeAllHandlers())},P.prototype.ki=function(t,n){var i,r,i=this,r=i._events[t];return!!r&&((n=n||{}).cancel=!1,n.eventName=t,r.raise(i,n),n.cancel)},P.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},P.prototype.W7t=function(t){return t=g({},t)},P.prototype.mOt=function(t){return t},P.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,_.keys)(n).map(function(t){return parseInt(t,10)})},P.prototype.gOt=function(t,n){var i=this,r;return(i.oOt||[])[t=n?t:i.s7t(t)]||[]},P.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},P.prototype.isUpdated=function(t){return this.gOt(t)[1]},P.prototype.getErrorInfo=function(t){var n=this,i=n.uOt;if(!(0,_.isNullOrUndefined)(i))return i[t=n.s7t(t)]},P.prototype.dOt=function(t,n){var i=this,r;(i.uOt=i.uOt||[])[t]=n},P.prototype.DBe=function(t,n){var i=this,r;(i._Be=i._Be||{})[t]=n},P.prototype.pOt=function(){this.oOt=j,this.q7t=j,this.aOt=j,this.uOt=j},P.prototype.lOt=function(t){var n=this,i;return(n.aOt=n.aOt||[])[t]},P.prototype.insertItem=function(t,n,i,r){var e,t,e=this,t=e.s7t(t);e.I7t({action:y.INSERT,index:t,item:n,N7t:!0}),e.isHierarchy()&&"Custom"===e.Fjt()&&e.g7t(t),i&&i({type:y.CREATE,success:!0})},P.prototype.recoverItemAtBatch=function(t,n,i,r){var e=this;e.X7t()&&this.OBe(t)?(e.I7t({action:y.RECOVER_DELETE,index:t,item:n,N7t:!0}),i&&i({type:y.CREATE,success:!0})):this.insertItem(t,n,i,r)},P.prototype.OBe=function(t){var n;return!(null==(n=this.q7t)||!n[t])},P.prototype.updateItem=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n}),i&&i({type:y.UPDATE,success:!0})},P.prototype.updateItemValues=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0}),i&&i({type:y.UPDATE,success:!0})},P.prototype.resetItem=function(t,n,i){var r,e,o,r=this,e,o=(r.aOt=r.aOt||[])[t=r.s7t(t)];r.isHierarchy()&&(o=r.bOt(t,o)),r.pjt(t,o),r.clearChangedStatus(t),r.dOt(t),n&&n({type:y.UPDATE,success:!0})},P.prototype.bOt=function(t,n){var i,r,t,e,o,i,u,i=this,r;return i.isHierarchy()?(t=i.bjt(t),e=i.Fjt(),o=i.Gjt(),i=i.$jt(),u=g({},n),"Parent"!==e&&"Level"!==e&&"Custom"!==e||(u[o]=t[o]),(0,_.isNullOrEmpty)(i)||(u[i]=t[i]),u):n},P.prototype.saveItem=function(t,n,i){var r,e,o,u,s,c,o,f,r=this;t=r.s7t(t),u=(o=(e=r.oOt||[])[t]||[])[0],s=o[1],0<o.length&&(u||s)&&(r.isHierarchy()&&(f=!(o=(c=r.njt)[t].parent).isRoot&&e[o.lp]&&e[o.lp][0])?i&&i({type:y.CREATE,success:!1}):r.yOt(t,r.bjt(t),u?y.INSERT:y.UPDATE,n,i))},P.prototype.yOt=function(n,i,t,r,e){var o=this,t=t===y.INSERT,u=t?y.CREATE:y.UPDATE,s=o.X7t(),c=o.wOt(u),f=o.MOt();s||!c||f?f&&(o.oOt[n]=[],o.aOt[n]=j,r)&&r({type:u,success:!0}):o.sOt()?o.cOt(t?y.CREATE:y.UPDATE,j,r,e):(t&&o.Y7t(i),i=o.jjt(i),i=o.kue(i),o.rOt({body:i},t?y.CREATE:y.UPDATE).then(function(t){var t,t,t={type:u,data:N(i,t)};return o.ki(S,t)?Promise.reject({cancel:!0,type:u,step:S}):(o._jt(t.data),t.data=o.xue(t.data),o.pjt(n,t.data),o.oOt[n]=[],o.aOt[n]=j,o.dOt(n),t={type:u,success:!0,items:[t.data]},u===y.CREATE&&o.Z7t(n),r&&r(t),o.ki(d,t),j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:u,success:!1,reason:t};o.dOt(n,t),o.ki(O,{type:t}),e(t)}))},P.prototype.I7t=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,l,i,n=this,i=n.X7t(),r=n.aOt=n.aOt||[];i&&(e=n.q7t=n.q7t||[]),o=t.action,u=t.index,s=t.item,c=t.x7t,u=(f=t.N7t)?u:n.s7t(u),a=this.TEt(u),n.oOt=n.oOt||[],h=n.oOt,o===y.INSERT?(0===n.vjt&&0===n.DEt.length&&n.COt(),n.vjt<u&&(n.vjt=u),(0,_.isNullOrUndefined)(l=u)&&(l=n.vjt),n.mjt(l,0,s),r.length>=u?r.splice(u,0,g({},s)):r[u]=g({},s),i&&(e.length>=u?e.splice(u,0,j):e[u]=j),h.length>=u?h.splice(u,0,[!0]):h[u]=[!0],(0,_.isNullOrUndefined)(n.wjt)||(n.wjt+=1),n.ki(y.ONCHANGE,{action:o,index:u,items:[t.item],modelIndex:a})):o===y.UPDATE?(l=n.bjt(u),r[u]||(r[u]=g({},l)),n.pjt(u,s,c),n.oOt[u]?n.oOt[u]=[n.oOt[u][0],!0]:n.oOt[u]=[!1,!0],M(g(g({},l),s),r[u])&&n.clearChangedStatus(u),n.ki(y.ONCHANGE,{action:o,index:u,items:[t.item],oldItems:[l],modelIndex:a})):o===y.RECOVER_DELETE&&e&&(i=!!e[u],delete e[u],i)&&this.setLength(this.length()+1)},P.prototype.clearChangedStatus=function(t){var n=this;!(n.oOt[t][1]=!1)!==n.oOt[t][0]&&(n.aOt[t]=j)},P.prototype.get=function(t){var n,i,r,e,o,u,n=this,i=n._data;if(t=n.s7t(t),i&&t<n.vjt){for(r={},e=0,o=n.DEt;e<o.length;e++)r[u=o[e]]=i[u].data[t];return r}return j},P.prototype.Xjt=function(t,n){var i=this,r=i._data;return r&&r[t]&&n<i.vjt?r[t].data[n]:j},P.prototype.SBe=function(t){var n,i=this._data;return i&&i[t]?i[t].data:[]},P.prototype.getFieldValue=function(t,n){var i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?r[t].data[n]:j},P.prototype.getFieldOriginalValue=function(t,n){var i,r,i,i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?(i=i.lOt(n),(0,_.isNullOrUndefined)(i)?r[t].data[n]:i[t]):j},P.prototype.EBe=function(t){for(var n,i,r,e,o,n=this,i=n.length(),r=n.SBe(t),e=0;e<i;e++)if(o=r[e],!(0,_.isNullOrUndefined)(o))return o},P.prototype.RBe=function(t){var t,n,t=this.EBe(t),n=typeof t;return"object"==n&&t instanceof Date?"date":n},P.prototype.Fbe=function(t){var n,i,r,e,o,u,s,n=this,i=n.s7t(t),r=n.lOt(i),e=n._data,u={};for(s in e)e.hasOwnProperty(s)&&(u[s]=o=e[s].data[i],(0,_.isUndefined)(o))&&(u[s]=r[s]);return u},P.prototype.SOt=function(t,n,i){var o,r,e,u,s,c,f,a,s,o=this,r;o.X7t()||!o.wOt(y.DELETE)||o.MOt()||o.isInserted(t)||!o.sOt()?o.isHierarchy()&&(t=o.s7t(t),e=o.c7t(t),f=e.getChildrenIndexes(!0).concat(t),a=h([],f,!0),s=f.map(function(r,e){return function(t,n){for(var i=e;i<f.length;i++)f[i]>r&&f[i]--;o.TOt(f[e],1,t,n)}}),(0,_.promiseSerialExecute)(s).then(function(t){o.X7t()||(a.sort(function(t,n){return n-t}),a.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})),"Custom"===o.Fjt()&&o.g7t();var t=t[t.length-1];t.removedCount=a.length,n&&n(t)}).catch(function(t){i&&i(t)})):(t=o.s7t(t),e=o.c7t(t),s=(u=e.getChildrenIndexes(!0).concat(t)).reduce(function(t,n){return t[n]=!0,t},[]),o.bind(S,c=function(){u.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})}),o.cOt(y.DELETE,s,function(t){o.unbind(S,c),t.removedCount=u.length,n&&n(t)},function(t){o.unbind(S,c),i&&i(t)}))},P.prototype.remove=function(t,n,i,r){var e=this;e.isHierarchy()?e.SOt(t,i,r):e.TOt(t,n,i,r)},P.prototype.TOt=function(i,r,e,n){var o,u,s,t,c,o=this,u=o.X7t();i<0||i>=(u?o.vjt:o.length())||(s=y.DELETE,u||!o.wOt(y.DELETE)||o.MOt()||o.isInserted(i)?(!u&&o.isHierarchy()||o.tX(i,r),e&&e(t={type:s,success:!0})):(c=o.gjt(i,i+r),o.Ejt(c),c=c.map(function(t){return o.kue(t)}),o.rOt({body:c},y.DELETE).then(function(t){var n;return o.ki(S,{type:s,data:c})?Promise.reject({cancel:!0,type:s,step:S}):(c&&c[0]&&!u&&(i=o.Bbe(i,c[0])),o.isHierarchy()||o.tX(i,r),o.Ejt(c,{isServerToClient:!0}),c=c.map(function(t){return o.xue(t)}),o.dOt(i),n={type:s,success:!0,items:[c]},e&&e(n),o.ki(d,n),j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:s,success:!1,reason:t};o.dOt(i,t),o.ki(O,{type:t}),n(t)})))},P.prototype.tX=function(i,r,e){var o,t,n,u,s,c,f,a,h,l,d,v,p,t,o=this,t=o.X7t(),u=o.oOt||[],s=o.aOt||[],c=i,f=i,a={};if(t){for(h=o.q7t=o.q7t||[],l=r,d=[],n=[],o.isHierarchy()?(f=this.TEt(c),v=o.njt,a.id=v[c].id,v[c].parent=m,o.y7t(i,r)):c=o.s7t(i),p=c;p<o.vjt&&(!0!==h[p]&&n.length<r&&(n.push(o.bjt(p)),d.push(p),h[p]=!0,--l),0!==l);p++);(0,_.forEachRight)(d,function(t){var n;u[t]&&u[t][0]&&(n=o.njt,h.splice(t,1),u.splice(t,1),s.splice(t,1),o.mjt(t,1),n.splice(i,r),!1!==e)&&n.forEach(function(t,n){t.lp=n})})}else v=o.njt,o.isHierarchy()&&(a.id=v[i].id),n=o.mjt(i,r),u.splice(i,r),s.splice(i,r),o.isHierarchy()&&(v[i].parent=m,o.y7t(i,r),v.splice(i,r),!1!==e)&&v.forEach(function(t,n){t.lp=n});t=n.length,(0,_.isNullOrUndefined)(o.wjt)||(o.wjt-=t,o.wjt=Math.max(o.wjt,0)),o.ki(y.ONCHANGE,{action:y.DELETE,items:n,index:null!=c?c:i,modelIndex:f,hierarchyNodeInfo:a})},P.prototype.COt=function(){var t,n,i,r,n=this,i=null==(t=n.options.schema)?void 0:t.columns;if(i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n._data[r]={data:[]},n.DEt.push(r))},P.prototype.MOt=function(){return(0,_.isNullOrUndefined)(this.options.remote)},P.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},P.prototype.sBe=function(){return this.options.autoSync&&!this.MOt()},P.prototype.wOt=function(t){var n,i,n,n=this,i=n.options,n=n.hjt;return!!i.autoSync&&!(0,_.isNullOrUndefined)(n.LEt[t])},P.prototype.rOt=function(t,n){var i,r,i=this,r=n||y.UPDATE;return!(t=i.hjt.setupRequestOptions(t,n||y.UPDATE))||i.ki(l,{type:r,requestParams:t})?Promise.reject({cancel:!0,type:r,step:l}):i.hjt.postData(t)},P.prototype.Q7t=function(t,n){var i=this;return t=i.mOt(t),!(t=i.hjt.setupRequestOptions(t,n=n||"read"))||i.ki(l,{type:n,requestParams:t})?Promise.reject({cancel:!0,type:n,step:l}):i.hjt.getData(t)},P.prototype.J7t=function(t){return(0,_.isString)(t)?t:t instanceof Error?t.message:"some error happened"},P.prototype.mTe=function(){var t=this.q7t;return!((0,_.isNullOrUndefined)(t)||0===t.length)},P.prototype.s7t=function(t){var n,i,r,e,o,n=this.q7t;if((0,_.isNullOrUndefined)(n)||0===n.length)return t;for(e=r=i=0,o=n.length;e<=o;e++)if(n[e])r+=1;else{if(i===t)break;i+=1}return t+r},P.prototype.TEt=function(t){var n,i,r,n=this.q7t;if(!(0,_.isNullOrUndefined)(n)&&0!==n.length)for(i=0,r=Math.min(n.length,t);i<=r;i++)n[i]&&--t;return t},P.prototype.Bbe=function(t,n){var i,r,e,o,u,i=this.gjt(t,t+1);if(!i||!M(i[0],n))for(r=this.length(),o=t+1,u=t-1;0<=u||o<r;){if(o<r){if(e=o,(i=this.gjt(e,e+1))&&M(i[0],n))return e;o++,o=Math.min(r,o)}if(0<=u){if(e=u,(i=this.gjt(e,e+1))&&M(i[0],n))return e;u--,u=Math.max(-1,u)}}return t},y.DataSource=P},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var i,r;function e(t){t&&(this._data=t.data,this.LEt=i({},t))}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,e.prototype.getData=function(t){var n;return Promise.resolve(this._data)},e.prototype.getDataSync=function(){return this._data},e.prototype.postData=function(t){var n;return Promise.resolve(this._data)},e.prototype.setupRequestOptions=function(t,n){return{}},n.LocalDataTransport=e},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,i){"use strict";var c,u,s,r,f,a,h,l,d,v,p,e;function o(t){var n;this.LEt=c({},t)}c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,i("./node_modules/whatwg-fetch/fetch.js"),u=i("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),s=i("./dist/src/dataSource/utils.js"),r=null,f=void 0,a="jsonp",h="read",l="create",d="update",v="delete",p="Content-Type",o.prototype.getData=function(t){var n,i,r,e,o,n=this,i,r=this.LEt[t.requestType],e=t.dataType,o=e===a?u:fetch;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(t):o(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},o.prototype.postData=function(t){var n,i,r,e,o,n=this,i,r=this.LEt[t.requestType],e=t.dataType,o=t.requestData;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(o,t):fetch(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},o.prototype.AOt=function(t){return void 0===t||"json"===t||t===a},o.prototype.setupRequestOptions=function(t,n){var i,r,e,o,u,s,i,e;if(t=t||{},r=(i=this).LEt[n])return e=r.body,(o=t.body)?(t.headers=t.headers||{},i.LEt.dataConverter?(t.body=o=i.LEt.dataConverter(o,n||h),t.headers[p]="application/plain;"):(t.body="string"==typeof o?o:JSON.stringify(o),t.headers[p]="application/json; charset=utf-8")):e&&(t.body="string"==typeof e?e:JSON.stringify(e),t.headers={},t.headers[p]="application/json; charset=utf-8"),i=r.method,n===h?(r.dataType===a&&(u={mode:"no-cors"}),s={method:i||"GET"}):n===l||n===d||"batch"===n?s={method:i||"POST"}:n===v&&(s={method:i||"DELETE"}),(e=r.options)&&e.mode&&(u={mode:e.mode}),e&&0<Object.keys(e).length||(e={}),c(c(c(c(c(c({},r),s),u),e),t),{requestType:n,requestData:o})},n.RemoteDataTransport=o},"./dist/src/dataSource/event.js":function(t,n){"use strict";var e,c,i;function r(t,n,i){var r=this;r.handler=t,r.owner=n,r.priority=i}function o(){this.IOt=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.Event=n.EventHandler=void 0,e=r,n.EventHandler=e,c=null,Object.defineProperty(o.prototype,"hasHandlers",{get:function(){return 0<this.IOt.length},enumerable:!1,configurable:!0}),o.prototype.addHandler=function(t,n,i){var r=this,t=new e(t,n,i=void 0===i?1:i);r.IOt.push(t),r.sortHandlers()},o.prototype.removeHandler=function(t,n){for(var i,r,e,o,u,i=this,r=i.IOt,e=r.length,o=0;o<e;o++)if((u=r[o]).handler===t&&u.owner===n){i.IOt.splice(o,1);break}},o.prototype.sortHandlers=function(){this.IOt.sort(function(t,n){var t=t.priority,n=n.priority;return t<n?1:n<t?-1:0})},o.prototype.removeHandlersByPriority=function(t){for(var n,i,r,e,o,u,s,n=this,i=n.IOt,r=i.length,e=c,o=c,u=0;u<r;u++)if((s=i[u]).priority===t)e===c&&(e=u),o=u;else if(e!==c)break;e!==c&&o!==c&&n.IOt.splice(e,o-e+1)},o.prototype.removeAllHandlers=function(){this.IOt.length=0},o.prototype.raise=function(t,n){var i,r,r,e,o,u,s,i=!1,r=function(){i=!0};for(n===c?n={stopPropagation:r}:n.stopPropagation=r,e=(r=this).IOt.length,o=r.IOt.slice(0,e),u=0;u<e&&!i;u++)(s=o[u]).handler.call(s.owner,t,n)},n.Event=o},"./dist/src/dataSource/utils.js":function(A,a,t){"use strict";var e,u,s,c,f,h;function n(t){return t&&!(0,a.isArray)(t)&&"object"==typeof t}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"boolean"==typeof t}function l(t,n){var i,r,e,o,u;if((0,a.isArray)(t))for(i=0;i<t.length;i++)n(t[i],i,t);else if(!R(t))for(e=0,o=r=Object.keys(t);e<o.length;e++)n(t[u=o[e]],u,t)}function d(t,n){var i,r,e,o,u;if((0,a.isArray)(t))for(i=t.length-1;0<=i;i--)n(t[i],i,t);else for((r=Object.keys(t)).reverse(),e=0,o=r;e<o.length;e++)n(t[u=o[e]],u,t)}function v(t){return Object.keys(t)}function p(t,n,i){if((0,a.isArray)(t))return t.reduce(n,i);throw new Error("NOT SUPPORT")}function w(t,n,i){return t.indexOf(n,i=void 0===i?0:i)}function b(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function m(t,n){var i,r,e,o,u,s,c;if(void 0===n&&(n=!1),!R(t)&&"object"==typeof t){if(t&&(0,a.isArray)(t))return t.map(function(t){return m(t,n)});if(t&&"object"==typeof t){for(i={},e=0,o=r=v(t);e<o.length;e++)s=t[u=o[e]],n?(c=M(s),i[u]="object"===c||"array"===c?m(s,n):s):i[u]=s;return i}}return t}function j(t,n,i,r){var e,o,u,s,c,f;if(void 0===i&&(i=!1),void 0===r&&(r=!1),!R(t)&&!R(n)){if(t instanceof Blob||n instanceof Blob)return t===n;if(t instanceof Date&&n instanceof Date)return t.valueOf()===n.valueOf();if(i)if((0,a.isArray)(t)&&(0,a.isArray)(n)){if(t.length===n.length){for(e=0;e<t.length;e++)if(!j(t[e],n[e],i,r))return!1;return!0}}else if("object"==typeof t&&"object"==typeof n&&(o=Object.keys(t).filter(function(t){return!r||"_"!==t[0]}),u=Object.keys(n).filter(function(t){return!r||"_"!==t[0]}),o.length===u.length)){for(s=0,c=o;s<c.length;s++)if(f=c[s],!n.hasOwnProperty(f)||!j(t[f],n[f],r))return!1;return!0}}return t===n}function y(t,n){return!j(t,n,!0)}function g(t,n){var i,r,e;for(void 0===t&&(t=[]),void 0===n&&(n=[]),i={},r=Math.min(t.length,n.length),e=0;e<r;e++)i[t[e]]=n[e];return i}function _(t){return"string"==typeof t}function O(t,n){var i,r,e,o;if(_(n))return t[n];for(i={},r=0,e=n;r<e.length;r++)i[o=e[r]]=t[o];return i}function S(t,n){if((0,a.isArray)(t))return t.map(n);throw new Error("NOT SUPPORT")}function C(t){return void 0===t}function F(t){return null===t}function R(t){return C(t)||F(t)}function I(t){return""===t||R(t)}function N(t){return t&&"="===t[0]}function E(t){return!_(t)&&_(t.name)&&!N(t.name)&&"formula"===t.dataType}function k(t){return t&&-1<t.indexOf(".")&&!N(t)}function M(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function L(t,n,i,r){n<0||n>t.length||i<0||i>t.length||n===i||r<=0||t.splice.apply(t,e([i-(n<i?r-1:0),0],t.splice(n,r),!1))}function x(t,n){var t=t.parent;t&&(n(t),x(t,n))}function T(t,n,i,r){var e,o,u,s,c,f,a,h,l,d,v,e=t[r||"children"]||[];for(I(i)?o=e.slice():(f=c=void 0,"string"==typeof i?u=i:"function"==typeof i?s=i:"object"==typeof i&&(u=i.field,s=i.getValue,c=i.compareFn,f=i.isOrderChildren),o=f?e:e.slice(),u?o.sort(function(t,n){return t[u]-n[u]}):s?o.sort(function(t,n){return s(t)-s(n)}):c&&o.sort(c)),"object"==typeof(a=n)&&(a=n.invoking,h=n.invoked),d=0;d<o.length;d++){if(v=o[d],a&&(l=a(v,t))&&l.cancel)return l;if((l=l&&l.cancelDeepRecursion?l:T(v,n,i,r))&&l.cancel)return l;if(h&&(l=h(v,t))&&l.cancel)return l}}function V(t){return t}function G(i){return void 0===i&&(i=0),new Promise(function(t,n){setTimeout(function(){t("timeout")},i)})}function D(t){var n=t.callback,i=t.timeout,i=void 0===i?5e3:i,t=t.retryCount,r=void 0===t?1:t;return Promise.race([n(),G(i)]).then(function(t){if("timeout"!==t)return Promise.resolve(t);if(0<r)return D({callback:n,retryCount:--r});throw"timeout"})}function B(t,n){return P(t.map(function(t){return function(){return new Promise(t)}}),n)}function P(t,i){var r=[];return t.reduce(function(t,n){return t.then(function(t){return r.push(Promise.resolve(t)),i?D({callback:n,timeout:i.timeout,retryCount:i.retryCount}):n()})},Promise.resolve({})).then(function(t){return r.shift(),r.push(Promise.resolve(t)),Promise.all(r)})}function q(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))}function U(t){return!R(t._error||t._code)}function H(t){var n;return R(t)||R(n=t._error||t._code)?t:n}function W(n,t){var i,i,r,e,o;if(R(n)||""===n)return"";if(i=q(t),!t||"General"===t||i)return"boolean"==typeof n||n instanceof Boolean?(n=s?n?s.getBoolean().boolean_true:s.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(r=(i=c.Fe(c.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(r=i.defaultDatePattern),h.Pe(n,r)):(n="number"==typeof n?f.Ge(n.toString()):n).toString();try{return(e=u.Formatter&&u.Formatter.GeneralFormatter)?(o=null,(o="string"==typeof t?new e(t):t).format(n,{})):n.toString()}catch(t){return n.toString()}}function K(t,n){var i,r;if(!R(t)&&!R(n))for(i=n.split(".");0<i.length;)t=t[r=i.shift()];return t}function J(t){var n,i,r,e,o;if(t&&0<t.length){for(n={},i=[],r=0,e=t;r<e.length;r++)n[o=e[r]]||(n[o]=!0,i.push(o));return i}return t}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(a,"__esModule",{value:!0}),a.getUniqueArray=a.q$=a.format=a.formatCalcError=a.isCalcError=a.promiseAllSerial=a.promiseSerialExecute=a.traversalTree=a.bubbleTree=a.swapArrayItems=a.getActualType=a.isRelation=a.isNamedFormulaColumn=a.isFormula=a.isNullOrEmpty=a.isNullOrUndefined=a.isNull=a.isUndefined=a.map=a.pick=a.isString=a.zipObject=a.isNotDeepEqual=a.isEqual=a.clone=a.findIndex=a.indexOf=a.reduce=a.keys=a.forEachRight=a.forEach=a.isBoolean=a.isNumber=a.isFunction=a.isObject=a.isArray=void 0,u=t("Common"),s=t("CalcEngine"),c=u.Common.CultureManager,f=u.Common.st,h=u.Common.ct,a.isArray=u.Common.lt.Nh,a.isObject=n,a.isFunction=i,a.isNumber=r,a.isBoolean=o,a.forEach=l,a.forEachRight=d,a.keys=v,a.reduce=p,a.indexOf=w,a.findIndex=b,a.clone=m,a.isEqual=j,a.isNotDeepEqual=y,a.zipObject=g,a.isString=_,a.pick=O,a.map=S,a.isUndefined=C,a.isNull=F,a.isNullOrUndefined=R,a.isNullOrEmpty=I,a.isFormula=N,a.isNamedFormulaColumn=E,a.isRelation=k,a.getActualType=M,a.swapArrayItems=L,a.bubbleTree=x,a.traversalTree=T,a.promiseSerialExecute=B,a.promiseAllSerial=P,a.isCalcError=U,a.formatCalcError=H,a.format=W,a.q$=K,a.getUniqueArray=J},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var i,r,e,o,u,u,u,u;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",(u=i=n.ViewArea||(n.ViewArea={}))[u.colHeader=1]="colHeader",u[u.viewport=3]="viewport",(u=r=n.StateRuleDirection||(n.StateRuleDirection={}))[u.none=0]="none",u[u.row=1]="row",u[u.column=2]="column",u[u.both=3]="both",(u=e=n.RowColumnStates||(n.RowColumnStates={}))[u.hover=1]="hover",u[u.readonly=4]="readonly",u[u.active=16]="active",u[u.selected=32]="selected",u[u.dirty=64]="dirty",u[u.inserted=128]="inserted",u[u.updated=256]="updated",u[u.pin=1024]="pin",u[u.primaryKey=2048]="primaryKey",u[u.required=4096]="required",(u=o=n.RelationshipMap||(n.RelationshipMap={}))[u.OneToOne=0]="OneToOne",u[u.OneToMany=1]="OneToMany"},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/query.js":function(e,t,n){"use strict";var r,t,ot,A,ut,s,h,i,o,st,c;function f(t){return"string"==typeof t}function k(t,o){var u,n,i,r,e,u=[],n=function(t){var n,i,r,e,i;for(n in t)t.hasOwnProperty(n)&&(e=r=void 0,f(i=t[n])?r=i:(r=i.order,e=i.list),i={field:n,ascending:"DESC"!==r,list:e,_f:n},null!=o&&o(i),u.push(i))};if((0,ot.isArray)(t))for(i=0,r=t;i<r.length;i++)n(e=r[i]);else n(t);return u}function ct(t){return t&&0<t.length&&t.some(function(t){return 0<t.length})}function L(t,n,i){var r,r;return(0,ot.isNullOrEmpty)(t)||-1===t.indexOf(n)?t:(r=(r=(r=t).replace(new RegExp("\\[@\\["+n+"\\]\\]","g"),"[@[".concat(i,"]]"))).replace(new RegExp("\\[@"+n+"\\]","g"),"[@".concat(i,"]"))).replace(new RegExp("\\["+n+"\\]","g"),"[".concat(i,"]"))}function V(t,n,i){var r,e,o,u,s,r,c,f,a,h;if(n&&0<(r=(0,ot.keys)(n)).length)for(e=0,o=r;e<o.length;e++)s=n[u=o[e]],(0,ot.isFormula)(s)&&(t=t.replace(new RegExp("\\[@"+u+"\\]","g"),s.substring(1)));if(i&&0<(r=(0,ot.keys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,ot.isFormula)(h)&&(t=t.replace(new RegExp("\\[@"+a+"\\]","g"),h.substring(1)));return t}function G(t,n,i){var r,e,o,u,s,r,c,f,a,h;if(n&&0<(r=(0,ot.keys)(n)).length)for(e=0,o=r;e<o.length;e++)s=n[u=o[e]],(0,ot.isFormula)(s)&&t===u&&(t=s);if(i&&0<(r=(0,ot.keys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,ot.isFormula)(h)&&t===a&&(t=h);return t}function B(t,n){return t&&t[n]||n}function ft(t){for(var n,i,n=[],i=0;i<t.length;i++)n[t[i]]=i;return n}function at(t,n){for(var i,r,e,o,u,s,c,f,a,h,l,d,i=[t],r=0;r<n;){for(e=0,o=i.length;e<o;e++)if((u=i.shift()).childrenArray&&u.childrenArray[0])for(c=u.childrenArray[s=0];s<c.length;s++)f=c[s],i.push(f);r++}for(a=[],h=0,l=i;h<l.length;h++)a.push((d=l[h]).recordRowNumbers[0]);return{indexMap:a,queue:i}}function m(t,n){return(0,ot.isNullOrUndefined)(t)&&(0,ot.isNullOrUndefined)(n)?0:(0,ot.isNullOrUndefined)(t)?-1:(0,ot.isNullOrUndefined)(n)?1:"number"==typeof t||t instanceof Date?t-n:n<t?1:t<n?-1:0}function j(t,n,i){var r=i[t],i=i[n];return r!==st&&i!==st?r-i:r!==st?-1:i!==st?1:m(t,n)}function u(t,n,i,r){var a,h,l,d,e,o,v,u,s,c,f,p,w,b,a=[],h=[],l=ct(i),d=r&&0<r.length,e=function(t){var n,i,r;return(0,ot.isNullOrUndefined)(t)?function(){return 0}:(n=t.ascending,i=t._f||t.field,(0,ot.isArray)(t.list)&&0<t.list.length?(r=t.list.reduce(function(t,n,i){return t[n]=i,t},{}),n?function(t,n){return j(t[i],n[i],r)}:function(t,n){return j(n[i],t[i],r)}):n?function(t,n){return m(t[i],n[i])}:function(t,n){return m(n[i],t[i])})};for(l?a=i.map(function(t){return t.map(e)}):d&&(h=r.filter(function(t){return!(0,ot.isNullOrUndefined)(t)}).map(e),d=0<h.length),o=[t],v=0;v<n.length;){for(u=0,s=o.length;u<s;u++)if((c=o.shift()).sort(function(t,n){var i,r,e,o,u,s,c,f,i=0;if(l)for(e=0,o=r=a[v];e<o.length&&0===(i=(u=o[e])(t,n));e++);else if(d)for(s=0,c=h;s<c.length;s++)if(0===(i=(f=c[s])(t,n)))return i;return i}),v<n.length-1)for(f=n[v+1].field,p=0,w=c;p<w.length;p++)b=w[p],o.push(b[f]);v++}}function _(t,n,i,r){for(var e,o,u,s,c,f,e,o={},u=0,s=(0,ot.keys)(t);u<s.length;u++)c=s[u],-1!==i.indexOf(c)?(f=r(c))!==c&&(t[f]=t[c],delete t[c]):-1===n.indexOf(c)&&(o[c]=t[c],delete t[c]);return o}function S(t,n,i,r){for(var e,o,e=r;0<=e;e--)if(t[o=i[e].caption||i[e].field]!==n[o])return;return 1}function l(y,g){var t,n,i,r,e,o,u,s,c,f;if(2<=g.length){for(t=function(i){for(var t,n,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,t=i===g.length-1?"$rows":g[i+1].field,n=[],r=g[i-1].caption||g[i-1].field,e=g[i].caption||g[i].field,o=g[i].summaryFields,u=o.map(function(t){return t.caption}),s=o.reduce(function(t,n){return n.FBe&&t.push({caption:n.caption,summaryField:n.BBe}),t},[]),c=o.map(function(t){var n=(0,ut.tse)(i);return t.caption+"_"+t.slice+n}),f=function(t){var n=(0,ut.tse)(i);return n?t.substring(0,t.lastIndexOf(n)):t},a=0,h=y;a<h.length;a++)if(d=(l=h[a])[r],0!==n.length&&S(n[n.length-1],l,g,i-1)){for(_(l,u.concat(e,t),c,f),m=0,j=s;m<j.length;m++)l[(b=j[m]).summaryField]=l[b.caption],delete l[b.caption];n[n.length-1][e].push(l)}else{for(v=_(l,u.concat(e,t),c,f),p=0,w=s;p<w.length;p++)l[(b=w[p]).summaryField]=l[b.caption],delete l[b.caption];v[r]=d,v[e]=[l],n.push(v)}y=n},n=g.length-1;0<n;n--)t(n);for(r=(i=g[0].summaryFields).reduce(function(t,n){return n.FBe&&t.push({caption:n.caption,summaryField:n.BBe}),t},[]),e=0,o=y;e<o.length;e++)for(u=o[e],s=0,c=r;s<c.length;s++)u[(f=c[s]).summaryField]=u[f.caption],delete u[f.caption]}return y}function ht(t,n,i,r,e){var r,o;n=l(n,i),(ct(r)||e&&0<e.length)&&u(n,i,r,e),n&&0<n.length&&(t[o=(r=i[0]).caption||r.field]=n)}function yt(O,t,n,S){var i,i,r,e,o,u,i,s,c,f,a,h,C,l,d,v,p,w,F,b,m,j,y,g,s,R,I,_,N,E,M,x,n,i,s,T,D,P,r={},e=[],i=O.select;if(i&&(s=i.fields,o=i.limit,u=i.skip,s))for(c=0,f=s;c<f.length;c++)a=f[c],(0<=t.indexOf(a)||0<=a.indexOf("."))&&e.push({value:a}),r[a]=!0;if(h=[],C=O.calculate)for(v=l=(d=0,ot.keys)(C);d<v.length;d++)p=v[d],w=C[p],w=S.Pbe(w)?(0,A.parseWindowOverByOption)(w):w,h.push({caption:p,value:w}),r[p]&&(delete r[p],r[w]=!0);if(F=null==(i=n.schema)?void 0:i.dimensions)for(j=b=(m=0,ot.keys)(F);m<j.length;m++)y=j[m],g=F[y],h.push({caption:y,value:g}),r[y]&&(delete r[y],r[g]=!0);if(s=O.groupBy,R=[],s)for(I=null==(i=n.schema)?void 0:i.measures,_=function(u){for(var d,v,p,w,b,m,j,t,n,i,r,e,o,s,c,f,a,h,l,y,g,_,d=[],v=[],p=[],w=void 0,b=void 0,m=[],j={},t,n=function(t){for(var l,n,i,r,e,o,l=u[t],n=[t],i=function(t){var f,t,n,i,r,e,o,u,s,s,s,s,s,c,a,h,s,f=t,t={field:t=G(t,C,F),summaryFields:[],caption:l.caption||f};if(l.summarize&&(t.summaryFields=l.summarize.map(function(t){for(var n,i,r,e,o,u,s,c,n,u=0,s=(0,ot.keys)(t);u<s.length;u++)"having"===(c=s[u])?o=V(t[c],C):"pivot"===c?r=t[c]:(i=V(B(I,t[c]),C,F),j[e=c]=!0);return{formula:i,filter:o,slice:r,caption:e,BBe:e,LBe:l.caption||f}})),n=l.calculate)for(e=i=(r=0,ot.keys)(n);r<e.length;r++)u=n[o=e[r]],u=V(u=S.Pbe(u)?(0,A.parseWindowOverByOption)(u):u,C),m.push({caption:o,value:u});if((s=l.where)?(s=V(s,C),v.push(s)):v.push(st),(s=l.orderBy)?(s=k(s,function(t){for(var n,i,r,e,n=t.field,i=0,r=m;i<r.length;i++)if(n===(e=r[i]).caption&&S.Pbe(e.value)){n=(0,A.parseWindowOverByOption)(e.value);break}t.field=n}),p.push(s)):p.push([]),w=l.includeDetailRows,b=!!O.nest,s=l.attributes)for(c=0,a=s;c<a.length;c++)h=a[c],j[h]=!0;d.push(t),s=l.caption||f,j[s]=!0},r=0,e=n="="!==t[0]&&0<=t.indexOf(",")?t.split(","):n;r<e.length;r++)i(o=e[r])},i=0,r=(0,ot.keys)(u);i<r.length;i++)n(e=r[i]);for(o=0;o<d.length;o++)for(c=0,f=(s=d[o]).summaryFields;c<f.length;c++){for(a=f[c],h=o+1;h<d.length;h++){for(y=0,g=(l=d[h]).summaryFields;y<g.length;y++)if(_=g[y],a.caption===_.caption){a.FBe=!0;break}if(a.FBe)break}a.FBe&&(a.caption="".concat(a.BBe,"__").concat(a.LBe),j[a.caption]=!0,v[o]=L(v[o],a.BBe,a.caption))}v=v.filter(function(t){return!(0,ot.isNullOrEmpty)(t)}),R.push({groupByInfos:d,groupFilterInfos:v,groupSortInfos:p,includeDetailRows:w,includeDetailRowsForNest:b,groupCalculateInfos:m,groupSelectFields:j})},N=0,E=s;N<E.length;N++)_(M=E[N]);if((n=O.where)&&(x=V(n,C,F)),i=[],(s=O.orderBy)&&(i=k(s,function(t){for(var n,i,r,e,n=t.field,i=0,r=h;i<r.length;i++)if(n===(e=r[i]).caption&&S.Pbe(e.value)){n=(0,A.parseWindowOverByOption)(e.value);break}t.field=n})),T={},D=O.window)for(P in D)D.hasOwnProperty(P)&&(T[P]=(0,A.parseWindowOverByOption)(D[P],!0));return{selectFields:r,relatedColumns:e,calculateColumns:h,windows:T,limit:o,skip:u,filterExpression:x,groupInfos:R,sortInfos:i}}function lt(t,n,i,r,e,o,u,s,c,f){var a,h,l,d,v;if(void 0===s&&(s=0),a=[],h=f.length,0<=(u=void 0===u?0:u))for(l=s,d=0===u?h:Math.min(s+u,h);l<d;l++)a.push((0,ut.nse)(t,n,i,r,e,f[l],o,!0,!0,c));else for(l=h-1-s,v=Math.max(0,h+u-s);v<=l;l--)a.push((0,ut.nse)(t,n,i,r,e,f[l],o,!0,!0,c));return a}function dt(t){for(var n,i,n=[],i=0;i<t;i++)n[i]=i;return n}function gt(t){var n,i,r,e,e;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],i=0,r=t;i<r.length;i++)e="="===(e=r[i])[0]?e.slice(1):e,n.push(e);return"=AND("+n.join(",")+")"}function vt(t,n,i){return(0,ot.isNullOrEmpty)(n)?i.slice():"string"==typeof n?a(t,t.Ywt(n,0,0),i):[]}function a(t,n,i,r){for(var e,o,u,s,e=[],o=0,u=r||0;u<i.length;u++)s=i[u],!0===t.nMt(n,s,0)&&(e[o]=s,o++);return e}function pt(i,t,n,r,e,o,u){var s,c,f,a,s=(0,h.ese)(i,t,n,e,r);if(u=u||e.length,0===(o=o||0)&&u>=e.length)e.sort(function(t,n){return s(i,r,t,n)});else for((c=e.slice(o,u)).sort(function(t,n){return s(i,r,t,n)}),f=0,a=c.length;f<a;f++)e[f+o]=c[f]}function d(t,n){var t=new i.FieldManager(st,t);return n=t.prepareFields(n),{fieldMgr:t,columnInfos:n}}function v(r,t,e){var n=r.POt;return new o.GroupManager(t,n.wEt.bind(n),r.QOt,function(t,n,i){pt(r,e,st,n,t,i)},function(t,n,i){return a(r,t,n,i)})}function wt(t,n,i,r){var r,e,r,t,o,i,u,i,r=d(t,r),e=r.fieldMgr,r=r.columnInfos,t=v(t,n,r),o=e.buildGroupFields(n,i),i=t.groupBy(o,i),u=i.rootNode,i=i.indexMap;return e.transposeSliceFields(o),{rootNode:u,newIndexMap:i,fieldMgr:e,groupMgr:t,columnInfos:r=(0,s.ise)(r,e,n)}}function p(t){for(var n,i,r,e,n={},i=0,r=t;i<r.length;i++)n[(e=r[i]).name]=!0;return n}function O(t,n){for(var i,r,e,o,u,i=[],r,e=0,o=(0,ot.keys)(t);e<o.length;e++)"="!==(u=o[e])[0]&&0<=u.indexOf(",")?i.push.apply(i,u.split(",")):i.push(n&&t[u].caption||u);return i}function w(t,n){var i,r,e,o,i=[];if(Array.isArray(t))for(r=0,e=t;r<e.length;r++)o=e[r],i.push.apply(i,o[n]);else i.push.apply(i,t[n]);return i}function C(t,n){var i,r,e;if(!(n.length<=0)){for(i=[],r=t,e=0;e<n.length;e++)r=w(r,n[e]);return i=r}}function b(t,n,i){for(var r,e,o,u,s,c,f,a,r=n(),e=[],o=0;o<t.length;o++)if(0<(s=i(u=t[o])).length)for(c=0;c<s.length;c++)!1!==(a=r[f=s[c]]).nde&&e.push(a.options);return[e,[]]}function y(t){var n,i,n,i;return g(t[0]).windowOverInfos}function g(t){for(var n,i,r,e,o,u,s,s,c,f,f,a,h,l,n={},i=[],o=0;o<t.length;o++)r=(u=t[o]).partitionKey,e=u.orderKey,(0,ot.isNullOrUndefined)(n[u.partitionKey])&&(s={partitions:u.partitions,orderedFunctions:[]},n[u.partitionKey]={index:i.length,orderMap:{},windowOverInfo:s},i.push(s)),c=(s=n[u.partitionKey]).orderMap,(0,ot.isNullOrUndefined)(c[u.orderKey])&&(f={orders:u.orders,functions:[]},c[u.orderKey]={index:s.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:f},s.windowOverInfo.orderedFunctions.push(f)),f=u.frameKey+"__"+u.windowFormula,(0,ot.isNullOrUndefined)(c[u.orderKey].functionMap[f])&&(c[u.orderKey].functionMap[f]=!0,c[u.orderKey].orderFunctions.functions.push({orders:c[u.orderKey].orderFunctions.orders,windowOverFormula:u.windowOverFormula,windowFormula:u.windowFormula,windowFrame:u.windowFrame}));return a=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[e];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<i.length?(l=i[o=(h=n[r]).index],i.splice(o,1),i.push(l),a(h)):1===i.length&&a(n[r]),{windowOverInfoMap:n,windowOverInfos:i}}function F(t,n){for(var i,r,i=0;i<n.length;i++)r=n[i],t.Xhe(r)}function R(t,n,i,r,e,o){for(var u,s,c,f,a,h,u,s=0,c=y(b(t,e,o));s<c.length;s++)I(a=(f=c[s]).partitions,h=f.orderedFunctions,n,i,r)}function bt(t,i,n,r){return F(i,t),R(t,function(t){r=wt(i,t,r,n).newIndexMap},function(t){pt(i,n,st,t,r)},function(t,n){return n(i.XOt[t],r)},function(){return i.XOt},function(t){return i.Gbe(t)}),r}function I(t,n,i,r,e){var o,u,s,c,f;if((0,ot.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,i(t);else for(o=0;o<n.length;o++)for(s=(u=n[o]).orders,(0,ot.isArray)(s)&&0<s.length&&r(s),c=u.functions,f=0;f<c.length;f++)e(c[f].windowOverFormula,function(t,n){return t.evaluateWindowFunction(n)})}function N(t){for(var i,n,r,e,o,u,i=(0,ut.ose)(t),n,r=function(n){n.sourceTable.name===t.name?(0,ut.ose)(n.targetTable).forEach(function(t){var t=n.sourceRelationshipName+"."+t.value;i.push({name:t,value:t})}):n.targetTable.name===t.name&&(0,ut.ose)(n.sourceTable).forEach(function(t){var t=n.targetRelationshipName+"."+t.value;i.push({name:t,value:t})})},e=0,o=t.QOt.relationships;e<o.length;e++)r(u=o[e]);return i}function E(t){for(var n,i,r,e,o,u,n,i={},r=0,e=(0,ot.keys)(t);r<e.length;r++)i[u=0<=(u=o=e[r]).indexOf(".")?o.replace(".","_"):u]=t[o];return i}function M(t){for(var n,i,r,e,o,u,s,c,n=0,i=t.groupBy;n<i.length;n++)for(r=i[n],o=0,u=e=Object.keys(r);o<u.length;o++)0<=(s=u[o]).indexOf(".")&&(r[c=s.replace(".","_")]=r[s],r[c].caption||(r[c].caption=s),delete r[s])}function _t(t,n){var t=t._dataSource.options;n?(t.schema||(t.schema={}),t.schema.window=n):t.schema&&(delete t.schema.window,0===Object.keys(t.schema).length)&&delete t.schema}function mt(t,n){var t=t._dataSource.options,i=n;return t.schema?t.schema.window?(i=r(r({},t.schema.window),n),t.schema.window=i):t.schema.window=n:t.schema={window:n},i}function jt(t,n,i,r,e,o){var r,u,r=r||lt(i,e,st,st,st,st,0,0,!1,o),u=i.name+c+Math.floor(1e3*Math.random());return t.push(u),(i=n.addTable(u,{data:r})).fetchSync(),o=dt(i.length()),{table:i,viewColumnInfos:e=(0,ut.ose)(i),viewIndexMap:o}}function Ot(t,n){for(var i,r,e,i=0,r=n;i<r.length;i++)-1<(e=r[i]).indexOf(c)&&t.removeTable(e)}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t=n("./dist/src/dataManager.js"),ot=n("./dist/src/dataSource/utils.js"),A=n("./dist/src/table/windowOverField.js"),ut=n("./dist/src/view/view.js"),s=n("./dist/src/view/view-group.js"),h=n("./dist/src/view/view-sort.js"),i=n("./dist/src/viewField/fieldManager.js"),o=n("./dist/src/viewField/groupManager.js"),st=void 0,t.DataManager.prototype.query=function(t){var n,t,i,r,e,o,i;return"string"==typeof t?n=this.queries[t]:(n=t).name&&(this.queries[t.name]=t),t=this.Ube(n),n.nest&&(e=p(r=N(i=this.tables[n.from])),o=dt(i.length()),i=lt(i,r,st,st,st,e,0,0,!1,o),this.Hbe(n.groupBy,n.nest,t,i,1)),t},t.DataManager.prototype.Hbe=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,o=1,u="nested_"+e+"_";if(t&&0<t.length&&n)for(s=0,c=t;s<c.length;s++)for(a=O(f=c[s],!1),h=O(f,!0),l=f[a[a.length-1]].includeDetailRows,v=0,p=d=C(i,h);v<p.length;v++)b=(w=p[v]).$rows.map(function(t){return E(r[t])}),m=u+o++,(j=this.addTable(m,{data:b})).fetchSync(),(y=(0,ot.clone)(n)).from=m,M(y),g=this.Ube(y),this.removeTable(m),this.Hbe(y.groupBy,y.nest,g,b,e+1),l||delete w.$rows,Object.assign(w,g)},t.DataManager.prototype.Ube=function(t){var n,i,r,e,o,u,A,t,s,c,f,a,k,L,h,l,d,v,p,V,w,G,B,b,q,t,m,j,c,f,a,t,y,h,U,H,W,g,_,O,K,J,S,C,$,_,F,R,I,Y,N,X,E,I,F,z,M,R,I,x,N,T,D,Q,Z,tt,P,nt,it,rt,et,n=this,i=n.tables[t.from];if(i){if(e=!(r=[]),t.unpivot&&(e=!0,i._dataSource.rse=i._dataSource._data,i.fetchSync(t.unpivot)),o=dt(i.length()),u=(0,ut.ose)(i),s=(t=yt(t,A=n.relationships.filter(function(t){return t.sourceTable.name===i.name}).map(function(t){return t.sourceRelationshipName}),i.options,i)).selectFields,c=t.relatedColumns,f=t.calculateColumns,a=t.windows,k=t.limit,L=t.skip,h=t.filterExpression,l=t.groupInfos,d=t.sortInfos,0<c.length)for(v=0,p=c;v<p.length;v++)V=p[v],u.push(V);if(0<f.length)for(w=0,G=f;w<G.length;w++)B=G[w],u.push(B);if((b=a)&&0<Object.keys(a).length&&(q=(t=i._dataSource.options.schema)&&t.window,b=mt(i,b)),h&&(o=vt(i,h,o)),m=Object.keys(s).filter(function(t){return i.Pbe(t)}),j=function(o,t,u){t.forEach(function(t){var t,n,i,r,e;if(t)for(t=t.field,i=0,r=n=u.Gbe(t);i<r.length;i++)e=r[i],o.push(e)})},d&&0<d.length&&l.length<=0&&j(m,d,i),0<m.length&&(h&&(f=(c=u.reduce(function(t,n){return t[i.Pbe(n.value)?0:1].push(n),t},[[],[]]))[0],a=c[1],mt((t=jt(r,n,i,null,u=a,o)).table,b),i=t.table,o=t.viewIndexMap,u=t.viewColumnInfos.concat(f)),o=bt(m,i,u,o)),d&&0<d.length&&l.length<=0&&pt(i,u,st,d,o),y={},0<(0,ot.keys)(s).length&&(h=lt(i,u,st,st,st,s,k,L,!1,o))&&0<h.length&&(y.$r=h),0<l.length)for(U=ft(o),H=o.slice(0),W=u.slice(0),g=0;g<l.length;g++){if(O=(_=l[g]).groupByInfos,K=_.groupSelectFields,J=_.groupCalculateInfos,S=_.groupFilterInfos,C=_.groupSortInfos,$=_.includeDetailRows,_=_.includeDetailRowsForNest,R=(F=wt(i,O,o,u)).rootNode,I=F.newIndexMap,Y=F.fieldMgr,N=F.groupMgr,o=I,u=X=F.columnInfos,0<(E=void 0,ot.keys)(K).length){if(F=(I=at(R,O.length)).indexMap,z=I.queue,E=lt(i,u,N,Y,O,K,0,0,!0,o=F),$&&y.$r||_)for(M=0;M<E.length;M++)E[M].$rows=z[M].recordRowNumbers.map(function(t){return U[t]});if(R=ct(C)||d&&0<d.length,0<J.length||0<S.length||R){for(x=(I=jt(r,n,i,E)).table,N=I.viewIndexMap,T=I.viewColumnInfos,mt(x,b),m=[],D=0,Q=J;D<Q.length;D++)for(Z=Q[D],T.push(Z),P=0,nt=tt=x.Gbe(Z.value);P<nt.length;P++)it=nt[P],m.push(it);0<S.length&&(N=vt(x,rt=gt(S),N)),ct(C)?j(m,C.reduce(function(t,n){return t.concat(n)},[]),x):d&&0<d.length&&j(m,d,x),N=bt(m,x,T,N),ht(y,et=lt(x,T,st,st,st,st,0,0,!1,N),O,C,d)}else ht(y,E,O)}o=H,u=W}return _t(i,q),e&&(i._dataSource._data=i._dataSource.rse,i.fetchSync(st,!0)),Ot(n,r),y}},c="_VirtualTable_"},"./dist/src/relationship.js":function(t,n,i){"use strict";var r,a,e,o;function u(t,n,i,r,e,o){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=i,this.targetTable=r,this.targetFieldName=e,this.targetRelationshipName=o,i&&(this.sourceField=t.xOt(n,i,r,e,this)),o&&(this.targetField=r.xOt(e,o,t,n,this))}Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,r=i("./dist/src/interfaces/interface.js"),a=i("./dist/src/dataSource/utils.js"),e=void 0,u.prototype.Gf=function(t,n,i,r,e,o){return new u(t||this.sourceTable,n||this.sourceFieldName,i||this.sourceRelationshipName,r||this.targetTable,e||this.targetFieldName,o||this.targetRelationshipName)},u.prototype.NOt=function(t){return t===this.targetRelationshipName},u.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},u.prototype.DOt=function(t){return this.relationshipMap===r.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?r.RelationshipMap.OneToOne:this.relationshipMap},u.prototype._Ot=function(){var t,n,t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?r.RelationshipMap.OneToOne:r.RelationshipMap.OneToMany},u.prototype.ROt=function(t){var n=this.relationshipMap;return(0,a.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,a.isNullOrUndefined)(n)?t:n===r.RelationshipMap.OneToOne?{uit:"object"}:{uit:"array"}},u.prototype.BOt=function(){var i,r,e,t,o,n,u,s,c;function f(t,n,i){t[n]?(t[n].push(i),t.uit="array"):t[n]=[i]}for(i=this.sourceField.LOt={uit:"object"},r=this.targetField.LOt=this.ROt({}),e=this.ROt({uit:"object"}),t=this.sourceTable.getDataSync(),o=this.targetTable.getDataSync(),n=0;n<t.length;n++)u=t[n][this.sourceFieldName],(0,a.isNullOrUndefined)(u)||f(e,u,n);for(s=function(n){var t=o[n][c.targetFieldName];(0,a.isNullOrUndefined)(t)||e[t]&&(r[n]=e[t],e[t].forEach(function(t){f(i,t,n)}))},c=this,n=0;n<o.length;n++)s(n);this.targetField.type=e.uit,this.sourceField.type=i.uit},u.prototype.dl=function(t){this.sourceField.LOt=e,this.targetField.LOt=e,this.targetTable.FOt(t?this.targetTable===t:e),this.sourceTable.FOt(t?this.sourceTable===t:e)},n.Relationship=u},"./dist/src/res.en.js":function(t,n){"use strict";var i,r,n;function e(t,n){return{description:t,parameters:n}}function o(t,n,i,r){return{name:t,optional:n,repeatable:i,enum:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={zve:{WINDOW:e("(TableSheet Specific) Determines the rows as the window by partitioning and ordering to apply the window function.",[o("window_function"),o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),WINDOWDEF:e("(TableSheet Specific) Define a shorthand that allow to be reused by the WINDOW function.",[o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),PARTITIONBY:e("(TableSheet Specific) Divides the rows into partitions.",[o("field_function",!(n=[{value:"0",description:"This is the default case, no rows are excluded."},{value:"1",description:"The current row is excluded, the other peers of the current row remain."},{value:"2",description:"The current row and the peers are all excluded."},{value:"3",description:"The current row remain, the other peers are excluded."}]),!0)]),ORDERBY:e("(TableSheet Specific) Defines the logical order in each partition.",[o("field_function",!(r=[{value:"-1",description:"Indicates the lower following of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@+n]",description:"Indicates the n following of the current, if the order is ascending."},{value:"[@-n]",description:"Indicates the n following of the current, if the order is descending."}]),!0)]),ORDERASC:e("(TableSheet Specific) Specifies ascending order for the specified field.",[o("field_function")]),ORDERDESC:e("(TableSheet Specific) Specifies descending order for the specified field.",[o("field_function")]),FRAMEROWS:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending rows against the current row.",[o("beginning_function",!(i=[{value:"-1",description:"Indicates the upper boundary of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@-n]",description:"Indicates the n preceding of the current, if the order is ascending."},{value:"[@+n]",description:"Indicates the n preceding of the current, if the order is descending."}]),!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),FRAMERANGE:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the value in the current row.",[o("beginning_function",!1,!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),FRAMEGROUPS:e('(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the counting "groups" relative to the current group.',[o("beginning_function",!1,!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),CUMEDIST:e("(TableSheet Specific) The cumulative distribution of a value within a group of values.",[]),W_PERCENTRANK:e("(TableSheet Specific) Calculates the percentage of the relative rank of a row within a partition of rows.",[]),ROWNUMBER:e("(TableSheet Specific) Returns the number of the current row within its partition.",[]),W_RANK:e("(TableSheet Specific) Returns the rank of each row within the partition of a result set.",[]),DENSERANK:e("(TableSheet Specific) Returns the rank of the current row within its partition, without gaps.",[]),LEAD:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that follows the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),LAG:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that before the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),NTILE:e("(TableSheet Specific) Divides a partition into N buckets, assigns each row its bucket number.",[o("n")]),FIRSTVALUE:e("(TableSheet Specific) Access to the value from the first row within the window frame.",[o("value_function")]),LASTVALUE:e("(TableSheet Specific) Access to the value from the last row within the window frame.",[o("value_function")]),NTHVALUE:e("(TableSheet Specific) Access to the value from the n-th row within the window frame.",[o("value_function"),o("n")]),CALCULATE:e("(TableSheet Grouping Specific) Expand the group context for the formula.",[o("formula"),o("remove_filters_function")]),REMOVEFILTERS:e("(TableSheet Grouping Specific) Select the context of the upper group level.",[o("group_field_function",!0,!0)]),CHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be a certain offset from the parent.",[o("level_offset"),o("field_function")]),ONLYCHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be not parent.",[o("field_function")]),PARENT:e("(TableSheet Hierarchy Specific) Retrieves the value of the parent that be a certain offset from the current.",[o("level_offset"),o("field_function")]),LEVEL:e("(TableSheet Hierarchy Specific) Retrieves the level of the current.",[]),LEVELROWNUMBER:e("(TableSheet Hierarchy Specific) Retrieves the row number of the current under its parent.",[])}}},"./dist/src/table/calcField.js":function(t,n,i){"use strict";var r,e,l,d,o,u,s;function c(t,n,i,r){var e,n,o,e=s.call(this)||this;if(e.eCe=0,e.calcSource=n.POt,e.calcService=e.calcSource.getCalcService(),e.GOt=t,(n=e.calcSource).Vbe=n.Vbe||[],n.Vbe.indexOf(t)<0){n.Vbe.push(t);try{o=e.expression=i||e.calcService.parse(e.calcSource,t,0,0),e.calcService&&o&&(e.w3=e.calcService.getGlobalSourceModel(),e.w3.cyt(e,0,0,o,o,!0))}catch(t){}n.Vbe.pop()}return e.Tl=[],e.zbe=(0,l.isNullOrUndefined)(r)?0:r,e}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,e=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),d=void 0,s=e.BaseCalc,r(c,s),c.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},c.prototype.vyt=function(){this.c_t().I3(this,3)},c.prototype.c_t=function(){return this.calcService},c.prototype.P6t=function(){this.C8()},c.prototype.C8=function(){this.Tl=[],this._me=d,this.eCe=0},c.prototype.getValue=function(t){var n,i,r;if(!this.expression)return"Invalid Formula";for((n=this.calcService).Ybe=n.Ybe||[],n.Zbe=n.Zbe||[],i=0;i<n.Ybe.length;i++)if(n.Ybe[i]===this&&n.Zbe[i]===t)return n.Wbe=!0,this.zbe;if(0!==n.Ybe.length||(r=this.Tl[t],(0,l.isUndefined)(r)&&!(0,l.isUndefined)(t))){this.calcSource.pe(t),n.Ybe.push(this),n.Zbe.push(t);try{r=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0},1<n.Ybe.length)}catch(t){}n.Wbe?r=e.Errors.Calc:1===n.Ybe.length&&(this.Tl[t]=r),n.Ybe.pop(),n.Zbe.pop(),0===n.Ybe.length&&delete n.Wbe}return r},c.prototype.getValues=function(t,n,i,r,e,o){var u,s,c,f,a,h;if(n=(0,l.isNumber)(n)?n:0,i=(0,l.isNumber)(i)?i:t.length-1,u=[],this._me!==t||this.eCe!==t.length)for(s=t.length,this._me=t,this.eCe=s,c=0;c<s;c++)u.push(this.getValue(t[c]));if(0===u.length)if(r!==d&&e!==d){for(f=n;f<r;f++)u.push(this.Tl[t[f]]);for(o!==d&&u.push(this.Tl[t[o]]),f=e+1,a=i+1;f<a;f++)u.push(this.Tl[t[f]])}else for(f=n,h=i+1;f<h;f++)u.push(this.Tl[t[f]]);else u=u.slice(n,i+1),r!==d&&e!==d&&(o!==d?u.splice(r-n,e-r+1,u[o-n]):u.splice(r-n,e-r+1));return u},c.prototype.getValueWithContext=function(t){var n,t,n=this.calcSource.DJ,t=this.getValue(t);return this.calcSource.DJ=n,t},c.prototype.insertItem=function(t,n){},c.prototype.getOriginalValue=function(t){},c.prototype.getRelatedTable=function(){},c.prototype.getRelationMaps=function(){},c.prototype.getHostTableIndexes=function(t){},n.CalcField=c},"./dist/src/table/hierarchyField.js":function(t,n,i){"use strict";var r,e,o,u;function s(t,n){this.GOt=t,this.nM=n,this.UOt=new e.CalcField(this.l7t(),n),this.HOt=new o.TableField(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/calcField.js"),o=i("./dist/src/table/tableField.js"),s.prototype.getKey=function(){return this.UOt.getKey()},s.prototype.vyt=function(){this.UOt.vyt()},s.prototype.c_t=function(){return this.UOt.c_t()},s.prototype.P6t=function(){this.C8()},s.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},s.prototype.C8=function(){var t=this.l7t();(0,r.isNullOrEmpty)(t)?this.UOt=null:(0,r.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new e.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new o.TableField(this.GOt,this.nM)},s.prototype.zOt=function(t){var n,n,n=this.nM;if(n.isHierarchy())return n=n.SEt(t),!(0,r.isNullOrUndefined)(n)&&0<n.children.length},s.prototype.getValue=function(t){return(!(0,r.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt:this.HOt).getValue(t)},s.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},s.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},s.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},s.prototype.hasItem=function(t){this.HOt.hasItem(t)},s.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},s.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},s.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},s.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},s.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.HierarchyField=s},"./dist/src/table/table.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/table/tableEvents.js"),n),e(i("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,i){"use strict";var r,l,s,e,h,b,u,o,c,d,v,p,f,j,a,w,m,i,y,g,_;function O(t,n,i){var r={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,onSucceeded:t,onFailed:n,onEnd:i,invoke:function t(){0===r.asyncCount&&r.syncDone&&(r.failedArgs?r.onFailed&&r.onFailed(r.failedArgs):r.onSucceeded&&r.onSucceeded(r.succeededArgs),r.onEnd)&&r.onEnd(r.succeededArgs||r.failedArgs)},execute:function t(n){n&&(r.onEnd=n),r.syncDone=!0,r.invoke()},suspend:function t(){return r.asyncCount++,{succeed:function t(n){r.succeededArgs=n,r.resume()},fail:function t(n){r.failedArgs=n,r.resume()}}},resume:function t(){r.asyncCount--,r.invoke()}};return r}function S(t,n){var i,r,e,o;for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i],n)if(n.hasOwnProperty(e)&&r===(o=n[e])&&0<r.rb)return!0}function C(t,n){return S(n.views,t.VOt)}function F(t,n){return-1<t.indexOf("[".concat(n,"]"))||-1<t.indexOf("[@".concat(n))||-1<t.indexOf("[@[".concat(n))}function R(t,n,i,r){var e,o,u,s,i,c,f,a,h;if(0!==n){for(u=i&&i.dataType,s=i&&i.dataMap,c=!!(u=(i="formula"===u&&!(0,b.isNullOrEmpty)(i.value))?m:u),f=t&&"="===t[0]||i?function(t){return(0,b.formatCalcError)(r(t))}:r,a=0;a<n;a++)h=f(a),s&&!(0,b.isNullOrUndefined)(s[h])&&(h=s[h]),c||(0,b.isNullOrUndefined)(h)||(o=h,c=!0),(e=e||{})[h=h instanceof Date?new Date(h.getFullYear(),h.getMonth(),h.getDate()).toISOString():h]||(e[h]=[]),e[h]&&e[h].push(a);return e.K$=u||(c?typeof o:"object"),e}}function I(t,n,i,r){var e,o,u,u,s;for(e in t)t.hasOwnProperty(e)&&(o=t[e],u=(u=r&&r[e])&&u.dataMap,o)&&(s=i[e],o[s=(s=u&&!(0,b.isNullOrUndefined)(u[s])?u[s]:s)instanceof Date?s.toISOString():s]?o[s].push(n):o[s]=[n])}function N(t,n,i,r,e,o){var t,i,o,t=t[i],i=o&&o.dataMap;t&&e!==r&&(i&&((0,b.isNullOrUndefined)(i[r])||(r=i[r]),(0,b.isNullOrUndefined)(i[e])||(e=i[e])),r instanceof Date&&(r=r.toISOString()),e instanceof Date&&(e=e.toISOString()),o=t[r])&&(1<o.length?o.splice(o.indexOf(n),1):delete t[r],t[e]?t[e].push(n):t[e]=[n])}function E(t,n,i){var r,e,o,u,s;for(r in t)if(t.hasOwnProperty(r)&&(e=t[r]))for(o in e)if(e.hasOwnProperty(o)&&(0,b.isArray)(e[o])&&(u=e[o],(0,b.isArray)(u))){for(s=0;s<u.length;s++)u[s]>=n+i?u[s]-=i:u[s]>=n&&u[s]<n+i&&(u.splice(s,1),s--);0===u.length&&delete e[o]}}function M(t,n){var t;this.Qbe=void 0,this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,i,r,e,i,n=this.Zc;if(this.Zc=t,i=this.QOt){for(r in this.VOt)this.VOt.hasOwnProperty(r)&&(e=this.VOt[r]).KOt(n,t);delete(i=i.tables)[n],i[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){var n,n,i,n,r,e,i=this;i.JOt=!0,i.vKe=!0,n=i.options,r=i.length(),e=i._dataSource.setDataSourceOptions(t,function(t){var t=t&&t.isDataSourceChanged;i.ase(r,t?m:i.columns,t)}),i.pCe((null==(n=n.schema)?void 0:n.window)||{},(null==(n=t.schema)?void 0:n.window)||{}),!i.Qbe&&e&&e.finally?i.Qbe=e.finally(function(){i.Qbe=void 0,i.vKe=!1}):i.vKe=!1}}),this.name=t,t=n instanceof s.DataSource?n:new s.DataSource(n),this._dataSource=t,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=w,this.JOt=!0,this.aT={}}function x(t){var n,t,i,r,n={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},t=t.remote;return t&&(i=n.remote={},(r=t.read)&&!(0,b.isFunction)(r)&&(i.read=r),(r=t.create)&&!(0,b.isFunction)(r)&&(i.create=r),(r=t.update)&&!(0,b.isFunction)(r)&&(i.update=r),(r=t.delete)&&!(0,b.isFunction)(r)&&(i.delete=r),(r=t.getColumns)&&!(0,b.isFunction)(r)&&(i.getColumns=r),(r=t.addColumn)&&!(0,b.isFunction)(r)&&(i.addColumn=r),(r=t.updateColumn)&&!(0,b.isFunction)(r)&&(i.updateColumn=r),(r=t.removeColumn)&&!(0,b.isFunction)(r)&&(i.removeColumn=r),r=t.batch)&&!(0,b.isFunction)(r)&&(i.batch=r),n}function T(){return null!==_&&_.apply(this,arguments)||this}r=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=n.isInCalcField=void 0,s=i("./dist/src/dataSource/dataSource.js"),e=i("./dist/src/calculation/calcSource.js"),h=i("CalcEngine"),b=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/dataSource/dataSource.interface.js"),o=i("./dist/src/view/view.js"),c=i("./dist/src/interfaces/interface.js"),d=i("./dist/src/table/tableEvents.js"),v=i("./dist/src/table/calcField.js"),p=i("./dist/src/table/tableField.js"),f=i("./dist/src/table/hierarchyField.js"),j=i("./dist/src/table/windowOverField.js"),a=i("./dist/src/table/triggerCalcField.js"),w=null,m=void 0,n.isInCalcField=F,n.generateFilterIndexCache=R,n.updateFilterIndexesCacheOnInsert=I,n.updateFilterIndexesCacheOnUpdate=N,n.updateFilterIndexesCacheOnRemove=E,M.prototype._Et=function(t,n,i){var r,e,n;"="===(n=!(0,b.isNullOrUndefined)(n)&&""!==n?n:"*")[0]?(r=this.bEt(n)).Iwt(0,t,i):(e=(e=this.aT[n])||(this.aT[n]={}),n=t.getKey(),i?e[n]=t:delete e[n])},M.prototype.o_t=function(t,n){var i,r,i=function(t,n){for(var i in t)n&&i.startsWith("T:")||t[i].vyt()};if((0,b.isNullOrUndefined)(t))for(r in this.aT)this.aT[r]&&i(this.aT[r],n);else-1<t.indexOf(".")&&(t=t.split(".")[0]),i(this.aT[t]),i(this.aT["*"])},M.prototype.REt=function(t){var n,i;if(t)this.QOt=t,this.POt=new e.DataManagerCalcSource(t.Lp,this);else{for(n in this.POt=w,this.views)this.views.hasOwnProperty(n)&&this.removeView(n);for(n in this.VOt)this.VOt.hasOwnProperty(n)&&((i=this.VOt[n]).$Ot(this),delete this.VOt[n]);this.QOt=t}},M.prototype.Ywt=function(t,n,i){var r=this.POt;return r.getCalcService().parse(r,t,n||0,i||0)},M.prototype.wde=function(t){var n=this.POt;return n.getCalcService().unparse(n,t,0,0)},M.prototype.nMt=function(t,n,i){var r=this.POt;return(0,b.isNumber)(n)&&r.pe(n),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:i||0})},M.prototype._fe=function(t,n,i){var r=this.POt;return r.pe(n,m,m,i),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:0})},M.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},M.prototype.NEt=function(t,n){var i,r,e,o,u,s,i=this;if(t){if(0<=t.indexOf(i))return w}else{if(i.tRt)return i.tRt;r=!0,t=[],n=[]}for(t.push(i),n.push(new Promise(function(t){if(i.JOt)return i.fetch().finally(t);t(null)})),e=i.Pq,o=0;o<e.length;o++)(s=(u=e[o]).targetTable)&&s.NEt(t,n);if(r)return i.tRt=Promise.all(n),i.tRt},M.prototype.fetch=function(n,i){var r,e,o,r=this;return!0===n&&!r.vKe||void 0===r.Qbe?(r.BEt&&(e=r.columns),o=r.length(),r.Qbe=r._dataSource.load({reload:n}),r.Qbe.then(function(t){return i&&!n&&r.isFetched()||r.ase(o,e,n),Promise.resolve(t)}).finally(function(){r.Qbe=void 0})):r.Qbe},M.prototype.isFetched=function(){return!this.JOt},M.prototype.cPt=function(t){var n,i,r,e,o,u,s,c,n=this,i={};if(t&&(r=n.columns))for(u=e=(o=0,b.keys)(r);o<u.length;o++)(c=r[s=u[o]]).value&&"="===c.value[0]&&(i[s]=c),"workTime"===c.value&&(i[s]=c),"TaskResources"===c.dataType&&(i[s]=c);return i},M.prototype.Kbe=function(i){var r,t,n,e,o,t,u,s,r=this,t=r._dataSource.options.schema,n=r.get(0),e=t&&t.columns;if(e)for(o in(0,b.isNullOrUndefined)(n)&&(n={}),e)n.hasOwnProperty(o)||e[o].spread||(n[o]=e[o]);n&&(t=(0,b.keys)(n),u=r.columns=r.cPt(!0),s=r.Pq=r.Pq.filter(function(t){return t.sourceField||t.targetField}),t.forEach(function(t){var n=i&&i[t];u[t]=r.nRt(t,n,e&&e[t]),s.push({name:t})}))},M.prototype.ase=function(t,n,i){var r,e,o,u,s,c,f,r=this,e=r._dataSource.options.schema;if((r.JOt||i)&&(r.Kbe(n),r.JOt=!1),i&&r.ARt(),e&&e.columns){for(s in u=[],o=e.columns)o[s]&&o[s].indexed&&u.push(s);r.eRt(u)}if(i&&r.clearIndexes(),r.createIndexes(r.qOt||[]),r.BEt=!1,r.dl(),i)for(f in r._dataSource.pOt(),c=r.views)c.hasOwnProperty(f)&&c[f].iM(t!==r.length(),!0);r.Jbe=m},M.prototype.fetchSync=function(t,n,i){var r,e,n,o,t,r=this,e=r.length(),n=r._dataSource.loadSync(t,n),o=m,t=(0,b.isNullOrUndefined)(t);return i&&(o=r.columns,t)&&r.Kbe(o),r.ase(e,o,!t),n},M.prototype.nRt=function(t,n,i){var o,r,e,u,s,s,o=this,r={jOt:!1};if((0,b.isNullOrUndefined)(n))i&&(i.dataType&&(e=i.dataType),i.isPrimaryKey)&&(r.jOt=i.isPrimaryKey);else{for(u in n)n.hasOwnProperty(u)&&!(0,b.isNullOrUndefined)(n[u])&&(r[u]=n[u]);e=n.W5||n.dataType||i&&i.dataType,(s=n.jOt||n.isPrimaryKey||i&&i.isPrimaryKey)&&(r.jOt=s)}return this.qOt&&0<this.qOt.length&&-1<this.qOt.indexOf(t)&&(r.jOt=!0),r.value=t,r.name=t,i&&!(0,b.isNullOrUndefined)(i.caption)&&(r.caption=i.caption),(i&&"formula"===i.dataType||"formula"===r.dataType)&&(s=(null==i?void 0:i.value)||n.value,r.value="="===s[0]?s:"="+s,r.readonly=!0,r.caption=t),Object.defineProperty(r,"dataType",{get:function(){return e},set:function(t){var t;e!==t&&("rowOrder"!==e&&"rowOrder"!==t||!o.isHierarchy()||o.setHierarchyOptionChanged(),"formula"!==(e=t)&&o._dataSource.xjt(this.name,this.dataType,this.dataPattern),t=this.value,o.dl(t),o.rRt(t))}}),Object.defineProperty(r,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,o.qOt||(o.qOt=[]),o.qOt.slice().sort().join(",")!==o.Ljt(!0).slice().sort().join(","))&&o.createIndexes(o.qOt)}}),Object.defineProperty(r,"mappedName",{get:function(){return this.value},set:function(n){var i;this.value===n||(0,b.isNullOrEmpty)(n)||(i=this.value,o._dataSource.Njt(i,n),o.dl(i),o.rRt(n),o.oRt(i,n),o.aRt(i,n),o.Pq.forEach(function(t){t.name===i&&(t.name=n)}),o.qOt=(o.qOt||[]).map(function(t){return t===i?n:t}),o.columns[n]=o.columns[i],delete o.columns[i],this.name=this.value=n)}}),Object.defineProperty(r,"relationship",{get:function(){for(var t,n,i,r,t,n=0,i=o.QOt.relationships;n<i.length;n++){if((r=i[n]).sourceTable===o&&r.sourceFieldName===this.value)return{table:r.targetTable,field:r.targetFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName};if(r.targetTable===o&&r.targetFieldName===this.value)return{table:r.sourceTable,field:r.sourceFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName}}},set:function(t){for(var n,i,r,e,n,i=0,r=o.QOt.relationships;i<r.length;i++)if((e=r[i]).sourceRelationshipName===t.sourceName){o.QOt.removeRelationship(e.sourceRelationshipName);break}t.table&&t.field&&o.QOt.addRelationship(o,this.value,t.sourceName,t.table,t.field,t.targetName)}}),r},M.prototype.isDataColumn=function(t){var n=(0,b.isString)(t)?t:t.value;return!((0,b.isFormula)(n)||(0,b.isNamedFormulaColumn)(t)||(0,b.isRelation)(n)||(0,b.isFunction)(n))&&this._dataSource.iCe(n)},M.prototype.canAddedColumn=function(t){return(0,b.isNamedFormulaColumn)(t)&&(0,b.isNullOrUndefined)(this.columns[t.name])||this.isDataColumn(t)},M.prototype.hasExistedColumn=function(t){var t=(0,b.isString)(t)?t:t.name;return!(0,b.isNullOrUndefined)(this.columns[t])},M.prototype.PBe=function(t){(0,b.isNamedFormulaColumn)(t)||(t.name=t.value)},M.prototype.uBe=function(t){this._dataSource.uBe(t);var n=t.name;this.GBe(n),delete this.columns[n],this.Pq.splice(this.Pq.findIndex(function(t){return t.name===n}),1)},M.prototype.addColumn=function(t,n,i){var r,e,r=this;this.PBe(t),this.hasExistedColumn(t)||!this.canAddedColumn(t)?i({type:s.ADD_COLUMN,success:!1}):(this.UBe(t),e=this.HBe(t),this._dataSource.cBe(t,e,function(t){r.dl(),r.Jhe(),n&&n(t)},i))},M.prototype.UBe=function(t,n){var i=t.name,r={name:i};this.columns[i]=this.nRt(i,t),this.rRt(i),(0,b.isNumber)(n)?this.Pq.splice(n,0,r):this.Pq.push(r)},M.prototype.HBe=function(t){var n,i,r,e;if(t&&!(0,b.isUndefined)(t.defaultValue)&&this.isDataColumn(t)){if(n=this.length(),i=[],"object"!=typeof t.defaultValue||t.defaultValue instanceof Date)if((0,b.isFormula)(t.defaultValue))try{for(e=this.Ywt(t.defaultValue),r=0;r<n;r++)i.push(this.nMt(e,r))}catch(t){}else for(r=0;r<n;r++)i.push(t.defaultValue);else if((0,b.isArray)(t.defaultValue))for(r=0;r<n;r++)i.push(t.defaultValue.slice());else for(r=0;r<n;r++)i.push(l({},t.defaultValue));return i}},M.prototype.vBe=function(t){this._dataSource.vBe(t);var n=t.table,t=t.name;n&&(n.column&&(this.columns[t]=n.column),n.field&&this.Pq.splice(n.fieldIndex,0,n.field),this.dl(),this.Jhe())},M.prototype.removeColumn=function(t,n,i){var r,e,r=this;!this.hasExistedColumn(t)||this.ABe(t)||this.xBe(t)?i({type:s.REMOVE_COLUMN,success:!1}):(this.VBe(t,e={}),this._dataSource.gBe(t,function(t){t.table=e,r.dl(),r.Jhe(),n&&n(t)},i))},M.prototype.VBe=function(t,n){var i,r,e,i=!!n;for((n=n||{}).column=this.columns[t],n.name=t,delete this.columns[t],i||(this.dl(),this.Jhe()),this.XOt[t]=m,r=0;r<this.Pq.length;r++)if((e=this.Pq[r]).name===t){this.Pq.splice(r,1),n.field=e,n.fieldIndex=r;break}return r},M.prototype.GBe=function(t){this.dl(t,!0),this.Jhe(),this.ARt(t),this.zBe(t)},M.prototype.bBe=function(t){var n,i,r;if(this._dataSource.bBe(t),n=t.table){if(this.GBe(n.newName),(0,b.isNullOrUndefined)(n.primaryKey)||(this.qOt=""===n.primaryKey?[]:n.primaryKey.split(",")),n.column&&(delete this.columns[n.newName],this.columns[n.name]=n.column),n.field)for(i=0;i<this.Pq.length;i++)(r=this.Pq[i]).name===n.newName&&(r.name=n.name);this.dl(),this.Jhe()}},M.prototype.updateColumn=function(t,n,i,r){var e,o,e=this;!this.hasExistedColumn(t)||this.ABe(t)||this.xBe(t)?r({type:s.UPDATE_COLUMN,success:!1}):((0,b.isNullOrUndefined)(n.value)&&(n.value=t),o={},this.PBe(n),this.YBe(t,n,o),this._dataSource.yBe(t,n,function(t){t.table=o,e.dl(),e.Jhe(),i&&i(t)},r))},M.prototype.YBe=function(n,t,i){var r,e,o,u,s,e,c,f,a,h,r=(0,b.isNamedFormulaColumn)(t),e=this.columns[n].dataType,o=t.dataType,u=!1;for(((u=e===o||(0,b.isNullOrEmpty)(o)||(0,b.isNullOrEmpty)(e)&&(s=this._dataSource.RBe(n))===o?u:!0)||r&&this.columns[n].value!==t.value)&&this.GBe(n),e=this.columns[n],c=t.name,(i=i||{}).column=e,i.name=n,i.newName=c,delete this.columns[n],f=0;f<this.Pq.length;f++)(a=this.Pq[f]).name===n&&(a.name=c);h=t.type!==e.type?l({},t):l(l({},e),t),Object.keys(h).forEach(function(t){"_"===t[0]&&delete h[t]}),this.columns[c]=this.nRt(c,h),e.isPrimaryKey!==t.isPrimaryKey&&(i.primaryKey=this.primaryKey(),t.isPrimaryKey?this.qOt=(this.qOt||[]).concat(c):this.qOt=i.primaryKey.split(",").filter(function(t){return t!==n}))},M.prototype.TBe=function(t){return this.VBe(t.column.name)},M.prototype.IBe=function(t,n){this.UBe(t.originalColumn,n)},M.prototype.kBe=function(t){var n;this.YBe(t.column.name,t.originalColumn)},M.prototype.xBe=function(t){return this._dataSource.xBe(t)},M.prototype.length=function(){return this._dataSource.length()},M.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},M.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},M.prototype.isUpdated=function(t,n){return this._dataSource.isUpdated(t)||(n?this.uRt(t):m)},M.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},M.prototype.uRt=function(t){var n,i,r,e,o,e,u,s,c,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)if(o=(e=i[r]).targetTable,e=e.LOt,o&&C(o,n)&&e&&e[t]&&!o.WOt)for(u=0,s=e[t];u<s.length;u++)if(c=s[u],o.isUpdated(c))return n.WOt--,!0;n.WOt--},M.prototype.Xbe=function(){this.Pq.reduce(function(t,n){var n=n.CRt;return n&&t.push(n),t},[]).forEach(function(t){t.VP()})},M.prototype.qbe=function(t){for(var n,i,r,n=t.ltt(),i=0;i<n.length;i++)(r=n[i].CRt)&&(r.sourceTable===t?r.Gf(this):r.Gf(m,m,m,this))},M.prototype.kbe=function(){return this._dataSource.kbe()},M.prototype.$be=function(){var t,n,i,r,e,o,u,s,c,t=this.Jbe;if((0,b.isNullOrUndefined)(t)){for(n=this.name+"__TriggerFormula__"+Math.floor(1e3*Math.random()),(t=this.Jbe=new y(n,{data:[]})).REt(this.QOt),t.fetchSync(),t._dataSource.Lbe(this._dataSource.DEt),i=this._dataSource.jbe(),e=0,o=r=this._dataSource.DEt;e<o.length;e++)u=o[e],t.twe(u,i[u]);for(u in this.columns)this.columns.hasOwnProperty(u)&&(s=this.columns[u].value,(0,b.isFormula)(s))&&t.nwe(u,s);for(u in c=this._dataSource.Obe())c.hasOwnProperty(u)&&t.nwe(u,c[u]);t.dl()}return t},M.prototype.ewe=function(t,n,i){var r,e;if(!(0,b.isNullOrUndefined)(t)&&0<Object.keys(t).length){for(e in r=this.$be(),i?(r._dataSource.insertItem(0,i),r._dataSource.updateItem(0,n)):r._dataSource.insertItem(0,n),r.qbe(this),t)t.hasOwnProperty(e)&&(n[e]=r._getValueByField(e,0));r._dataSource.remove(0,1),r.dl(),r.Xbe()}},M.prototype.iwe=function(t){this.ewe(this._dataSource.jbe(),t)},M.prototype.rwe=function(t,n){var n,r,e,i,o,n=this.vRt(n),r=this._dataSource.jbe(u.TriggerWhenType.onNewAndUpdate),e=Object.keys(t),i=function(t){var i;r.hasOwnProperty(t)&&-1===(i=(0,a.getWatchedFields)(r[t])).indexOf("*")&&!e.some(function(n){return i.some(function(t){return t===n})})&&delete r[t]};for(o in r)i(o);this.ewe(r,t,n)},M.prototype.insertItem=function(n,i,r,t){var e,o,u,e=this;for(o in this.iwe(i),i)i.hasOwnProperty(o)&&this.o_t(o);this.ki(d.Events.ItemInserting,u={index:n,data:i}),this._dataSource.insertItem(n,i,function(t){e.sRt(n,i),e.cRt(n,i),e.dl(),e.Jhe(),e.ki(d.Events.ItemInserted,u),r&&r(t)},t)},M.prototype.recoverItemAtBatch=function(n,i,r,t){var e,o,u,e=this;for(o in this.iwe(i),i)i.hasOwnProperty(o)&&this.o_t(o);this.ki(d.Events.ItemInserting,u={index:n,data:i}),this._dataSource.recoverItemAtBatch(n,i,function(t){e.sRt(n,i),e.cRt(n,i),e.dl(),e.Jhe(),e.ki(d.Events.ItemInserted,u),r&&r(t)},t)},M.prototype.updateItem=function(t,n,i,r){var e,o,u,s,c,f,a,h;for(c in this.rwe(n,t),e=[],o={},u={},s=[],n)n.hasOwnProperty(c)&&(f=n[c],a=this._getValueByField(c,t),(0,b.isNotDeepEqual)(f,a))&&(e=e.concat(this.sge(t,c)),u[c]=a,o[c]=f,s.push(c),this.o_t(c));this.ki(d.Events.ItemUpdating,h={index:t,data:o,originalData:u,changingFields:s}),this._dataSource.updateItemValues(t,o,this.owe(t,o,u,h,e,i),r)},M.prototype.owe=function(e,o,u,s,c,f){var a=this;return function(t){var n,i,r;for(n in o)o.hasOwnProperty(n)&&(i=u[n],r=o[n],a.lRt(e,i,r),a.hRt(e,n,i,r));a.dl(),a.Jhe(),a.uge(e,c),a.ki(d.Events.ItemUpdated,s),f&&f(t)}},M.prototype.fRt=function(n,i,r,e,o,u,s){var c=this;return function(t){c.lRt(n,i,r),c.hRt(n,e,i,r),c.dl(),c.Jhe(),c.uge(n,u),c.ki(d.Events.ItemUpdated,o),s&&s(t)}},M.prototype.dRt=function(t,n,i,r,e,o){var u,s,c,u=this.sge(t,i),s=n[i],c={index:t,data:n,field:i,originalValue:r,newValue:s};this.ki(d.Events.ItemUpdating,c),this._dataSource.updateItem(t,n,this.fRt(t,r,s,i,c,u,e),o)},M.prototype.updateItemValue=function(t,n,i,r,e){var o,u,s,c,c,u=this.sge(t,n),s=this._getValueByField(n,t),c=this.vRt(t);c[n]=i,this.ki(d.Events.ItemUpdating,c={index:t,data:c,field:n,originalValue:s,newValue:i}),this._dataSource.updateItemValues(t,((o={})[n]=i,o),this.fRt(t,s,i,n,c,u,r),e)},M.prototype.resetItem=function(n,t,i){var r,t,i,e,i,o,u,s,r=this,t=O(t,i);this.mRt(n,t.suspend),this._dataSource.isUpdated(n)&&(this.o_t(m,!0),i=t.suspend(),e=i.succeed,i=i.fail,o=this.vRt(n),u=this.gRt(n),s=this.sge(n),this.ki(d.Events.ItemResetting,{index:n}),this._dataSource.resetItem(n,function(t){r.pRt(n,o,u),r.dl(),r.Jhe(),r.uge(n,s),r.ki(d.Events.ItemReset,{index:n,originalData:o,dataBeforeChanged:u}),e(t)},i)),t.execute()},M.prototype.pRt=function(t,n,i){var r,e,o,u,u,r=this,e=r.columns;if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(i))for(o in e)e.hasOwnProperty(o)&&(u=(u=e[o]).value instanceof Function?u.value.name:u.value,r.hRt(t,u,n[u],i[u]))},M.prototype.mRt=function(c,f){var a,h,t,n,a=this,h=a.Pq;for(a.WOt++,t=function(t){var t,r,t,n,i,e,o,u,s,u,t=h[t],r=t.targetTable,t=t.LOt;if(r&&C(r,a)&&t&&t[c]&&!r.WOt){for(n=[],i=0,e=t[c];i<e.length;i++)o=e[i],r.isInserted(o)?n.push(o):r.isUpdated(o)&&(s=(u=f()).succeed,u=u.fail,r.resetItem(o,s,u));0<n.length&&(n.sort(function(t,n){return n-t}),n.forEach(function(t){var n=f(),i=n.succeed,n=n.fail;r.qCt(t,1,i,n)}))}},n=0;n<h.length;n++)t(n);a.WOt--},M.prototype.saveItem=function(n,t,i){var r,t,i,e,i,e,o,i,r=this,t=O(t,i),i=t.suspend(),e=i.succeed,i=i.fail;this.bRt(n,e,i),(this._dataSource.isUpdated(n)||this._dataSource.isInserted(n))&&(e=t.suspend(),o=e.succeed,i=e.fail,this.ki(d.Events.ItemSaving,{index:n}),this._dataSource.saveItem(n,function(t){r.dl(),r.Jhe(),r.ki(d.Events.ItemSaved,{index:n}),o(t)},i)),t.execute()},M.prototype.bRt=function(t,n,i){var n,r,e,o,u,s,c,s,f,a,h,l,d,l,n=O(n,i),r=n.suspend,e=this,o=e.Pq;for(e.WOt++,u=0;u<o.length;u++)if(c=(s=o[u]).targetTable,s=s.LOt,c&&C(c,e)&&s&&s[t]&&!c.WOt)for(f=0,a=s[t];f<a.length;f++)h=a[f],(c.isUpdated(h)||c.isInserted(h))&&(d=(l=r()).succeed,l=l.fail,c.saveItem(h,d,l));n.execute(function(){return e.WOt--})},M.prototype.get=function(t){return this._dataSource.get(t)},M.prototype.nv=function(t){return this._dataSource.s7t(t)},M.prototype.mTe=function(){return this._dataSource.mTe()},M.prototype.remove=function(t,n,i,r){var e,o,u,s,u,e=this;void 0===n&&(n=1),s=(u=(o=O(function(){e.qCt(t,n,i,r)},r)).suspend()).succeed,u=u.fail,this.yRt(t,n,s,u),o.execute()},M.prototype.qCt=function(n,i,r,t){var e,o,u,e=this;this.o_t(m,!0),o=this.Zc,u={index:n,count:i,tableName:o},this.ki(d.Events.ItemRemoving,u),this._dataSource.remove(n,i,function(t){"number"==typeof t.removedCount&&(u.count=t.removedCount),e.dl(),e.Jhe(),e.wRt(),e.MRt(n,i),e.ki(d.Events.ItemRemoved,u),r&&r(t)},t)},M.prototype.yRt=function(c,f,t,n){var t,a,i,h,r,l,e,t=O(t,n),a=t.suspend,i=this,h=i.Pq;for(i.WOt++,r=function(t){var t,r,n,i,n,t,n,e,o,u,s,t=h[t],r=t.targetTable,n=t.CRt,i=t.LOt;if(r&&n.NOt(t.name)&&i&&l.uCe(c,f,i)&&!r.WOt){for(t=(n=a()).succeed,n=n.fail,e=[],o=void 0,u=function(t){var n=i[c+t];n&&(e=e.concat(Object.keys(n).map(function(t){return n[t]})))},s=0;s<f;s++)u(s);if(0===e.length)return"continue";e.sort(function(t,n){return n-t}),o=e.map(function(i){return function(t,n){r.remove(i,1,t,n)}}),(0,b.promiseSerialExecute)(o).then(t).catch(n)}},l=this,e=0;e<h.length;e++)r(e);t.execute(function(){return i.WOt--})},M.prototype.uCe=function(t,n,i){for(var r=0;r<n;r++)if(i[t+r])return!0;return!1},M.prototype.getChanges=function(){return this._dataSource.getChanges()},M.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},M.prototype.submitChanges=function(t,r,e,o){var u=this;return new Promise(function(n,i){u.SRt(t,r,function(t){n(t),e&&e(t)},function(t){i(t),o&&o(t)})})},M.prototype.SRt=function(r,e,n,i){var o,t,u,s,u,o=this,t=O(function(){o.wRt(),o.ki(d.Events.ChangesSubmitting,m),o._dataSource.submitChanges(function(t,n,i){r?r(t,n,i):o.ki(d.Events.ChangesSubmittedRowFailed,{index:t,reason:n,type:i})},function(t,n,i){e?e(t,n,i):o.ki(d.Events.ChangesSubmittedColumnFailed,{name:t,reason:n,type:i})}).then(function(t){o.ki(d.Events.ChangesSubmitted,t),n(t)}).catch(function(t){i(t)})}),u=t.suspend(),s=u.succeed,u=u.fail;this.TRt(s,u),t.execute()},M.prototype.TRt=function(t,n){var t,i,r,e,o,u,s,u,u,c,u,t=O(t,n),i=t.suspend,r=this,e=r.Pq;for(r.WOt++,o=0;o<e.length;o++)s=(u=e[o]).targetTable,u=u.LOt,s&&u&&!s.WOt&&(c=(u=i()).succeed,u=u.fail,s.submitChanges(m,c,u));t.execute(function(){return r.WOt--})},M.prototype.ZBe=function(){return this._dataSource.getColumnChanges()},M.prototype.QBe=function(){var t=this;t.WBe(this.ZBe(),t.TBe.bind(t),t.kBe.bind(t),t.IBe.bind(t))},M.prototype.WBe=function(t,n,i,r){var e,o,u;if((0,b.isArray)(t))for(e=0,o=t;e<o.length;e++)switch((u=o[e]).type){case s.ADD_COLUMN:n(u);break;case s.UPDATE_COLUMN:i(u);break;case s.REMOVE_COLUMN:r(u)}},M.prototype.cancelChanges=function(n,t){var i,r,e,i=this,r=(this.ZBe()||[]).some(function(t){return"addColumn"===t.type||"removeColumn"===t.type}),e=O(function(){var t={isDataLengthChanged:i.isDataLengthChanged(),isColumnCountChanged:r};i.ki(d.Events.ChangesCancelling,m),i.QBe(),i._dataSource.cancelChanges(),i.dl(),i.Jhe(),i.wRt(),i.ARt(),i.ki(d.Events.ChangesCancelled,t),n&&n(m)});this.IRt(e.suspend),e.execute()},M.prototype.IRt=function(t){var n,i,r,e,o,e,e,u,e,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)o=(e=i[r]).targetTable,e=e.LOt,o&&e&&!o.WOt&&(u=(e=t()).succeed,e=e.fail,o.cancelChanges(u,e));n.WOt--},M.prototype.xRt=function(t,n){var i=t instanceof v.CalcField;return(i=i&&this._dataSource.gCe(n)?!1:i)||t instanceof f.HierarchyField||t instanceof a.TriggerCalcField},M.prototype.NRt=function(){var t,i,n,r,e,o,t=this.options.schema.hierarchy.column,i=[new RegExp("(\\[@)(".concat(t,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(r=this.XOt[n])instanceof f.HierarchyField&&(r.C8(),i.push(new RegExp("(\\[@)(".concat(r.GOt,")\\]"))));for(n in e=function(t){var n;Object.prototype.hasOwnProperty.call(o.XOt,t)&&(n=o.XOt[t])instanceof v.CalcField&&i.some(function(t){return t.test(n.GOt)})&&n.C8()},(o=this).XOt)e(n)},M.prototype.FOt=function(t){var n,i;for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n],this.xRt(i)?i.C8(t):this.XOt[n]=m)},M.prototype.removeCalcCache=function(t){this.XOt[t]=m},M.prototype.dl=function(t,n){var i,r,e;if(t){for(i=this.XOt[t],this.xRt(i,t)?i.C8():this.XOt[t]=m,r=0;r<this.Pq.length;r++)if(t===(e=this.Pq[r]).name||t===e.sourceField||n&&t===e.targetField)return void(e.LOt&&e.CRt.dl(this))}else for(this.FOt(),r=0;r<this.Pq.length;r++)(e=this.Pq[r]).CRt&&e.CRt.dl(this)},M.prototype.primaryKey=function(t){var t,n,i,r,e,o,u,s,c,f;if(0===arguments.length)return this.qOt||(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,b.isNullOrUndefined)(t)&&(this.qOt=(this.qOt||[]).concat(t.split(",")),t=this._dataSource.options.schema,!(0,b.isNullOrUndefined)(t))){for(r in i=[],n=t.columns=t.columns||{})Object.prototype.hasOwnProperty.call(n,r)&&(e=n[r]).isPrimaryKey&&i.push(r);if(0===i.length)this.qOt.forEach(function(t){""===t||(0,b.isNullOrUndefined)(t)||(n[t]=n[t]||{},n[t].isPrimaryKey=!0)});else{for(o=0;o<i.length;o++)u=i[o],this.columns&&this.columns[u]&&(this.columns[u].isPrimaryKey=!0);for(s=this.qOt.slice().sort(),i.sort(),c=i,f=0;f<s.length||f<c.length;f++)if(s[f]!==c[f])return void(this.qOt=c)}}},M.prototype.getIndexes=function(){return(0,b.keys)(this.YOt)},M.prototype.kRt=function(){return(0,b.keys)(this.ZOt)},M.prototype.createIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]||(n[e]=this.DRt(e))},M.prototype.eRt=function(t,n){for(var i,r,e,o,i=this.ZOt,r=0,e=t;r<e.length;r++)i[o=e[r]]&&!n||(i[o]=this._Rt(o))},M.prototype.dropIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]&&delete n[e]},M.prototype.clearIndexes=function(){this.YOt={}},M.prototype.oRt=function(t,n){var i=this.YOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},M.prototype.zBe=function(t){this.ORt(t)&&this.dropIndexes([t])},M.prototype.ARt=function(t){t?delete this.ZOt[t]:this.ZOt={}},M.prototype.aRt=function(t,n){var i=this.ZOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},M.prototype.wRt=function(){var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},M.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},M.prototype.DRt=function(t){for(var n,i,r,e,o,i=this.length(),r=0;r<i;r++)(n=n||{})[o="string"!=typeof(o=(e=this.get(r))[t])?String(o):o]||(n[o]=[]),n[o]&&n[o].push(r);return n},M.prototype._Rt=function(n){var i=this;return R(n,this.length(),this.jRt(n),function(t){return i._getValueByField(n,t)})},M.prototype.ORt=function(t){return!!this.YOt[t]},M.prototype.search=function(t,n){if(!(0,b.isNullOrUndefined)(t)&&!(0,b.isNullOrUndefined)(n))return(0,b.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},M.prototype.mEt=function(t){var i,n,r,e,o,u,i=this.primaryKey().split(",");if(0===i.length||!this.YOt[i[0]])return[];if(1===i.length)return this.YOt[i[0]][t];if((t=t.split("|")).length!==i.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(r={},e={},this.YOt[i[0]][t[0]].forEach(function(t){r[t]=1}),o=function(n){u.YOt[i[n]]&&u.YOt[i[n]][t[n]].forEach(function(t){r[t]===n&&(e[t]=n)}),r=e,e={}},u=this,n=1;n<t.length;n++)o(n);return Object.keys(r)},M.prototype.kEt=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,w;if(i){for(r={},e=0;e<n.length;e++)o=n[e],u=this._dataSource._data[o],r[o]=u&&u.data[t];for(c=0,f=s=this.QOt.relationships;c<f.length;c++)if((a=f[c]).sourceTable===this&&a.targetTable!==this){for(h={},l=a.sourceRelationshipName+".",p=d=(v=0,b.keys)(a.targetTable.columns);v<p.length;v++)h[w=p[v]]=a.sourceTable._getValueByField(l+w,t);r[a.sourceRelationshipName]=h}}else for(r=[],e=0;e<n.length;e++)r.push(this.rRt(n[e]).getValue(t));return r},M.prototype.ASt=function(t,n,i,r){for(var e,o,u,s,e=[],o=this.length(),u=0;u<o;u++)s=n&&this.rRt(n).getValue(u),n!==w&&s!==t&&String(s)!==t||e.push(this.kEt(u,i||this._dataSource.DEt,r));return e},M.prototype.BRt=function(t,n){for(var i,r,e,o,u,i=[],r=this.length(),e=0;e<r;e++)(u=(o=this.get(e))[n])!==t&&String(u)!==t||i.push(o);return i},M.prototype.RRt=function(t,n){var i,r,n,e,o,u,s,i,r,n=this.YOt[n][t],e=[];if(n)for(o=0,u=n;o<u.length;o++)s=u[o],e.push(this.get(s));return e},M.prototype.sRt=function(t,n){var i,r,e,o,i=this.YOt;for(r in i)i.hasOwnProperty(r)&&(e=i[r])&&(e[o=n[r]]?e[o].push(t):e[o]=[t])},M.prototype.cRt=function(t,n){var i=this._dataSource.options.schema;I(this.ZOt,t,n,i&&i.columns)},M.prototype.lRt=function(t,n,i){var r,e,o,u,r=this.YOt;for(e in r)r.hasOwnProperty(e)&&(o=r[e])&&i!==n&&((u=o[n])&&1<u.length?u.splice(u.indexOf(t),1):delete o[n],o[i]?o[i].push(t):o[i]=[t])},M.prototype.hRt=function(t,n,i,r){N(this.ZOt,t,n,i,r,this.jRt(n))},M.prototype.cge=function(){var t,n,i,t=[];if(this.ZOt)for(i in n=this.ZOt)this.Pbe(i)&&t.push(i);return t},M.prototype.bCe=function(){var t=this.cge();t&&0<t.length&&this.eRt(t,!0)},M.prototype.wCe=function(t){var n,n;return!!(0,b.isFormula)(t)||"formula"===(null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.dataType)||this._dataSource.gCe(t)},M.prototype.EJe=function(t,n){return this.wHe(this.awe(t),function(t){return t===n})},M.prototype.sge=function(t,n){var i,r,e,i=[];if(this.ZOt)for(e in r=this.ZOt)this.wCe(e)&&(n===m||this.EJe(e,n)&&!this.Pbe(e))&&i.push({field:e,originValue:this._getValueByField(e,t)});return i},M.prototype.uge=function(t,n){var i,r,e;if(n&&0<n.length)for(i=0;i<n.length;i++)r=n[i].field,e=n[i].originValue,this.hRt(t,r,e,this._getValueByField(r,t))},M.prototype.MRt=function(t,n){E(this.ZOt,t,n)},M.prototype.LRt=function(t,n){var i,r,e,o,i=this.ZOt,r=i&&i[t];if(r)for(e in r)if(r.hasOwnProperty(e)&&(o=r[e],(0,b.isArray)(o))&&o.some(function(t){return t===n}))return e},M.prototype.jOt=function(t){return 0<=this.Ljt().indexOf(t)},M.prototype.OOt=function(){return 1<this.Ljt().length},M.prototype.EOt=function(){return 0<this.Ljt().length},M.prototype.Ljt=function(t){var t,n,i,r,e,o,u,s;if(!this.qOt||t)if(t=this._dataSource.options.schema,(0,b.isNullOrUndefined)(t)||(0,b.isNullOrUndefined)(t.columns)||0===Object.keys(t.columns).length)for(n in this.qOt=[],this.columns)this.columns[n].isPrimaryKey&&this.qOt.push(n);else{for(n in r=[],i=t.columns=t.columns||{})i.hasOwnProperty(n)&&(e=i[n]).isPrimaryKey&&r.push(n);for(this.qOt||(this.qOt=[]),o=this.qOt.slice().sort(),r.sort(),u=r,s=0;s<o.length||s<u.length;s++)if(o[s]!==u[s]){this.qOt=u;break}}return this.qOt},M.prototype.defaultView=function(){var r=this;return r.FRt?Promise.resolve(r.FRt):new Promise(function(i,t){r.fetch().then(function(t){var n,n,n,n=r.get(0),n=(0,b.keys)(n),n=r.addView(c.DEFAULT_VIEW_NAME,n);r.FRt=n,i(n)})})},M.prototype.addView=function(t,n,i,r){var n=new o.View(t,n,i,r);return(this.views[t]=n).PRt(this),n},M.prototype.GRt=function(t,n){var n=new o.View(t,n);return n.PRt(this),this.QOt.rV[t]=n},M.prototype.removeView=function(t){var n=this.views;n[t].PRt(w),delete n[t],this.URt(t)},M.prototype.URt=function(t){var n,i,r,n=this.QOt.tables;for(i in n)n.hasOwnProperty(i)&&(r=n[i]).VOt[t]&&(r.VOt[t].$Ot(r),delete r.VOt[t])},M.prototype.HRt=function(t){return this.views[t]},M.prototype.zRt=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name===t)return r;return null},M.prototype.Ole=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name.toUpperCase()===t.toUpperCase())return{field:r,fieldName:r.name};return null},M.prototype.VRt=function(t){var n,i,r,n=this.getDataSync(t),i=[];if(t)for(r=0;r<t.length;r++)i.push(n[t[r]]);else for(r=0;r<n.length;r++)i.push(n[r]);return i},M.prototype.vRt=function(t){return this.VRt([t])[0]},M.prototype.gRt=function(t){return this._dataSource.lOt(t)},M.prototype.YRt=function(t,n){for(var i,r,i=[],r=0;r<n.length;r++)i.push(this._getValueByField(t,n[r]));return i},M.prototype.twe=function(t,n){var i=this.XOt[t];return i&&i instanceof a.TriggerCalcField||(this.XOt[t]=i=new a.TriggerCalcField(t,n,this)),i},M.prototype.bEt=function(t){var n;return this.XOt[t]||!this.CEt()||(0,b.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new f.HierarchyField(t,this)),this.XOt[t]||"="!==t[0]||this.Xhe(t),this.XOt[t]||("="===(null==(n=this.awe(t))?void 0:n[0])?(this.Xhe(n),this.XOt[t]=new v.CalcField(n,this)):"="===t[0]?this.XOt[t]=new v.CalcField(t,this):this.XOt[t]=new p.TableField(t,this)),this.XOt[t]},M.prototype.Gbe=function(t){return(0,b.isNullOrEmpty)(t)||!(0,b.isString)(t)?[]:(0,j.addWindowOverFormulas)(this.POt,this.awe(t))},M.prototype.awe=function(t){var n,n,n,n;return(0,b.isFormula)(t)?t:(n=null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.value,(0,b.isFormula)(n)?n:(n=this._dataSource.Ebe(t))&&!(0,b.isFormula)(n)?"="+n:n)},M.prototype.wHe=function(t,n){var i,r,t;return!((0,b.isNullOrEmpty)(t)||!(0,b.isString)(t))&&((i=this.POt.getCalcService()).dCe=i.dCe||{},i.dCe.hasOwnProperty(t)?!(i.Wbe=!0):(i.dCe[t]=!0,r=this.Ywt(t),delete i.dCe[t],t=i.Wbe,0===Object.keys(i.dCe).length&&(delete i.dCe,delete i.Wbe),!t&&this.yHe(r,n)))},M.prototype.yHe=function(t,n){var i,r,e,o,u,u,s,c,f,a;if(!(0,b.isNullOrUndefined)(t))if(t.function){for(r=0,e=t.arguments;r<e.length;r++)if(o=e[r],i=this.yHe(o,n))return!0}else if(14===t.type){if(t.value&&!t.value.field.inCircular)return!!(i=n(u=t.value.field.GOt||t.value.Pq.join(".")))||!(!(u=this.awe(u))||(t.value.field.inCircular=!0,i=this.wHe(u,n),delete t.value.field.inCircular,!i))||void 0}else for(s=0,c=Object.keys(t);s<c.length;s++)if((a=t[f=c[s]])instanceof h.Expression&&(i=this.yHe(t[f],n)))return!0},M.prototype.Pbe=function(t){return!(0,b.isNullOrEmpty)(t)&&("object"==typeof t&&"string"==typeof t.aggregate||0<this.Gbe(t).length)},M.prototype.nwe=function(t,n){var i=this.XOt[t];return i&&i instanceof v.CalcField||(this.XOt[t]=i=new v.CalcField(n||t,this)),i},M.prototype.Cve=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,n=this.XOt;if(t.D5?i=t.D5:(i="="!==(i=this.wde(t))[0]?"="+i:i,t.D5=i),o=(e=i).indexOf("=[@"),u=i.lastIndexOf("]"),s=0===o&&u===i.length-1){for(h=a=!1,l=c=o+3,d=f=u-1;l<d&&("["!==i[l]&&c===o+3&&(a=!0,o=l),"]"!==i[d]&&f==u-1&&(h=!0,u=d),!a||!h);l++,d--);e=i.slice(o,u+1)}return r=n[e],(0,b.isNullOrUndefined)(r)&&(r=n[e]=s?new p.TableField(e,this):new v.CalcField(e,this,t)),s?function(t){return r.getValue(t)}:function(t){return r.getValueWithContext(t)}},M.prototype.MHe=function(t,n){var i,r;return(0,j.isWindowOverFormula)(t)&&(t=(i=(0,j.deconstructWindowOverFunction)(this,t)).formulaFromWindowChaining||i.windowOverFormula),r={},(n=n||[]).forEach(function(t){r[t]=!0}),this.wHe(t,function(t){(0,b.isString)(t)&&(0,b.isRelation)(t)&&!r[t]&&(n.push(t),r[t]=!0)}),n},M.prototype.uwe=function(t,n){var i,r,e,o,o,i=this;if(!(0,b.isNullOrEmpty)(t)&&!(0,b.isNullOrUndefined)(n)&&0!==n.length)for(r=1===n.length&&(0,j.isWindowOverFormula)(t),e=0;e<n.length;e++)o=n[e],o=(0,j.deconstructWindowOverFunction)(i,o),r&&(o.originalWindowOverFormula=t),i.qhe(o.windowOverFormula,o)},M.prototype.Xhe=function(t){var n,i,n=this;return!this.XOt[t]&&0<(i=n.Gbe(t)).length&&(n.uwe(n.awe(t),i),!0)},M.prototype.qhe=function(t,n){var i,r,e,o,u,s,c;if(!(this.XOt[t]&&this.XOt[t]instanceof j.WindowOverCalcField)){if(i=n.partitions,r=n.orders,(0,b.isArray)(i))for(e=0;e<i.length;e++)o=i[e],this.columns[o.field]||this.rRt(o.field);if((0,b.isArray)(r))for(e=0;e<r.length;e++)u=r[e],this.columns[u.field]||this.rRt(u.field);s=n.formulaFromWindowChaining||t,c=this.XOt[s],(0,b.isNullOrUndefined)(c)&&(c=new j.WindowOverCalcField(s,this,n)),this.XOt[s]=c,this.XOt[t]=c,(0,b.isNullOrUndefined)(n.originalWindowOverFormula)||(this.XOt[n.originalWindowOverFormula]=c)}return this.XOt[t]},M.prototype.pCe=function(t,n){for(var i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,i=Object.keys(t),r=Object.keys(n),e=[],o=0,u=i.concat(r);o<u.length;o++)if(s=u[o],!n.hasOwnProperty(s)||t[s]!==n[s])for(f=0,a=c=Object.keys(this.XOt);f<a.length;f++)if(h=a[f],(l=this.XOt[h])instanceof j.WindowOverCalcField&&l.options.windowDefineName===s&&-1<h.indexOf('"'.concat(s,'"'))){for(delete this.XOt[h],d=0,v=Object.keys(this.XOt);d<v.length;d++)p=v[d],this.XOt[p]===l&&delete this.XOt[p];e.push(h)}for(w=0,b=e;w<b.length;w++)this.Xhe(m=b[w])},M.prototype.Jhe=function(){this.$he(!0)&&this.bCe()},M.prototype.$he=function(t){},M.prototype.fme=function(){return 1===Object.keys(this.views).length},M.prototype.ZRt=function(t){try{this.rRt(t)}catch(t){}var t=this.XOt[t];return t&&t.setValue},M.prototype.WRt=function(t,n,i){this.rRt(t);var r=this.XOt[t];return this.o_t(t),r&&r.setValue&&r.setValue(n,i)},M.prototype.QRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.setItemValue&&o.setItemValue(n,i,r,e)},M.prototype.KRt=function(t,n){this.rRt(t);var t=this.XOt[t];return t&&t.hasItem&&t.hasItem(n)},M.prototype.JRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.insertItem&&o.insertItem(n,i,r,e)},M.prototype._getValueByField=function(t,n,i){return this.rRt(t),this.XOt[t].getValue(n,i)},M.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},M.prototype.swe=function(t,n){return this.rRt(t),this.XOt[t].getRelatedModelIndex(n)},M.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},M.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},M.prototype.tBt=function(t){for(var n,i,r,e,o,u,n=this,i,r,e=0,o=n.QOt.relationships;e<o.length;e++){if((u=o[e]).sourceTable===n&&u.sourceFieldName===t)return u.targetTable;if(u.targetTable===n&&u.targetFieldName===t)return u.sourceTable}},M.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},M.prototype.rRt=function(t){return this.XOt[t]||this.bEt(t),this.XOt[t]},M.prototype.xOt=function(t,n,i,r,e){var n={name:n,sourceField:t,targetTable:i,targetField:r,CRt:e};return this.Pq.push(n),n},M.prototype.kOt=function(t){for(var n=this.Pq.length-1;0<=n;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},M.prototype.eBt=function(t){for(var n,i,r,e,n=[this],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)&&n.push(e);return t?n.slice(1):n},M.prototype.JBe=function(){for(var t,n,i,r,e,t=[],n=[],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)?(n.push(e),(0,b.isNullOrUndefined)(i[r].type)&&this.rRt(i[r].name),t.push({field:i[r].name,tableName:e.name,isMany:"array"===i[r].type,isTable:!0})):t.push({field:i[r].name});return t},M.prototype.KBe=function(t,n){var t,i,i=this;return t?(null==(t=i.qRt(t))?void 0:t.KBe(w,!0))||[]:i.JBe().filter(function(t){return n||t.isTable}).map(function(t){return{table:t.field,tableName:t.tableName,isTable:t.isTable,isMany:t.isMany}})},M.prototype.XBe=function(t){var n,t,n,t,n=this,t=(0,b.isString)(t)?t:t.value;return n.isDataColumn(t)?n.rBt(t):(0,b.isRelation)(t)&&(n=n.qRt(t),t=t.split(".").pop(),n)&&n.columns&&n.columns[t]?n.rBt(t):void 0},M.prototype.iBt=function(n){var i,t,r,i=this,t=i.Pq,r={};return t.forEach(function(t){var t=t.name;r[t]=i._getValueByField(t,n)}),r},M.prototype.ltt=function(){return this.Pq},M.prototype.rBt=function(t){var t=this.jRt(t);return t&&t.dataType},M.prototype.jRt=function(t){var n,i,r,n=this,i=n._dataSource.options.schema;return i&&i.columns&&i.columns[t]?r=i.columns[t]:(0,b.isNullOrUndefined)(n.columns)||(r=n.columns[t]),r},M.prototype.oBt=function(t){var n,i,t;return 0===t.length?[]:((t=(i=(n=this).zRt(t[0]))&&i.targetTable?i.targetTable.oBt(t.slice(1)):[]).unshift(i),t.filter(function(t){return!(0,b.isNullOrUndefined)(t)}))},M.prototype.Ix=function(){var t,n,i,r,t=[],n={},i=this.name;return n[i]||(t.push(i),n[i]=!0),(r=this.QOt)&&this.qBe(r,i,t,n),t},M.prototype.qBe=function(t,n,i,r){for(var e,o,u,s,c,s,e,o=0,u=t.relationships;o<u.length;o++)c=(s=u[o]).sourceTable.name,s=s.targetTable.name,c===n&&s!==n?r[s]||(i.push(s),r[s]=!0,this.qBe(t,s,i,r)):s!==n||c===n||r[c]||(i.push(c),r[c]=!0,this.qBe(t,c,i,r))},M.prototype.toJSON=function(){var t,n,i,t=this.views,n=[];for(i in t)t.hasOwnProperty(i)&&n.push(t[i].toJSON());return{name:this.name,dataSourceOption:x(this._dataSource.options),primaryKey:this.primaryKey(),views:n,columns:this.aBt(this.columns),notFetchAfterLoad:this.Nx}},M.prototype.fromJSON=function(t){for(var i,t,n,r,e,o,u,i=this,n,r=0,e=t.views;r<e.length;r++)o=e[r],(u=this.addView(o.name,o.columns,!1,o.options)).fromJSON(o);return this.columns=t.columns,this.columns&&Object.keys(this.columns).forEach(function(t){var n;"="===t[0]&&i.columns[t]&&i.columns[t].value===t&&i.columns[t].caption&&"="!==i.columns[t].caption[0]&&(n=i.columns[t].caption,i.columns[n]=i.columns[t],delete i.columns[t])}),this.primaryKey(t.primaryKey),t.notFetchAfterLoad||null!=(t=this.options)&&t.remote&&!this.options.remote.read?Promise.resolve(null):this.fetch()},M.prototype.bind=function(t,n){this._dataSource.bind(t,n)},M.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},M.prototype.ki=function(t,n){return this._dataSource.ki(t,n)},M.prototype.vOt=function(t){return this._dataSource.vOt(t)},M.prototype.aBt=function(t){var n,i;for(n in t)t.hasOwnProperty(n)&&!(0,b.isNullOrUndefined)(t[n])&&((i=t[n]).W5=i.dataType);return t},M.prototype.z7t=function(t,n,i){return this._dataSource.z7t(t,n,i)},M.prototype.V7t=function(t){return this._dataSource.V7t(t)},M.prototype.d7t=function(t,n,i){return this._dataSource.d7t(t,n,i)},M.prototype.uBt=function(){return this._dataSource.$jt()},M.prototype.qX=function(){return this._dataSource.qX()},M.prototype.m7t=function(t,n,i,r){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,i,r)},M.prototype.ABe=function(t,n){return this._dataSource.ABe(t,n)},M.prototype.CEt=function(){return this._dataSource.isHierarchy()},M.prototype.isHierarchy=function(){return this.CEt()},M.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},M.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},M.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},M.prototype.rebuildHierarchyStructure=function(){return this._dataSource.load({reload:!0})},M.prototype.SEt=function(t){return this._dataSource.SEt(t)},M.prototype.f7t=function(){return this._dataSource.f7t()},M.prototype.getHierarchyRootNode=function(){return this.f7t()},M.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},M.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},M.prototype.O7t=function(t,n,i){return this._dataSource.O7t(t,n,i)},M.prototype.L7t=function(t,n,i){return this._dataSource.L7t(t,n,i)},M.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},M.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},M.prototype.Xme=function(t,n){return this._dataSource.Xme(t,n)},M.prototype.H7t=function(t){return this._dataSource.H7t(t)},M.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},M.prototype.OBe=function(t){return this._dataSource.OBe(t)},M.prototype.tBe=function(t){this._dataSource.tBe(t)},M.prototype.$Fe=function(){return this._dataSource.$Fe()},M.prototype.I7t=function(t){this._dataSource.I7t(t)},M.prototype.X7t=function(){return this._dataSource.X7t()},M.prototype.KFe=function(t){return this._dataSource.KFe(t)},M.prototype.XFe=function(t,n){this._dataSource.XFe(t,n)},M.prototype.isColumnSpreadChanged=function(){return this._dataSource.Cue()},M.prototype.setColumnSpreadChanged=function(t){this._dataSource.Sue(t)},n.Table=i=M,r(T,_=i),T.prototype.getDataSync=function(t){var n,i,r,e,n=[];if(t)for(i=0;i<t.length;i++)n.push(this._dataSource.Fbe(t[i]));else for(r=0,e=this._dataSource.length();r<e;r++)n.push(this._dataSource.Fbe(r));return n},y=T},"./dist/src/table/tableEvents.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0,r.ItemInserting="ItemInserting",r.ItemInserted="ItemInserted",r.ItemUpdating="ItemUpdating",r.ItemUpdated="ItemUpdated",r.ItemResetting="ItemResetting",r.ItemReset="ItemReset",r.ItemSaving="ItemSaving",r.ItemSaved="ItemSaved",r.ItemRemoving="ItemRemoving",r.ItemRemoved="ItemRemoved",r.ChangesSubmitting="ChangesSubmitting",r.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",r.ChangesSubmittedColumnFailed="ChangesSubmittedColumnFailed",r.ChangesSubmitted="ChangesSubmitted",r.ChangesCancelling="ChangesCancelling",r.ChangesCancelled="ChangesCancelled",n.Events=r},"./dist/src/table/tableField.js":function(t,n,i){"use strict";var f,c,a,r;function h(u,s,c){return function(t,n,i,r){var e=u.map[t],o=e;return(0,f.isNullOrUndefined)(o)&&(e=u.map[t]=[]),n[s.targetField]=c._getValueByField(s.sourceField,t),u.relatedTable.JRt(u.subField,void 0,n,function(t){e.push(t.index),t.index=e.length-1,i&&i(t)},r)}}function e(t,u){var e,s,o,t,t,e=this;this.Oit=[],s="string"==typeof t?t.split("."):t,!(o=s[0]&&u.zRt(s[0]))&&s[0]&&(t=u.Ole(s[0]))&&(o=t.field,s[0]=t.fieldName),o&&o.targetTable?(this.relatedTable=o.targetTable,this.map=o.LOt,this.setValue=null,this.map||(o.CRt.BOt(),this.map=o.LOt),this.getRelationMaps=function(){var t=[{name:o.name,relationshipMap:o.CRt.DOt(o.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,i,t,i,r,n=[t];return this.relatedTable?(this.subField&&(n=this.relatedTable.nBt(this.subField,t)),t=void 0,t=(i=o.CRt).targetTable===this.relatedTable?i.targetRelationshipName:i.sourceRelationshipName,i=this.relatedTable.zRt(t),r=i.LOt,n.reduce(function(t,n){return t.concat(r[n])},[])):n},this.getRelatedModelIndex=function(t){var t=this.map[t];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t[0])},"object"===o.type?1===s.length?(this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t[0])},this.setValue=function(t){var n=t[s[0]];return t[o.sourceField]=n?n[o.targetField]:null,t}):(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t[0],!0)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t[0])},this.setItemValue=function(t,n,i,r){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.QRt(e.subField,t[0],n,i,r)},this.hasItem=function(t){var t=e.map[t];return!(0,f.isNullOrUndefined)(t)&&e.relatedTable.KRt(e.subField,t[0])},this.insertItem=h(this,o,u)):1===s.length?this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?[]:e.relatedTable.VRt(t)}:(t=s[1]-1,isNaN(t)?(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.YRt(e.subField,t)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.hasItem=function(t){var t=e.map[t];return t&&0<t.length},this.insertItem=h(this,o,u)):2===s.length?(this.arrayFieldIndex=s[1]-1,this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t)}):(this.arrayFieldIndex=t,this.subField=s.slice(2).join("."),this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t)},this.getOriginalValue=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.setItemValue=function(t,n,i,r){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return e.relatedTable.QRt(e.subField,t,n,i,r)},this.getRelatedModelIndex=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t)}))):(0===s.length?this.getValue=function(t){return u._dataSource.get(t)}:1===s.length?(this.getValue=function(t){return u._dataSource.getFieldValue(s[0],t)},this.getOriginalValue=function(t){return u._dataSource.getFieldOriginalValue(s[0],t)},this.getRelatedTable=function(){return u},this.setItemValue=function(t,n,i,r){return u.updateItemValue(t,s[0],n,i,r)},this.hasItem=function(t){return u._dataSource.length()>t},this.insertItem=function(t,n,i,r){var e=(0,f.isNullOrUndefined)(t)?u.length():t;return u.insertItem(e,n,function(t){t.index=e,i&&i(t)},r)},this.setFieldValue=function(t,n,i){var t;u._dataSource.updateItemValues(t,((t={})[n]=i,t))}):(this.getValue=function(t){for(var n,i,n=u._dataSource.getFieldValue(s[0],t),i=1;n&&i<s.length;i++)n=(0,f.isArray)(n)?n[s[i]-1]:n[s[i]];return n},this.setItemValue=function(t,n,i,r){var e,o,o,o=u._getValueByField(s[0],t);if(!(0,f.isNullOrUndefined)(o))return o=(0,f.clone)(o,!0),this.setValue(((e={})[s[0]]=o,e),n),u.updateItemValue(t,s[0],o,i,r)}),this.setValue=function(t,n){for(var i,r,e,o,i=t,r=t,e=s.length,o=0;r&&o<e;o++)i=(0,f.isArray)(r)?r[s[o]-1]:r[s[o]],o!==e-1&&(r=i);return r!==i&&(i!==n||(0,f.isNullOrUndefined)(i)&&(0,f.isNullOrUndefined)(n))&&(r[s[e-1]]=n),t})}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,f=i("./dist/src/dataSource/utils.js"),c=null,a=void 0,e.prototype.getValue=function(t){return null},e.prototype.getValues=function(t,n,i,r,e,o){var u,s,i;if(n=(0,f.isNumber)(n)?n:0,i=(0,f.isNumber)(i)?i:t.length-1,(u=this.Oit).length!==t.length||this._me!==t)for(this._me=t,this.Oit=u=[],s=u.length;s<t.length;s++)u.push(this.getValue(t[s]));return i=u.slice(n,i+1),r!==a&&e!==a&&(o!==a?i.splice(r-n,e-r+1,i[o-n]):i.splice(r-n,e-r+1)),i},e.prototype.setValue=function(t,n){return null},e.prototype.setItemValue=function(t,n,i,r){},e.prototype.setFieldValue=function(t,n,i){},e.prototype.hasItem=function(t){},e.prototype.insertItem=function(t,n){},e.prototype.getOriginalValue=function(t){return null},e.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},e.prototype.getRelationMaps=function(){return[]},e.prototype.getHostTableIndexes=function(t){return[t]},e.prototype.getRelatedModelIndex=function(t){return t},n.TableField=e},"./dist/src/table/triggerCalcField.js":function(t,n,i){"use strict";var e,o,u,s,c,f,r;function a(t,n,i){var r,n,t;this.GOt=t,this.nM=i,this.HOt=new f.TableField(t,i),r="=[@".concat(t,"]"),n?(this.MU=n,this.cwe=n.when===u.TriggerWhenType.onNewAndUpdate,this.cwe&&(this.fwe=l(n),this.lwe=-1<n.fields.indexOf("*"),this.hwe=this.lwe||-1<this.fwe.indexOf(t)),r=n.formula,n=["[@".concat(t,"]"),"[@[".concat(t,"]]")],(-1<r.indexOf(n[0])||-1<r.indexOf(n[1]))&&(this.dwe=!0),this.dwe&&(t="".concat(o.TRIGGERFIELDVALUE,'("').concat(t,'", ').concat(this.hwe?0:1,")"),this.vwe=h(h(r,n[0],t),n[1],t),this.mwe=new c.CalcField(this.vwe,this.nM,void 0,e.Errors.Calc))):this.gwe=!0,this.UOt=new c.CalcField(r,i,void 0,e.Errors.Calc)}function h(t,n,i){return t.split(n).join(i)}function l(t){return t.fields.split(",").reduce(function(t,n){return n=n.trim(),(0,s.isNullOrEmpty)(n)||t.push(n),t},[])}Object.defineProperty(n,"__esModule",{value:!0}),n.getWatchedFields=n.TriggerCalcField=void 0,e=i("CalcEngine"),o=i("./dist/src/calculation/functions/triggerFieldValue.js"),u=i("./dist/src/dataSource/dataSource.interface.js"),s=i("./dist/src/dataSource/utils.js"),c=i("./dist/src/table/calcField.js"),f=i("./dist/src/table/tableField.js"),a.prototype.getKey=function(){return this.UOt.getKey()},a.prototype.vyt=function(){this.UOt.vyt()},a.prototype.c_t=function(){return this.UOt.c_t()},a.prototype.P6t=function(){this.C8()},a.prototype.C8=function(){this.UOt.C8(),this.mwe&&this.mwe.C8(),this.HOt=new f.TableField(this.GOt,this.nM),this.pwe=!1},a.prototype.getValue=function(t){var n,i,r,n=this,i=this.HOt.getValue(t),r=(0,s.isUndefined)(i);return r?i=!this.gwe&&(r=!this.cwe||this.lwe?r:this.fwe.some(function(t){return!(0,s.isUndefined)(n.nM._dataSource.getFieldValue(t,0))}))?this.dwe?(this.hwe&&!this.pwe&&(this.pwe=!0),this.evaluateSelfTrigger(t)):this.evaluateTrigger(t):this.nM.XRt(this.GOt,0):!this.hwe||this.pwe||e.Convert.BJ(i)||(this.pwe=!0,i=this.dwe?this.evaluateSelfTrigger(t):this.evaluateTrigger(t)),i},a.prototype.evaluateTrigger=function(t){var t=this.UOt.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.evaluateSelfTrigger=function(t){var t=this.mwe.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},a.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},a.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},a.prototype.hasItem=function(t){this.HOt.hasItem(t)},a.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},a.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},a.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},a.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},a.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.TriggerCalcField=a,n.getWatchedFields=l},"./dist/src/table/windowOverField.js":function(t,n,i){"use strict";var r,u,l,e,d,x,T,a,h,D,o,s,c;function f(t,n,i){var r=c.call(this,i.windowFormula,n)||this;return r.GOt=t,r.options=i,r.Qhe=function(t){return n.rRt(t)},r.tde={evaluator:r},r.nde=!0,r.Sve(),r.Tve(),r.CHe(n,t),r}function P(t,n,i,r,e){var o,u,s,c,f;for(void 0===e&&(e=!1),o=i,u=r,s=D;o<=u;)n<=(f=t(c=Math.floor((o+u)/2)))?(e?o=c+1:u=c-1,s=c):e?u=c-1:o=c+1;return s}function A(t,n,i,r,e){var o,u,s,c,f;for(void 0===e&&(e=!1),o=i,u=r,s=D;o<=u;)(f=t(c=Math.floor((o+u)/2)))<=n?(e?u=c-1:o=c+1,s=c):e?o=c+1:u=c-1;return s}function y(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=D,c=i.length-1;o<=u;){for(a=!0,h=t(f=Math.floor((o+u)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(u=f-1,s=f):o=f+1}return s}function k(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=D,c=i.length-1;o<=u;){for(a=!0,h=t(f=Math.floor((o+u)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(o=f+1,s=f):u=f-1}return s}function L(t,n,i,r){for(var e,o,u,s,e=i,o=r,u=D;e<=o;)t(s=Math.floor((e+o)/2))===n?(e=s+1,u=s):o=s-1;return u}function V(t,n,i,r){var e,o,u,s,c;for(void 0===r&&(r=!1),e=n,o=i,u=D;e<=o;)c=t(s=Math.floor((e+o)/2)),(0,T.isNullOrUndefined)(c)?(r?o=s-1:e=s+1,u=s):r?e=s+1:o=s-1;return u}function G(t){return(0,T.isNumber)(t)&&-1<t?t:0}function v(t,n,i){var r,e,n;return(0,T.isNullOrEmpty)(n)||!(0,T.isString)(n)?[]:(i=i||[],(r=t.getCalcService()).dCe=r.dCe||{},r.dCe.hasOwnProperty(n)?(r.Wbe=!0,[]):(r.dCe[n]=!0,e=(0,d.parseFormula)(t,n),delete r.dCe[n],n=r.Wbe,0===Object.keys(r.dCe).length&&(delete r.dCe,delete r.Wbe),n?[]:(p(t,e,i),i)))}function p(t,n,i){var r,e,o,u,s,c,f;if(!(0,T.isNullOrUndefined)(n))if(n.function)if((0,d.getExprFunctionName)(n)===d.WINDOWOVER)i.push("="+(0,d.unparseExpression)(t,n));else for(r=0,e=n.arguments;r<e.length;r++)p(t,o=e[r],i);else if(14===n.type)n.value&&n.value.field instanceof a.CalcField&&!n.value.field.inCircular&&(n.value.field.inCircular=!0,v(t,n.value.field.GOt,i),delete n.value.field.inCircular);else for(u=0,s=Object.keys(n);u<s.length;u++)(f=n[c=s[u]])instanceof h.Expression&&p(t,n[c],i)}function w(t){var n;return!(0,T.isNullOrEmpty)(t)&&("string"==(n=typeof t)&&-1<t.indexOf(d.WINDOWOVER)||"object"==n&&"string"==typeof t.aggregate)}function b(t){var n=t.indexOf(d.WINDOWOVER);return(0,T.isFormula)(t)?1===n:0===n}function m(t,n){var i,r,e,o,u,s,c,f,a,i=[],r=d.WINDOWOVER.length,e=r+2,o=0,u=0;do{if(-1===(o=t.indexOf(d.WINDOWOVER,o)))break;for(u=o+r,s=0,c="=".concat(d.WINDOWOVER),f=0;u<t.length;u++)if((" "!==(a=t[u])||" "===a&&(!1===n||0<f))&&(c+=a),"("===a)s++;else if(")"===a){if(0===--s)break}else"["===a?f++:"]"===a&&f--}while(u!==t.length&&(i.push(c),o=u,t.length-o>=e));return i}function j(t,n){var t,i,r,e,o,t=t.nMt(t.Ywt(n.replace(d.WINDOWOVER,d.WINDOWOVERDECONSTRUCT))),i=(t.partitions||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field)},"p"),r=(t.orders||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field,"_").concat(n.ascending)},"o"),e="f",o=t.windowFrame;return o&&(e+="__".concat(o.type),o.begin&&(e+="__p__".concat(o.begin.type,"__").concat(o.begin.offset)),o.end)&&(e+="__f__".concat(o.end.type,"__").concat(o.end.offset)),u({partitionKey:i,orderKey:r,frameKey:e,windowOverFormula:n},t)}function g(t){return"["===t[0]&&"]"===t[t.length-1]}function _(t){return(0,T.isFormula)(t)?t.slice(1):g(t)?t:"[".concat(t,"]")}function O(t,n){var i;return(0,T.isNumber)(t)?i=0===t?"[@]":"[@".concat(t,"]"):"current"===t?i="[@]":"unbounded"===t&&(i="-1"),i||(n?"-1":"")}function S(t,n){var i,r,i=[];if(i.push(O(n.from,!0)),r=O(n.to,!1),(0,T.isNullOrEmpty)(r)||i.push(r),!(0,T.isNullOrEmpty)(n.exclude))switch(n.exclude){case l.FrameExcludeNoOthers:i.push(0);break;case l.FrameExcludeCurrentRow:i.push(1);break;case l.FrameExcludeGroup:i.push(2);break;case l.FrameExcludeTies:i.push(3)}return"".concat(t,"(").concat(i.join(),")")}function C(t,n){var n,i,f,i,r,e,o,t,e,u,s,c,a,h,e,o,r;if("string"==typeof t||(0,T.isNullOrUndefined)(t))return t;if(n=!n,i=t.aggregate,!(0,T.isNullOrEmpty)(i)||!n){if(f=[],n&&(0,T.isFormula)(i)&&(i=i.slice(1)),n&&f.push(i),i=t.window,e=t.partitionBy,o=t.orderBy,t=t.frame,(r=!1,T.isArray)(e)?(e=e.filter(function(t){return!(0,T.isNullOrEmpty)(t)}).map(_).join(),f.push("".concat(d.PARTITIONBY,"(").concat(e,")"))):n&&!(0,T.isNullOrEmpty)(i)&&(r=!0,f.push('"'.concat(i,'"'))),!(0,T.isNullOrUndefined)(o)&&((0,T.isArray)(o)?0<o.length:0<Object.keys(o).length))for(s=function(t){var n,i,r,e,o,u,s,c,s,s,n=Object.keys(t);if(0<n.length){for(i=[],r=function(t){return"string"==typeof t||(0,T.isNullOrUndefined)(t)},e=function(t,n){t===l.OrderAsc?i.push("".concat(d.ORDERASC,"(").concat(n,")")):t===l.OrderDesc?i.push("".concat(d.ORDERDESC,"(").concat(n,")")):i.push(n)},o=0,u=n;o<u.length;o++)c=_(s=u[o]),r(s=t[s])?e(s,c):r(s=s.order)&&e(s,c);f.push("".concat(d.ORDERBY,"(").concat(i.join(),")"))}},a=u=(c=0,T.isArray)(o)?o:[o];c<a.length;c++)s(h=a[c]);else!n||r||(0,T.isNullOrEmpty)(i)||(r=!0,f.push('"'.concat(i,'"')));return(0,T.isNullOrUndefined)(t)?!n||r||(0,T.isNullOrEmpty)(i)||f.push('"'.concat(i,'"')):(e=t.rows,o=t.range,r=t.groups,e?f.push(S(d.FRAMEROWS,e)):o?f.push(S(d.FRAMERANGE,o)):r&&f.push(S(d.FRAMEROWS,r))),"=".concat(n?d.WINDOWOVER:d.WINDOWDEF,"(").concat(f.join(),")")}}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.parseWindowOverByOption=n.deconstructWindowOverFunction=n.getWindowOverFormulas=n.isWindowOverFormula=n.hasWindowOverFormulas=n.processWindowOverFormula=n.addWindowOverFormulas=n.WindowOverCalcField=void 0,l=i("./dist/src/dataSource/dataSource.interface.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),d=i("./dist/src/calculation/functions/windowOvers/util.js"),x=i("./dist/src/dataSource/dataSource.interface.js"),T=i("./dist/src/dataSource/utils.js"),a=i("./dist/src/table/calcField.js"),h=i("CalcEngine"),D=-1,c=a.CalcField,r(f,c),f.prototype.P6t=function(){},f.prototype.C8=function(t){!1===t&&!this.SHe||(this.Tl=[],this.nde=!0,this.Sve())},f.prototype.getValue=function(t){return this.Tl[t]},f.prototype.XBt=function(t,n,i,r){var e,o,u,s,e=this;if(e.Tl||(e.Tl=[]),i=(0,T.isNumber)(i)?i:0,r=(0,T.isNumber)(r)?r:t.length-1,(0,T.isArray)(n))for(u=i,s=0;u<=r;u++,s++)o=t[u],e.Tl[o]=n[s];else for(u=i;u<=r;u++)o=t[u],e.Tl[o]=n;return e.Tl},f.prototype.CHe=function(t,n){var i=this.options.partitions&&this.options.partitions.some(function(t){return(0,T.isRelation)(t.field)}),i;i=(i=i||this.options.orders&&this.options.orders.some(function(t){return(0,T.isRelation)(t.field)}))||t.wHe(n,function(t){return(0,T.isString)(t)&&(0,T.isRelation)(t)}),this.SHe=i},f.prototype.Sve=function(){var t,n,i,r,t=this,n=t.options,i=t.Ave={};if((0,T.isArray)(n.orders))for(r=0;r<n.orders.length;r++)i[n.orders[r].field]={}},f.prototype.Tve=function(){var t=this,n=t.options.windowFormula,i=[e.ROWNUMBER,e.WRANK,e.DENSERANK,e.WPERCENTRANK,e.CUMEDIST,e.LEAD,e.LAG,e.NTILE,e.FIRSTVALUE,e.LASTVALUE,e.NTHVALUE];t.Ive=!i.some(function(t){return-1<n.indexOf(t)})},f.prototype.nMt=function(t,n,i,r,e,o,u){var s,t,n,s=this;return s.calcSource.pe(t,n,i,void 0,r,e,o),(t=7===arguments.length)&&s.calcSource.wEt("extendContext",u),n=s.calcService.evaluateExpression(s.calcSource,s.expression,{row:0,col:0}),t&&s.calcSource.wEt("extendContext"),n},f.prototype.ede=function(t,n,i,r,e,o,u,s){var c=this,f=c.tde.valueCache,a,o;!(0,T.isNullOrUndefined)(f)||-1===n&&-1===i||(c.tde.begin=(0,T.isNumber)(e)?e:n,o=c.nMt(t,n,i,o,u,s,c.tde),(0,T.isNumber)(r)&&(n=i=r),f=c.tde.valueCache,(0,T.isNullOrUndefined)(f)||(o=f,n=e,i=void 0),c.XBt(t,o,n,i))},f.prototype.xve=function(t){return this.Ave[t]},f.prototype.Nve=function(t,n,i){var r=n[i];return r=void 0===r?n[i]=this.calcSource.nM._getValueByField(t,i):r},f.prototype.evaluateWindowFunction=function(t,n){var i=this;i.ide(t,n||0),i.rde(),i.nde=!1},f.prototype.rde=function(){this.tde.begin=void 0,this.tde.valueCache=void 0},f.prototype.ide=function(t,n){var i=this,r=i.options.windowFrame;r&&r.begin&&-1===r.begin.offset&&r.end&&-1===r.end.offset||(i.Ive?i.ode(i.options.windowFrame,t,n):i.ede(t,n,void 0,void 0,n))},f.prototype.ode=function(t,n,i){for(var r,e,o,u,s,r=this,e={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},o=r.ube(n,i),u=i,s=n.length;u<s;u++)r.Khe(t,i,u,n,e,o),r.ede(n,e.startIndex,e.endIndex,u,i,e.gapStartIndex,e.gapEndIndex,e.currentIndex)},f.prototype.Khe=function(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,t,d,t,u=this,l=x.WindowOverFrameExcludeMode.none;(e.gapStartIndex=e.gapEndIndex=e.currentIndex=void 0,T.isNullOrUndefined)(t)?a=(0,T.isNullOrUndefined)(u.options.orders)||0===u.options.orders.length?(s=x.WindowOverFrameType.ROWS,c=x.WindowOverFramePreceding.UnBounded,x.WindowOverFrameFollowing.UnBounded):(s=x.WindowOverFrameType.RANGE,c=x.WindowOverFramePreceding.UnBounded,x.WindowOverFrameFollowing.CurrentRow):(s=t.type,l=t.exclude||l,d=t.begin,t=t.end,d?(c=d.type,f=d.offset):c=x.WindowOverFramePreceding.UnBounded,t?(a=t.type,h=t.offset):a=x.WindowOverFrameFollowing.CurrentRow,s!==x.WindowOverFrameType.RANGE&&s!==x.WindowOverFrameType.GROUPS||!(0,T.isNullOrUndefined)(u.options.orders)&&0!==u.options.orders.length||(s=x.WindowOverFrameType.ROWS,c=x.WindowOverFramePreceding.UnBounded,a=x.WindowOverFrameFollowing.UnBounded)),d=r.length-1,s===x.WindowOverFrameType.RANGE?(e.startIndex=e.lastStartIndex,e.endIndex=e.lastEndIndex,c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.ude(c,f,n,d,i,r,-1===e.startIndex?i+1:e.startIndex,!0):e.startIndex=u.ade(c,f,n,i,r,-1===e.startIndex?n:e.startIndex),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.ade(a,h,n,i,r,-1===e.endIndex?n:e.endIndex,!0):e.endIndex=u.ude(a,h,n,d,i,r,-1===e.endIndex?i+1:e.endIndex),e.startIndex>e.endIndex?(e.startIndex=-1,e.endIndex=-1):(u.Dme(c,a,n,d,e),e.lastStartIndex=e.startIndex,e.lastEndIndex=e.endIndex,u.bwe(r,e,i,l))):s===x.WindowOverFrameType.GROUPS?(t=u.wwe(o,i),c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.ywe(c,f,d,i,o,t,!0):e.startIndex=u.Mwe(c,f,n,i,o,t),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.Mwe(a,h,n,i,o,t,!0):e.endIndex=u.ywe(a,h,d,i,o,t),u.Dme(c,a,n,d,e),u.Cwe(e,i,l,o&&o[t])):s===x.WindowOverFrameType.ROWS&&(c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.cde(c,f,d,i):e.startIndex=u.sde(c,f,n,i),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.sde(a,h,n,i):e.endIndex=u.cde(a,h,d,i),u.Dme(c,a,n,d,e),u.Swe(r,e,i,l))},f.prototype.Twe=function(t,n){t.startIndex<=n&&n<=t.endIndex&&(t.startIndex===n&&t.endIndex===n?(t.startIndex=-1,t.endIndex=-1):t.startIndex===n?t.startIndex=n+1:t.endIndex===n?t.endIndex=n-1:(t.gapStartIndex=n,t.gapEndIndex=n))},f.prototype.bwe=function(e,t,n,i){var o,r,u,s,c,f,a,h,l,d,v,p,w,b,m,j,o=this;if(i===x.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(i!==x.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,u=(r=o.options.orders)&&0<r.length){for(s=[],h=[],l=[],v=d=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)d=r[b].field,v=o.xve(d),h.push(d),l.push(v),s.push(o.Nve(d,v,p));c=function(t){return e[t]},f=function(t,n){return o.Nve(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,T.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==o.Nve(h[r],l[r],n)){i=!0;break}return!i}}i===x.WindowOverFrameExcludeMode.group?u&&t.startIndex<=n&&n<=t.endIndex&&(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===D&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===D&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),t.startIndex>t.endIndex)&&(t.startIndex=-1,t.endIndex=-1):i===x.WindowOverFrameExcludeMode.ties&&u&&t.startIndex<=n&&n<=t.endIndex&&(m=D,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=D,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===D&&j===D?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===D?t.gapStartIndex=n+1:j===D?t.gapEndIndex=n-1:t.currentIndex=n)}},f.prototype.Cwe=function(t,n,i,r){var e,o,u,e=this;(0,T.isNullOrUndefined)(r)||(i===x.WindowOverFrameExcludeMode.current?e.Twe(t,n):i===x.WindowOverFrameExcludeMode.group?(o=r.begin,u=r.end,t.startIndex<o&&u<t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=u):t.startIndex===o&&t.endIndex===u?(t.startIndex=-1,t.endIndex=-1):t.startIndex<=u&&t.startIndex>=o?t.startIndex=u+1:t.endIndex<=u&&t.endIndex>=o&&(t.endIndex=o-1)):i===x.WindowOverFrameExcludeMode.ties&&(o=r.begin,u=r.end,t.startIndex===o&&t.endIndex===u?(t.startIndex=n,t.endIndex=n):t.startIndex<=o&&u<=t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=u,t.currentIndex=n):t.startIndex<=u&&t.startIndex>=o?n<t.startIndex?t.startIndex=u+1:(t.gapStartIndex=t.startIndex,t.gapEndIndex=u,t.currentIndex=n):t.endIndex<=u&&t.endIndex>=o&&(n>t.startIndex?t.endIndex=o-1:(t.gapStartIndex=o,t.gapEndIndex=t.endIndex,t.currentIndex=n))))},f.prototype.Swe=function(e,t,n,i){var o,r,u,s,c,f,a,h,l,d,v,p,w,b,m,j,o=this;if(i===x.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(i!==x.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,u=(r=o.options.orders)&&0<r.length){for(s=[],h=[],l=[],v=d=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)d=r[b].field,v=o.xve(d),h.push(d),l.push(v),s.push(o.Nve(d,v,p));c=function(t){return e[t]},f=function(t,n){return o.Nve(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,T.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==o.Nve(h[r],l[r],n)){i=!0;break}return!i}}i===x.WindowOverFrameExcludeMode.group?(!u||(t.startIndex<n&&n<t.endIndex?(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===D&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===D&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0)):n<=t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==D&&(t.startIndex=j+1):n>=t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==D&&(t.endIndex=m-1),t.startIndex>t.endIndex))&&(t.startIndex=-1,t.endIndex=-1):i===x.WindowOverFrameExcludeMode.ties&&(u?(t.startIndex<=n&&n<=t.endIndex?(m=D,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=D,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===D&&j===D?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===D?t.gapStartIndex=n+1:j===D?t.gapEndIndex=n-1:t.currentIndex=n):n<t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==D&&(t.startIndex=j+1):n>t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==D&&(t.endIndex=m-1),t.startIndex>t.endIndex&&(t.startIndex=-1,t.endIndex=-1)):(t.startIndex=n,t.endIndex=n))}},f.prototype.Dme=function(t,n,i,r,e){t===x.WindowOverFramePreceding.UnBounded?n===x.WindowOverFramePreceding.NPreceding?-1!==e.startIndex&&-1===e.endIndex&&(e.startIndex=-1):n===x.WindowOverFrameFollowing.NFollowing&&-1!==e.startIndex&&-1===e.endIndex&&(e.endIndex=r):t===x.WindowOverFramePreceding.NPreceding?n===x.WindowOverFramePreceding.NPreceding||n===x.WindowOverFramePreceding.CurrentRow?-1===e.startIndex&&-1!==e.endIndex&&(e.startIndex=i):n!==x.WindowOverFrameFollowing.NFollowing&&n!==x.WindowOverFrameFollowing.UnBounded||(-1===e.startIndex&&(e.startIndex=i),-1===e.endIndex&&(e.endIndex=r)):t===x.WindowOverFramePreceding.CurrentRow?n===x.WindowOverFrameFollowing.NFollowing&&-1===e.endIndex&&(e.endIndex=r):t===x.WindowOverFrameFollowing.NFollowing&&(n===x.WindowOverFrameFollowing.NFollowing?-1!==e.startIndex&&-1===e.endIndex?e.endIndex=r:-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1):n===x.WindowOverFrameFollowing.UnBounded&&-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1))},f.prototype.sde=function(t,n,i,r){var e;switch(t){case x.WindowOverFramePreceding.UnBounded:e=i;break;case x.WindowOverFramePreceding.NPreceding:e=i<=(e=r-G(n))?e:-1;break;default:x.WindowOverFramePreceding.CurrentRow;e=r}return e},f.prototype.cde=function(t,n,i,r){var e;switch(t){case x.WindowOverFrameFollowing.UnBounded:e=i;break;case x.WindowOverFrameFollowing.NFollowing:e=(e=r+G(n))<=i?e:-1;break;default:x.WindowOverFrameFollowing.CurrentRow;e=r}return e},f.prototype.Mwe=function(t,n,i,r,e,o,u){var s,c,c;switch(t){case x.WindowOverFramePreceding.UnBounded:s=i;break;case x.WindowOverFramePreceding.NPreceding:s=i,(0,T.isNullOrUndefined)(e)||(c=e[o-G(n)],s=(0,T.isNullOrUndefined)(c)?-1:u?c.end:c.begin);break;case x.WindowOverFramePreceding.CurrentRow:s=r,(0,T.isNullOrUndefined)(e)||(c=e[o],s=u?c.end:c.begin);break;default:s=r}return s},f.prototype.ywe=function(t,n,i,r,e,o,u){var s,c,c;switch(t){case x.WindowOverFrameFollowing.UnBounded:s=i;break;case x.WindowOverFrameFollowing.NFollowing:s=i,(0,T.isNullOrUndefined)(e)||(c=e[o+G(n)],s=(0,T.isNullOrUndefined)(c)?-1:u?c.begin:c.end);break;case x.WindowOverFrameFollowing.CurrentRow:s=r,(0,T.isNullOrUndefined)(e)||(c=e[o],s=u?c.begin:c.end);break;default:s=r}return s},f.prototype.ade=function(t,n,i,r,e,o,u){var s,c,f,a,h,l,d,v,p,d,w,b,m,j,y,g,_,O,S,C,F,R,I,m,N,s=this,f=s.options.orders;switch(t){case x.WindowOverFramePreceding.NPreceding:if(n=G(n),c=i,1===f.length&&i<=(c=r))if(a=f[0].field,h=f[0].ascending,l=s.xve(a),d=s.Nve(a,l,e[r]),(0,T.isNullOrUndefined)(d)){if(v=e[r-1],d!==(p=s.Nve(a,l,v)))return c;c=o}else(0,T.isNumber)(d)&&(d=!1===h?d+n:d-n,w=function(t){return s.Nve(a,l,e[t])},m=e[b=r-1],c=(y=(j=!(0,T.isNumber)(m)||r===i)||(!1===h?d<s.Nve(a,l,m):d>s.Nve(a,l,m)))?u?j?-1:b:r:u?!1===h?P(w,d,o,b,!0):A(w,d,o,b):!1===h?A(w,d,o,b,!0):P(w,d,o,b));break;case x.WindowOverFramePreceding.UnBounded:c=i;break;default:x.WindowOverFramePreceding.CurrentRow;if(i<(c=r)){if(1===f.length){if(g=f[0].field,_=s.xve(g),O=s.Nve(g,_,e[r]),v=e[r-1],O!==(S=s.Nve(g,_,v)))return c}else{for(O=[],C=[],F=[],_=g=void 0,R=e[r],I=0;I<f.length;I++)g=f[I].field,_=s.xve(g),C.push(g),F.push(_),O.push(s.Nve(g,_,R));for(v=void 0,m=O.length-1,v=e[r-1],N=m;0<=N;N--)if(O[N]!==s.Nve(C[N],F[N],v))return c}c=o}}return c},f.prototype.ude=function(t,n,i,r,e,o,u,s){var c,f,a,h,l,d,v,p,w,b,m,j,v,y,g,_,O,g,S,C,F,R,I,N,E,y,M,c=this,a=c.options.orders;switch(t){case x.WindowOverFrameFollowing.NFollowing:n=G(n),f=r,1===a.length&&(h=a[0].field,l=a[0].ascending,d=c.xve(h),v=c.Nve(h,d,o[e]),p=function(t){return c.Nve(h,d,o[t])},(0,T.isNullOrUndefined)(v)?(w=!0,e!==i&&(b=o[e-1],w=!(0,T.isNumber)(b)||v!==c.Nve(h,d,b)),f=u,w&&(m=o[e+1],f=(j=!(0,T.isNumber)(m)||v!==c.Nve(h,d,m))?e:V(p,u,r,!1===l))):(0,T.isNumber)(v)&&(v=!1===l?v-n:v+n,m=o[y=e+1],f=(j=(g=!(0,T.isNumber)(m)||e===r)||(!1===l?v>c.Nve(h,d,m):v<c.Nve(h,d,m)))?s?g?-1:y:e:s?!1===l?A(p,v,u,r,!0):P(p,v,u,r):!1===l?P(p,v,u,r,!0):A(p,v,u,r)));break;case x.WindowOverFrameFollowing.UnBounded:f=r;break;default:x.WindowOverFrameFollowing.CurrentRow;if(1===a.length)_=a[0].field,O=c.xve(_),g=c.Nve(_,O,o[e]),p=function(t){return c.Nve(_,O,o[t])},w=!0,e!==i&&(b=o[e-1],w=!(0,T.isNumber)(b)||g!==c.Nve(_,O,b)),f=u,w&&(m=o[e+1],f=(j=!(0,T.isNumber)(m)||g!==c.Nve(_,O,m))?e:L(p,g,u,r));else{for(S=[],C=[],F=[],I=R=void 0,N=o[e],E=0;E<a.length;E++)R=a[E].field,I=c.xve(R),C.push(R),F.push(I),S.push(c.Nve(R,I,N));y=function(t){var n,i,r,n=o[t],i=!(0,T.isNumber)(n);if(!i)for(r=a.length-1;0<=r;r--)if(S[r]!==c.Nve(C[r],F[r],n)){i=!0;break}return i},f=u,w=!0,(w=e!==i?y(e-1):w)&&((j=y(e+1))||(f=k(M=function(t){return o[t]},p=function(t,n){return c.Nve(C[n],F[n],t)},S,u+1,r))===D)&&(f=e)}}return f},f.prototype.ube=function(t,n){var i,r,e,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,i=this,r=i.options.orders,e=i.options.windowFrame&&i.options.windowFrame.type;if(r&&0<r.length&&e===x.WindowOverFrameType.GROUPS){if(e=t[n],o=[{begin:n,end:n}],1<t.length-n){for(u=[],s=[],c=[],a=f=void 0,h=e,l=r.length-1,d=0;d<=l;d++)f=r[d].field,a=i.xve(f),s.push(f),c.push(a),u.push(i.Nve(f,a,h));for(d=n+1,v=t.length;d<v;d++){for(p=t[d],w=[],b=!0,m=0;m<=l;m++)j=i.Nve(s[m],c[m],p),w.push(j),u[m]!==j&&(b=!1);b?o[o.length-1].end=d:(u=w,o[o.length]={begin:d,end:d})}}return o}},f.prototype.wwe=function(t,n){var i,r,e;if(!(0,T.isNullOrUndefined)(t))for(i=0,r=t.length;i<r;i++)if((e=t[i]).begin<=n&&n<=e.end)return i},n.WindowOverCalcField=f,n.addWindowOverFormulas=v,n.processWindowOverFormula=p,n.hasWindowOverFormulas=w,n.isWindowOverFormula=b,n.getWindowOverFormulas=m,n.deconstructWindowOverFunction=j,n.parseWindowOverByOption=C},"./dist/src/undo/changesHelper.js":function(t,n,i){"use strict";var r,c,e;function o(t){this.zQt=t,this.P8=0,this.G8=[]}r=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ChangesHelper=void 0,c=i("./dist/src/undo/interface.js"),o.prototype.$Be=function(){return{inTransaction:this.P8,changes:r([],this.G8,!0)}},o.prototype.tGe=function(t){var n=t.inTransaction,t=t.changes;this.P8=n,this.G8=t},o.prototype.VAe=function(){this.P8++},o.prototype.zAe=function(){this.P8=Math.max(this.P8-1,0)},o.prototype.lM=function(){return 0<this.P8},o.prototype.nGe=function(t){if(this.lM())return this.G8.push(t),this.G8},o.prototype.eGe=function(){return r([],this.G8,!0)},o.prototype.iGe=function(){this.G8=[]},o.prototype.Mtt=function(t){var n,i,r,e,o,u,o,i=t.type;if(i===c.ViewChangeType.Update||i===c.ViewChangeType.Insert)return this.rGe(t);if(i===c.ViewChangeType.DefineColumnRemoveColumn||i===c.ViewChangeType.DefineColumnModifyColumn||i===c.ViewChangeType.DefineColumnAddColumn||i===c.ViewChangeType.UpdateColumn||i===c.ViewChangeType.UpdateColumnName||i===c.ViewChangeType.DeleteColumn||i===c.ViewChangeType.AddColumn||i===c.ViewChangeType.MoveColumnOptions||i===c.ViewChangeType.MoveColumnInfos||i===c.ViewChangeType.RemoveCrossFields||i===c.ViewChangeType.RemoveColumnInfoOptions||i===c.ViewChangeType.UpdateCrossColumnIndex)this.oGe(t);else if(i===c.ViewChangeType.SortUpdate)this.zQt.aGe(t.oldData.sortInfo,t.oldData.indexMap);else if(i===c.ViewChangeType.DetailColumnsVisible)this.zQt.detailColumnsVisible(t.oldData);else if(i===c.ViewChangeType.PinnedRows||i===c.ViewChangeType.PinnedColumns)this.uGe(t);else if(i===c.ViewChangeType.StyleRuleChanges)for(e in this.zQt.clearStyleRules(),r=null!=(n=t.oldData)?n:{})r.hasOwnProperty(e)&&(u=(o=r[e]).style,o=o.rule,this.zQt.addStyleRule(e,u,o));else i===c.ViewChangeType.TableSheetColumnDataTypeChanged||i===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged?this.sGe(t):i!==c.ViewChangeType.HierarchyLevelChanged&&i!==c.ViewChangeType.RowDataChanged&&i!==c.ViewChangeType.MovedUpdateOrDown||this.cGe(t)},o.prototype.cGe=function(t){var n,n,t,n=t.type;n===c.ViewChangeType.HierarchyLevelChanged?this.zQt.fGe(t.oldData):n===c.ViewChangeType.RowDataChanged?this.zQt.lGe(t.oldData):n===c.ViewChangeType.MovedUpdateOrDown&&(n=t.moveIndex,t=t.destIndex,this.zQt.m7t(n,t))},o.prototype.sGe=function(t){var n=t.type,t=t.oldData;n===c.ViewChangeType.TableSheetColumnDataTypeChanged?(this.zQt.hGe(t.columnValue,t.oldData),this.zQt.updateColumnDataType(t.columnValue,t.oldDataType)):n===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged&&this.zQt.updateColumnIsPrimaryKeyType(t.columnValue,t.oldIsPrimaryKey)},o.prototype.rGe=function(t){var n=t.type;if(n===c.ViewChangeType.Update)this.zQt.updateItem(t.modelIndex,t.oldData,null,null,{isModelIndex:!0});else if(n===c.ViewChangeType.Insert)return this.zQt.removeItems([t.index])},o.prototype.oGe=function(t){var n,i,r,e,o,u,s,i,e,r,u,n=t.type;n===c.ViewChangeType.UpdateColumn?this.zQt.yBe(t.oldData,t.isInfo):n===c.ViewChangeType.UpdateColumnName?this.zQt.dGe(t.newName,t.oldName):n===c.ViewChangeType.DeleteColumn?this.zQt.vGe(t.index,t.oldData,t.isInfo,t.isField):n===c.ViewChangeType.AddColumn?this.zQt.removeColumn(t.newData.value):n===c.ViewChangeType.DefineColumnRemoveColumn?this.zQt.vBe(t):n===c.ViewChangeType.DefineColumnModifyColumn?this.zQt.bBe(t):n===c.ViewChangeType.DefineColumnAddColumn?this.zQt.uBe(t):n===c.ViewChangeType.MoveColumnOptions?this.zQt.DPt(t.to,t.from):n===c.ViewChangeType.MoveColumnInfos?(i=t.to,r=t.from,e=t.count,s=u=void 0,s=(o=i<r)?(u=i,r+e-1):(u=i-e+1,r),this.zQt.OPt(u,s,t.count)):n===c.ViewChangeType.RemoveCrossFields?this.zQt.gGe(t.oldData):n===c.ViewChangeType.UpdateCrossColumnIndex?(i=t.data.map(function(t){var n=t.oldIndex,i;return{oldIndex:t.newIndex,newIndex:n}}),this.zQt.wLt(i)):n===c.ViewChangeType.RemoveColumnInfoOptions&&(r=(e=t.oldData).columnInfoOptions,u=e.options,this.zQt.mGe(r,u))},o.prototype.uGe=function(t){var n=t.oldData,t=t.type;t===c.ViewChangeType.PinnedRows?(this.zQt.pGe(),this.zQt.togglePinnedRows(this.bGe(n.pinnedRows))):t===c.ViewChangeType.PinnedColumns&&(this.zQt.wGe(),this.zQt.togglePinnedColumns(n.pinnedColumns))},o.prototype.bGe=function(t){var n,i=this.zQt.iRt;return t.map(function(t){return i.indexOf(t)})},n.ChangesHelper=o},"./dist/src/undo/interface.js":function(t,n){"use strict";var i,n;Object.defineProperty(n,"__esModule",{value:!0}),n.ViewChangeType=void 0,(n=i=n.ViewChangeType||(n.ViewChangeType={})).Update="update",n.Insert="insert",n.UpdateColumn="updateColumn",n.UpdateColumnName="updateColumnName",n.DeleteColumn="deleteColumn",n.AddColumn="addColumn",n.DefineColumnAddColumn="createColumn",n.DefineColumnRemoveColumn="removeColumn",n.DefineColumnModifyColumn="modifyColumn",n.MoveColumnOptions="moveColumnOptions",n.MoveColumnInfos="moveColumnInfos",n.SortUpdate="sortUpdate",n.DetailColumnsVisible="detailColumnsVisible",n.PinnedRows="pinnedRows",n.PinnedColumns="pinnedColumns",n.StyleRuleChanges="styleRuleChanged",n.TableSheetColumnDataTypeChanged="tableSheetColumnDataTypeChanged",n.TableSheetColumnIsPrimaryKeyChanged="tableSheetColumnIsPrimaryKeyChanged",n.RemoveCrossFields="removeCrossFields",n.RemoveColumnInfoOptions="removeColumnInfoOptions",n.UpdateCrossColumnIndex="updateCrossColumnIndex",n.HierarchyLevelChanged="hierarchyLevelChanged",n.RowDataChanged="rowDataChanged",n.MovedUpdateOrDown="movedUpdateOrDown"},"./dist/src/view/view-cross.js":function(t,n,i){"use strict";var n,r,u,e,w,i,s;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),u=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/viewField/fieldManager.js"),w=i("./dist/src/undo/interface.js"),i=n.Common.lt.Dh,s=void 0,i(r.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n){var i=this;i.lLt&&i.lLt.removeCrossFieldValues(t,n)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){var i,r;return"string"==typeof t&&(i=!0,r=t,i=!(!(0,u.isNullOrUndefined)(this.LEt.cross)&&(t=this.LEt.cross[r],!(0,u.isNullOrUndefined)(t)))&&i)&&(t={over:r,attributes:[""]}),(0,e.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,u.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some(function(t){return t.cross})},wLt:function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,p;for(void 0===n&&(n=!0),i=this,r=[],e=function(n,t){r.push({newIndex:t,columnInfos:i.yLt.filter(function(t){return t.RBt===n}),fields:i.lLt?i.lLt.getFields(function(t){return t.initialOptionIndex===n}):[]})},o=0,u=t;o<u.length;o++)e(c=(s=u[o]).oldIndex,f=s.newIndex);for(a=function(t,n,i){t.forEach(function(t){return t.RBt=i}),n.forEach(function(t){return t.initialOptionIndex=i})},h=0,l=r;h<l.length;h++)a(v=(d=l[h]).columnInfos,p=d.fields,f=d.newIndex);n&&this.AGe.nGe({type:w.ViewChangeType.UpdateCrossColumnIndex,data:t})},MLt:function(){var n=this,t;return n.CLt.map(function(t){return n.SLt(t)})},TLt:function(t,n){var i,r,e,e,o,u,o,u,s,o,i=this,r=i.MLt(),e=i.ALt(r);if(0<e.length&&(t=e[t],n=e[n]),(e=i.ILt[t])&&"string"==typeof e.cross){if(o=i.ILt[t-1]||{},u=i.ILt[t+1]||{},o.cross===e.cross||u.cross===e.cross)return!0;if(o=i.ILt[n],u=i.ILt[t<n?n+1:n-1]||{},o.cross===e.cross||u.cross===e.cross)return!0}return s=function(t,n){return-1<r.indexOf(t)?s(t+n,n):t},(o=function(t,n){var t=i.ILt[s(t,-1)]||{},n=i.ILt[s(n,1)]||{};if("string"==typeof t.cross&&t.cross===n.cross)return!0})(t-1,t+1)||(t<n?o(n,n+1):o(n-1,n))},xLt:function(t){for(var i,r,n,e,o,i=this,r=0,n=function(t){return t&&0===t.length?s:t},e={lastFilterInfo:(0,u.clone)(i.NLt),lastSortInfo:(0,u.clone)(i.kLt),lastSortInfoBeforeGroup:(0,u.clone)(i.DLt),lastSortInfoAfterGroup:(0,u.clone)(i._Lt),columnInfos:(0,u.clone)(i.yLt)},o=function(){var n=i.yLt[r];n.RBt===t?(i.NLt=i.NLt&&i.NLt.filter(function(t){return t.field!==n.value}),i.kLt=i.kLt&&i.kLt.filter(function(t){return t.field!==n.value}),i.DLt=i.DLt&&i.DLt.filter(function(t){return t.field!==n.value}),i._Lt=i._Lt&&i._Lt.filter(function(t){return t.field!==n.value}),i.yLt.splice(r,1),i.lLt&&i.lLt.removeFields(r,1,function(t){var n;e.fields=null!=(n=e.fields)?n:t})):r++};r<i.yLt.length;)o();i.NLt=n(i.NLt),i.kLt=n(i.kLt),i.DLt=n(i.DLt),i._Lt=n(i._Lt),this.AGe.nGe({type:w.ViewChangeType.RemoveCrossFields,oldData:e})},gGe:function(t){var n,i,r,e,o,u,t,n=this,i=t.lastFilterInfo,r=t.lastSortInfo,e=t.lastSortInfoAfterGroup,o=t.lastSortInfoBeforeGroup,u=t.fields,t=t.columnInfos;n.NLt=i,n.kLt=r,n._Lt=e,n.DLt=o,n.yLt=t,u&&n.lLt.yGe(u)},ELt:function(){var i=this;i.ILt.forEach(function(t,n){(0,u.isNullOrUndefined)(t.cross)||((0,u.isNullOrUndefined)(t.LBt)&&(t.LBt=n),i.yLt[n].LBt=t.LBt)})}})},"./dist/src/view/view-event.js":function(t,n,i){"use strict";var n,O,w,i,n,r,b;function a(n){var t,i,r,e,o,u,s,t=[],i=[],r=Object.keys(w.Events);if((0,O.isArray)(n))for(e=function(n){(r.some(function(t){return t===n})?t:i).push(n)},o=0,u=n;o<u.length;o++)e(s=u[o]);else(r.some(function(t){return t===n})?t:i).push(n);return[t,i]}Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),O=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/table/tableEvents.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,b=void 0,n(i.View.prototype,{bind:function(t,n){var i=this,t=a(t),r=t[0],t=t[1];0<t.length&&(i.jLt(t,n),this.gLt.bind(t,n)),0<r.length&&this.D3(r,this.OLt(n),n)},D3:function(t,n,i){var r,n,r=this,n=r.RLt(n);r.jLt(t,n,null,i),r.gLt.bind(t,n)},unbind:function(t,n){var i,r,e,o,u,s,c,f,i=this,r=a(t),e=r[0],o=r[1];if(0<o.length)for(i.nge(o,n),u=0;u<o.length;u++)s=o[u],this.gLt.unbind(s,n);if(0<e.length&&(c=this.nge(e,null,null,n),i.gLt))for(f=0;f<c.length;f++)i.gLt.unbind(t,c[f])},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},Dge:function(t){for(var n,i,t,r,e,o,u,s,n=this,i=n.gLt.name,t=(0,O.isArray)(t)?t:[t],r=n.BLt[i]=n.BLt[i]||{},e=[],o=0,u=t;o<u.length;o++)s=u[o],e=e.concat(r[s]||[]);return e},jLt:function(t,n,i,r){var e,o,u,s,c,f,a,h,h,f,e=this;if(n)for(o=(i||e.gLt).name,c=u=(s=0,O.isArray)(t)?t:[t];s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&(h=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],(0,O.isNullOrUndefined)(r)||(f=(0,O.isFunction)(r)?r:r[f],a.ege=f),h.push(a))},nge:function(t,n,i,r){var e,o,i,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,e=this,o=(i||e.gLt).name,i=(0,O.isArray)(t)?t:[t],u=[];if((0,O.isNullOrUndefined)(r))if(n)for(s=0,c=i;s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&-1<(d=(l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[]).indexOf(a))&&(u=u.concat(l.splice(d,1)));else for(v=0,p=i;v<p.length;v++)for(f=p[v],l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],h[f]=[],w=0;w<l.length;w++)b=l[w],u.push(b);else for(m=0,j=i;m<j.length;m++){for(f=j[m],l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],y=[],g=(0,O.isFunction)(r)?r:r[f],w=0;w<l.length;w++)(b=l[w]).ege===g&&y.push(w);for(_=y.length-1;0<=_;_--)u=u.concat(l.splice(d=y[_],1))}return u},OLt:function(o){var u=this;return function(t,n){var i,r,e;if(u.LLt(n),(0,O.isArray)(o))for(i=0,r=o;i<r.length;i++)(e=r[i]).call(u,t,n);else o&&o.call(u,t,n)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,O.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(i){var r=this;return function(t,n){r.PLt()&&i.call(r,t,n)}},PLt:function(t){return!0===t?this.rb--:!1===t&&this.rb++,this.rb=Math.max(this.rb,0),this.rb<1},GLt:function(n,i){var r=this;return r.PLt(!1),{success:function(t){r.PLt(!0),n&&n(t)},fail:function(t){r.PLt(!1),i&&i(t)}}},v7:function(){var e=this;e.D3(w.Events.ItemInserting,function(t,n){var i=n.index,n=n.data;e.ULt(n),i===e.length()&&e.Dit()&&e.HLt(n,i)}),e.D3(w.Events.ItemInserted,function(t,n){var i=n.index,n=n.data;e.zLt(i,n)}),e.D3(w.Events.ItemUpdating,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.kwe(i,n,r)}),e.D3(w.Events.ItemUpdated,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.YLt(i,n,r)}),e.D3(w.Events.ItemReset,function(t,n){var i=n.index,r=n.originalData,n=n.dataBeforeChanged;e.ZLt(i,r,n)}),e.D3(w.Events.ItemRemoved,function(t,n){var i=n.index,n=n.count;e.WLt(i,n)}),e.D3(w.Events.ChangesSubmitted,function(t,n){e.QLt()}),e.D3(w.Events.ChangesCancelled,function(t,n){e.KLt(n.isDataLengthChanged)})},wpt:function(){var t,n,i,r,e,o,u,s,c,f,t=this,n=t.BLt;for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])if(r.hasOwnProperty(e))for(u=0,s=o=r[e];u<s.length;u++)c=s[u],(f=t.gLt.QOt.tables[i])&&f.unbind(e,c);t.BLt={}},$Ot:function(t){var n,i,r,e,o,u,s,c,f,n,i=this.BLt,r=t.name,e=i[r];for(o in e)if(e.hasOwnProperty(o))for(s=0,c=u=e[o];s<c.length;s++)f=c[s],t&&t.unbind(o,f);i[r]=b},KOt:function(t,n){var i,r,e,i,r=this.BLt,e=r[t];delete r[t],r[n]=e},jge:function(t,n){for(var i,r,e,o,u,i=this,r,e=0,o=i.Dge(n.eventName);e<o.length;e++)u=o[e],(0,O.isNullOrUndefined)(u.ege)||u.call(i,t,n)},JLt:function(){var t,n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w;if(this.XLt()){for(i=(n=t=this).name,r=t.yLt,e=t.gLt,o=[],u=0,s=r;u<s.length;u++)if(c=s[u],(0,O.isFunction)(c.value)||(0,O.isFormula)(c.value)||!(0,O.isRelation)(c.value)){if(0<(f=this.gLt.Gbe(c.value)).length)for(a=0,h=f;a<h.length;a++)l=h[a],this.gLt.MHe(l,o)}else o.push(c.value);for(d=0,v=o;d<v.length;d++)w=e.qRt(p=v[d]),!(0,O.isNullOrUndefined)(w)&&(0,O.isNullOrUndefined)(w.VOt[i])&&(w.VOt[i]=n,t.qLt(w))}},qLt:function(i){var v,p,t,l,d,t,o,v=this,p=v.gLt,t=p.QOt.relationships.reduce(function(t,n){return n.sourceTable===p&&n.targetTable===i?{relationshipName:n.sourceRelationshipName,relationFieldName:n.sourceFieldName}:n.sourceTable===i&&n.targetTable===p?{relationshipName:n.targetRelationshipName,relationFieldName:n.targetFieldName}:t},{}),l=t.relationshipName,d=t.relationFieldName,t=function(t,h){var n=v.RLt(function(o,u){var i,t,n,s,n,r,e,c,f,a,n,i=function(t,n){var t=t.value.split(".");return t[t.length-1-n]},t=v.ILt.filter(function(t){return(0,O.isRelation)(t.value)&&i(t,1)===l}),n=t;if(u.eventName!==w.Events.ItemUpdating&&u.eventName!==w.Events.ItemUpdated||(n=n.filter(function(n){return u.changingFields.some(function(t){return i(n,0)===t})})),s=[b],n.forEach(function(n){var t,i,r,e,t=!(0,O.isNullOrUndefined)(n.cross);t?(r=("string"==typeof n.cross?v.LEt.cross[n.cross]:n.cross).over,(0,O.isNullOrUndefined)(v.NLt)||-1<(e=(0,O.findIndex)(v.NLt,function(t){return-1<t.field.indexOf(n.value)&&-1<t.field.indexOf(r)}))&&(i=v.NLt[e].field)):v.$Lt(n.value)&&s.push(n.value),h.call(v,n.value,t,i)(o,u)}),u.eventName===w.Events.ItemInserted||u.eventName===w.Events.ItemRemoved||u.eventName===w.Events.ItemUpdated){if(u.eventName===w.Events.ItemUpdated&&(n=u.changingFields.some(function(t){return d===t}),r=t.some(function(t){if(!(0,O.isNullOrUndefined)(t.cross)){var n=("string"==typeof t.cross?v.LEt.cross[t.cross]:t.cross).over.split(".").pop();if(u.changingFields.some(function(t){return n===t}))return!0}return!1}),n||r))for(f=e=p.nBt(t[c=0].value,u.index);c<f.length;c++)a=f[c],v.vLt(a);(0<(n=v.Cde(!0))[0].length||0<n[1].length)&&v.pme(),v.tFt(b,!0,s,b)}v.jge(o,u)});v.jLt(t,n,i),i.bind(t,n)},o=function(t,n,i,r){var e,e,e,o,u,s,c,f,a,h,a,l,d;if(v.Dit())for(u=0,s=o=r.relatedViewIndexes||p.nBt(t,r.index);u<s.length;u++)c=s[u],h=a=f=void 0,h=n?(v.vLt(c),f=p.LRt(i,c),(e={})[i]=f,a=e,v.nFt(c,((e={})[i]=!0,e))[i]):(f=p.LRt(t,c),(e={})[t]=f,a=e,p._getValueByField(t,c)),a=v._we(c,a),v.iFt(a,f,t,c),v.hRt(c,t,f,h),p.hRt(c,t,f,h);else if(n)for(l=0,d=o=r.relatedViewIndexes||p.nBt(t,r.index);l<d.length;l++)c=d[l],v.vLt(c)};t(w.Events.ItemRemoving,function(i,r){return function(t,n){r&&(n.relatedViewIndexes=p.nBt(i,n.index))}}),t(w.Events.ItemRemoved,function(i,r,e){return function(t,n){o(i,r,e,n)}}),t(w.Events.ItemInserted,function(i,r,e){return function(t,n){o(i,r,e,n)}}),t(w.Events.ItemUpdating,function(f,a,h){return function(t,n){var i,i,r,e,o,u,s,c,c;if(v.Dit())for(r=n.relatedViewIndexes=p.nBt(f,n.index),n.relatedViewValues=[],e=0,o=r;e<o.length;e++)u=o[e],c=s=void 0,a?s=(c=v.nFt(u,((i={})[h]=!0,i)))[h]:(s=p._getValueByField(f,u),(i={})[f]=s,c=i),c=v._we(u,c),n.relatedViewValues[u]=s,v.iFt(c,s,f,u)}}),t(w.Events.ItemUpdated,function(f,a,h){return function(t,n){var i,r,e,o,u,s,c;if(v.Dit())for(e=0,o=r=n.relatedViewIndexes||p.nBt(f,n.index);e<o.length;e++)u=o[e],s=n.relatedViewValues[u],c=void 0,a?(c=v.nFt(u,((i={})[h]=!0,i))[h],f=h):c=p._getValueByField(f,u),v.hRt(u,f,s,c),p.hRt(u,f,s,c)}})}})},"./dist/src/view/view-filter.js":function(t,n,i){"use strict";var m,o,v,n,d,r;function p(t){return e(t[0])}function e(t){return t&&void 0!==t.Vce}function u(t,n){for(var i=0,r=t.length;i<r;i++)if(!s(t[i],n[i]))return;return 1}function s(t,n){for(var i,r,e,o,e,i=["field","value","operator","relation"],r=0;r<i.length;r++)if(!((o=t[e=i[r]])===(e=n[e])||(0,m.isNullOrUndefined)(o)&&(0,m.isNullOrUndefined)(e)))return;return t.ort===n.ort}function w(t,n){for(var i,r,e,o,u,i={},r=0;r<t.length;r++)if(!i[e=t[r].field]){for(o=i[e]=[],u=r;u<t.length;u++)t[u].field===e&&o.push(t[u]);n(e,o)}}Object.defineProperty(n,"__esModule",{value:!0}),m=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/table/table.js"),v=i("./dist/src/view/view-util.js"),n=i("Common"),d=i("./dist/src/view/view.js"),(r=n.Common.lt.Dh)(d.View.prototype,{buildInFilter:function(s){var c,f,a,h,t,l,n,i,r,e,i,o,u,c=this.gLt,f={};if(1<s.length){for(a=[],h=[],t=function(r){var t,n,i,e,t,o,u,t=s[r],n=t.field,i=t.operator,e=t.value,t=t.relation,o=f[n];o=o||(f[n]=c.jRt(n)),h.push(t),u=(0,d.rFt)(l.gLt,l.yLt,l.lLt,n,s[r]),u=(0,v.mapGetValueFunc)(o,u),u=(0,v.oFt)(l,i,e,u),a.push(function(t,n,i){return u(t,i,n[r])})},l=this,n=0;n<s.length;n++)t(n);return(0,v.aFt)(a,h)}return r=(i=s[0]).field,e=i.operator,i=i.value,o=c.jRt(r),u=(0,d.rFt)(this.gLt,this.yLt,this.lLt,r,s[0]),u=(0,v.mapGetValueFunc)(o,u),u=(0,v.oFt)(this,e,i,u,r),function(t,n,i){return u(t,i,n[0])}},uFt:function(t){var n=this,i=n.ZOt,r;return n.gLt.ZOt[t]||i[t]},eRt:function(t,n){var i=this,r=i.gLt,e=i.yLt,o,u=[],s=[];t.forEach(function(n){(o=e.filter(function(t){return t.value===n})[0])&&((0,v.isViewColumn)(o)?u:s).push(n)}),r.eRt(s,n),i.sFt(u)},sFt:function(t){for(var n,i,r,e,o,n,i=this.ZOt,r=0,e=t;r<e.length;r++)i[o=e[r]]||(i[o]=this._Rt(o))},cFt:function(t){var n=this;t?(delete n.ZOt[t],n.gLt.ARt(t)):n.ZOt={}},_Rt:function(t){var n=this.lLt.getFieldByName(t);return(0,o.generateFilterIndexCache)(t,(0,m.isNullOrUndefined)(n)?0:this.length(),this.jRt(t),function(t){return n.getValue(t)})},cRt:function(t,n){var i=this,r,e=i.gLt._dataSource.options.schema;i.Yce(t),(0,o.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,e&&e.columns)},hRt:function(t,n,i,r){var e=this;e.Yce(t,!1,n),e.fge(n),(0,o.updateFilterIndexesCacheOnUpdate)(e.ZOt,t,n,i,r,e.jRt(n))},pRt:function(t,n,i){var r,e,o,u,s,s,r=this,e=r.yLt;if(!(0,m.isNullOrUndefined)(n)&&!(0,m.isNullOrUndefined)(i))for(o=0,u=e;o<u.length;o++)s=(s=u[o]).value instanceof Function?s.value.name:s.value,r.hRt(t,s,n[s],i[s])},MRt:function(t,n){var i=this;i.Zce(t,n),(0,o.updateFilterIndexesCacheOnRemove)(i.ZOt,t,n)},fFt:function(t){var i,r,e,n,o,u,s,c,f,a,h,l,d;if(t){if(r=(i=this).iRt,e=[],o=(n=i.lFt).length,n&&0<o&&(e=r.slice(0,o)),u=o,"string"==typeof t)for(s=i.Ywt(t,0,0),c=o;c<r.length;c++)f=r[c],!0===i.nMt(s,f,0)&&(e[u]=f,u++);else if("function"==typeof t)for(c=o;c<r.length;c++)f=r[c],t(i.getRowData(f,!0))&&(e[u]=f,u++);else{if(r.length!==i.length())return i.Wce(),void i.Qce(t,e,r);for(d in(0,m.isArray)(t)||(t=[t]),(0,m.isNullOrUndefined)(i.Jce)&&(i.Jce={}),a=i.isHierarchy(),i.qce(t,function(t,n){i.Qce(n,e,r.slice()),a&&p(n)&&i.afe(n),i.tfe(t,n)}),h=[],l=function(n){t.some(function(t){return t.field===n})?a&&p(i.Jce[n].options)||h.push(n):delete i.Jce[n]},i.Jce)l(d);e=i.nfe(h)}i.iRt=e}},Qce:function(t,r,n){var e,i,o,u,s,c,f,a,h,l,d,e=this,i=(e.lFt||[]).length,o=i;for((0,m.isArray)(t)||(t=[t]),s=[],c=[],f=0;f<t.length;f++)a=t[f],((0,v.isFieldListFilterInfo)(a)?s:c).push(a);if(h=r,l=n,0<s.length&&(h=r.slice(),w(t=s,function(t,n){var t=t,i=e.uFt(t);i||(e.eRt([t]),i=e.uFt(t)),(0,v.hFt)(h,o,i,n,l),l=h,h=r.slice()}),h=l),0<c.length)for(h=r.slice(),t=c,u=this.buildInFilter(t),f=i;f<l.length;f++){d=l[f];try{u(e.gLt,t,d)&&(h[o]=d,o++)}catch(t){}}e.iRt=h},tfe:function(t,n){var i,r,e,o,i=this;if(!(0,m.isNullOrUndefined)(t))for(r=i.lFt||[],e=i.Jce[t]={options:n,count:i.iRt.length-r.length},o=r.length;o<i.iRt.length;o++)e[i.iRt[o]]=!0},afe:function(i){for(var r,e,t,n,o,u,s,c,f,a,h,l,d,v,p,w,b,r=this,e=[],t=function(t){var n=i[t];e.push(r.yLt.find(function(t){return t.value===n.field}))},n=0;n<i.length;n++)t(n);for(o=r.lFt||[],u=r.iRt.slice(0,o.length),n=o.length;n<r.iRt.length;n++)if(s=r.iRt[n],0===(c=r.getHierarchyNode(s,!0)).children.length)for(f=function(t,n){return(0,m.formatCalcError)(r.ufe(t,n))},a=r.ufe.bind(r),h=0;h<i.length;h++){for(d="="===(l=i[h]).field[0]?f:a,v=c,p=0;p<l.Vce.length&&(w=l.Vce[p],(b=d(e[h],v.modalIndex))===w);p++)v=v.parent;if(p===l.Vce.length){u.push(s);break}}r.iRt=u},Wce:function(){this.Jce=null},Yce:function(t,n,i){var r,e,o,u,s,c,f,a,h,r=this,e=r.Jce;if(e&&!(-1<(o=r.lFt||[]).indexOf(t))){for(s in u=r.iRt,e)((0,m.isNullOrUndefined)(i)||s===i||!1===n&&r.EJe(s,i)&&!r.gLt.Pbe(s))&&(f=(c=e[s]).options,a=u.slice(0,o.length),h=u.slice(0,o.length).concat(t),r.Qce(f,a,h),-1<r.iRt.indexOf(t)?c[t]||(c[t]=!0,c.count+=1):c[t]&&(delete c[t],--c.count));r.iRt=u}},fge:function(t){var n,i,r,e,o,u,s,c,f,n=this,i=n.Jce;if(i&&!n.mme()){for(o in r=n.lFt||[],e=n.iRt,i)(0,m.isFormula)(o)&&((0,m.isNullOrUndefined)(t)||n.EJe(o,t))&&n.gLt.Pbe(o)&&(s=(u=i[o]).options,c=e.slice(0,r.length),f=e.slice(),n.Qce(s,c,f),(u=n.iRt).count=n.iRt.length,u.options=s);n.iRt=e}},Zce:function(t,n){var i,r,e,o,u,s,c,f,a,i=this,r=i.Jce;if(r&&!(-1<(e=i.lFt||[]).indexOf(t)))for(o in r)if(r.hasOwnProperty(o)){for(s=(u=r[o]).options,delete u.options,delete u.count,c=Object.keys(u),f=0;f<c.length;f++)t+n<=(a=+c[f])?c[f]=a-n:t<=a&&a<t+n&&(c.splice(f,1),f--);(u=c.reduce(function(t,n){return t[n]=!0,t},{})).options=s,u.count=c.length,r[o]=u}},nfe:function(t){var n,i,r,e,o,u,s,c,n=this;if(0<t.length){if(i=n.lFt||[],r=n.iRt,e=n.Jce,1===t.length&&r.length-i.length===e[t[0]].count)return r;for(o=r.slice(0,i.length),u=i.length;u<r.length;u++){for(s=r[u],c=0;c<t.length&&e[t[c]][s];c++);c===t.length&&o.push(s)}return o}return n.iRt},dFt:function(){var t,n,i,r,e,o,u,s,t=this.iRt;for(t||(this.gFt(),t=this.iRt),r=(i=this.lFt).length,i&&0<r&&(n=t.slice(0,r)),e=[],o=this.length(),s=u=0;s<o;s++)(!n||n.indexOf(s)<0)&&(e[u]=s,u++);n&&0<n.length?this.iRt=n.concat(e):this.iRt=e,this.cFt()},HLt:function(t,n){var i=this,r=i.NLt;i.Dit()&&i.autoFilter&&(0,v.addFilterInfoForFieldValue)(r,t,i,void 0,void 0,n)},iFt:function(t,n,i,r){var e=this,o=e.NLt;e.Dit()&&e.autoFilter&&(0,v.addFilterInfoForFieldValue)(o,t,e,n,i,r)},vFt:function(t){var n=this;n.mFt(t)&&n.filter(n.NLt)},mFt:function(t){return(t||this.autoFilter)&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,m.isArray)(n)&&0<n.length},xGe:function(t){var n,i,r,t,n=this;if(n.Dit())return i=n.NLt,r=n.ife(t),t=!1,n.NLt=i.filter(function(t){return t.field!==r}),0===n.NLt.length&&(t=!(n.NLt=null)),n.cFt(r),t},TGe:function(t,n){var i,r,e,o,u,s,c,f,i=this;if(i.Dit()){if(r=i.NLt,e=i.ife(t),o=i.ife(n),t.type!==n.type||t.dataType!==n.dataType)return i.xGe(n),!0;if(e!==o){for(u=!1,s=0,c=r;s<c.length;s++)(f=c[s]).field===o&&(f.field=e,u=!0);u&&i.cFt(o)}}},filter:function(t){var n=this;return n.iRt||n.gFt(),t&&(!(0,m.isArray)(t)||0<t.length)?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():(this.dFt(),n.bde()),this.NLt=(0,m.isArray)(t)&&0<t.length?t:null,this.iRt.length},$ce:function(){var i=this;i.bFt().forEach(function(t){var n;i.getHierarchyNode(t,!0).modalIndex=t})},yFt:function(t){var n,i,r,e,o,u,s,c,f,t,a,n=this,i=n.iRt;if(!(0,m.isNullOrUndefined)(i)&&0!==i.length){for(t||n.$ce(),r=[],e=1,o=0;o<i.length;o++)u=i[o],(s=n.getHierarchyNode(u,!0)).visit=e,(0,m.bubbleTree)(s,function(t){t.isRoot||(t.visit=e)}),(0,m.traversalTree)(s,function(t){t.visit=e});for(f in n.Jce)if(p(n.Jce[f].options)){c=n.Jce[f];break}if(!(0,m.isNullOrUndefined)(c)){for(u in e=2,t=c.options,a=c.count,delete c.options,delete c.count,c)c.hasOwnProperty(u)&&(s=n.getHierarchyNode(+u,!0),(0,m.isNumber)(s.visit))&&(s.visit=e,(0,m.bubbleTree)(s,function(t){t.isRoot||(t.visit=e)}));c.options=t,c.count=a}(0,m.traversalTree)(n.getHierarchyRootNode(),function(t){t.visit===e&&(r.push(t.modalIndex),delete t.visit,delete t.modalIndex)}),n.iRt=r}},bFt:function(){var t=this,n=t.iRt,i,r=t.isHierarchy(),i=t.wFt;return r&&!(0,m.isNullOrUndefined)(i)||(t.gFt(),t.sort(t.kLt),i=t.iRt,t.iRt=n,r&&(t.wFt=i)),i},qce:function(t,e){var o=this;(0,m.isNullOrUndefined)(o.Jce)&&(o.Jce={}),w(t,function(t,n){var i=o.Jce[t],r;!(0,m.isNullOrUndefined)(i)&&i.options.length===n.length&&u(i.options,n)||e(t,n)})}})},"./dist/src/view/view-group.js":function(t,n,i){"use strict";var r,e,b,m,j,y,g,o,i,u,d;function c(c,f,a){for(var h,l,d,v,p,t,n,w,i,r,e,h=[],l=-1,d=-1,v=g.GROUP_COLUMN_WIDTH,p={},t=function(t){for(var n,i,r,e,n=c[t],i=0,r=a.length;i<r;i++)e=a[i],n.value===e.field&&(n.GFt=!0,n.OFt=i,p[(0,y.combineName)(n.value,(0,b.findIndex)(a,function(t){return t.field===n.value}))]={colInfo:n,index:t})},n=0;n<c.length;n++)t(n);for(i=function(t,n){var i,r,e,o,u,s,i=f.getField(w[t]),r=i.name,e,o={caption:i.extra.caption,value:r,name:r,Kyn:i.key,isGroup:!0};-1<(d=(0,b.findIndex)(a,function(t,n){return(0,y.combineName)(t.field,n)===r}))&&(v=(0,g.getGroupColumnWidth)(a[d].field,c),l=d,o.DFt=!0,u=p[r],(0,b.isNullOrUndefined)(u)||(u.colInfo._Ft=t,o._Ft=u.index+n)),o.RJe=!o.DFt&&(0,m.isGroupSummary)(o.value),o.LJe=!o.RJe&&(0,m.isGroupSlice)(o.value),o.OFt=l,o.width=v,(s=i.extra)&&(0,j.setFieldExtraProperties)(function(t){(0,b.isNullOrUndefined)(s[t])||(o[t]=s[t])}),h.push(o)},r=0,e=(w=f.groupFieldKeys).length;r<e;r++)i(r,e);return h}function w(t,n,i){for(var i,r,e,o,u,s,c,f,i=i?i.length:0,r={},e=i;e<t.length;e++)r[t[e]]=!0;for(o=0,u=i,s=n.length,c=t.length;o<s&&u<c;o++)r[f=n[o]]&&(t[u]=f,u++)}function _(t,n){var i,r,e,o,u;if(t&&0<t.length){for(i=[],r=n.length,0<(e=t.length)&&(i=t.slice(0)),o=e,u=0;u<r;u++)-1===t.indexOf(n[u])&&(i[o]=n[u],o++);return i}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.ise=void 0,r=i("Common"),e=i("./dist/src/view/view.js"),b=i("./dist/src/dataSource/utils.js"),m=i("./dist/src/viewField/groupManager.js"),j=i("./dist/src/viewField/fields.js"),y=i("./dist/src/viewField/utils.js"),g=i("./dist/src/view/view-util.js"),o=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,u=null,d=void 0,n.ise=c,i(e.View.prototype,{groupBy:function(t){var n,i,n=this;return 0===arguments.length||!(0,b.isArray)(t)||n.hasHierarchyColumn()||0===(t=0<(i=n.yLt.filter(function(t){return t.isCross})).length?t.filter(function(n){return!i.some(function(t){return t.value===n.field})}):t).length?n.MFt:(n.iRt||n.gFt(),n.CFt(t),void(this.MFt=t))},windowOver:function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,r=this,e=!1,u=function(){return o=!r.iRt||(e=r.iRt.length!==r.length())?r.qFt():r.iRt.slice()},s=r.gLt.fme(),c=!1,f=!1,o=!s||(c=r.vde(),f=r.Dit(),i)||c||f?u():(r.iRt||r.gFt(),r.iRt);if((0,b.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,o=r.mde(t,o).indexMap;else for(a=0;a<n.length;a++)for(l=(h=n[a]).orders,(0,b.isArray)(l)&&0<l.length&&r.gde(o,l),d=h.functions,v=0;v<d.length;v++)(p=r.gLt.XOt[d[v].windowOverFormula]).evaluateWindowFunction(o);!s||c&&!e||(f?i||w(r.iRt,o,r.lFt):r.iRt=_(r.lFt,o))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=u,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,i,r,e,o,u,s,c,f,t=this,n=t.gLt,i=t.NLt,r=t.ZOt,e=t.getColumnInfos();if(i){for(f=i.length-1;0<=f;f--)o=i[f],(u=e.filter(function(t){return t.name===o.field})[0]).DFt?(s=(0,g.getColumnName)(e[u._Ft]),(c=r[o.field])&&(n.ZOt[s]=r[o.field],delete r[o.field]),o.field=s):u.isGroup&&(i.splice(f,1),delete r[o.field]);t.NLt=0===i.length?d:i}},xFt:function(){var t,n,i,r,e,t=this;if(t.kLt){for(n=[],i=0,r=t.kLt;i<r.length;i++)delete(e=r[i]).EFt,e.jFt?(0,m.isGroupField)(e.field)&&(delete e.jFt,delete e.OFt,e.field=(0,m.getGroupFieldName)(e.field),n.push(e)):n.push(e);t.kLt=0===n.length?d:n}t._Lt=d,t.DLt=t.kLt},uii:function(t){var n,i,r,t,n=this;if(n.IGe())return i=n.MFt,r=n.ife(t),t=!1,n.MFt=i.filter(function(t){return t.field!==r}),0===n.MFt.length?t=!(n.MFt=u):i.forEach(function(t){t.summaryFields&&0<t.summaryFields.length&&t.summaryFields.forEach(function(t){var n,n;t.slice&&(n=(n=void 0,b.isString)(t.slice)?t.slice:t.slice.field)===r&&delete t.slice})}),t},kGe:function(t,n){var i,r,e,t,o,u,s,c,i=this;if(i.IGe())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else for(u=0,s=o=i.MFt;u<s.length;u++)(c=s[u]).field===e&&(c.field=r),c.summaryFields&&c.summaryFields.forEach(function(t){t.slice&&(t.slice===e?t.slice=r:t.slice.field===e&&(t.slice.field=r))})},CFt:function(t){var n,i,r,i,r,i;t&&((n=this).kFt(),r=(i=n.mde(t)).rootNode,i=i.indexMap,n.FFt=r,n.iRt=i,r=n.yLt.slice(),i=n.yLt.filter(function(t){return t.isGroup}),n.JJe(t),n.KJe(r,i))},JJe:function(t){this.SFt(),this.TFt(t)},KJe:function(t,i){var n,r,e,o,u,s,c,f,a,h,l,n=this,r=!1,e=n.yLt.filter(function(t){return t.isGroup});if(0<e.length)for(o=function(n){e.some(function(t){return t.value===n.value})||(n.FJe=!0,r=!0)},u=0,s=i;u<s.length;u++)o(c=s[u]);if(f=!1,0<i.length)for(a=function(n){i.some(function(t){return t.value===n.value})||(n.nme=!0,f=!0)},h=0,l=e;h<l.length;h++)a(c=l[h]);r||f?(n.BJe=t,n.PJe||(n.PJe=t)):n.BJe=d,(0===i.length&&0<e.length||0<i.length&&0===e.length)&&(n.BJe=d,n.PJe=d)},mde:function(t,n){var i,n,r,e,o,i,t,i=this,n=n||i.iRt,r=i.lLt||i.RFt(),e=i.BFt||i.LFt(t),o=n;return i.length()>n.length?((0,b.isNullOrUndefined)(i.Efe)&&(i.Efe=i.qFt()),o=i.Efe):i.Efe=d,i=r.buildGroupFields(t,o),t=e.groupBy(i,n),r.transposeSliceFields(i),t},kFt:function(){var t,n,n=this;(n.BFt=null)!=(t=n.lLt)&&t.reset(),n.FFt=null},pde:function(t,n){var i=this,n=(n||this.autoGroup)&&this.MFt;return n&&((0,b.isString)(t)?i.$Lt(t):!((0,b.isArray)(t)&&0<t.length)||t.some(function(t){return i.$Lt(t)}))},PFt:function(t,n){var i=this;i.pde(t,n)&&i.CFt(i.MFt)},IGe:function(){var t,n=this.MFt;return(0,b.isArray)(n)&&0<n.length},$Lt:function(n,i){var r,e,r=this,e=function(t){return i?!(0,b.isFormula)(t)&&t===n:r.EJe(t,n)};return r.MFt&&r.MFt.some(function(t){return e(t.field)||t.summaryFields&&t.summaryFields.some(function(t){return!i&&t.formula&&r.EJe(t.formula,n)||t.slice&&("string"==typeof t.slice?e(t.slice):t.slice.field&&e(t.slice.field))})})},LFt:function(t){var n=this,i=n.gLt,r=i.POt;return n.BFt=new m.GroupManager(t,r.wEt.bind(r),i.QOt,n.gde.bind(n)),n.BFt},SFt:function(t){for(var n,i,r,e,n=this,i=n.getColumnInfos(),r=i.length-1;0<=r;r--)(e=i[r]).isGroup&&i.splice(r,1),e.GFt&&(!1!==t&&(e.GFt=d),e._Ft=d);n.setColumnInfos(i)},TFt:function(t){var n,i,r,e,o,u,s,n=this;if(n.$Je()){for(i=c(n.yLt,n.lLt,t),r=n.UFt,o=0,u=e=n.getColumnInfos();o<u.length;o++)s=u[o],r||(s.visible=!1),i.push(s);n.setColumnInfos(i)}},HFt:function(t){var i,n,r,e,o,u,s,c,f,a;if(t){for(n=(i=this).FFt,r=[],e=i.yLt,o=Array.isArray(t)?t:[t],u=[],s=[],c=function(t){var n,t,n=o[t],t=e.filter(function(t){return t.value===n.field})[0];(t&&(0,b.isNumber)(t.OFt)?(n.jFt=!0,n.EFt=i.zFt([n]),n.OFt=t.OFt,u):s).push(n)},f=0;f<o.length;f++)c(f);a=i.zFt(s),s.forEach(function(t){return t.EFt=a}),i.VFt(n,r,0,u,s),i.iRt=r}},VFt:function(t,n,i,r,e){var o,t,u,s,c,f,a,h,l,d,v,p,w,o=this,t=t.childrenArray&&t.childrenArray[0];if(t)for(1<t.length&&0<r.length&&0<(c=r.filter(function(t){return t.OFt===i})).length&&(f=c[0].EFt,t.sort(function(t,n){return f(o.gLt,c,t.recordRowNumbers&&t.recordRowNumbers[0],n.recordRowNumbers&&n.recordRowNumbers[0])})),a=0,h=t;a<h.length;a++)if(v=!(d=(l=h[a]).childrenArray)||!d[0]||0===d[0].length)for(1<(s=l.recordRowNumbers).length&&0<e.length&&(f=(c=e)[0].EFt,s.sort(function(t,n){return f(o.gLt,c,t,n)})),u=n.length,p=0,w=s.length;p<w;p++)n[u+p]=s[p];else o.VFt(l,n,i+1,r,e)},setGroupSliceColumnSettings:function(t,n){var i=this,r=t[n];t.isGroup&&i.isGroupSliceColumn(t)&&i.getGroupSliceColumns(t).forEach(function(t){return t[n]=r})},isGroupSliceColumn:function(t){return t.isGroup&&(0,m.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,i,r,e,o,u,n,i=[],r=t.OFt,e=this.yLt;if(t.isGroup)for(o=0;o<e.length;o++)(u=e[o]).OFt===r&&(0,m.isGroupSlice)(u.value)&&i.push(u);return i},updateColumnSettingToGroupOptions:function(t,r){var n,i,e,o,u,n,i=this.MFt;if(i&&t.isGroup)switch(o=function(n,i){(0,j.setFieldExtraProperties)(function(t){!(0,b.isNullOrUndefined)(r)&&r!==t||(n[t]=i[t])})},(e=(0,m.getGroupOptionIndexesFrom)(t.value)).length){case 1:o(i[e[0]],t);break;case 2:o(i[e[0]].summaryFields[e[1]],t);break;case 3:o(u="string"==typeof(u=i[e[0]].summaryFields[e[1]].slice)?i[e[0]].summaryFields[e[1]].slice={field:u}:u,t)}},detailColumnsVisible:function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.UFt;if(n.UFt!==t){if(i=n.UFt,n.UFt=t,n.BFt)for(r=n.getColumnInfos(),e=0;e<r.length;e++)r[e].isGroup||(r[e].visible=t);this.AGe.nGe({type:o.ViewChangeType.DetailColumnsVisible,oldData:i})}}})},"./dist/src/view/view-sort.js":function(t,n,i){"use strict";var e,r,p,w,b,o,i,u;function s(r){return r.iRt.reduce(function(t,n){var i=r.getHierarchyNode(n,!0);return(0,p.isNullOrUndefined)(i)||(t[i.id]=n),t},{})}function c(n,i){return function(t){(0,p.isNullOrUndefined)(n[t.id])||i.push(n[t.id])}}function m(t,n,i,r,e){for(var o,u,s,c,o={},u=(0,w.rFt)(t,n,i,e,o,!1),s=0;s<r.length;s++)if(c=u(o,s,o),!(0,p.isNullOrUndefined)(c)&&!(0,p.isCalcError)(c))return c;return null}function j(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,v;if(1===e.length)return o=o||0,u=e[0],s=(0,w.rFt)(t,n,i,u.field,u),c=void 0,c=u.compare?function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return n[o].compare(i,t,n[o].ascending)}:null===(f=m(t,n,i,r,u.field))?function(){return 0}:(a=u.ascending,h=u.list,(0,p.isArray)(h)&&0<h.length?(l=h.reduce(function(t,n,i){return t[n]=i,t},{}),function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return(0,b.compareListValue)(a,f,i,t,l)}):function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return(0,b.compareValue)(a,f,i,t)});for(d=0;d<e.length;d++)u=e[d],(v=(0,w.ZFt)(t,n,u.field)).isGroup&&(0,p.isNullOrUndefined)(u.ascending)&&(u.compare=function(t,n){return t===n?0:1}),u.WFt=j(t,n,i,r,[u],d);return b.multiSort}function f(t){return!t.gLt.fme()||t.Dit()}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ese=void 0,r=i("Common"),p=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/view/view.js"),b=i("./dist/src/view/view-util.js"),o=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,u=void 0,n.ese=j,i(w.View.prototype,{zFt:function(t,n){return j(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){var n;t&&((n=this).isHierarchy()?(n.wFt=null,n.DLt=(0,b.getSortInfos)(t),n.KFt(t)):n.MFt?(n._Lt=(0,b.getSortInfos)(t),n.HFt(t)):(n.DLt=(0,b.getSortInfos)(t),n.JFt(t)))},JFt:function(t){var n,i,r,e,o,u,u,o,o;t&&(r=(i=(n=this).lFt).length,u=void 0===(u=(o=(e=Array.isArray(t)?t:[t])[0]).startRow)?0:u,o=void 0===(o=o.endRow)?n.length():o,n.gde(n.iRt,t,r+u,o))},gde:function(t,n,i,r){var e,o,u,s,c,f;if(n&&(e=this,0!==(o=Array.isArray(n)?n:[n]).length))if(u=e.zFt(o),r=r||t.length,0===(i=i||0)&&r>=t.length)t.sort(function(t,n){return u(e.gLt,o,t,n)});else for((s=t.slice(i,r)).sort(function(t,n){return u(e.gLt,o,t,n)}),c=0,f=s.length;c<f;c++)t[c+i]=s[c]},XFt:function(){var t,n,i,t=this,n=t.gLt.uBt();return!(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&(i={field:n,ascending:!0},t.isHierarchy()?t.KFt(i):t.JFt(i)),!0):(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)&&t.isHierarchy()?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&t.$Ft(),!0):void 0},KFt:function(i){var r,t,n,e,o,u;i&&(t=(r=this).getHierarchyRootNode(),n=[],e=Array.isArray(i)?i:[i],o=s(r),u=r.zFt(e),e.forEach(function(t){return t.EFt=u}),(0,p.traversalTree)(t,c(o,n),{isOrderChildren:r.tOi,compareFn:function(t,n){return u=(i=e)[0].EFt,(0,p.isNullOrUndefined)(o[t.id])||(0,p.isNullOrUndefined)(o[n.id])?0:u(r.gLt,i,o[t.id],o[n.id])}}),r.iRt=n)},$Ft:function(){var t,n,i,r,t=this,n=t.getHierarchyRootNode(),i=[],r=s(t);(0,p.traversalTree)(n,c(r,i),{field:"sequence",isOrderChildren:!1}),t.iRt=i},NFt:function(t){var n=this;n.tPt(t)&&n.sort(n.kLt)},tPt:function(t){return(t||this.autoSort)&&this.kLt},Pct:function(){var t,n=this.kLt;return(0,p.isArray)(n)&&0<n.length},NGe:function(t){var n,i,r,t,n=this;if(n.Pct())return i=n.kLt,r=n.ife(t),t=!1,n.kLt=i.filter(function(t){return t.field!==r}),0===n.kLt.length&&(n.kLt=void 0),n.DLt&&(n.DLt=n.DLt.filter(function(t){return t.field!==r}),0===n.DLt.length)&&(n.DLt=void 0),n._Lt&&(n._Lt=n._Lt.filter(function(t){return t.field!==r}),0===n._Lt.length)&&(n._Lt=void 0),t=n.kLt||n.DLt||n._Lt?t:!0},jGe:function(t,n){var i,r,e,t,n,t,i,o,u,s,c,f,a,h,l,d,i=this;if(i.Pct())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else{if(n=i.kLt,t=i.DLt,i=i._Lt,n)for(o=0,u=n;o<u.length;o++)(s=u[o]).field===e&&(s.field=r);if(t)for(c=0,f=t;c<f.length;c++)(a=f[c]).field===e&&(a.field=r);if(i)for(h=0,l=i;h<l.length;h++)(d=l[h]).field===e&&(d.field=r)}},sort:function(t){var n,i,r,n=this;n.iRt||n.gFt(),i=this.kLt,r=e([],this.iRt,!0),n.QFt(t),this.kLt=t,this.AGe.nGe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:i,indexMap:r}})},aGe:function(t,n){t?this.sort(t):(this.kLt=void 0,this.DLt=void 0,this._Lt=void 0,this.iRt=n,this.CFt(this.MFt))},_Ge:function(t){this.iRt=t},vde:function(t){var n=this;return n.tPt()||n.pde(t)},bde:function(t,n){var i,r,e,o,u,u,s,u,i=this;if(!i.vde(t)&&(n||f(i))&&i.tme()){for(r=i.getColumnInfos(),e=[],o=r.length-1;0<=o;o--)if(u=r[o],0<(u=i.Gbe(u)).length){u=(s=i.gLt.XOt[u[u.length-1]]).options,(0,p.isArray)(u.partitions)&&0<u.partitions.length&&u.partitions.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})}),(0,p.isArray)(u.orders)&&0<u.orders.length&&u.orders.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})});break}0<e.length&&i.JFt(e)}},DGe:function(){var t,t,n,t=this.OGe(),t=t.sortBefore||t.sortInfo,n=e([],this.iRt,!0);this.AGe.nGe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:t,indexMap:n}})},EGe:function(t){var n=this,t=t||n.autoSort,i=n.DLt&&0<n.DLt.length;t&&i&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt))},RGe:function(t){var n=this,t=t||n.autoSort,i=n._Lt&&0<n._Lt.length;t&&i&&n.HFt(n._Lt)},nPt:function(t,n){var i=this;i.bde(t),i.FGe(n)},FGe:function(t,n){var i,r,t,n,i=this;i.EGe(n),i.PFt(t,n),i.RGe(n),i.BJe&&(r=i.BJe.filter(function(t){return t.FJe}),t=0,n=!1,this.NLt&&(t=this.NLt.length,this.NLt=this.NLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.NLt.length!==t)&&(n=!0),this.kLt&&(t=this.kLt.length,this.kLt=this.kLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.kLt.length!==t)&&(n=!0),this._Lt&&(t=this._Lt.length,this._Lt=this._Lt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this._Lt.length!==t)&&(n=!0),n=!(!this.DLt||(t=this.DLt.length,this.DLt=this.DLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.DLt.length===t))||n)&&i.tFt(u,!0,u,!0)}})},"./dist/src/view/view-status.js":function(t,n,i){"use strict";var o,n,u,i,n,r,o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),u=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,n(i.View.prototype,{BGe:function(t,n){var i,t,n,n,i,i=this;return!(0,u.isNullOrUndefined)(i.LGe)&&(t=i.RJ(t),n=(n=i.Dve(n))&&n.name,!(0,u.isNullOrUndefined)(n))&&(0,u.isNumber)(t)&&(i=i.LGe[n])?i[t]:r},PGe:function(t,n,i){var r,e,t,e,n,e,r,e=this;(0,u.isNullOrUndefined)(e.LGe)||(t=e.RJ(t),n=(e=e.Dve(n))&&e.name,!(0,u.isNullOrUndefined)(n)&&(0,u.isNumber)(t)&&((e=this.LGe[n])?(r=e[t],i?e[t]=o(o({},r),i):r&&delete e[t]):this.LGe[n]=((r={})[t]=o({},i),r)))},GGe:function(t,n){var i,r,t,e,i,i=this,r,t=i.UGe(t).name;n&&(i=(e=i.UGe(n)).name,this.LGe[i]=this.LGe[t]),delete this.LGe[t]},HGe:function(t,n){var i,r,e,o,u,s,c,i,r=this.LGe;if(r)for(e in r)if(r.hasOwnProperty(e))for(o=r[e],u=Object.keys(o),s=0;s<u.length;s++)t+n<=(c=+u[s])?(o[c-n]=o[c],delete o[c]):t<=c&&c<t+n&&delete o[c]},VGe:function(t){var n,i,r,e,o,u,s,n,i=this.LGe;if(i)for(r in i)if(i.hasOwnProperty(r))for(e=i[r],u=(o=Object.keys(e)).length-1;0<=u;u--)t<=(s=+o[u])&&(e[1+s]=e[s],delete e[s])}})},"./dist/src/view/view-style.js":function(t,n,i){"use strict";var e,n,r,o,u,e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),o=i("./dist/src/undo/interface.js"),(u=n.Common.lt.Dh)(r.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var t,n,n=this.getStyleRules();return e({},t?null!=(t=n[t])?t:{}:null!=n?n:{})},addStyleRule:function(t,n,i){var n,r,i,n;t&&(r={},n&&(r.style=n),i&&(r.rule=i),i=null!=(n=this.getStyleRules())?n:{},n=e({},i),i[t]=r,this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:n}))},removeStyleRule:function(t){var n,i,n=this.getStyleRules(),i=e({},n);delete n[t],this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:i})},clearStyleRules:function(){var t,t,t=e({},null!=(t=this.LEt.styleRules)?t:{});this.LEt.styleRules={},this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:t})}})},"./dist/src/view/view-util.js":function(A,e,t){"use strict";var j,f,F,s,c,a,y,R;function u(t,n,i,r){var e,t,e=t?i:r,t=t?r:i;return(0,F.isNullOrUndefined)(e)&&(0,F.isNullOrUndefined)(t)?0:(0,F.isNullOrUndefined)(e)?-1:(0,F.isNullOrUndefined)(t)?1:"number"==typeof n||n instanceof Date?e-t:t<e?1:e<t?-1:0}function n(t,n,i,r,e){var o,e,o=t?e[i]:e[r],e=t?e[r]:e[i];return o!==R&&e!==R?o-e:o!==R?-1:e!==R?1:u(t,n,i,r)}function i(t,n,i,r,e){var o,u;if(i instanceof Date)if(-1<s.indexOf(n))i=i.getTime(),o=r,r=function(t,n,i){return o(t,n,i)&&o(t,n,i).getTime()};else{if(-1<c.indexOf(n))return function(){return!1};if(-1<a.indexOf(n))return function(){return!0}}return u=h(t,n,i,e),function(t,n,i){return u(r(t,n,i))}}function h(t,n,i,r){var e,o,u,s,c,c,c,e=i+"",o=e&&e.length;switch((0,F.isString)(i)&&(u=f.Common.$T.jJ(i)),s=t.gLt,n){case"eq":return c=function(t){return t===i},(0,F.isNullOrUndefined)(i)&&(c=function(t){return t===y||t===R}),u?function(t){return new RegExp("^"+u+"$").test(t)}:c;case"neq":return c=function(t){return t!==i},(0,F.isNullOrUndefined)(i)&&(c=function(t){return t!==y&&t!==R}),u?function(t){return!new RegExp("^"+u+"$").test(t)}:c;case"lt":return function(t){return null!==t&&t<i};case"lte":return function(t){return null!==t&&t<=i};case"gt":return function(t){return i<t};case"gte":return function(t){return i<=t};case"startswith":return u?function(t){return new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)===i};case"doesnotstartwith":return u?function(t){return!new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)!==i};case"endswith":return u?function(t){return new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(i,(t+"").length-o)};case"doesnotendwith":return u?function(t){return!new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(i,(t+"").length-o)};case"contains":return u?function(t){return new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&0<=(t+"").indexOf(i)};case"doesnotcontain":return u?function(t){return!new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(i)<0};case"top":case"bottom":return(c=t.uFt(r))||(t.eRt([r]),c=t.uFt(r)),i=d(Object.keys(c),n,i),function(t){return-1<i.indexOf(t)};case"above":return i=v(l(t,s,r),s.jRt(r)),function(t){return i<t};case"below":return i=v(l(t,s,r),s.jRt(r)),function(t){return t<i};case"quarter":return function(t){return p(i,t)};case"month":return function(t){return(t&&t.getMonth())===i};default:return function(){return!1}}}function l(t,n,i){var n,r,e,o,u;if(!i)return[];if(n=n._dataSource._data[i])return n.data;if(r=t.length(),e=[],o=t.UGe(i,!0,!0))for(u=0;u<r;u++)e.push(t.lKe(u,o));return e}function d(t,n,i){for(var r,e,o,u,r=[],e=0,o=t;e<o.length;e++)u=o[e],isNaN(u)||r.push(parseFloat(u));return i>=r.length||("top"===n?r=b(r,i):"bottom"===n&&(r=_(r,i))),r}function v(t,n){var i,r,e,o,u,i=0;if(!t||0===t.length)return i;for(r=n&&n.dataMap,e=0,o=t;e<o.length;e++)u=o[e],"number"==typeof(u=r&&"number"==typeof r[u]?r[u]:u)&&(i+=u);return i/t.length}function p(t,n){var i=n&&n.getMonth();switch(t){case 0:return i<=2;case 1:return 3<=i&&i<=5;case 2:return 6<=i&&i<=8;case 3:return 9<=i;default:return!1}}function r(t,n,i,r){for(var e,o,u,s,e=0,o=0,u=n.length;o<u&&0===(e=(s=n[o]).WFt(t,n,i,r));o++);return e}function o(t){return Array.isArray(t)?t:[t]}function w(t,n){var i,r;if(0===t.length)return[];for(i=t.slice(0),r=0;r<n;r++)-1===t.indexOf(r)&&i.push(r);return i}function b(t,n){for(var i,r,e,i=m(t.slice(0,n)),r=n;r<t.length;r++)t[r]>i[0]&&(e=i[0],i[0]=t[r],t[r]=e,m(i));return i}function m(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)g(t,i,n);return t}function g(t,n,i){var r,e,o,r,r=2*n+1,e=2*n+2,o=n;r<i&&t[r]<t[o]&&(o=r),n!==(o=e<i&&t[e]<t[o]?e:o)&&(r=t[n],t[n]=t[o],t[o]=r,g(t,o,i))}function _(t,n){for(var i,r,e,i=O(t.slice(0,n)),r=n;r<t.length;r++)t[r]<i[0]&&(e=i[0],i[0]=t[r],t[r]=e,O(i));return i}function O(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)S(t,i,n);return t}function S(t,n,i){var r,e,o,r,r=2*n+1,e=2*n+2,o=n;r<i&&t[r]>t[o]&&(o=r),n!==(o=e<i&&t[e]>t[o]?e:o)&&(r=t[n],t[n]=t[o],t[o]=r,S(t,o,i))}function C(t,n){for(var i,r,e,o,i=0,r=t;i<r.length;i++)if(o=n(e=r[i]))return o}function I(n){var t,i,r,e,t=n.style,i=(i=(t=t||(n.style={})).cellButtons)||(t.cellButtons=[]),r=(r=t.dropDowns)||(t.dropDowns=[]);(e=C(i,function(t){return"openDateTimePicker"===t.command}))?i.forEach(function(t){t.enabled=!n.readonly}):i.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent",enabled:!n.readonly}),(e=C(r,function(t){return"dateTimePicker"===t.type}))||r.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function N(n,t){var i,r,i=(0,F.findIndex)(t,function(t){return E(t)===n});return-1<i&&(r=t[i]).width||e.GROUP_COLUMN_WIDTH}function E(t){var t;return(0,F.isString)(t)||"string"==typeof(t=t.value)?t:"function"==typeof t?t.name:void 0}function M(t){return!t.JOt}function x(t){var n,i,r,e,o,n=M(t);if(n){for(t.WOt++,r=0,e=i=t.eBt();r<e.length&&(!(o=e[r])||o.WOt||(n=x(o)));r++);t.WOt--}return n}function T(t){return t.isGroup||t.isCross}function D(t){return P(t[0])}function P(t){return t.operator===R}function k(t){return t[0].operator!==R&&t[0].ort}function L(h,l,d,v,p,w){for(var b,m,t,n,i,r,b=d.isHierarchy(),m={},t=function(n){var t,i,r,e,o,u,s,c,f,a;if(n&&!m[n.field]&&((0,F.isNullOrUndefined)(p)||n.field===p)){if(m[n.field]=!0,(t=d.uFt(n.field))||(d.eRt([n.field]),t=d.uFt(n.field)),i=t&&Object.keys(t),e=void 0,(r=l[n.field])instanceof Date){for((o=new Date(r)).setHours(0,0,0,0),u=o.toISOString().slice(0,10),e=!0,s=0,c=i;s<c.length;s++)if((f=c[s]).startsWith(u)){e=!1;break}}else e=(0,F.isNullOrUndefined)(r)?-1===i.indexOf("null")&&-1===i.indexOf("undefined"):-1===i.indexOf(r+"");if(!h.some(function(t){return t.field===n.field&&t.value===r})&&e&&(D(h)?(h.push(j(j({},n),{value:r,isAdded:!0})),b&&V(d,h[h.length-1],p,r,w)):(k(h)||r===v&&void 0===v)&&h.push(j(j({},n),{value:r,operator:"eq",relation:"or",isAdded:!0}))),-1<i.indexOf(v+"")&&1===t[v].length&&v!==r)for(a=0;a<h.length;a++)if(h[a].value===v&&h[a].isAdded){h.splice(a,1);break}}},n=0,i=h;n<i.length;n++)t(r=i[n])}function V(t,n,i,r,e){var i,o,u,s;if(n.field===i||(0,F.isNullOrUndefined)(i)){if(i=void 0,n.Vce)(i=n.Vce.slice())[0]=r;else{for(u=(o=t.getHierarchyNode(e,!0)).parent,s=[r];!u.isRoot;)s.push(u.getFieldValue(n.field)),u=u.parent;i=s}n.Vce=i}}function G(t){var n,i,r,e,e;if((0,F.isNullOrUndefined)(t))return t;for(n=[],i=0,r=t;i<r.length;i++)e=r[i],(e=j({},e)).getValue&&delete e.getValue,n.push(e);return n}function B(r,e){var t,o,u,t,o=function(n,i,r,t){return t.every(function(t){return t(n,i,r)})},u=function(){for(var t,n,i,t=[],n=[r[0]],i=1;i<r.length;i++)"or"===e[i]?(t.push(n),n=[r[i]]):n.push(r[i]);return 0<n.length&&t.push(n),t}();return function(n,i,r){return u.some(function(t){return o(n,i,r,t)})}}function q(t,r){var e;return t&&t.dataMap?(e=JSON.parse(JSON.stringify(t.dataMap)),function(t,n,i){var t=r(t,n,i);return void 0!==e[t]?e[t]:t}):r}function U(t,n,i,r,e){var o,u,s,r,c,f,a,h,l,d,v,p,w,b,m,j,o=[],u=!1,s=!1,r=r.map(function(t){var n=t.value;return n===y&&(u=!0),n===R&&(s=!0),t.value});for(u&&!s&&r.push(R),s&&!u&&r.push(y),c=0,f=r;c<f.length;c++)for(a=f[c],l=0,d=h=i&&i[a]||[];l<d.length;l++)o[v=d[l]]=!0;for(p=n,w=t.reduce(function(t,n){return t[n]=!0,t},{}),b=0,m=e;b<m.length;b++)!o[j=m[b]]||0<n&&w[j]||(t[p]=j,p++)}function H(t,n,i,r,e,o,u){var s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,O,S,C,s=[],c=r.map(function(t,n){return n}),f=[];if(e&&e.length&&(a=!(c=[]),r.forEach(function(t,n){-1<o.indexOf(n)?(s.push(n),c.push(R)):(s.push(R),c.push(n)),t.isCross&&(a=!0)}),t=e[t],n=e[n],a)){for(h=[],l=[],d=0;d<r.length;d++)(r[d].isCross?(h[r[d].RBt]||(h[r[d].RBt]=[],f.push(h[r[d].RBt])),v=h[r[d].RBt]):f).push(d),t===d&&(t=f.length-1),n===d&&(n=f.length-1);for(p=0,w=o;p<w.length;p++)b=w[p],l.push(f.indexOf(b));s=[],c=[],f.forEach(function(t,n){-1<l.indexOf(n)?(s.push(n),c.push(R)):(s.push(R),c.push(n))}),i=1}if((0,F.swapArrayItems)(c,t,n,i),c=c.filter(function(t){return!(0,F.isNullOrUndefined)(t)}),e&&e.length){for(d=0;d<s.length;d++)void 0===s[d]&&(s[d]=c.shift());if(f&&f.length){for(m=[],j=0;j<s.length;j++)if(y=s[j],Array.isArray(f[y]))if("string"==typeof(g=u[j].cross)){for(_=[s[j]];j+1<u.length&&g===u[j+1].cross;)_=_.concat(s[j+1]),j++;for(O=f[_[0]].length,S=[],C=0;C<O;C++)for(d=0;d<_.length;d++)S.push(f[_[d]][C]);m=m.concat(S)}else m=m.concat(f[y]);else m.push(f[y]);s=m}}else s=c;return s}j=this&&this.__assign||function(){return(j=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e.ePt=e.hFt=e.mapGetValueFunc=e.aFt=e.removeExtraInfos=e.addFilterInfoForFieldValue=e.isFieldListFilterInfo=e.isFieldListFilter=e.isViewColumn=e.isTableDataReady=e.getColumnName=e.getGroupColumnWidth=e.applyDateTimePicker=e.array_find=e.generatePinnedColumnIndexMap=e.getSortInfos=e.multiSort=e.oFt=e.compareListValue=e.compareValue=e.GROUP_COLUMN_WIDTH=void 0,f=t("Common"),F=t("./dist/src/dataSource/utils.js"),s=["eq","neq","lt","lte","gt","gte"],c=["startswith","doesnotstartwith","endswith","contains"],a=["doesnotendwith","doesnotcontain"],y=null,R=void 0,e.GROUP_COLUMN_WIDTH=100,e.compareValue=u,e.compareListValue=n,e.oFt=i,e.multiSort=r,e.getSortInfos=o,e.generatePinnedColumnIndexMap=w,e.array_find=C,e.applyDateTimePicker=I,e.getGroupColumnWidth=N,e.getColumnName=E,e.isTableDataReady=x,e.isViewColumn=T,e.isFieldListFilter=D,e.isFieldListFilterInfo=P,e.addFilterInfoForFieldValue=L,e.removeExtraInfos=G,e.aFt=B,e.mapGetValueFunc=q,e.hFt=U,e.ePt=H},"./dist/src/view/view.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/view/view.js"),n),e(i("./dist/src/view/view-status.js"),n),e(i("./dist/src/view/view-style.js"),n),e(i("./dist/src/view/view-event.js"),n),e(i("./dist/src/view/view-group.js"),n),e(i("./dist/src/view/view-sort.js"),n),e(i("./dist/src/view/view-filter.js"),n),e(i("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(A,t,n){"use strict";var f,y,S,u,p,r,m,i,g,o,_,s,a,O,e,k;function c(t){return{rule:{area:u.ViewArea.colHeader,direction:u.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function h(t){(0,S.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,S.clone)(e,!0))}function l(t){return t instanceof Date&&!isNaN(t.valueOf())}function d(t){return i.Common.ct.Q0(t)}function v(t){var n=i.Common.ct.dJ(t);return n&&!l(n)&&(n=i.Common.ct._DT(t)),l(n)?n:null}function w(t){var n,i,r,e,n=[],i=t.columns;if(i)for(r in i)i.hasOwnProperty(r)&&("="===(e=(0,S.clone)(i[r])).value[0]&&e.name&&(e.value=e.name),n.push(e));return n}function j(t){return 0===t?"":"_"+t}function b(t,n,i,r){var e,o,r,r;return(0,S.isNullOrUndefined)(i)||(o=i.value,i.isCross||i.isGroup?r&&(r=r.getFieldByName(o))&&(e=r.getValue(n)):o&&("string"==(r=typeof o)?e=F(t,i,n):"function"==r&&(e=i.value(t.iBt(n))))),e}function C(e,a,t,o,i,u,s,c,f,n){var h,l,r,d,v,p,w,b,h={},l=[],r=!!i;if(a.forEach(function(t,n){var i,r,i=t.value;s&&!s[i]||(t.isCross?o&&(h[t.value]=o.getFieldByColumn(t).getValue(u)):t.isGroup?o&&o.kve(h,t,u,c,f):i&&("string"==typeof i?(r=c&&t.caption||i,h[r]=F(e,t,u)):"function"==typeof i&&l.push({name:i.name,caption:t.caption,value:i})))}),0<l.length&&(d=e.iBt(u),l.forEach(function(t){h[t.name]=t.value(d)})),r&&o&&i&&n){for(p in v=o.getFieldValues(u,c,f))!v.hasOwnProperty(p)||f&&s&&!s[p]||(h[p]=v[p]);for(w=function(c){for(var f,t,n,f=i[c].summaryFields,t=function(i){var t,n,t,r,e,o,u,s,t=f[i];if(t&&t.slice){for(n=j(c),t=t.caption+"_"+t.slice+n,r={},o=0,u=e=a.filter(function(t){var n=(0,m.getGroupOptionIndexesFrom)(t.value);return t.isGroup&&3===n.length&&+n[0]===c&&+n[1]===i});o<u.length;o++)r[(s=u[o]).caption]=v[s.value];h[t]=r}},n=0;n<f.length;n++)t(n)},b=0;b<i.length;b++)w(b)}return h}function F(t,n,i){return R(t._getValueByField(n.value,i),n)}function R(t,n){var n=n&&n.dataMap;return t=n?n[t]||t:t}function I(t,n){var i,r,e,o,i=t.value,r=t.dataMap,e=n[i];if(r)for(o in r)if(e===r[o]){n[i]=e=isNaN(o)?o:+o;break}}function N(t,n){var i,r,i=[];for(r in t)t[r]!==n[r]&&i.push(r);return i}function E(t,n){var i,r,i={};for(r in t)n.hasOwnProperty(r)||(i[r]=t[r]);return i}function M(t,n){var i,r,i={};for(r in n)t.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(i[r]=t[r]);return i}function x(t,n,i){for(var r,e,r=0;r<n.length;r++)if((e=n[r]).value===i||e.caption===i)return!t.columns[e.value]||(0,S.isFormula)(t.columns[e.value].value)||(0,S.isFormula)(e.value)?(0,p.isViewColumn)(e)?{value:e.value,isGroup:e.isGroup,isCross:e.isCross}:{value:e.value}:e.value;return i===t.uBt()||t.columns[i]?i:t.XOt[i]?{value:i}:a}function T(r,t,n){return!1!==n&&"="===t[0]?function(t,n,i){return(0,S.formatCalcError)(r(t,n,i))}:r}function L(n,t,i,r,e,o){var u,s,c,f,a,h,l,d,u=x(n,t,r);return e?(0,p.isViewColumn)(u)?(e.getValue=i.getFieldByName(u.value),T(function(t,n,i){return i.getValue.getValue(n)},u.value,o)):u.value?(e.getValue=n.XOt[u.value],(0,S.isNullOrUndefined)(e.getValue)&&(e.getValue={getValue:function(t){return n._getValueByField(u.value,t)}}),T(function(t,n,i){return i.getValue.getValue(n)},u.value,o)):(e.getValue=n._dataSource._data[u].data,n.mTe()?(s={},c=n.nv.bind(n),function(t,n,i){var r=s[n];return r===O&&(s[n]=r=c(n)),i.getValue[r]}):function(t,n,i){return i.getValue[n]}):(f=String(u.value),a=String(u),u.value?T(function(t,n){return t._getValueByField(f,n)},f,o):n.mTe()?(h={},l=n.nv.bind(n),d=n._dataSource._data[a].data,function(t,n){var i=h[n];return i===O&&(h[n]=i=l(n)),d[i]}):function(t,n){return t._dataSource._data[a].data[n]})}function D(t){var n=(0,p.getColumnName)(t);return(0,S.isFormula)(n)&&!(0,S.isNamedFormulaColumn)(t)||(0,S.isRelation)(n)||(0,S.isFunction)(n)}function P(t,n,i,r){void 0===i&&(i=!0),void 0===r&&(r={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.LGe={},this.dme=0,this.rb=0,this.BLt={},this.tKe=!0;var e=this;e.name=t,Object.defineProperty(e,"tableName",{get:function(){var t;return null==(t=e.gLt)?void 0:t.name}}),e.ILt=(0,S.clone)(n=n||[]).map(function(t){return"string"==typeof t?{value:t}:t}),e.yLt=n.map(function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t}),e.aPt=i,e.autoSort=!0,e.autoFilter=!1,e.autoGroup=!0,e.UFt=!0,e.yde=!1,h(r),(e.LEt=r).styleRules||e.clearStyleRules(),this.AGe=new o.ChangesHelper(e)}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},y=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.View=t.rFt=t.ZFt=t.nse=t.tse=t.ose=void 0,S=n("./dist/src/dataSource/utils.js"),u=n("./dist/src/interfaces/interface.js"),p=n("./dist/src/view/view-util.js"),r=n("./dist/src/viewField/fieldManager.js"),m=n("./dist/src/viewField/groupManager.js"),i=n("Common"),g=n("./dist/src/table/windowOverField.js"),o=n("./dist/src/undo/changesHelper.js"),_=n("./dist/src/undo/interface.js"),s=n("./dist/src/dataSource/dataSource.js"),a=null,O=void 0,e={pin:c(u.RowColumnStates.pin),primaryKey:c(u.RowColumnStates.primaryKey),readonly:c(u.RowColumnStates.readonly),required:c(u.RowColumnStates.required)},t.ose=w,t.tse=j,t.nse=C,t.ZFt=x,t.rFt=L,P.prototype.$Je=function(t){if(0===arguments.length)return this.tKe;this.tKe=t,this.lLt&&this.MFt&&this.JJe(this.MFt)},P.prototype.XLt=function(){var t,n=this.gLt;return(0,p.isTableDataReady)(n)},P.prototype.Ywt=function(t,n,i){var r=this.gLt;return r&&r.Ywt(t,n,i)},P.prototype.wde=function(t){var n,i=this.gLt.POt;return i.getCalcService().unparse(i,t,0,0)},P.prototype.nMt=function(t,n,i){var n=this.RJ(n),i=this.uPt(i);return this.sPt(t,n,i)},P.prototype.sPt=function(t,n,i){return this.jfe(t,n,(0,S.isNumber)(i)?(0,p.getColumnName)(this.yLt[i]):O)},P.prototype.jfe=function(t,n,i){var r,e,t,r=this.gLt;if(r)return!(e=!1,S.isNullOrEmpty)(i)&&(0,S.isNullOrUndefined)(r.XOt[i])&&(e=!0,r.XOt[i]=this.lLt.getFieldByName(i)),t=r._fe(t,n,i),e&&delete r.XOt[i],t},P.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=w(n),t.ILt=(0,S.clone)(t.yLt)),t.fPt(),t.lPt())},P.prototype.getTable=function(){return this.gLt},P.prototype.PRt=function(t){var n=this;t?(n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):n.cPt(),t.$he=n.$he.bind(n),n.XLt()&&(n.hPt(),n.dPt=!0,n.yde||(n.yde=!0,n.Mde(),n.$he(),n.gLt.fme())||n.tFt()),n.v7()):(n.wpt(),n.gLt=t)},P.prototype.fPt=function(){var t,t,n,t,i,r,e,o,u,s,c,f,a,h,n=null==(t=null==(t=this.gLt._dataSource.options)?void 0:t.schema)?void 0:t.columns;if(n)for(t=this.yLt,r=(i=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,e=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],o=0,u=t;o<u.length;o++)if("string"==typeof(s=u[o]).value&&(i&&s.value===r&&(s.readonly=!0),c=n[s.value])){for(f=0,a=e;f<a.length;f++)(0,S.isNullOrUndefined)(s[h=a[f]])&&(s[h]=c[h]);s.dataType=c.dataType,"date"===c.dataType&&(0,p.applyDateTimePicker)(s),"formula"===c.dataType&&(s.readonly=!0),i&&"rowOrder"===c.dataType&&(s.readonly=!0),c.n7t&&"rowOrder"!==c.dataType&&(s.readonly=!1,delete c.n7t)}},P.prototype.lPt=function(){for(var t,n,i,r,e,t=this.LEt.defaultColumnWidth||60,n,i=0,r=this.yLt;i<r.length;i++)e=r[i],(0,S.isNullOrUndefined)(e.width)&&(e.width=t)},P.prototype.tme=function(){var n=this,t;return n.yLt.some(function(t){return n.Pbe(t)})},P.prototype.vme=function(){var t=this;return!t.mme()&&t.tme()&&t.gLt.fme()},P.prototype.Pbe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Pbe(t.value)},P.prototype.Gbe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Gbe(t.value)},P.prototype.Xhe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Xhe(t.value)},P.prototype.Cde=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,n=this,i=n.gLt,r=i.XOt,e=[];if(t){if(u=[],o=i.fme())for(s=n.getColumnInfos(O,O,O,!0),c=0;c<s.length;c++)f=s[c],a=n.Gbe(f),u=u.concat(a);for(h in r)if(r.hasOwnProperty(h)&&(l=r[h])instanceof g.WindowOverCalcField&&!1!==l.nde&&!l.options.nme&&(e.push(l.options),l.options.nme=!0,o))for(d=l.options.windowOverFormula.slice(1),v=0;v<u.length;v++)if(-1<(p=u[v]).indexOf(d)){l.options.Sde=!0;break}if(o){for(w=[],b=[],v=0;v<e.length;v++)delete(m=e[v]).nme,(m.Sde?(delete m.Sde,w):b).push(m);return[w,b]}for(v=0;v<e.length;v++)delete(m=e[v]).nme}else for(s=n.getColumnInfos(),c=0;c<s.length;c++)if(f=s[c],0<(j=n.Gbe(f)).length)for(v=0;v<j.length;v++)!1!==(l=r[d=j[v]]).nde&&e.push(l.options);return[e,[]]},P.prototype.Tde=function(t){for(var n,i,r,t,e,i,o,u,s,c,f,a,n=this,i=t[0],r=t[1],t=n.Ade(i),e=t.windowOverInfoMap,i=t.windowOverInfos,o=[],u=0;u<r.length;u++)s=r[u],(0,S.isNullOrUndefined)(e[s.partitionKey])||(0,S.isNullOrUndefined)(e[s.partitionKey].orderMap[s.orderKey])?o.push(s):(c=e[s.partitionKey].orderMap[s.orderKey],f=s.frameKey+"__"+s.windowFormula,(0,S.isNullOrUndefined)(c.functionMap[f])&&(c.functionMap[f]=!0,c.orderFunctions.functions.push({orders:s.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame})));return[a=n.Ade(o).windowOverInfos,i]},P.prototype.Ade=function(t){for(var n,i,r,e,o,u,s,c,c,f,a,a,n,h,l,d,v,i={},r=[],u=0;u<t.length;u++)e=(s=t[u]).partitionKey,o=s.orderKey,(0,S.isNullOrUndefined)(i[s.partitionKey])&&(c={partitions:s.partitions,orderedFunctions:[]},i[s.partitionKey]={index:r.length,orderMap:{},windowOverInfo:c},r.push(c)),f=(c=i[s.partitionKey]).orderMap,(0,S.isNullOrUndefined)(f[s.orderKey])&&(a={orders:s.orders,functions:[]},f[s.orderKey]={index:c.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:a},c.windowOverInfo.orderedFunctions.push(a)),a=s.frameKey+"__"+s.windowFormula,n=f[s.orderKey].functionMap[a],h=s.windowFrame&&s.windowFrame.exclude,((0,S.isNullOrUndefined)(n)||(0,S.isNullOrUndefined)(n[h]))&&(f[s.orderKey].functionMap[a]=((n={})[h]=!0,n),f[s.orderKey].orderFunctions.functions.push({orders:f[s.orderKey].orderFunctions.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame}));return l=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[o];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<r.length?(v=r[u=(d=i[e]).index],r.splice(u,1),r.push(v),l(d)):1===r.length&&l(i[e]),{windowOverInfoMap:i,windowOverInfos:r}},P.prototype.Mde=function(){for(var t,n,i,r,t=this,n=t.getColumnInfos(),i=0;i<n.length;i++)r=n[i],t.Xhe(r)},P.prototype.$he=function(t){var n,i,n,r,n,e,o,u,s,c,f,a,i=this;if(0===i.dme){for(t&&null!=(n=i.BFt)&&n.dl(),r=(n=i.Tde(i.Cde(t)))[0],n=n[1],e=0,o=r;e<o.length;e++)s=(u=o[e]).partitions,c=u.orderedFunctions,i.windowOver(s,c,!0);for(f=0,a=n;f<a.length;f++)s=(u=a[f]).partitions,c=u.orderedFunctions,i.windowOver(s,c,t);return!0}},P.prototype.gme=function(){this.dme++},P.prototype.pme=function(){0<this.dme&&this.dme--,this.dme<=0&&(this.dme=0,this.$he(!0),this.fge(),this.gLt.bCe())},P.prototype.mme=function(){return 0!==this.dme},P.prototype.gFt=function(t){this.XFt()||(this.iRt=this.qFt(t))},P.prototype.qFt=function(t){var n,i,r,t,e,o,n=[],i=t||this.length(),r=this.lFt,t=r.length;for(0<t&&(n=r.slice(0)),e=t,o=0;o<i;o++)-1===r.indexOf(o)&&(n[e]=o,e++);return n},P.prototype.jRt=function(t){return O},P.prototype.RFt=function(t){var n=this,i=n.gLt;return n.iRt||n.gFt(),n.lLt=new r.FieldManager(n.LEt,i),n.ELt(),n.yLt=n.lLt.prepareFields(t||n.yLt),n.YBt(),n.lLt},P.prototype.getLookup=function(t){return(0,r.getLookupBy)(this.gLt,t)},P.prototype.isLookupField=function(t){return(0,r.isLookupField)(this.gLt,t)},P.prototype.isLookupListField=function(t){return(0,r.isLookupListField)(this.gLt,t)},P.prototype.isLookupRelationField=function(t){return(0,r.isLookupRelationField)(this.gLt,t)},P.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},P.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},P.prototype.length=function(){return this.gLt.length()},P.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},P.prototype.getDirtyIndexes=function(){var n=this;return n.gLt.getDirtyIndexes().map(function(t){return n.FLt(t)})},P.prototype.isInserted=function(t){var n=this,t=n.RJ(t);return n.vPt(t)},P.prototype.vPt=function(t){return this.gLt.isInserted(t)},P.prototype.isUpdated=function(t){var n,t,t,n=this,t=n.RJ(t);return n.PLt(!1),t=n.gLt.isUpdated(t,n.bLt()),n.PLt(!0),t},P.prototype.getErrorInfo=function(t){var n,t=this.RJ(t);return this.gLt.getErrorInfo(t)},P.prototype.kbe=function(){return this.gLt.kbe()},P.prototype.insertItem=function(t,n,i,r,e,o,u,s){var c,f,c=this;return c.isHierarchy()?0===(f=c.visibleLength())?void this.addHierarchyFirstItem(n,i,r,e,o):void(t<f?c.addHierarchyItemBefore(t,n,i,r,e,o):c.addHierarchyItemAfter(f-1,n,i,r,e,o)):c.mPt(t,n,i,r,o,u,s)},P.prototype.insertItems=function(t,n,i){var s,c,n,r,e,f,a,i,s=this,c=this,n=c.GLt(n,i),r=n.success,e=n.fail,f=0,a=0,i=t.map(function(u){return function(t,n){var i,r,e,o,i=u.row,r=u.isAfter,e=u.data;f<i&&(f=i),a++,0===(o=c.visibleLength())?s.addHierarchyFirstItem(e,t,n):r?c.addHierarchyItemAfter(i,e,t,n):c.addHierarchyItemBefore(i,e,t,n)}});return(0,S.promiseSerialExecute)(i).then(function(t){t.row=f,t.addedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},P.prototype.mPt=function(n,t,i,r,e,o,u){var s,i,c,r,i,f,e,t,a,h,l,o,d,v;return void 0===e&&(e=!0),i=(s=this).GLt(i,r),c=i.success,r=i.fail,i=s.visibleLength(),n=i<n?i:n,o=null!=o?o:s.RJ(n),f=e?s.gPt(t):t,s.ULt(f),this.AGe.nGe({type:_.ViewChangeType.Insert,index:n}),(0,S.isNullOrUndefined)(o)&&(s.Dit()?(o=s.length(),s.HLt(f,o)):o=n),e=s.gLt.uBt(),t=!(0,S.isNullOrUndefined)(e),a=s.isHierarchy(),h=o,l=n<i,t&&!a&&(d=o=void 0,v=!1,l?(o=s.RJ(n-1),d=h):(d=s.RJ(n-1),v=!0),f[e]=s.gLt.d7t(o,d,v)),(t||a)&&(h=s.Dit()?s.length():i),s.gLt.insertItem(h,f,function(t){s.zLt(h,f,l,n,u),c&&c(t)},r)},P.prototype.zGe=function(n,t,i,r){var e,i,o,r,u,s,e=this,i=e.GLt(i,r),o=i.success,r=i.fail,u=n,s=e.gPt(t);return e.gLt.recoverItemAtBatch(u,s,function(t){e.zLt(u,s,!0,n,!0),o&&o(t)},r)},P.prototype.zLt=function(t,n,i,r,e){var o,u,s,c,f,s,e;void 0===e&&(e=!1),u=!((o=this).vme()&&!o.Dit()),i?(s=o.length()-1,o.cRt(s,n),o.VGe(s),c=o.autoFilter,(f=!(0,S.isNullOrUndefined)(o.NLt))&&(o.autoFilter=!0),u&&((0,S.isNumber)(r)&&!o.tPt()&&o.isHierarchy()?o.iRt.splice(r,0,s):o.iRt.push(s)),o.tFt(O,!f&&!e),f&&(o.autoFilter=c)):(o.cRt(t,n),s=o.length(),e=!o.autoFilter&&!!o.iRt,(e=(0,S.isNullOrUndefined)(i)&&(0,S.isNullOrUndefined)(r)&&o.isHierarchy()?!1:e)&&u&&o.iRt.push(s-1),o.tFt(s,e))},P.prototype.gPt=function(t){var n,i,r,e,o,u,s,u,n={};if(this.isHierarchy())for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(e=0,o=r=this.yLt;e<o.length;e++)s=t[i=(u=o[e]).value instanceof Function?u.value.name:u.value],(0,S.isUndefined)(s)||("string"==typeof(u=u.value)?n[u]=s:u(n,s));return n},P.prototype.Dwe=function(t,n,i,r){var e=this;e.ULt(t),e.iFt(t,n,i,r)},P.prototype.jwe=function(u,s,t,r){var n,c,e,o,f,a,h,l,d,i,v,p,w,b,m,j,y,g,_,O,n=this,c=n.gLt,e=n.lLt,o=Object.keys(u),f=this.yLt;if(n.vPt(s)&&o.some(function(n){return f.some(function(t){return t.isCross&&t.value===n})}))return!1;for(a={},h=[],l=function(t,n,i,r){var e,o,e,e=c.qRt(n);e.name!==c.name?(o=a[e.name],(0,S.isNullOrUndefined)(o)&&(a[e.name]=o={}),e=c.swe(r?r.getRelationField(s):n,s),(0,S.isNullOrUndefined)(o[e])&&(o[e]={}),o[e][i]=t):u[n]=t},d=function(t,n,i){var r;h.push({data:((r={})[t.valueField]=u[n],r[t.dimRelationKey]=t.getDimValue(),r),valueRelation:t.valueRelation,onSucceeded:i})},i=function(t){var t,n,i,t,t=f[t],n=t.value;t.isCross&&-1<o.indexOf(n)&&(i=e.getFieldByColumn(t),t=c.KRt(i.valueRelation,s),i.isOneToMany?(t=t&&(0,S.isNumber)(i.getValueIndex(s)))?l(u[n],i.valueRelation,i.valueField,i):d(i,n,function(t){e.setCrossFieldInsertedIndex(i,s,t.index)}):t?(l(u[n],i.valueRelation,i.valueField),l(i.getDimValue(),i.dimRelationPath,i.dimRelationKey)):d(i,n),r[n]=u[n])},v=0;v<f.length;v++)i(v);if(0<(p=Object.keys(a)).length)for(w=0;w<p.length;w++)for(y in b=p[w],m=this.gLt.QOt.tables[b],j=a[b])j.hasOwnProperty(y)&&m.updateItem(Number(y),j[y]);if(0<h.length)for(g=0,_=h;g<_.length;g++)O=_[g],c.JRt(O.valueRelation,s,O.data,O.onSucceeded);return Object.keys(u).length===Object.keys(r).length?(n.VLt(u,t,s),n.YLt(u,t,s),!0):void 0},P.prototype.VLt=function(t,n,i){var r=this;r.Owe(i,t,n),r.kwe(t,n,i)},P.prototype.kwe=function(t,n,i){var r,e,o,r=this;for(e in t)(0,S.isNotDeepEqual)(t[e],n[e])&&(o=n[e],r.Dwe(t,o,e,i))},P.prototype.YLt=function(t,n,i){var r,e,o,u,r=this,e=[];for(o in t)(0,S.isNotDeepEqual)(t[o],n[o])&&(u=n[o],e.push(o),r.hRt(i,o,u,t[o]));r.tFt(O,!0,e,O)},P.prototype.updateItem=function(t,n,i,r,e){var e,o,u,e,e,s,i,c,r,f,a,i,o,u,e=null!=e?e:{},o=e.hasAddNewRowData,u=e.currentModelIndex,e=e.isModelIndex,e=void 0!==e&&e,s=this,i=s.GLt(i,r),c=i.success,r=i.fail,f=o?u:e?t:s.RJ(t),a=this.getRowData(f,!0),i={},o=s.jwe(n,f,a,i),u={type:_.ViewChangeType.Update,modelIndex:f,oldData:M(a,n)};if(this.AGe.nGe(u),!(0,S.isBoolean)(o))return s.VLt(n,a,f),s.gLt.updateItem(f,E(n,i),function(t){s.YLt(n,a,f),c(t)},r);o?c({index:f,data:n,originalData:a,changingFields:N(n,a)}):r()},P.prototype.Owe=function(t,n,i){var r,e,o,u,s,c,f,a,h;for(i=i||this.getRowData(t,!0),r=(0,S.clone)(i,!0),e=Object.keys(n),u=0,s=o=this.yLt;u<s.length;u++)(f=(c=s[u]).value)instanceof Function&&!(0,S.isUndefined)(n[f.name])&&-1<e.indexOf(f.name)&&f(r,n[f.name]);for(a in r)r.hasOwnProperty(a)&&(h=r[a],(0,S.isNotDeepEqual)(h,i[a]))&&(n[a]=h)},P.prototype._we=function(t,r){var n,e,i,o,n=this,e=this.yLt,i=function(n){var t,i;r.hasOwnProperty(n)&&(t=r[n],(0,S.isUndefined)(t)||I(i=e.find(function(t){return t.value===n}),r))};for(o in r)i(o);return n.Owe(t,r),r},P.prototype.resetItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,o=r.RJ(t),u=this.getRowData(o,!0),s=r.bPt(o);if(!(0,S.isNullOrUndefined)(t)&&!(0,S.isNullOrUndefined)(o))return this.AGe.nGe({type:_.ViewChangeType.Update,modelIndex:o,oldData:u}),r.kwe(s,u,o),r.gLt.resetItem(o,function(t){r.ZLt(o,u,s),e(t)},i);i()},P.prototype.ZLt=function(t,n,i){var r=this;r.vLt(t),r.pRt(t,n,i),r.tFt(O,!0,O,O)},P.prototype.saveItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,n=r.RJ(t);return r.gLt.saveItem(n,function(t){e(t)},i)},P.prototype.getRowData=function(t,n,i,r,e,o){var u,n,u=this,n=n?t:u.RJ(t);return u.nFt(n,i,r,e,o)},P.prototype._ve=function(t,n){var i=this;return b(i.gLt,i.RJ(t),n,i.lLt)},P.prototype.lKe=function(t,n){var i=this;return b(i.gLt,t,n,i.lLt)},P.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},P.prototype.wPt=function(t,n){var i=this,r=i.gLt.uBt(),e,r=i.isHierarchy()||!(0,S.isNullOrUndefined)(r),o=(0,S.isNullOrUndefined)(i.MFt),t=!(0<i.lFt.length)||i.lFt.length<t&&(!(0,S.isNumber)(n)||i.lFt.length<n);return r&&o&&t},P.prototype.MPt=function(){var t=this;return!!(0,S.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},P.prototype.CPt=function(t,n){var i,r,e,o,i=this,e=i.getHierarchyNode(t).parent;if(n){for(o=t+1;o<i.visibleLength();o++)if(i.getHierarchyNode(o).parent===e){r=o;break}}else for(o=t-1;0<=o;o--)if(i.getHierarchyNode(o).parent===e){r=o;break}return r},P.prototype.m7t=function(t,n){var i,r,e,o,o,u,s,c,f,a,h,r,r,i=this;if(t!==n&&i.wPt(t,n)){if(o=(e=t<n)?n+1:n-1,(r=i.isHierarchy())&&1===Math.abs(t-n)&&(n=i.CPt(t,e)),o=i.gLt.m7t(e,i.RJ(t),i.RJ(n),i.RJ(o))){if(u=i.iRt,c=1,f=[s=i.RJ(t)],r)for(f=[],h=(a=t)+(c=i.gLt.V7t(s));a<h;a++)f.push(i.RJ(a));e?(r=i.gLt.V7t(i.RJ(n)),u.splice.apply(u,y([n+r,0],f,!1)),u.splice(t,c)):(u.splice(t,c),u.splice.apply(u,y([n,0],f,!1))),i.wFt=O,r=u.indexOf(s),this.AGe.nGe({type:_.ViewChangeType.MovedUpdateOrDown,moveIndex:r,destIndex:r+(e?-1:1)})}return o}},P.prototype.moveUp=function(t){var n,i=1;0<t&&this.m7t(t,t-1)},P.prototype.moveDown=function(t){var n=this,i=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},P.prototype.SPt=function(t){for(var n,i,r,e,o,u,s,n,n=this,i=n.gLt._dataSource.options.schema.hierarchy.outlineColumn,r=n.yLt,e=-1,o=-1,u=0;u<r.length;u++){if(s=r[u],!(0,S.isNullOrEmpty)(s.outlineColumn)){e=u;break}-1!==o||s.value!==i&&((0,S.isNullOrUndefined)(i)||s.value!==i.value)||(o=u)}return n=-1!==e?{index:e,options:r[e].outlineColumn}:{index:o,options:i},t&&(n.index=this.BPt(n.index)),n},P.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},P.prototype.getHierarchyColumnIndex=function(t){return this.SPt(t).index},P.prototype.hasHierarchyColumn=function(t){var n=this,i=n.isHierarchy(),r=i&&n.getHierarchyColumnIndex();return(0,S.isNumber)(t)?i&&r===n.uPt(t):!(!i||-1===r)},P.prototype.ABe=function(t,n){return this.gLt.ABe(this.ife(t),n)},P.prototype.isHierarchy=function(){return this.gLt.CEt()},P.prototype.getHierarchyNode=function(t,n){var i,n,i=this;if(i.isHierarchy())return n=n?t:i.RJ(t),i.gLt.SEt(n)},P.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},P.prototype.promoteHierarchyLevel=function(t){var n,i,r,t,n;this.isHierarchy()&&(i=this.$Fe(),r=this.YGe(),this.gLt.M7t(this.RJ(t)),t=r(),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:i}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:t}))},P.prototype.$Fe=function(){return this.gLt.$Fe()},P.prototype.YGe=function(){var a,h,r,l,e,o,t,n,a=this,h=[],r={},l=y([],this.iRt,!0),e=function(t,n,i){var r,e,o,u,s,n,c,f,r=n.action,e=n.index,o=n.oldItems,u=n.items,s=n.modelIndex,n=n.hierarchyNodeInfo,c,f=a.gLt.name===i?l.indexOf(s):s;h.push({rowIndex:f,oldItems:o,items:u,action:r,livingIndex:e,hierarchyNodeInfo:n,tableName:i,modelIndex:s})},o=this.gLt.QOt.tables,t=function(t){var i;o.hasOwnProperty(t)&&(i=o[t],r[i.name]=function(t,n){e(t,n,i.name)},i.bind(s.ONCHANGE,r[i.name]))};for(n in o)t(n);return function(){var t,n;for(t in o)o.hasOwnProperty(t)&&(n=o[t])&&r[n.name]&&n.unbind(s.ONCHANGE,r[n.name]);return h}},P.prototype.fGe=function(t){this.gLt.tBe(t),this.tFt(void 0,!1)},P.prototype.lGe=function(t){var h,l,d,h=this,l=[],d={};y([],t,!0).reverse().forEach(function(i){var r,n,t,e,o,u,s,c,f,a,r=i.rowIndex,n=i.action,t=i.oldItems,e=i.items,o=i.livingIndex,u=i.hierarchyNodeInfo,s=i.tableName,c=h.gLt.QOt.tables[s];"update"===n?(f=h.iRt[r],t.forEach(function(t){c.I7t({action:n,index:f,item:t,x7t:!0,N7t:!1})})):"delete"===n&&(a=c===h.gLt,e.forEach(function(t,n){a?h.ZGe(t,r+n,o+n,u,i.modelIndex):h.QGe(t,r+n,o+n,u,c)}),d[s]||(l.push(c),d[s]=!0))}),this.WGe(l)},P.prototype.WGe=function(t){0<t.length&&(t.forEach(function(t){t.dl()}),this.hLt())},P.prototype.QGe=function(t,n,i,r,e){var o,u,o,u;e.X7t()&&e.OBe(i)?e.recoverItemAtBatch(i,t):e.insertItem(n,t,null,null)},P.prototype.ZGe=function(t,n,i,r,e){var o,u,o,u;this.gLt.X7t()&&this.gLt.OBe(i)?this.zGe(i,t,null,null):this.insertItem(n,t,null,null,r,!1,e,!0)},P.prototype.demoteHierarchyLevel=function(t,n){var i,r,e,i,i=this;i.isHierarchy()&&(r=this.$Fe(),e=this.YGe(),i.gLt.S7t(i.RJ(t),n),i=e(),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:r}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:i}))},P.prototype.hasRowOrder=function(){var t;return!(0,S.isNullOrUndefined)(this.gLt.uBt())},P.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},P.prototype.addHierarchyItemBefore=function(t,n,i,r,e,o){var u,s,e,u=this;u.yPt(t)&&(s=this.$Fe(),e=u.gLt.O7t(u.RJ(t),n,e),u.APt(n,e),u.mPt(t,n,i,r,o),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}))},P.prototype.addHierarchyItemAfter=function(t,n,i,r,e,o){var u,s,c,e,u=this;if(u.yPt(t))return s=this.$Fe(),c=u.gLt.V7t(u.RJ(t)),e=u.gLt.L7t(u.RJ(t),n,e),u.APt(n,e),u.mPt(t+c,n,i,r,o),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}),c},P.prototype.addHierarchyItemAbove=function(t,n,i,r){var e,o,u,e=this;e.yPt(t)&&(o=this.$Fe(),u=e.gLt.F7t(e.RJ(t),n),e.APt(n,u),e.mPt(t,n,i,r),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:o}))},P.prototype.addHierarchyItemBelow=function(t,n,i,r){var e,o,u,s,e=this;if(e.yPt(t))return o=this.$Fe(),u=e.gLt.V7t(e.RJ(t)),s=e.gLt.G7t(e.RJ(t),n),e.APt(n,s),e.mPt(t+u,n,i,r),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:o}),u},P.prototype.addHierarchyFirstItem=function(t,n,i,r,e){var o,r,o=this,r=o.gLt.Xme(t,r);o.APt(t,r),o.mPt(0,t,n,i,e)},P.prototype.APt=function(t,n){var i,r,e,i,r=this.gLt.H7t(n);if(!(0,S.isNullOrUndefined)(r))for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},P.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},P.prototype.fetch=function(i){var r,n,t,t,r=this,n=r.gLt.QOt.tables,t=r.gLt.Ix();if(0<t.length)return t=t.map(function(t){var t=n[t];return t&&t.fetch(i,!0)}),Promise.all(t).then(function(t){r.yde||r.JLt(),r.pLt()&&(r.RFt(),r.cPt()),!i&&r.yde||(r.cPt(),r.yde||r.Mde(),r.$he(),r.gLt.fme())||r.tFt(),r.dPt||r.hPt();var n=r;return(n.dp||n.vp)&&(n.dp&&n.dp(),n.vp)&&n.vp(),r.yde=!0,t})},P.prototype.iM=function(t,n){var i=this;i.Wce(),i.cFt(),t&&i.gFt(),i.hLt(),i.lLt&&n&&i.RFt(i.ILt.map(function(t){return f({},t)})),n&&i.cPt(),i.tFt(O,!0,O,n)},P.prototype.hPt=function(){for(var t,n,i,r,e,o,t,n=0,i=this.yLt;n<i.length;n++)(r=i[n]).cross||(e=r.lookup,(0,S.isArray)(e)?"string"==typeof r.value&&-1===r.value.indexOf(".")&&0<(e=(0,S.getUniqueArray)(e)).length&&((o=(o=r.style)||(r.style={})).cellType||(o.cellType={type:"combobox",items:e})):(0,S.isString)(e)&&e?this.IPt(r,e):(0,S.isObject)(e)&&this.IPt(r,e.name,e.columns))},P.prototype.IPt=function(t,n,i){var r,t,e,r,o,r,o,n,r,r=t.style,t=(t=(r=r||(t.style={})).cellButtons)||(r.cellButtons=[]),e=(e=r.dropDowns)||(r.dropDowns=[]),r=(0,p.array_find)(t,function(t){return"openMultiColumn"===t.command}),o=(0,p.array_find)(e,function(t){return"multiColumn"===t.type});r||o||(o=(r=this.xPt(n)).table,n=r.field,o&&n&&o!==this.gLt&&(r=o.columns)&&(t.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),e.push({type:"multiColumn",option:{dataSource:o.views[u.DEFAULT_VIEW_NAME]||o.addView(u.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(r,i),valuePath:n}})))},P.prototype.xPt=function(t){for(var n,i,r,e,o,u,r,e=0,o=this.gLt.QOt.relationships;e<o.length;e++)if((u=o[e]).sourceRelationshipName===t){n=u.targetTable,i=u.targetFieldName;break}return{table:n,field:i}},P.prototype.NPt=function(n,t){return t?t.map(function(t){return(0,S.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,S.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}}):(0,S.keys)(n).map(function(t){var t=n[t];return{name:t.value,width:(0,S.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})},P.prototype.oV=function(){for(var t,n,i,r,t=this,n=t.gLt.length(),i=[],r=0;r<n;r++)i.push(t.nFt(r));return i},P.prototype.ULt=function(t){for(var n,i,r,e,o,e,n,i=0,r=this.yLt;i<r.length;i++)"string"==typeof(o=(e=r[i]).value)&&(I(e,t),t.hasOwnProperty(o))&&(e=this.gLt.bEt(o))&&e.relatedTable&&e.setValue&&e.setValue(t)},P.prototype.kPt=function(t,n){var i,r,e,i=this.lFt;if(i&&0<i.length){for(r=0;r<n;r++)-1<(e=i.indexOf(t+r))&&i.splice(e,1);for(r=0;r<i.length;r++)i[r]>t&&(i[r]-=n)}},P.prototype.removeRowData=function(i,r,t,n){var e,t,o,n,t,u,s,c,f,a,h,e=this,t=e.GLt(t,n),o=t.success,n=t.fail,t=e.gLt,u=e.RJ(i),s=e.isHierarchy(),a=[];(0,S.isNullOrUndefined)(i)||(0,S.isNullOrUndefined)(u)||(0,S.isNullOrUndefined)(r)?n():(s&&(c=this.$Fe()),f=this.YGe(),h=y([],this.lFt,!0),t.remove(u,r,function(t){var n;e.WLt(u,t.removedCount||r,i),f&&f().forEach(function(t,n){a[n]=t}),o(t)},n),s&&this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:c}),s||this.AGe.nGe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:h}}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:a}))},P.prototype.removeItems=function(t,n,i){var u,s,n,r,e,c,f,a,i,u=this,s=this,n=s.GLt(n,i),r=n.success,e=n.fail,c=s.gLt,f=[],a=0,i=t.map(function(o){return function(i,t){var n,r,e,n=1;u.isHierarchy()&&(n+=(r=u.getHierarchyNode(o)).getChildrenCount()),e=s.RJ(o),c.remove(e,n,function(t){var n=t.removedCount||1;s.WLt(e,t.removedCount||1,o),f.push({index:e,count:n}),a+=n,s.rebuildFieldGetter(),i()},t)}});return(0,S.promiseSerialExecute)(i).then(function(t){t.removedItems=f,t.totalRemovedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},P.prototype.WLt=function(t,n,i){var e,o,r,u,s,e=this;if(e.kPt(t,n),(0,S.isNumber)(i)||(i=e.FLt(t)),!e.mFt()&&(!e.vme()||e.Dit())){for(o=e.iRt.slice(i,i+n),r=function(t,n){var i,r,i=e.iRt[t],r=o.reduce(function(t,n){return n<i?t+1:t},0);0<r&&(e.iRt[t]-=r)},u=0,s=e.iRt.length;u<s;u++)r(u,s);e.iRt.splice(i,n)}e.dLt(t,n),e.MRt(t,n),e.HGe(t,n),e.tFt(void 0,!0)},P.prototype.getChanges=function(){for(var t,n,i,r,e,t,n=this.gLt.getChanges(),i=0,r=n;i<r.length;i++)e=r[i],(0,S.isNullOrUndefined)(e.index)||(e.index=this.FLt(e.index));return n},P.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},P.prototype.submitChanges=function(r,e){var o=this,t=o.GLt(),n=t.success,t=t.fail,i;return o.gLt.submitChanges(function(t,n,i){var t;i===s.DELETE&&(o.Wce(),o.cFt(),o.gFt(),o.hLt(),o.tFt(O,!0)),r&&(t=o.FLt(t),r(t,n,i))},function(t,n,i){e&&e(t,n,i)}).then(function(t){return o.QLt(),n(),t}).catch(t)},P.prototype.QLt=function(){},P.prototype.cancelChanges=function(){var t,n,i,n,r,e,t=this,n=t.GLt(),i=n.success,n=n.fail,r=t.isDataLengthChanged(),e=t.gLt.ZBe();t.gLt.cancelChanges(function(){t.QBe(e),t.KLt(r),i()},n)},P.prototype.KLt=function(t){this.iM(t)},P.prototype.ZBe=function(){return this.gLt.ZBe()},P.prototype.QBe=function(t){var n=this;this.gLt.WBe(t,function(t){n.removeColumn(t.column.name||t.column.value)},function(t){n.YBe(t.column.name||t.column.value,t.originalColumn)},function(t){n.addColumn(t.originalColumn)})},P.prototype.DPt=function(t,n){var i,r,e,t,o,i=this,r=i.TLt(t,n);if(this.AGe.nGe({type:_.ViewChangeType.MoveColumnOptions,from:t,to:n}),e=i.ILt.map(function(t,n){return{index:n,option:t}}),t=i._Pt(t,n),e=t.map(function(t){return e[t]}),i.ILt=e.map(function(t){return t.option}),r)return!0;o=[],e.forEach(function(t,n){(0,S.isNullOrUndefined)(t.option.cross)||t.index===n||o.push({oldIndex:t.index,newIndex:n})}),i.wLt(o,!1)},P.prototype.EPt=function(){var i,t,r,i=this,t=i.CLt;return t&&0<t.length?(r=[],t.forEach(function(t,n){r.push(i.yLt[t].value)}),r):[]},P.prototype.jPt=function(t){var n,i=this.yLt;return(0,S.isNullOrUndefined)(t)?[]:t.map(function(n){return(0,S.findIndex)(i,function(t){return t.value===n})})},P.prototype.OPt=function(t,n,i){var r,e,t,n,o,u,s,c,f,a,a,h,l,r=this;if(r.yLt.forEach(function(t,n){t.RPt=n}),e=r.oPt,this.AGe.nGe({type:_.ViewChangeType.MoveColumnInfos,from:t,to:n,count:i}),t=(0,p.ePt)(t,n,i,r.yLt,r.oPt,r.CLt,r.ILt),n=r.CLt.map(function(t){return r.yLt[t]}),r.yLt=t.map(function(t){return r.yLt[t]}),n&&n.length){for(o=[],u=r.yLt.length,s=-1,c=0,f=n;c<f.length;c++)a=f[c],a=r.yLt.indexOf(a),s=Math.max(a,s),o.push(a);for(h=0;h<u;h++)-1===o.indexOf(h)&&o.push(h);r.oPt=o,r.CLt=o.slice(0,n.length)}return l=r.yLt.reduce(function(t,n,i){return n.RPt!==i&&t.push({oldIndex:n.RPt,newIndex:i}),delete n.RPt,t},[]),r.yLt.forEach(function(t){for(var n,i,r,e,r,n=0,i=l;n<i.length;n++)if(e=(r=i[n]).oldIndex,r=r.newIndex,t._Ft===e){t._Ft=r;break}}),r.lLt&&r.lLt.moveFieldsByIndexes(l),l.map(function(t){return t.oldIndex=r.BPt(t.oldIndex,e),t.newIndex=r.BPt(t.newIndex),t})},P.prototype.SLt=function(t){var n,i,n,r,n=this,i=n.yLt,n=n.ILt,r=i[t];return r.isCross?r.RBt:(0,S.findIndex)(n,function(t){return t.value===r.value})},P.prototype.ALt=function(t){var n=this,i=n.CLt,r=n.ILt;return t=t||i.map(function(t){return n.SLt(t)}),(0,p.generatePinnedColumnIndexMap)(t,r.length)},P.prototype._Pt=function(t,n){var i,r,e,o,r,r,u;if(t!==n)return r=(i=this).CLt,e=i.ILt.map(function(t,n){return{index:n}}),o=r.map(function(t){return i.SLt(t)}),0<(r=(0,p.generatePinnedColumnIndexMap)(o,e.length)).length&&(t=r[t],n=r[n]),r=o.map(function(t){var t=e[t];return t.LPt=!0,t}),(0,S.swapArrayItems)(e,t,n,1),u=e.filter(function(t){return!t.LPt}),r.forEach(function(t,n){u.splice(o[n],0,t)}),u.map(function(t){return t.index})},P.prototype.getColumnInfos=function(i,r,e,o){for(var u,s,c,f,t,a,n,u=[],s=this.yLt,c=this.oPt,f=this.gLt,t=function(t){var t,n,t,t=!(0<c.length)||e||(0,S.isNullOrUndefined)(c[t])?t:c[t],n=s[t];if(!o&&f.jOt(n.value)&&(n.isPrimaryKey=!0),!i||!n.isGroup){if(r&&n.isCross&&(t=n.RBt,(n=a.ILt[t]).RBt=t,u.some(function(t){return t===n})))return"continue";u.push(n)}},a=this,n=0;n<s.length;n++)t(n);return u},P.prototype.JGe=function(t,n){var t=(0,S.isFormula)(t)?this.Ywt(t):t;return t?(0,r.getFieldNamesFrom)(t,n):[]},P.prototype.EJe=function(t,n){var i,r,i=(0,S.isFormula)(t)?t:this.gLt.wCe(t)?this.gLt.awe(t):a;return(0,S.isString)(n)?r=function(t){return t===n}:(0,S.isFunction)(n)&&(r=n),i?this.gLt.wHe(i,r):r(t)},P.prototype.ife=function(t){var n=this;return(0,p.getColumnName)((0,S.isNumber)(t)?n.Dve(t):t)},P.prototype.FPt=function(t,n){var i=this.gLt.qRt(t);return!((0,S.isNullOrUndefined)(i)||(!n||!(0,S.isRelation)(t))&&i===this.gLt)},P.prototype.setColumnInfos=function(t,n){for(var i,r,e,o,u,i={},r=0;r<this.yLt.length;r++)"string"==typeof(e=this.yLt[r]).value&&e.value===e.name&&(i[e.value]=!0);for(o=0;o<t.length;o++)"string"!=typeof(u=t[o]).value||i[u.value]||this.Xhe(u);this.yde&&(this.yLt=t,this.$he()),this.yLt=t,this.PPt(),this.Gfe(),n&&this.cPt()},P.prototype.Gfe=function(){for(var t,n,i,r,e,o,u,t=this.ILt,n=0;n<t.length;n++)if(!(i=t[n]).cross)for(r=this.yLt,e=0;e<r.length;e++)if(o=r[e],i.value===o.value){for(u in o)o.hasOwnProperty(u)&&"_"!==u.charAt(0)&&(i[u]=o[u]);break}},P.prototype.PPt=function(){for(var t,n,i,r,e,o,u,s,t=this.ILt,n=t.length-1;0<=n;n--)"string"==typeof(i=t[n].value)&&"="===i[0]&&t.splice(n,1);for(r=this.yLt,e=n=0;n<r.length;)o=r[n],u=t[e],o.isGroup||o.isCross?n++:u&&u.cross?e++:(s=o.value)===(i=u&&u.value)?(n++,e++):"string"!=typeof s||"="!==s[0]&&"formula"!==o.dataType?n++:(s!==o.name&&this.dGe(o.name,s),t.splice(e,0,o),n++,e++)},P.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},P.prototype.Xfe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,i=this,r=i.NLt;if(i.mFt())i.Wce(),i.filter();else{for(u in e=i.iRt,o=i.Jce)if(o.hasOwnProperty(u)){for(c=(s=o[u]).options,f=s.count,delete s.options,delete s.count,a=0;a<t.length;a++)h=t[a],(0,S.isNullOrUndefined)(s[h])||(delete s[h],f--);if(0<n.length)for(i.iRt=n,i.filter(c),l=0;l<i.iRt.length;l++)s[d=i.iRt[l]]=!0,f++;s.options=c,s.count=f}i.Jce=o,i.iRt=e}i.NLt=r},P.prototype.togglePinnedRows=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j;if((0,S.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=y([],this.lFt,!0),i=this.lFt,r=this.iRt,e=t.length,o=[],u=[],s=[],c=i.length,f=0;f<e;f++)-1<(a=r[t[f]])&&(-1<(h=i.indexOf(a))?(u.push(h),s):o).push(a);if(i.length-(d=u.length)+(l=o.length)>this.rPt)return-1;if(0<d)for(u.sort(),f=d-1;0<=f;f--)i.splice(u[f],1);for(f=0;f<l;f++)i.push(o[f]);if(0<d||0<l){for(v=[],p=r.length,0<(w=i.length)&&(v=i.slice(0)),a=w,f=0;f<p;f++)-1===i.indexOf(r[f])&&(v[a]=r[f],a++);if(!this.mFt()&&!this.tPt())for(f=0;f<d;f++)b=r[u[f]],m=v.indexOf(b),j=this.UPt(b,c,v),v.splice(m,1),v.splice(j=m<j?j-1:j,0,b),w<c&&c--;this.iRt=v,this.Xfe(o,s),this.vFt(),this.bde(O,0<d),this.NFt()}return this.AGe.nGe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:n}}),i.length},P.prototype.pGe=function(){for(var t,n,i,t=this.lFt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedRows(n)},P.prototype.togglePinnedColumns=function(t,n){var i,t,i=y([],this.CLt,!0),t=this.KGe(t,n);return this.AGe.nGe({type:_.ViewChangeType.PinnedColumns,oldData:{pinnedColumns:i}}),t},P.prototype.KGe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,i=this;if((0,S.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(r=this.oPt,e=0<r.length,t=t.filter(function(t){var t=e?r[t]:t;return!i.yLt[t].isCross}),o=this.CLt,u=t.length,s=[],c=[],f=0;f<u;f++)-1<(a=e?r[t[f]]:t[f])&&(-1<(h=o.indexOf(a))?c.push(h):s.push(a));if(o.length-(d=c.length)+(l=s.length)>this.rPt)return-1;if(v=[],0<d)for(c.sort(),f=d-1;0<=f;f--)v.push(o.splice(c[f],1));for(f=0;f<l;f++)o.push(s[f]);return n&&(o=o.map(function(t){for(var n,i,r,n=0,i=v;n<i.length;n++)(r=i[n])<t&&--t;return t})),(0<l||0<d)&&(this.oPt=(0,p.generatePinnedColumnIndexMap)(o,this.yLt.length-(n?d:0))),o.length},P.prototype.wGe=function(){for(var t,n,i,t=this.CLt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedColumns(n)},P.prototype.uPt=function(t){var n,i=this.oPt;return i&&0<i.length?i[t]:t},P.prototype.BPt=function(t,n){var i;return(n=n||this.oPt)&&0<n.length?n.indexOf(+t):+t},P.prototype.getRowDataAsync=function(i){var r=this;return r.fetch().then(function(t){var n=r.RJ(i);return r.nFt(n)})},P.prototype.UPt=function(t,n,i){for(var r=n;r<i.length;r++)if(i[r]>t)return r;return i.length},P.prototype.nFt=function(t,n,i,r,e){var o=this;return C(o.gLt,o.yLt,o.BFt,o.lLt,o.MFt,t,n,i,r,e)},P.prototype.rebuildFieldGetter=function(){var i,t,i=this.gLt;i&&(t=this.yLt).forEach(function(t,n){var t=t.value;"string"==typeof t&&i.rRt(t)})},P.prototype.ufe=function(t,n){return F(this.gLt,t,n)},P.prototype.XGe=function(t){var n,n;return null==(n=null==(n=this.gLt)?void 0:n.columns)?void 0:n[t]},P.prototype.updateColumnDataType=function(t,n){var i,i,i,r,i,i,e,r=this.XGe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].dataType=n:i[t]={dataType:n}),i=r.dataType,e=(0,S.clone)(this.gLt.KFe(r.name)),this.AGe.nGe({type:_.ViewChangeType.TableSheetColumnDataTypeChanged,oldData:{columnValue:t,oldDataType:i,oldData:e}}),r.dataType=n)},P.prototype.hGe=function(t,n){var t=this.XGe(t);t&&this.gLt.XFe(t.name,n)},P.prototype.updateColumnIsPrimaryKeyType=function(t,n){var i,i,i,r,i,r=this.XGe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].isPrimaryKey=n:i[t]={isPrimaryKey:n}),this.AGe.nGe({type:_.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged,oldData:{columnValue:t,oldIsPrimaryKey:r.isPrimaryKey}}),r.isPrimaryKey=n)},P.prototype.bPt=function(s){var c,t,f,a,h,l,n,i,r,c=this,t=c.yLt,f={},a=[],h=!!c.MFt,l=c.gLt;if(t.forEach(function(t,n){var i,r,e,o,u,i=t.value;t.isCross?f[t.value]=c.lLt.getFieldByColumn(t).getOriginalValue(s):i&&!t.isGroup&&("string"==typeof i?(r=0<=i.indexOf("."),e="="===i[0],o=l.XOt&&(0,S.isNullOrUndefined)(l.XOt[i]),(!h||r||e||o)&&(f[i]=R(e?l._getValueByField(i,s):l.XRt(i,s),t))):"function"==typeof i&&a.push({name:i.name,caption:t.caption,value:i}))}),0<a.length&&(n=l.iBt(s),a.forEach(function(t){f[t.name]=t.value(n)})),h)for(r in i=this.lLt.CBt(s))i.hasOwnProperty(r)&&(f[r]=i[r]);return f},P.prototype.JBe=function(){return this.gLt.JBe()},P.prototype.KBe=function(t){return this.gLt.KBe(t)},P.prototype.XBe=function(t){return this.gLt.XBe(t)},P.prototype.addColumn=function(t){this.cBe(t,!0)},P.prototype.cBe=function(t,n,i){var r,n,r,e;t=this.qGe(t),r=(0,S.isNamedFormulaColumn)(t),(n||r)&&(t=f({},t)),r?(t.value=t.name,delete t.dataType):t.name=(0,p.getColumnName)(t),n=this.$Ge(t),(r=this.tUe(i))?r.isCross?(e=this.nUe(i,r),this.yLt.splice(e,0,t),this.ILt.splice(r.RBt,0,t)):(i=this.uPt(i),this.yLt.splice(i,0,t),this.ILt.splice(i,0,t)):(this.yLt.push(t),this.ILt.push(t)),this.eUe(t),this.AGe.nGe({type:_.ViewChangeType.AddColumn,newData:f({},t)}),n||(this.lLt&&this.lLt.addBaseField(t),this.Xhe(t)&&this.yde&&this.$he(),this.PPt(),this.Gfe())},P.prototype.tUe=function(t){var n,t,n=(0,S.isNumber)(t)&&0<=t&&t<this.yLt.length,t=(n=n&&(!(0<this.CLt.length)||t>=this.CLt.length))&&this.Dve(t);if(n&&!t.isGroup)return t},P.prototype.nUe=function(t,n){var i,r;if(n=n||this.tUe(t)){if(n.isCross)for(i=t-1;0<=i;i--)if(!(r=this.Dve(i)).isCross||r.RBt!==n.RBt)return i+1;return t}return this.yLt.length},P.prototype.iUe=function(t,n,i){this.rUe(a,t,a,n,i)},P.prototype.rUe=function(n,i,r,t,e){var o,t,u,e,t,t,o=this,t=o.GLt(t,e),u=t.success,e=t.fail;if(i=f({},o.qGe(i)),t=o.gLt.hasExistedColumn(i),D(i)||t)return t?(t=o.UGe(o.ife(i),!0,!0,!0),o.cBe(t,!1,n),void o.pUe(t,i,r,u,e)):(r&&r(a),o.cBe(i,!1,n),void u({success:!0,column:f({},i)}));o.gLt.addColumn(i,function(t){r&&r(t),o.cBe(i,!1,n),t.column=f({},i),(t.table||t.source)&&o.AGe.nGe({type:_.ViewChangeType.DefineColumnAddColumn,name:(0,p.getColumnName)(i),table:t.table,source:t.source}),u(t)},e)},P.prototype.$Ge=function(n){var t=this,i=t.ILt.some(function(t){return t.value===n.value&&(0,S.isNullOrUndefined)(n.cross)}),t=!i&&t.yLt.some(function(t){return t.value===n.value});return i||t},P.prototype.qGe=function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),"date"===t.dataType&&(0,p.applyDateTimePicker)(t),t},P.prototype.vGe=function(t,n,i,r){i?(this.yLt.splice(t,0,n),r&&this.lLt&&this.lLt.addBaseField(n),this.eUe(n),this.Xhe(n)&&this.yde&&this.$he(),this.PPt(),this.Gfe()):this.ILt.splice(t,0,n)},P.prototype.vBe=function(t){this.gLt.vBe(t)},P.prototype.bBe=function(t){this.gLt.bBe(t)},P.prototype.uBe=function(t){this.gLt.uBe(t)},P.prototype.getColumn=function(t){var n=this;return(0,S.isNullOrUndefined)(t)?n.getColumnInfos():n.Dve(t,!1)},P.prototype.Dve=function(t,n,i){var r=this;if(!(t<0||t>=r.yLt.length))return r.oUe(r.uPt(t),n,i)},P.prototype.oUe=function(t,n,i){var t,i;if(t!==O)return t=this.yLt[t],i&&(i=this.hHe(t))?f(f({},t),i):(this.gLt.jOt(t.value)&&(t.isPrimaryKey=!0),!1===n?f({},t):t)},P.prototype.hHe=function(t){var t,n,t=(0,p.getColumnName)(t),n=this.gLt.jRt(t);if(n)return(0,S.isNullOrUndefined)(n.value)&&(n.value=n.name=t),n},P.prototype.dHe=function(t){var n=t.value;return!(0,S.isNullOrUndefined)(this.UGe((0,S.isNullOrUndefined)(n)?t:n,!0))},P.prototype.updateColumn=function(t){this.yBe(t)},P.prototype.yBe=function(t,n){var i,r,i=this,r;!!t.cross||!1===n?i.aUe(t):(i.uUe(t),i.PPt(),i.Gfe())},P.prototype.dGe=function(n,t){var i,r,e,i,r,e=this,i=null==(i=this.yLt.filter(function(t){return t.name===n}))?void 0:i[0],r=null==(r=this.ILt.filter(function(t){return t.name===n}))?void 0:r[0];(i||r)&&(i&&(i.name=t),r&&(r.name=t),e.lLt&&e.lLt.renameBaseField(n,t),e.AGe.nGe({type:_.ViewChangeType.UpdateColumnName,oldName:n,newName:t}))},P.prototype.aUe=function(n){var t,i,r,t=this,i=t.ILt.findIndex(function(t){return t.name===n.name});i<0||(r=t.ILt[i]?f({},t.ILt[i]):null,t.ILt[i]=n,t.AGe.nGe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},P.prototype.uUe=function(n){var t,i,r,t=this,i=this.yLt.findIndex(function(t){return t.name===n.name});i<0||(r=t.yLt[i]?f({},t.yLt[i]):null,t.yLt[i]=n,this.AGe.nGe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},P.prototype.sUe=function(t){var n,i,r,e,i=this;i.cUe(t),null!=(n=i.xLt)&&n.call(i,t),r=[],(e=i.ILt.map(function(t,n){return{index:n,option:t}})).forEach(function(t,n){(0,S.isNullOrUndefined)(t.option.cross)||r.push({oldIndex:t.index,newIndex:n})}),i.wLt(r)},P.prototype.cUe=function(t){var n,i,r,e,t,r,o,u,s,c,n=this,i={columnInfoOptions:(0,S.clone)(n.ILt),options:(0,S.clone)(n.LEt),columnInfos:(0,S.clone)(n.yLt)},r=n.ILt.map(function(t,n){return{index:n,option:t}}),e=(r.splice(t,1)[0]||{}).option,t=r.map(function(t){return t.option}),r=n.LEt;if(e&&"string"==typeof e.cross){for(o=!1,u=0,s=t;u<s.length;u++)if((c=s[u])&&c.cross===e.cross){o=!0;break}!o&&r.cross&&delete r.cross[e.cross]}this.AGe.nGe({type:_.ViewChangeType.RemoveColumnInfoOptions,oldData:i}),n.ILt=t,n.LEt=r},P.prototype.mGe=function(t,n){var i=this;i.ILt=t,i.LEt=n},P.prototype.UGe=function(n,t,i,r){var e,o;if((0,S.isNumber)(n))return this.Dve(n,t);if((0,S.isString)(n)){if(e=void 0,-1<(o=this.yLt.findIndex(function(t){return(0,p.getColumnName)(t)===n})))e=this.oUe(o,t);else if(i&&(e=this.hHe(n)))return!1===t||r?f({},e):e;return e}return n},P.prototype.xRe=function(t){var n,i,r,e,n=this;return(0,S.isNumber)(t)&&(i=n.uPt(t)),e=function(){var t=n.getHierarchyColumnIndex();return t===i||n.yLt[t].value===r.value},!(!(r=n.UGe(t))||!(r.isGroup||r.isCross||n.isHierarchy()&&e()||n.ABe(r,!0)||n.xBe(r)))},P.prototype.aHe=function(t,n){var i,t,r,i=this,t=i.UGe(t),r=function(t,n){var t,n,t=(0,S.isFormula)(t.value)||(0,S.isRelation)(t.value)||i.FPt(t.value,!0)||(0,S.isNamedFormulaColumn)(t),n=i.gLt.isDataColumn(n);return t&&n};return!(r(t,n)||r(n,t))},P.prototype.xBe=function(t){return this.gLt.xBe(this.ife(t))},P.prototype.removeColumn=function(t){this.VBe(t)},P.prototype.VBe=function(t,e){var o,n,u,o=this,n=this.UGe(t);this.xRe(n)||(this.fUe(n),this.GGe(n),u=this.lLt&&this.lLt.removeField(t),this.lUe(t,function(t,n,i,r){var i=e?e(n,i):i.splice(n,1)[0];o.AGe.nGe({type:_.ViewChangeType.DeleteColumn,index:n,oldData:i,isInfo:r,isField:!!r&&u})}))},P.prototype.hUe=function(t,n,i){this.dUe(t,a,n,i)},P.prototype.dUe=function(t,n,i,r){var e,i,o,r,u,e=this,i=e.GLt(i,r),o=i.success,r=i.fail,u=e.ife(t);D(u)?(n&&n(a),e.removeColumn(u),o({success:!0})):e.gLt.removeColumn(u,function(t){n&&n(t),e.removeColumn(u),e.AGe.nGe({type:_.ViewChangeType.DefineColumnRemoveColumn,name:u,table:t.table,source:t.source}),o(t)},r)},P.prototype.fUe=function(i){var r,e,o,u,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(o=r.yLt,u=o.length,t=function(n){var t=o[n];if(i===t)return r.CLt=e=e.map(function(t){return n<t&&--t,t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,u-1),"break"},n=0;n<u&&"break"!==(s=t(n));n++);},P.prototype.eUe=function(i){var r,e,o,u,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(o=r.yLt,u=o.length,t=function(n){var t=o[n];if(i===t)return r.CLt=e=e.map(function(t){return n<=t&&(t+=1),t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,u),"break"},n=0;n<u&&"break"!==(s=t(n));n++);},P.prototype.OGe=function(){var t=this;return{sortBefore:(0,p.removeExtraInfos)(t.DLt),sortAfter:(0,p.removeExtraInfos)(t._Lt),sortInfo:(0,p.removeExtraInfos)(t.kLt)}},P.prototype.YBe=function(t,n,i,r){var e,o,u,e=this,o=this.qGe(n);return i&&(o=f({},o)),(0,S.isNamedFormulaColumn)(o)?(o.value=o.name,delete o.name,delete o.dataType):o.name=(0,p.getColumnName)(o),e.vUe(t,o,r),u=o,e.lUe(t,function(t,n,i,r){u=e.gUe(o,t),i.splice(n,1,u),e.AGe.nGe({type:_.ViewChangeType.UpdateColumn,index:n,oldData:f({},t),isInfo:r})}),r&&r.isNameUpdated&&e.dGe(t,(0,p.getColumnName)(u)),u},P.prototype.mUe=function(t,n,i,r){this.pUe(t,n,a,i,r)},P.prototype.pUe=function(t,n,i,r,e){var o,r,u,e,s,c,r,o=this,r=o.GLt(r,e),u=r.success,e=r.fail;n=o.qGe(n),t=o.UGe(t),s=n.type!==t.type?f({},n):f(f({},t),n),o.aHe(t,s)?(c=(0,S.isNamedFormulaColumn)(t)?t.name:o.ife(t),(0,S.isFormula)(c)&&(0,S.isFormula)(s.value)&&!(0,S.isNamedFormulaColumn)(s)||(0,S.isRelation)(c)&&(0,S.isRelation)(s.value)||(0,S.isFormula)(c)&&(0,S.isRelation)(s.value)||(0,S.isRelation)(c)&&(0,S.isFormula)(s.value)?(r=i?{onSucceededBefore:i}:a,n=o.YBe(c,s,!1,r),u(f({success:!0,column:f({},n)},r))):(0,S.isFormula)(c)&&(0,S.isNamedFormulaColumn)(s)?o.iUe(s,function(t){o.VBe(c,function(t,n){return n.splice(t,1,n.pop())[0]}),u(t)},e):o.gLt.updateColumn(c,n,function(t){t.onSucceededBefore=function(t){t.isNameUpdated&&o.lLt&&o.lLt.renameBaseField(c,(0,p.getColumnName)(n)),i&&i(t)},n=o.YBe(c,s,!1,t),t.column=f({},n),o.AGe.nGe({type:_.ViewChangeType.DefineColumnModifyColumn,table:t.table,source:t.source}),u(t)},e)):e()},P.prototype.vUe=function(t,n,i){var r,e,o,u,s,t,r=this,e=r.UGe(t),o=r.TGe(n,e),u=r.jGe(n,e),s=r.kGe(n,e),t=t!==r.ife(n);t&&r.GGe(e,n),i?(i.isNameUpdated=t,i.isFilterUpdated=o,i.isSortUpdated=u,i.isGroupUpdated=s,i.onSucceededBefore(i)):o?r.tFt(a,a,a,!0):s?r.nPt(a,!0):u&&r.NFt(!0)},P.prototype.lUe=function(t,n){for(var i,r,e,o,u,i=this.ILt,r=0;r<i.length;r++)if(e=i[r],this.bUe(e,t)){n(e,r,i,!1);break}for(o=this.yLt,r=0;r<o.length;r++)if(u=o[r],this.bUe(u,t)){n(u,r,o,!0);break}this.PPt(),this.Gfe()},P.prototype.bUe=function(t,n){return t.value===n||t.name===n},P.prototype.gUe=function(t,n){return t.type!==n.type?f({},t):f(f({},n),t)},P.prototype.tFt=function(t,n,i,r){n||this.gFt(t);var n=this.mFt(r);n&&this.dFt(),this.vFt(r),this.nPt(n?O:i,r),this.wFt=O,this.Efe=O},P.prototype.VAe=function(){this.AGe.VAe()},P.prototype.zAe=function(){this.AGe.zAe()},P.prototype.eGe=function(){return this.AGe.eGe()},P.prototype.$Be=function(){return this.AGe.$Be()},P.prototype.tGe=function(t){this.AGe.tGe(t)},P.prototype.iGe=function(){this.AGe.iGe()},P.prototype.Mtt=function(t){return this.AGe.Mtt(t)},P.prototype.excludeInsertedPinnedRows=function(){for(var t,n,i,r,t=this,n=t.lFt,i=[],r=0;r<n.length;r++)t.isInserted(r)||i.push(n[r]);return i},P.prototype.toJSON=function(){var i,t,r,n,e,i=this,t={};if(i._Lt&&(t={sortBefore:(0,p.removeExtraInfos)(i.DLt),sortAfter:(0,p.removeExtraInfos)(i._Lt)}),0===(r=i.ILt).length)0===i.yLt.length&&i.cPt(),r=i.ILt=i.yLt;else for(n=function(n){var t,t,t,t=r[n].cross;(0,S.isNullOrUndefined)(t)&&(t=i.yLt.filter(function(t){return t.value===r[n].value})[0])&&(r[n]=t),(t=r[n].validator)&&"date"===t.type&&(l(t.value1)&&(t.value1=d(t.value1)),l(t.value2))&&(t.value2=d(t.value2))},e=0;e<r.length;e++)n(e);return f(f({},t),{name:i.name,options:i.LEt,columns:i.ILt,indexMap:i.iRt,columnIndexMap:i.oPt,autoSort:i.autoSort,sortInfo:(0,p.removeExtraInfos)(i.kLt),autoFilter:i.autoFilter,filterInfo:(0,p.removeExtraInfos)(i.NLt),autoGroup:i.autoGroup,groupInfo:i.MFt,detailColumnsVisible:i.UFt,pinnedRows:i.excludeInsertedPinnedRows(),pinnedColumns:i.CLt})},P.prototype.fromJSON=function(t){var n,i,r,e,o,u,n=this;if(n.iRt=t.indexMap,i=t.columnIndexMap,r=n.yLt,i&&r&&0<i.length&&i.length<r.length)for(e=i.length;e<r.length;e++)i[e]=e;for(e=0;e<r.length;e++)(o=r[e].validator)&&"date"===o.type&&("string"==typeof o.value1&&(u=v(o.value1))&&(o.value1=u),"string"==typeof o.value2)&&(u=v(o.value2))&&(o.value2=u);n.oPt=i,n.autoSort=t.autoSort,n.kLt=t.sortInfo,n.DLt=t.sortInfo,t.sortAfter&&(n.DLt=t.sortBefore,n._Lt=t.sortAfter),n.autoFilter=t.autoFilter,n.NLt=t.filterInfo,n.autoGroup=t.autoGroup,n.MFt=t.groupInfo,n.UFt=t.detailColumnsVisible,n.lFt=t.pinnedRows,n.CLt=t.pinnedColumns},t.View=P},"./dist/src/viewField/fieldManager.js":function(F,t,n){"use strict";var u,a,M,s,x,j,c,R;function f(r,e,o,u){return function(t,n){var n,i,n=r.getField(n),i=o&&!(0,c.isGroupSlice)(n.name)&&n.extra&&n.extra.caption||n.name;return u&&n instanceof j.ColumnDataReaderField||(t[i]=n.getValue(e)),t}}function i(t,n){this._id=0,this.Pq=[],this.Z={},this.groupFieldKeys=[],this.sBt=t,this.cBt={},this.nM=n}function h(t,n){var i,r,e,o,o,u,s,c,f,f,i=[];if(t.function)for(r=0,e=t.arguments;r<e.length;r++)if(14===(o=e[r]).type){if(!n){i.push(o.value.Pq[0]);break}i.push(o.value.Pq[0])}else(o=h(o))&&(i=i.concat(o));else for(u=0,s=Object.getOwnPropertyNames(t);u<s.length;u++)if((f=t[c=s[u]])instanceof a.Expression)if(14===f.type){if(!n){i.push(f.value.Pq[0]);break}i.push(f.value.Pq[0])}else(f=h(f))&&(i=i.concat(f));return i}function r(t,n){for(var n,i,r,e,o,u,s,c,n=n.valueRelation,i=n.split("."),r=t(n),e="",o=!1,u=!1,s=0;s<i.length;s++)c=r[s],(0,M.isNullOrEmpty)(i[s])||(e+=".".concat(i[s])),!u&&c&&"array"===c.type&&c.name===i[s]&&(o=u=!0,e+=".".concat(x.RelationTemplateToken));return{isOneToMany:o,relationTemplate:e.slice(1)}}function l(t,n,i,r){var e,o,e=P(t),o;return{valueRelation:t,valueCaption:n||e,valueIndex:i,valueCrossKey:r}}function T(t){for(var n,i,r,e,o,n=t.columns,i=t.crossKeys,r=t.initialOptionIndex,e=[],o=0;o<n.length;o++)e.push(l(n[o].value,n[o].caption,r+o,i[o]));return e}function D(t,n){return e(t,n,"")}function e(t,n,i){return!(0,M.isNullOrEmpty)(n)&&0<=t.indexOf(n)?e(t=t.replace(n,i),n,i):t}function y(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function d(t){var t,t="string"==typeof t||(0,M.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value;return(t||"").split(".")}function P(t){var t=d(t);return t[t.length-1]}function A(t){if(!(0,M.isNullOrEmpty)(t.formatter))return t.formatter}function k(t){var t=d(t);return t[t.length-2]}function L(t,n){var t=d(t);return n&&t.splice(t.length-1,0,""),t.slice(0,t.length-1).join(".")}function V(t){return"string"==typeof t?[t]:t||[]}function g(t){for(var n,i,r,e,o,n=0,i={},r=0;r<t.length;r++)e=t[r].caption,(0,M.isArray)(e)?(t[r].caption=e.map(function(t){return null==t?void 0:t.toString()}),i[r]=e.length,n<i[r]&&(n=i[r])):t[r].caption=null==e?void 0:e.toString();for(r in i)if(i[r]<n)for(o=n-i[r],e=t[r].caption;0<o;)e.unshift(),o--;for(r=0;r<t.length;r++)e=t[r].caption,(0,M.isArray)(e)&&1===e.length&&(t[r].caption=e[0])}function v(t,n){var t,t,t,i,t=t.qRt(n);if(!((0,M.isNullOrUndefined)(t)||(t=t._dataSource.options.schema,(0,M.isNullOrUndefined)(t))||(t=t.columns,(0,M.isNullOrUndefined)(t))||(i=t[P(n)],(0,M.isNullOrUndefined)(i))))return i.lookup}function o(t,n){return p(t,n)||w(t,n)}function p(t,n){return(0,M.isArray)(v(t,n))}function w(t,n){var i,r,e,o,n,i=v(t,n);if((0,M.isObject)(i)&&(i=i.name),(0,M.isString)(i))return r=t.qRt(n),e=P(n),o=P(i),n=t.QOt.relationships.find(function(t){return t.sourceTable===r&&t.sourceFieldName===e&&t.sourceRelationshipName===o}),!(0,M.isNullOrUndefined)(n)}function b(t,n,i){var r=P(i),i=S(t,function(t){return t.sourceFieldName===r&&t.sourceTable===n});return i?{relationTable:i.targetTable,relationPrimaryKey:i.targetFieldName,relationTableName:i.sourceRelationshipName}:{}}function m(t,n,i){var r,n,e,o,n,o,n,e,o,r,r=n.over,n=n.attributes;return!((0,M.isNullOrEmpty)(r)||(0,M.isNullOrEmpty)(i)||i===r||_(t,i)||(e=d(i),n=!(o=p(t,r))&&w(t,r)&&n&&0<n.length,!o&&!n)||(o=b(t,O(t,r),r),-1<e.indexOf(o.relationTableName)))&&(n=t.$Rt(r),e=t.$Rt(i),!(!n.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})||!e.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}))||(o=(0,M.findIndex)(n,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),r=(0,M.findIndex)(e,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),-1<o&&o===r&&n[o].name===e[r].name?n.slice(o+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})&&e.slice(o+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}):void 0))}function _(t,n){var i=O(t,n),r=P(n);return i.jOt(r)||S(t,function(t){return t.sourceTable===i&&t.sourceFieldName===r||t.targetTable===i&&t.targetFieldName===r})}function O(t,n){return t.qRt(n)}function S(t,n){return t.QOt.relationships.find(n)}function C(t){var r=t.ascending,i=t.compare;return i?function(t,n){return i(t.extra.caption,n.extra.caption,r)}:function(t,n){var t=t.extra.caption,n=n.extra.caption,i=r?t:n,n=r?n:t;return n<i?1:i<n?-1:0}}u=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.isValidCross=t.isLookupRelationField=t.isLookupListField=t.isLookupField=t.getLookupBy=t.getFieldNamesFrom=t.FieldManager=void 0,a=n("CalcEngine"),M=n("./dist/src/dataSource/utils.js"),s=n("./dist/src/interfaces/interface.js"),x=n("./dist/src/viewField/utils.js"),j=n("./dist/src/viewField/fields.js"),c=n("./dist/src/viewField/groupManager.js"),i.prototype.hde=function(){return this.nM.length()},i.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},i.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},i.prototype.hBt=function(t){return this.nM.iBt(t)},i.prototype.dBt=function(t){return S(this.nM,t)},i.prototype.vBt=function(t){return O(this.nM,t)},i.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},i.prototype.gBt=function(t){return!(0,M.isNullOrUndefined)(this.nM._dataSource._data[t])&&!this.nM._dataSource.X7t()},i.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},i.prototype.pBt=function(){return this.nM.POt},i.prototype.bBt=function(t){return v(this.nM,t)},i.prototype.yBt=function(t){return o(this.nM,t)},i.prototype.wBt=function(t){return p(this.nM,t)},i.prototype.MBt=function(t){return w(this.nM,t)},i.prototype.getTable=function(){return this.nM},i.prototype.getField=function(n){return this.Z[n]||this.Pq.find(function(t){return t.key===n})},i.prototype.getFieldByColumn=function(t){return this.getField(t.Kyn)},i.prototype.getFieldByName=function(t){return this.Z[t]},i.prototype.getFields=function(t){return this.Pq.filter(t)},i.prototype.kve=function(t,n,i,r,e){var o=this;f(o,i,r,e)(t,o.getFieldByColumn(n).key)},i.prototype.getFieldValues=function(t,n,i){for(var r,e,o,u,s,c,r=this,e=f(r,t,n,i),o={},u=0,s=r.Pq;u<s.length;u++)e(o,(c=s[u]).key);return o},i.prototype.CBt=function(t){for(var n,i,r,e,o,u,n=this,i=f(n,t),r={},e=0,o=n.Pq;e<o.length;e++)(u=o[e]).isGroup&&i(r,u.key);return r},i.prototype.moveFields=function(t,n,i){(0,M.swapArrayItems)(this.Pq,t,n,i)},i.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach(function(t){t.field=n.Pq[t.oldIndex]}),t.forEach(function(t){n.Pq[t.newIndex]=t.field})},i.prototype.removeFields=function(t,n,i){var r;i&&i({fields:u([],this.Pq,!0)})},i.prototype.yGe=function(t){var t=t.fields;this.Pq=t},i.prototype.reset=function(){var n=this;n.Pq=n.Pq.filter(function(t){return t.isBasic}),n.Z={},n.groupFieldKeys=[],n.Pq.forEach(function(t){n.Z[t.name]=t,n.Z[t.key]=t})},i.prototype.bMt=function(t){return this.cBt[t]||this.Awe(t)},i.prototype.Awe=function(t,n){var i=this,r=i.cBt,e=r[t],n=n||i.pBt(),o=n.getCalcService(),e;return e=e||(r[t]=i.fixExpression(o.parse(n,t,0,0)))},i.prototype.SBt=function(t){var n=this,e=n.Awe(t),o=n.pBt(),u=o.getCalcService();return function(t,n,i,r){var t,n;return o.pe(t,n,i),(t=4===arguments.length)&&o.wEt("extendContext",r),n=u.evaluateExpression(o,e,{row:0,col:0}),t&&o.wEt("extendContext"),n}},i.prototype.TBt=function(t,n){var i=this,e=i.Awe(t,n),o=n||i.pBt(),u=o.getCalcService();return function(t,n,i,r){var t,n;return o.pe(t,n,i),(t=4===arguments.length)&&o.wEt("extendContext",r),n=u.MX.evaluateExpression(e,o.getEvaluatorContext({row:0,col:0},!1),!1,!0),t&&o.wEt("extendContext"),(0,M.isNullOrUndefined)(n.toArray)?[]:n.toArray()}},i.prototype.fixExpression=function(t){var n,i,r,e,o,u,s,n=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),i=0,r=t.arguments;i<r.length;i++)e=r[i],n.fixExpression(e);else for(o=0,u=Object.getOwnPropertyNames(t);o<u.length;o++)t[s=u[o]]instanceof a.Expression&&n.fixExpression(t[s]);return t},i.prototype.ABt=function(t){var n=this;return t.key=n._id++,n.Pq.push(t),n.Z[t.name]=t,n.Z[t.key]=t},i.prototype.removeField=function(t){var n=this,i;return((i=(0,M.isString)(t)?n.getFieldByName(t):i)instanceof j.ColumnDataField||i instanceof j.ColumnDataReaderField)&&(n.Pq.splice(n.Pq.indexOf(i),1),delete n.Z[i.name],delete n.Z[i.key],!0)},i.prototype.addBaseField=function(t){var n=this,i=y(t),r=t.value;n.gBt(i)?n.addDataBaseField(i,n.mBt(i),t):n.addReaderBaseField(i,r,t)},i.prototype.renameBaseField=function(t,n){var i=this,r;return((r=(0,M.isString)(t)?i.getFieldByName(t):r)instanceof j.ColumnDataField||r instanceof j.ColumnDataReaderField)&&(i.Z[n]=i.Z[r.name],delete i.Z[r.name],r.name=n,!0)},i.prototype.addDataBaseField=function(t,n,i){var r=this,t=r.addColumnDataField(t,n,i);return i.Kyn=t.key,r.CGe(t)},i.prototype.addReaderBaseField=function(t,n,i){var r,t,r=this,t=r.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return r.fBt(n,t)},i,r.hde.bind(r));return i.Kyn=t.key,r.CGe(t)},i.prototype.CGe=function(t){return t.isBasic=!0,t},i.prototype.addColumnDataField=function(t,n,i){return this.ABt(new j.ColumnDataField(t,n,i))},i.prototype.addColumnDataReaderField=function(t,n,i,r){return this.ABt(new j.ColumnDataReaderField(t,n,i,r))},i.prototype.addDataField=function(t,n){return this.ABt(new j.DataField(t,n))},i.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},i.prototype.xBt=function(t,n){return new j.FormulaField(t,n,this.SBt(n))},i.prototype.addCategoryFormulaField=function(t,n,i){return this.ABt(this.NBt(t,n,i))},i.prototype.NBt=function(t,n,i){return new j.CategoryFormulaField(t,n,this.SBt(n),i,i?this.Awe(i):null)},i.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},i.prototype.kBt=function(t,n){return new j.CategoryField(t,n)},i.prototype.addSliceCategoryField=function(t){return this.ABt(new j.SliceCategoryField(t))},i.prototype.DBt=function(t,n,i,r,e){for(var o,u,s,c,f,a,h,a,l,d,v,c,o=this,u=t.fieldExtra,s=t.field,l=0,d=i.length;l<d;l++)f=(a=i[l]).result,h=a.key,(0,M.isUndefined)(h)&&(v=a.value,t.field.addKey(v,a.recordRowNumbers[0]),c=t.field.getMap(),h=a.key=c[v]),a=t.sliceFields[h],(0,M.isUndefined)(a)&&(c=s.getValueByKey(h),(a=o.addSliceCategoryField((0,x.combineName)((0,M.isNullOrEmpty)(c)?" ":c,"s",n.name))).isGroup=!0,a.setFieldExtra(u),a.setFieldManager(o),t.sliceFields[h]=a,t.sliceKeys.push(a.key)),a.setData(f,r,e)},i.prototype._Bt=function(n,t,i,r){var e=this;return(0,x.isField)(n)?e.getFieldByName(n):(0,M.isFormula)(n)?e.EBt((0,x.combineName)(n,"".concat(r,"_formula_source")),t,n,i):(0,M.isRelation)(n)?new j.ColumnDataReaderField((0,x.combineName)(n,"".concat(r,"_related_source")),function(t){return e.fBt(n,t)},{value:n},e.hde.bind(e)):e.getFieldByName(n)},i.prototype.EBt=function(t,n,i,r){var e,t=this.xBt((0,x.combineName)(t,n),i);return t.evaluateFormulaBy(r),t},i.prototype.MGe=function(t){var n,i,t,n,i,t=h(this.bMt(t),!0);return t&&0<t.length?t[0]:null},i.prototype.buildGroupFields=function(t,c){var f=this,i,a,h=[];return t.forEach(function(t,n){var s,n,n;(0,M.isNullOrEmpty)(t.field)||(a=(0,M.isNullOrUndefined)(a)?i={}:a.group={},s=(0,x.combineName)(t.field,n),n=f._Bt(t.field,s,c,"group_field"),(n=f.addCategoryField(s,n)).setFieldExtra(t),n.setFieldManager(f),n.isGroup=!0,h.push(n.key),a.field=n,"boolean"==typeof t.ascending&&(a.sort=t.ascending?"asc":"desc"),(0,M.isNullOrUndefined)(t.summaryFields)||t.summaryFields.forEach(function(t,n){var n,i,r,r,i,e,o,u,o;(0,M.isNullOrEmpty)(t.formula)||(n=(0,x.combineName)(t.formula,n,s),(i=f.addCategoryFormulaField(n,t.formula,t.filter)).setFieldExtra(t),i.setFieldManager(f),(0,M.isNullOrEmpty)(t.position)||(i.extra.position=t.position),(0,M.isNullOrEmpty)(t.relateTo)?(r=f.MGe(t.formula),(0,M.isNullOrUndefined)(r)||(i.extra.relateTo=r)):i.extra.relateTo=t.relateTo,(0,M.isNullOrUndefined)(a.formulas)&&(a.formulas=[]),r=a.formulas.push(i)-1,i.isGroup=!0,h.push(i.key),(0,M.isNullOrUndefined)(t.slice))||(i=t.slice,o=(e=(0,M.isString)(i))?i:i.field,u=f._Bt(o,n,c,"slice"),(u=f.kBt((0,x.combineName)(o,"slice_category",n),u)).setFieldManager(f),(0,M.isNullOrUndefined)(a.slices)&&(a.slices=[]),o=f.NBt((0,x.combineName)(o,"slice_formula_result",n),t.formula),a.slices.push({field:u,formula:o,formulaIndex:r,sliceKeys:[],fieldExtra:e?{}:i,sliceFields:{},addSliceField:f.DBt.bind(f)}))}),(0,M.isNullOrUndefined)(t.windowOrderedFunctions))||(a.windowFunctionOptions=t.windowOrderedFunctions.map(function(t){return{orders:t.orders,fields:t.functions.map(function(t){return f.nM.XOt[t.windowOverFormula]})}}))}),f.groupFieldKeys=h,i},i.prototype.transposeSliceFields=function(i){var r=this,e,o;i.slices&&i.slices.forEach(function(t){var n,n,n=i.formulas[t.formulaIndex];e=r.groupFieldKeys.indexOf(n.key),o=t.sliceKeys,(0,M.isNullOrUndefined)(t.fieldExtra.sort)||(o=o.map(function(t){return r.getField(t)}).sort(C(t.fieldExtra.sort)).map(function(t){return t.key})),(n=r.groupFieldKeys).splice.apply(n,u([e+1,0],o,!1))}),i.group&&r.transposeSliceFields(i.group)},i.prototype.prepareFields=function(u){for(var s,c,f,t,n,i,r,e,o,a,o,h,l,d,v,p,w,b,m,s=this,c=[],f=0,t=0;f<u.length;f++,t++)if(i=y(n=u[f]),r=n.value,e=n.cross){if(a=(o=s.jBt(u,f)).crossColumnOptions,o=o.endColIndex,h=a.columns.length,0!==(l=s.OBt(a))){for(d=s.Pq.length-l,v=function(t,n){var i,r,i,e,o,i=d+t,r=f+n,i=s.Pq[i];i.setFieldExtra(u[r]),i.setFieldManager(s),e={value:i.name,name:i.name,Kyn:i.key,isCross:!0,RBt:r},i.isReadonly()&&(e.readonly=!0),(o=i.extra)&&(0,j.setFieldExtraProperties)(function(t){(0,M.isNullOrUndefined)(o[t])||(e[t]=o[t])}),c.push(e),p=++t,w=n=h<=++n?0:n},m=b=0;b<l;)v(b,m),b=p,m=w;f=o,t+=l-1}}else s.gBt(i)?s.addDataBaseField(i,s.mBt(i),n):s.addReaderBaseField(i,r,n),c.push(u[f]);return g(c),c},i.prototype.jBt=function(t,n){var i,r,e,o,e,u,s,i=this,r=n,e=t[n],o=e.cross,e=i.BBt(o,[e],r);if("string"==typeof o){for(s=u=n;n<t.length&&!(++s<t.length&&o!==t[s].cross);)n++;e=i.BBt(o,t.slice(u,s),r)}return{crossColumnOptions:e,endColIndex:n}},i.prototype.BBt=function(t,n,i){var t="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:i,crossKeys:n.map(function(t){return t.LBt}),cross:t,columns:n,lookup:this.FBt(t,n)}},i.prototype.FBt=function(n,t){var i=this;return t.every(function(t){return i.isValidCross(n,t.value)})&&this.bBt(n.over)},i.prototype.isValidCross=function(t,n){return m(this.nM,t,n)},i.prototype.OBt=function(t){var n=this,i=t.lookup,r=0;return(0,M.isArray)(i)?r=n.PBt(t):((0,M.isString)(i)||(0,M.isObject)(i))&&(r=n.GBt(t)),r},i.prototype.GBt=function(t){var n,i,r,e,o,u,s,c,f,a,h,t,l,d,v,p,w,l,b,i,m,j,y,g,_,O,S,C,F,R,I,N,E,R,N,n=this,i=t.cross,r=n.sBt.showCrossValueHeader,e=V(i.caption),o=0,u=T(t),s=i.over,c=P(s),f=s,a=i.attributes||[],h=a.length,t=L(a[0],!0),l=n.UBt(n.vBt(f),f),d=l.relationTableName||k(a[0]),v=l.relationTable||n.HBt(d),p=v.length(),w=l.relationPrimaryKey||n.zBt(d,c),l=i.filter?n.TBt(D(i.filter,t),v.POt):null;for((0,M.isNullOrUndefined)(l)||0<(i=l(null)).length&&(b=i.reduce(function(t,n){var i;return t["object"==typeof n?n[w]:n]=!0,t},{})),m=[],j=0;j<h;j++)y=P(a[j]),g=A(a[j]),m.push({fieldName:y,formatter:g});for(_=0;_<p;_++)if(O=v._getValueByField(w,_),(0,M.isNullOrUndefined)(b)||b[O]){for(S=e.slice(),j=0;j<h;j++)y=m[j].fieldName,C=v._getValueByField(y,_),g=m[j].formatter,(0,M.isNullOrUndefined)(g)||(C=(0,M.format)(C,g)),S.push(C);for(F=0;F<u.length;F++)I=(R=u[F]).valueRelation,N=R.valueCaption,E=R.valueIndex,R=R.valueCrossKey,N=r?S.concat(N):S,n.VBt({path:N,value:(0,x.combineName)(I,O,s,R),valueRelation:I,dimRelationPath:f,dimRelationKey:c,dimTableName:d,dimTableKeyFieldValue:O,initialOptionIndex:E}),o++}return o},i.prototype.PBt=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,w,m,n=this,i=t.cross,r=t.lookup,e=n.sBt.showCrossValueHeader,o=V(i.caption),u=0,s=T(t),c=i.over,f=P(c),a=c,h=r.length,l=0;l<h;l++)for(d=o.slice(),v=r[l],d.push(v),p=0;p<s.length;p++)b=(w=s[p]).valueRelation,m=w.valueCaption,j=w.valueIndex,w=w.valueCrossKey,m=e?d.concat(m):d,n.VBt({path:m,value:(0,x.combineName)(b,v,c,w),valueRelation:b,dimRelationPath:a,dimRelationKey:f,dimTableKeyFieldValue:v,initialOptionIndex:j}),u++;return u},i.prototype.setCrossFieldValues=function(t){var n,i,r,e,o,u,s,c,f,n=this,i=n.Pq,r=t.length,e=i.filter(function(t){return t instanceof j.CrossField});if(0<e.length)for(o=0;o<r;o++)for(u=t[o],s={},c=0;c<e.length;c++)f=e[c],n.YBt(f,u,s)},i.prototype.YBt=function(t,n,i){var r,e,o,u,r=this,e=t.dimRelationPath,o=i[e];if((0,M.isNullOrUndefined)(o)&&t.isOneToMany&&(o=i[e]=r.fBt(e,n)),(0,M.isArray)(o))for(u=0;u<o.length;u++)if(t.ZBt(o[u],t.dimTableKeyFieldValue)&&(0,M.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,u);break}},i.prototype.zBt=function(n,i){var t=this,r=t.dBt(function(t){return t.sourceFieldName===i&&t.sourceRelationshipName===n});return r?r.targetFieldName:(r=t.dBt(function(t){return t.targetFieldName===i&&t.targetRelationshipName===n}))?r.sourceFieldName:void 0},i.prototype.HBt=function(n){var t,i=this.dBt(function(t){return t.sourceRelationshipName===n||t.targetRelationshipName===n})||{},i=i.sourceRelationshipName===n?i.sourceField:i.targetField;return i?i.targetTable:{length:function(){return 0}}},i.prototype.UBt=function(t,n){return b(this.nM,t,n)},i.prototype.WBt=function(t){var n=this,t=new j.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(t),n.CGe(t),t},i.prototype.VBt=function(t){var n,t,n,i,n,n=this,t=n.WBt(t);t.isReadonly()||(i=(n=r(n.oBt.bind(n),t)).isOneToMany,n=n.relationTemplate,i&&(t.isOneToMany=i,t.valueArrayRelation=n))},i.prototype.isCrossField=function(t){return t instanceof j.CrossField},i.prototype.clearCrossFieldData=function(){for(var t,n,i,r,t,n=this.Pq,i=0;i<n.length;i++)(r=n[i])instanceof j.CrossField&&r.clearData()},i.prototype.resetCrossFieldRowValues=function(t){for(var n,i,r,e,o,n=this,i=n.Pq,r={},e=0;e<i.length;e++)(o=i[e])instanceof j.CrossField&&(o.clearValue(t),n.YBt(o,t,r))},i.prototype.removeCrossFieldValues=function(t,n){for(var i,r,e,o,i,r=this.Pq,e=0;e<r.length;e++)(o=r[e])instanceof j.CrossField&&o.removeData(t,n)},i.prototype.setCrossFieldInsertedIndex=function(t,n,i){for(var r,e,o,u,s,r,e=this.Pq,o=L(t.valueRelation,!0),u=0;u<e.length;u++)(s=e[u])instanceof j.CrossField&&s.isOneToMany&&t.dimTableKeyFieldValue===s.dimTableKeyFieldValue&&(0,M.isNullOrUndefined)(s.getValueIndex(n))&&o===L(s.valueRelation,!0)&&s.setValueIndex(n,i)},t.FieldManager=i,t.getFieldNamesFrom=h,t.getLookupBy=v,t.isLookupField=o,t.isLookupListField=p,t.isLookupRelationField=w,t.isValidCross=m},"./dist/src/viewField/fields.js":function(t,n,i){"use strict";var r,c,s,i,e,o,u,f,e,a,h,l,d,v,p,w,b,m,j,y,g;function _(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit","allowSort","allowFilterByValue","allowFilterByList"].forEach(t)}function O(t){var n=(this.name=t).indexOf(s.FieldNameDelimiter);-1<n&&(t=t.slice(0,n)),this.fieldValue=t}function S(t,n){var t=v.call(this,t)||this;return t.data=n||[],t}function C(t,n,i){var t=p.call(this,t,n)||this;return t.column=i,t}function F(t,n,i,r){var t=w.call(this,t)||this;return t.column=i,t.setFieldExtra(i),t.getValue=n,t.getLength=r,t}function R(t,n,i){var t=b.call(this,t)||this;return t.setFieldExtra({value:n}),t.formula=n,t.P6t=i,t}function I(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function N(t,n){var t=m.call(this,t)||this;return t.QBt=n,t.KBt={},t.Oit=[],t}function E(t,n,i,r,e){var t=j.call(this,t)||this;return t.P6t=i,t.formula=n,t.filter=r,t.filterExpression=e,t}function M(t){return y.call(this,t)||this}function x(t,n,i,r){var e=g.call(this,t.value)||this;return e.path=t.path,e.valueRelation=t.valueRelation,e.valueField=-1<t.valueRelation.indexOf(".")?t.valueRelation.split(".").pop():t.valueRelation,e.dimRelationPath=t.dimRelationPath,e.dimRelationKey=t.dimRelationKey,e.dimTableName=t.dimTableName,e.isDateDimValue=t.dimTableKeyFieldValue instanceof Date,e.dimTableKeyFieldValue=e.isDateDimValue?t.dimTableKeyFieldValue.getTime():t.dimTableKeyFieldValue,e.initialOptionIndex=t.initialOptionIndex,e.getValueByField=T(t,r,n),e.getOriginalValueByField=T(t,r,i),e.data=[],e}function T(t,i,r){return(0,c.isFunction)(t.valueRelation)?function(t,n){return(0,c.isFunction)(t)?t(i(n)):r(t,n)}:r}r=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,c=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/viewField/utils.js"),n.setFieldExtraProperties=_,O.prototype.setFieldExtra=function(n){var i,t,i=this;(0,c.isUndefined)(i.extra)&&(i.extra={}),(0,c.isNullOrUndefined)(n)||(n.field&&(i.fieldValue=n.field),_(function(t){i.JBt(t,n)}),(0,c.isNullOrUndefined)(n.caption)&&0<=(t=i.name.indexOf(s.FieldNameDelimiter))&&(i.extra.caption=i.name.substring(0,t)),(0,c.isNullOrUndefined)(n.spacing))||(i.extra.spacing=n.spacing)},O.prototype.JBt=function(t,n){var i=this,n=n[t];(0,c.isNullOrUndefined)(n)||(i.extra[t]=n)},O.prototype.setFieldManager=function(t){this.fieldManager=t},O.prototype.getFieldManager=function(){return this.fieldManager},O.prototype.getValue=function(t){return this.data[t]},O.prototype.getOriginalValue=function(t){return this.getValue(t)},O.prototype.getLength=function(){return this.data.length},O.prototype.XBt=function(t,n,i,r){var e,o,u,s,e=this;if(e.data||(e.data=[]),i=(0,c.isNumber)(i)?i:0,r=(0,c.isNumber)(r)?r:t.length-1,(0,c.isArray)(n))for(u=0,s=n.length;i<=r&&u<s;u++)o=t[i=u+i],e.data[o]=n[u];else for(u=i;u<=r;u++)o=t[u],e.data[o]=n;return e.data},O.prototype.qBt=function(t,n){var i,r,e,o,i=this;for(i.data||(i.data=[]),e=0,o=t.length;e<o;e++)r=t[e],i.data[r]=n(r);return i.data},n.Field=i=O,r(S,v=i),n.DataField=e=S,r(C,p=e),n.ColumnDataField=C,r(F,w=i),n.ColumnDataReaderField=F,r(R,b=e),R.prototype.evaluateFormulaBy=function(t){var n=this,i=n.formula,r=n.P6t;return n.qBt(t,function(t){return I(r(t),i)})[t[0]]},n.FormulaField=R,r(N,m=i),N.prototype.getKey=function(t){return this.KBt[t]},N.prototype.getMap=function(){return this.KBt},N.prototype.getValueByKey=function(t){return this.Oit[t]},N.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},N.prototype.getValue=function(t){var n=this;return n.data&&0<n.data.length?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},N.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},N.prototype.addKey=function(t,n){var i=this,r=i.getKey(t);return(0,c.isUndefined)(r)&&i.$Bt(r=n,t),r},N.prototype.getSourceField=function(){return this.QBt},n.CategoryField=e=N,r(E,j=e),E.prototype.evaluateFormulaBy=function(t,n,i){var r,e,i,r=this,e=0;return(0,c.isNullOrUndefined)(i)&&(i=t,e=n||0),i=r.P6t(i,e),r.XBt(t,r.addKey(i,t[n]),n),i},n.CategoryFormulaField=E,r(M,y=e),M.prototype.setData=function(t,n,i){var r=this,t=r.addKey(t,n[i]);r.XBt(n,t,i)},n.SliceCategoryField=M,r(x,g=i),x.prototype.setFieldExtra=function(t){g.prototype.setFieldExtra.call(this,t),this.extra.caption=this.path},x.prototype.ZBt=function(t,n){var i,r;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},x.prototype.tLt=function(t,n){var i=this,r=i.isOneToMany,e=i.dimRelationPath,o=i.dimTableKeyFieldValue;return!r&&i.ZBt(n(e,t),o)?t:this.data[t]},x.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,t=t.dimTableKeyFieldValue;return n?new Date(t):t},x.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},x.prototype.setValueIndex=function(t,n){this.data[t]=n},x.prototype.clearData=function(){this.data=[]},x.prototype.clearValue=function(t){this.data[t]=void 0},x.prototype.removeData=function(t,n){this.data.splice(t,n)},x.prototype.isReadonly=function(){return(0,c.isFormula)(this.valueRelation)||(0,c.isFunction)(this.valueRelation)},x.prototype.Sl=function(t,n){var i,r,e,o,i,u,i=this,r=i.isOneToMany,e=i.valueArrayRelation,o=i.valueRelation,i=i.tLt(t,n);if((0,c.isNumber)(i))return u=void 0,n(u=r?e.replace(s.RelationTemplateToken,i+1):o,t)},x.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},x.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},x.prototype.getRelationField=function(t){var n=this,i=n.isOneToMany,r=n.valueArrayRelation,e=n.valueRelation,n=n.getValueIndex(t);return i?(0,c.isNumber)(n)?r.replace(s.RelationTemplateToken,n+1):void 0:e},n.CrossField=x},"./dist/src/viewField/groupManager.js":function(t,n,i){"use strict";var e,l,o,u,s,c,r;function f(t,n){var i,r,e,o,u;if((0,l.isNullOrUndefined)(t)||(0,l.isNullOrUndefined)(n))return t===n;if(i=Object.keys(t),r=Object.keys(n),i.length!==r.length)return!1;for(e=0,o=i;e<o.length;e++)if(t[u=o[e]]!==n[u])return!1;return!0}function a(t){for(var n,i,r,n=[],i=t.split(o.FieldNameDelimiter).reverse(),r=0;r<i.length;r+=2)n.push(i[r]);return n}function h(t){return 1===a(t).length}function d(t){return 2===a(t).length}function v(t){return 3===a(t).length}function p(t){return 2===t.split(o.FieldNameDelimiter).length}function w(t){var t=t.split(o.FieldNameDelimiter);return t[t.length-2]}function b(t,n,i,r,e){this.LEt=t,this.wEt=n,this.wwn=r||function(){},this.xwe=e||function(){return[]};var t=this.fCe=new s.DataManagerProxy(i);this.Vhe=new u.DataManagerReportGroupHelper(t,void 0,void 0,new c.DataManagerReportSortHelper(t))}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,l=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/viewField/utils.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),c=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),n.getGroupOptionIndexesFrom=a,n.isGroupCategory=h,n.isGroupSummary=d,n.isGroupSlice=v,n.isGroupField=p,n.getGroupFieldName=w,b.prototype.dl=function(){this.fCe.clearTableDataCache()},b.prototype.isGrouped=function(t){return f(t,this.LEt)},b.prototype.groupBy=function(t,n){var i,r,e,o,i=this,r=i.Yhe(t),e,o={childrenArray:[this.Vhe.generateCellNodeTreeData(r,void 0,void 0,n,void 0,void 0,{ignoreMultipleTableJoinCache:!0})]};return{rootNode:o,indexMap:i.eLt(n,function(){return i.iLt(t,o)})}},b.prototype.Yhe=function(t){var n,i,r,e,i=this,r,e=(t.field.getSourceField()||t.field).fieldValue;return{templateCell:{sorts:t.sort?[((n={})[t.sort]=e,n)]:void 0,dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:e}},data:{groups:[]},field:t.field,group:t.group,children:t.group?[this.Yhe(t.group)]:[],slices:t.slices&&t.slices.length?t.slices.map(function(t){return i.Zhe(t)}):[],formulas:t.formulas}},b.prototype.Zhe=function(t){var n,i,r,n=e({},t),i,r=(n.field.getSourceField()||n.field).fieldValue;return n.templateCell={dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:r}},n.children=[],n.data={groups:[]},n},b.prototype.eLt=function(t,n){var i,r,r,i=this,r=i.LEt;return i.DJ={path:[],groupOptions:r,entireScope:t},i.wEt("groupContext",i.DJ),r=n(),i.DJ=null,i.wEt("groupContext"),r},b.prototype.iLt=function(t,n){for(var i,r,e,o,u,s,i=this,r,e=[],o=0,u=n.childrenArray&&n.childrenArray[0];o<u.length;o++)s=u[o],i.aLt(s,t,e);return e},b.prototype.aLt=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,r=this,e=i.length,o=t.recordRowNumbers;if(r.uLt(t),t.childrenArray&&t.childrenArray[0]&&0!==t.childrenArray[0].length)for(a=c=t.childrenArray[f=0];f<a.length;f++)h=a[f],r.aLt(h,n.group,i);else{for(u=0,s=o.length;u<s;u++)i[e+u]=o[u];t.key=n.field.addKey(t.value,i[e])}if(r.SGe(t,r.sLt(n.formulas,i,e)),r.dde(n.windowFunctionOptions,i,e),t.slices)for(u=0,d=(l=t.slices).length;u<d;u++){for(v=l[u],w=(p=n.slices[u]).formula,b=0,m=c=v.childrenArray&&v.childrenArray[0];b<m.length;b++)(h=m[b]).result=r.cLt(w,h.recordRowNumbers);p.addSliceField(p,n.formulas[p.formulaIndex],c,i,e)}r.fLt()},b.prototype.SGe=function(t,n){n&&(t.summaryResults=n)},b.prototype.Iwe=function(t,n,i){var r=t.filter;if(!(0,l.isNullOrEmpty)(r))return this.xwe(t.filterExpression,n,i)},b.prototype.Nwe=function(t,n,i){for(var r,e,o,u,s,c,f,r=[],u=0,s=t.length;u<s;u++)f=(c=t[u]).filter,(0,l.isNullOrEmpty)(f)||(e!==f?(e=f,o=r[u]=this.xwe(c.filterExpression,n,i)):r[u]=o);return r},b.prototype.sLt=function(t,n,i){var r,e,o,u,s,c,f,e,r,a,h,h;if(t)for(o={},u=this.Nwe(t,n,i),s=0,c=t.length;s<c;s++)e=(f=t[s]).extra&&f.extra.position,r=f.formula,a=f.extra&&f.extra.relateTo,o[r]?(h=o[r][e],(0,l.isNullOrUndefined)(h)&&(o[r][e]=h={}),(0,l.isNullOrUndefined)(h[a])&&(h[a]=f.extra)):(h=f.evaluateFormulaBy(n,i,u[s]),o[r]=((r={value:h})[e]=((e={})[a]=f.extra,e),r));return o},b.prototype.cLt=function(t,n){var i;if(t)return i=this.Iwe(t,n),t.evaluateFormulaBy(n,void 0,i)},b.prototype.dde=function(t,n,i){var r,e,o,u,s,c,f,a,h;if(t)for(r=this,e=0,o=t.length;e<o;e++)for(s=(u=t[e]).orders,c=u.fields,(0,l.isArray)(s)&&0<s.length&&r.wwn(n,s,i),f=0,a=c.length;f<a;f++)(h=c[f]).evaluateWindowFunction(n,i)},b.prototype.uLt=function(t){this.DJ.path.push(t)},b.prototype.fLt=function(){this.DJ.path.pop()},n.GroupManager=b},"./dist/src/viewField/utils.js":function(t,i){"use strict";function n(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.join(i.FieldNameDelimiter)}function r(t){return-1<t.indexOf(i.FieldNameDelimiter)}Object.defineProperty(i,"__esModule",{value:!0}),i.isField=i.combineName=i.RelationTemplateToken=i.CaptionDelimiter=i.FieldNameDelimiter=void 0,i.FieldNameDelimiter="__",i.CaptionDelimiter="\\",i.RelationTemplateToken="{{}}",i.combineName=n,i.isField=r},"./dist/src/viewField/viewField.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/viewField/groupManager.js"),n),e(i("./dist/src/viewField/fieldManager.js"),n),e(i("./dist/src/viewField/fields.js"),n),e(i("./dist/src/viewField/utils.js"),n)},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var i,r,n,e,o,u;e=this,void 0!==(n="function"==typeof(i=o=function(t,n){"use strict";var i,r=5e3,e="callback",o=null;function h(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function l(n){try{delete window[n]}catch(t){window[n]=void 0}}function d(t){var t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}function u(o){var u,s,c,f,a,u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o,c=u.timeout||r,f=u.jsonpCallback||e,a=void 0;return new Promise(function(t,n){var i,r,e,i=u.jsonpCallbackFunction||h(),r=f+"_"+i;window[i]=function(n){t({ok:!0,json:function t(){return Promise.resolve(n)}}),a&&clearTimeout(a),d(r),l(i)},s+=-1===s.indexOf("?")?"?":"&",(e=document.createElement("script")).setAttribute("src",""+s+f+"="+i),u.charset&&e.setAttribute("charset",u.charset),e.id=r,document.getElementsByTagName("head")[0].appendChild(e),a=setTimeout(function(){n(new Error("JSONP request to "+o+" timed out")),l(i),d(r),window[i]=function(){l(i)}},c),e.onerror=function(){n(new Error("JSONP request to "+o+" failed")),l(i),d(r),a&&clearTimeout(a)}})}n.exports=u})?i.apply(n,r=[n,t]):i)&&(t.exports=n)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,i){"use strict";var s,r,e,o,u,c;function f(t){return t&&DataView.prototype.isPrototypeOf(t)}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return t="string"!=typeof t?String(t):t}function l(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return s.iterable&&(t[Symbol.iterator]=function(){return t}),t}function d(n){this.map={},n instanceof d?n.forEach(function(t,n){this.append(n,t)},this):Array.isArray(n)?n.forEach(function(t){this.append(t[0],t[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function v(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(i){return new Promise(function(t,n){i.onload=function(){t(i.result)},i.onerror=function(){n(i.error)}})}function w(t){var n,i,n=new FileReader,i=p(n);return n.readAsArrayBuffer(t),i}function b(t){var n,i,n=new FileReader,i=p(n);return n.readAsText(t),i}function m(t){for(var n,i,r,n=new Uint8Array(t),i=new Array(n.length),r=0;r<n.length;r++)i[r]=String.fromCharCode(n[r]);return i.join("")}function j(t){var n;return t.slice?t.slice(0):((n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),n.buffer)}function y(){return this.bodyUsed=!1,this.HPt=function(t){(this.zPt=t)?"string"==typeof t?this.VPt=t:s.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:s.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():s.arrayBuffer&&s.blob&&f(t)?(this.WPt=j(t.buffer),this.zPt=new Blob([this.WPt])):s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||e(t))?this.WPt=j(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var t=v(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?v(this)||Promise.resolve(this.WPt):this.blob().then(w)}),this.text=function(){var t=v(this);if(t)return t;if(this.YPt)return b(this.YPt);if(this.WPt)return Promise.resolve(m(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},s.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t){var n=t.toUpperCase();return-1<o.indexOf(n)?n:t}function _(t,n){var i=(n=n||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t.zPt||(i=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new d(n.headers)),this.method=g(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(i)}function O(t){var i=new FormData;return t.trim().split("&").forEach(function(t){var t,n,t;t&&(n=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),i.append(decodeURIComponent(n),decodeURIComponent(t)))}),i}function S(t){var i,n,i=new d,n;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var t,n,t,t=t.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),i.append(n,t))}),i}function C(t,n){n=n||{},this.type="default",this.status=void 0===n.status?200:n.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new d(n.headers),this.url=n.url||"",this.HPt(t)}i.r(n),i.d(n,{DOMException:function(){return c},Headers:function(){return d},Request:function(){return _},Response:function(){return C},fetch:function(){return F}}),(s={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],e=ArrayBuffer.isView||function(t){return t&&-1<r.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,n){t=a(t),n=h(n);var i=this.map[t];this.map[t]=i?i+", "+n:n},d.prototype.delete=function(t){delete this.map[a(t)]},d.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},d.prototype.set=function(t,n){this.map[a(t)]=h(n)},d.prototype.forEach=function(t,n){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(n,this.map[i],i,this)},d.prototype.keys=function(){var i=[];return this.forEach(function(t,n){i.push(n)}),l(i)},d.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),l(n)},d.prototype.entries=function(){var i=[];return this.forEach(function(t,n){i.push([n,t])}),l(i)},s.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries),o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],_.prototype.clone=function(){return new _(this,{body:this.zPt})},y.call(_.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this.zPt,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},C.error=function(){var t=new C(null,{status:0,statusText:""});return t.type="error",t},u=[301,302,303,307,308],C.redirect=function(t,n){if(-1===u.indexOf(n))throw new RangeError("Invalid status code");return new C(null,{status:n,headers:{location:t}})},c=self.DOMException;try{new c}catch(t){(c=function(t,n){this.message=t,this.name=n;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),c.prototype.constructor=c}function F(o,u){return new Promise(function(i,t){var n,r,n=new _(o,u);if(n.signal&&n.signal.aborted)return t(new c("Aborted","AbortError"));function e(){r.abort()}(r=new XMLHttpRequest).onload=function(){var t,n,t={status:r.status,statusText:r.statusText,headers:S(r.getAllResponseHeaders()||"")};t.url="responseURL"in r?r.responseURL:t.headers.get("X-Request-URL"),n="response"in r?r.response:r.responseText,i(new C(n,t))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.onabort=function(){t(new c("Aborted","AbortError"))},r.open(n.method,n.url,!0),"include"===n.credentials?r.withCredentials=!0:"omit"===n.credentials&&(r.withCredentials=!1),"responseType"in r&&s.blob&&(r.responseType="blob"),n.headers.forEach(function(t,n){r.setRequestHeader(n,t)}),n.signal&&(n.signal.addEventListener("abort",e),r.onreadystatechange=function(){4===r.readyState&&n.signal.removeEventListener("abort",e)}),r.send(void 0===n.zPt?null:n.zPt)})}F.polyfill=!0,self.fetch||(self.fetch=F,self.Headers=d,self.Request=_,self.Response=C)},CalcEngine:function(t){"use strict";t.exports=i("@spreadjs/js-calc")},Common:function(t){"use strict";t.exports=i("@spreadjs/js-sheets-common")}},o={},s.d=function(t,n){for(var i in n)s.o(n,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u=s("./dist/src/dataManager.entry.js"),(r={}).Data=u,t.exports=r.Data},"./node_modules_local/@spreadjs/js-data-manager/index.js":function(t,n,i){t.exports=i("./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js")},"@spreadjs/js-sheets-common":function(t){"use strict";t.exports=GC.Spread},"@spreadjs/js-calc":function(t){"use strict";t.exports=GC.Spread.CalcEngine}},r={},t=e("./node_modules_local/@spreadjs/js-data-manager/index.js"),(GC=void 0===GC?{}:GC).Data=t}();
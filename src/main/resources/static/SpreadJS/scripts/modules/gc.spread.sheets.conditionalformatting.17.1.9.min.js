/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var n,e,t;function i(t){var r,r,r=e[t];return void 0!==r||(r=e[t]={exports:{}},n[t].call(r.exports,r,r.exports,i)),r.exports}n={"./dist/plugins/conditional/conditional.entry.js":function(t,r,n){var e,i,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./dist/plugins/conditional/conditional.js"),r),i(n("./dist/plugins/conditional/conditional.ns.js"),r)},"./dist/plugins/conditional/conditional.js":function(O,b,t){var M,B,V,q,D,r,F,m,Y,G,L,W,j,P,U,o,p,K,C,k,Z,z,X,tt,rt,nt,et,it,ot,at,ut,ft,st,lt,t,ct,ht,vt,dt,T,yt,g,x,Ct,bt,pt,gt,St,wt,mt,kt,Tt,xt,_t,Nt,It,t,Rt,At,Et,Ot,Mt,Bt,Vt,$,qt,Dt,Ft,Gt,Lt,J,Wt,jt,Pt,Ut,$t,d,r,Jt,Qt,Ht,Yt,r,Kt,Zt,n,zt,_,Xt,tr,rr,nr,er,v,ir,or,ar,ur,fr,N,sr,I,lr,cr,hr,vr,dr,yr,y,Cr,l,c,h,br,pr,gr,Sr,wr,mr,kr,Tr,xr,_r,Nr,S,n,e,Ir,Rr,Ar,Er,R,e,Or,Mr,Br,e,Vr,qr,e,Dr,Fr,Gr,e,Lr,Wr,jr,Pr,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,Ur,n,n,e,$r,Jr,Qr,Hr,Yr;function Kr(t){return kt(Tt(t))}function Q(t){return t.rowCount}function H(t){return t.colCount}function Zr(t){return""===t.trim()}function zr(t){return""===t}function Xr(t){return T(t)?m.SheetArea.viewport:t}function tn(t,r,n,e){switch(e&&"string"==typeof r&&"string"==typeof n&&(r=r.toLowerCase(),n=n.toLowerCase()),t){case Xt.equalsTo:return r===n;case Xt.notEqualsTo:return r!==n;case Xt.greaterThan:return n<r;case Xt.greaterThanOrEqualsTo:return n<=r;case Xt.lessThan:return r<n;case Xt.lessThanOrEqualsTo:return r<=n;default:return!1}}function rn(t){return(null==t?void 0:t.fileType)===m.OpenSaveFileType.excel}function nn(t,r){T(t.rJ)||r.set(t.rJ,t)}function en(t){var r,n,r={},n;return ot.YK(t,r)?r.value:typeof t===z&&t.toLowerCase()===X}function a(t,r){var n,e,n=(r=r||{}).formula;(e=this).offsetRow=0,e.offsetCol=0,e.conType("string"==typeof t?y[t]:t),T(r.compareType)||e.ZK(r.compareType),T(r.expected)||e.expected(r.expected),T(n)||e.formula("string"==typeof n?ct(p.trim(n),"="):n),T(r.item1)||e.item1(r.item1),T(r.item2)||e.item2(r.item2),T(r.customValueType)||e.customValueType(r.customValueType),T(r.type)||e.type(r.type),e.ranges(r.ranges),e.WK=C,e.QK=C}function on(t,r,n,e,i,o,a,u,f){var s=Math.round;switch(t.lineWidth=1,t.rect(o,a,u,f),n=s(++n),e=s(e),t.clip(),r.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:G.drawArrows(t,r.iconSetType,r.iconIndex,n,e,i);break;case 2:G.drawIconTypeIsTwo(t,r.iconSetType,r.iconIndex,n,e,i);break;case 3:G.drawStar(t,r.iconSetType,r.iconIndex,n,e,i);break;case 14:case 12:case 5:G.drawCircle(t,r.iconSetType,r.iconIndex,n,e,i);break;case 4:G.drawFlag(t,r.iconSetType,r.iconIndex,n,e,i);break;case 6:G.drawTrafficLight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 7:G.drawIconTypeIsSen(t,r.iconSetType,r.iconIndex,n,e,i);break;case 8:G.drawIconTypeIsEight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 9:G.drawIconTypeIsNine(t,r.iconSetType,r.iconIndex,n,e,i);break;case 18:G.drawSector(t,r.iconSetType,r.iconIndex,n,e,i);break;case 17:case 13:G.drawSignal(t,r.iconSetType,r.iconIndex,n,e,i);break;case 19:G.drawMagicCube(t,r.iconSetType,r.iconIndex,n,e,i)}}function an(t,r,n){var e,i,o,a,u,e=[],i=t.row,o=t.rowCount,a=t.col,u=t.col+t.colCount-1;return a<r?r<=u&&u<=n?(e[0]=$(i,a,o,r-a),e[1]=$(i,r,o,u-r+1)):n<u&&(e[0]=$(i,a,o,r-a),e[1]=$(i,r,o,n-r+1),e[2]=$(i,n+1,o,u-n)):a<=n&&(r<=u&&u<=n?e[1]=t:n<u&&(e[1]=$(i,a,o,n-a+1),e[2]=$(i,n+1,o,u-n))),e}function un(t,r,n){var e,i,o,a,u,e=[],i=t.col,o=t.colCount,a=t.row,u=t.row+t.rowCount-1;return a<r?r<=u&&u<=n?(e[0]=$(a,i,r-a,o),e[1]=$(r,i,u-r+1,o)):n<u&&(e[0]=$(a,i,r-a,o),e[1]=$(r,i,n-r+1,o),e[2]=$(n+1,i,u-n,o)):a<=n&&(r<=u&&u<=n?e[1]=t:n<u&&(e[1]=$(a,i,n-a+1,o),e[2]=$(n+1,i,u-n,o))),e}function i(t,r,n){var e=this;e.KK=!0,e.ruleType(t),e.style(r),e.ranges(n)}function fn(t,r){return t===_.cellValueRule&&(r===nr.between||r===nr.notBetween)}function sn(t,r,n){var r,e,i,r;if(t&&r&&!(!(r=r[0])||r.row<0||r.col<0)){if(e=m.IndexHelper.nr(r.col)+(r.row+1),i="",i=r.rowCount===m.XmlConstants.Io?o("${0}:${1}",[m.IndexHelper.nr(r.col),m.IndexHelper.nr(r.col+r.colCount-1)]):r.colCount===m.XmlConstants.xo?o("${0}:${1}",[r.row+1,r.row+r.rowCount]):o("${0}${1}:${2}${3}",[m.IndexHelper.nr(r.col),r.row+1,m.IndexHelper.nr(r.col+r.colCount-1),r.row+r.rowCount]),r=Nn(n),"top10"===t.type)return t.bottom?t.percent?o("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[i,t.rank,e]):o("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[i,t.rank,e]):t.percent?o("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[i,t.rank,e]):o("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[i,t.rank,e]);if("containsText"===t.type)return o('NOT(ISERROR(SEARCH("{0}",{1})))',[r,e]);if("notContainsText"===t.type)return o('ISERROR(SEARCH("{0}",{1}))',[r,e]);if("beginsWith"===t.type)return o('LEFT({0},{1}) = "{2}"',[e,n.length,r]);if("endsWith"===t.type)return o('RIGHT({0},{1}) = "{2}"',[e,n.length,r]);if("duplicateValues"===t.type)return o("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[i,e]);if("uniqueValues"===t.type)return o("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[i,e]);if("aboveAverage"===t.type||"belowAverage"===t.type||"aboveOrEqualToAverage"===t.type||"belowOrEqualToAverage"===t.type){if("aboveAverage"===t.type&&T(t.stdDev))return o("{0}>AVERAGE({1})",[e,i]);if(!T(t.aboveAverage)){if(!(T(t.equalAverage)||t.aboveAverage||T(t.equalAverage))&&t.equalAverage&&T(t.stdDev))return o("{0}<=AVERAGE({1})",[e,i]);if(!t.aboveAverage&&T(t.stdDev))return o("{0}<AVERAGE({1})",[e,i])}if(!T(t.equalAverage)&&t.equalAverage&&T(t.stdDev))return o("{0}>=AVERAGE({1})",[e,i]);if(!T(t.stdDev))return T(t.aboveAverage)||t.aboveAverage?o("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[e,i,t.stdDev]):o("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[e,i,t.stdDev])}}return null}function ln(t){return t&&t.font&&0===t.font.indexOf("normal normal")&&delete t.font,t}function u(t,r,n,e,i,o,a,u,f,s){var t,n,t=$r.call(this,t,n)||this,n=t;return n.ranges(r),n.operator(e),n.value1("string"==typeof i?p.trim(i):i),n.value2("string"==typeof o?p.trim(o):o),n.text(a),n.formula(u),n.type(f),n.rank(s),n.cached=!1,n.JK=C,t}function cn(t,r,n,e){var r,r,n,r=r.ranges(),r=Et(r),n=Y.formulaToExpression(t,n,r.r,r.c,e);return Y.expressionToFormula(t,n,r.r,r.c,!e)}function hn(t,r){this.type=t,this.value=r}function f(t,r,n,e,i,o,a,u,f,s,l){var t,l,r,n,e,i,o,a,u,f,s,t=Jr.call(this,t,C,l)||this,l=t;return l.KK=!1,l.lowestValueCached=C,l.highestValueCached=C,l.XK={},l.cached=!1,l.JK=C,r=r,n=n,e=e,i=i,o=o,a=a,u=u,f=f,s=s,arguments.length<=1&&(r=1,n=C,e=Vt(255,248,105,107),i=4,o=50,a=Vt(255,255,235,132),u=2,f=C,s=Vt(255,99,190,123)),l.minColor(e),l.minValue(n),l.minType(r),l.midColor(a),l.midValue(o),l.midType(i),l.maxColor(s),l.maxValue(f),l.maxType(u),t}function vn(t){return t.c_[0]&&t.c_[0].c_[0]&&t.c_[0].c_[0].c_[0]}function s(t,r,n,e,i,o){var a,t,r,n,e,i,a=this,t=t,r=r,n=n,e=e,i=i;return 0===arguments.length&&(t=5,n=7,e=r=C,i=Vt(255,99,142,198)),(a=Qr.call(this,12,t,r,C,C,C,C,n,e,C,o)||this).KK=!1,a.Hc(i),a}function dn(t,r,n){this.isGreaterThanOrEqualTo=t,this.iconValueType=r,this.iconValue=n}function w(t,r){var n,t,n=this,t=0===arguments.length?0:t;return(n=Hr.call(this,13,C,C,C)||this).KK=!1,n.ranges(r),n.Hc(t),n}function yn(t){return t="string"==typeof t&&"="!==t[0]?'="'+K.Vi(t,'"','""')+'"':t}function A(t,r,n,e){var t,e,t=Yr.call(this,t,k,e)||this,e=t;return e.style(n),e.state(r),t}function E(t){this.qK=[],this.$K=C,this.sE(),this.nJ=!0,this.eJ=t}function Cn(t,r,n,e,i){var o,a,u,f;if(!$t(r))return r[t];for(o=tt(r.length,n.length),a=0;a<o;a++)if((u=n[a]).contains(e,i,1,1))return(f=r[a])[t]}function bn(t,r){if(r)for(var n=0;n<r.length;n++)t.push(r[n])}function pn(t){for(var r,n,e,i,o,a,r=J(t),n=0;n<r;n++)if(i=(e=t[n]).ranges)for(o=0;o<i.length;o++)if(1e3<(a=i[o]).rowCount)return 1}function gn(t){for(var r,n,e,i,o,a,r=J(t),n=0;n<r;n++)if(i=(e=t[n]).ranges())for(o=0;o<i.length;o++)if(1e3<(a=i[o]).rowCount)return 1}function Sn(t){for(var r,n,e,i,r=[],n=J(t),i=0;i<n;i++)e=t[i],r.push($(e.row,e.col,Q(e),H(e)));return r}function wn(t,r){for(var n,e,n=0;n<t.length;n++)if((e=t[n])&&e.equals(r))return 1}function mn(t,r){for(var n,e,i,o,a,n=!0,e=!0,i=!0,o=r.iJ,a=0;a<o.length;a++)if(o[a].iconSetType!==t){n=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==a){e=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==o.length-1-a){i=!1;break}return!n||!e&&!i||!e&&!r.reverseIconOrder()}function kn(t){return!(!t.ruleType||t.ruleType()!==_.dataBarRule)}function Tn(t){var r;if(t.ruleType()===_.iconSetRule)return 3===(r=t.iconSetType())||2===r||19===r||mn(r,t)}function xn(t){return t.ruleType()===_.rowStateRule||t.ruleType()===_.columnStateRule}function _n(t){var r,n,e,r,n=/</g,e=/>/g;return"string"==typeof t?t.replace(/&/g,"&amp;").replace(n,"&lt;").replace(e,"&gt;"):T(t)?t:""+t}function Nn(t){return"string"==typeof t?t.startsWith('="')&&t.endsWith('"')?t.slice(2,-1):t.replace(/"/g,'""'):T(t)?t:""+t}function In(t){var t=t.c_&&t.c_[0];if(t)return gt(t,"cfvo")}function Rn(t){var t,t,t=t.c_&&t.c_[0];return t&&(t=gt(t,"color"))&&0<t.length?t.map(function(t){return wt(t)}):[]}function An(t,r,n){switch(t){case"cellIs":return Er[r];case"containsText":return er.contains;case"beginsWith":return er.beginsWith;case"endsWith":return er.endsWith;case"notContainsText":return er.doesNotContain;case"timePeriod":return N[n]}}function En(t,r,n){var e,i,o;switch(t){case _.cellValueRule:return e={type:"cellIs"},T(n)||(e.operator=Er[n]),e;case _.specificTextRule:return i="containsText",o="contains",2===n?o=i="beginsWith":3===n?o=i="endsWith":1===n?(i="notContainsText",o="notContains"):0===n&&(o="containsText"),e={type:i,operator:o};case _.formulaRule:return e={type:"expression"},T(n)||(e.operator=n),e;case _.dateOccurringRule:return e={type:"timePeriod"},T(r)||(e.timePeriod=Ar[r]),e;case _.top10Rule:return e={type:"top10"},T(n)||(e.operator=n),e;case _.uniqueRule:return e={type:"uniqueValues"},T(n)||(e.operator=n),e;case _.duplicateRule:return e={type:"duplicateValues"},T(n)||(e.operator=n),e;case _.averageRule:return e={type:"aboveAverage"},T(n)||(e.operator=n),e;case _.twoScaleRule:return e={type:"colorScale"},T(n)||(e.operator=n),e;default:return}}function On(t){var r;return{num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7}[t]}function Mn(t){var r;return{0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"}[t]}function Bn(t){var r;return{"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20}[t]}function Vn(t){var r;return{0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"}[t]}function qn(t){var r,t,r,t={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8}[t];return t!==k?t:1}function Dn(t){var r;return{1:"num",4:"percent",5:"percentile",7:"formula"}[t]}function Fn(t){var r;return{num:1,percent:4,percentile:5,formula:7}[t]}function Gn(t){return"lowestValue"===t||"highestValue"===t}function Ln(t){return"string"==typeof(t=Tt(t))&&"="!==t.charAt(0)?"="+t:t}function Wn(t,r){var n;return T(t.val)?T(r)||(n=U(Tt(r.c_&&r.c_[0]))):n=t.val,n}function jn(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n)return void(wn(o.ranges,r)||o.ranges.push(r));t.push({rule:n,ranges:[r]})}function Pn(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===r)return void(o.rule=n)}function Un(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n&&wn(o.ranges,r))return 1}function $n(t,r){if(10===t){if(3===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0}}else if(15===t){if(4===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0};if(2===r)return{iconSetType:0,iconIndex:1};if(3===r)return{iconSetType:10,iconIndex:2};if(1===r)return{iconSetType:10,iconIndex:1}}else if(11===t){if(3===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0}}else if(16===t){if(4===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0};if(2===r)return{iconSetType:1,iconIndex:1};if(3===r)return{iconSetType:11,iconIndex:2};if(1===r)return{iconSetType:11,iconIndex:1}}else if(14===t){if(3===r)return{iconSetType:5,iconIndex:2};if(2===r)return{iconSetType:5,iconIndex:1};if(1===r)return{iconSetType:5,iconIndex:0}}else if(13===t){if(0===r)return{iconSetType:17,iconIndex:1};if(1===r)return{iconSetType:17,iconIndex:2};if(2===r)return{iconSetType:17,iconIndex:3};if(3===r)return{iconSetType:17,iconIndex:4}}return{iconSetType:t,iconIndex:r}}M=this&&this.__extends||(Pr=function(t,r){return(Pr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}))(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}Pr(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),B=this&&this.__spreadArray||function(t,r,n){if(n||2===arguments.length)for(var e=0,i=r.length,o;e<i;e++)!o&&e in r||((o=o||Array.prototype.slice.call(r,0,e))[e]=r[e]);return t.concat(o||Array.prototype.slice.call(r))},Object.defineProperty(b,"__esModule",{value:!0}),b.ConditionalFormats=b.StateRule=b.IconSetRule=b.IconCriterion=b.DataBarRule=b.ScaleRule=b.ScaleValue=b.NormalConditionRule=b.ConditionRuleBase=b.Condition=b.oJ=b.aJ=b.ConditionType=b.IconValueType=b.IconSetType=b.DataBarAxisPosition=b.BarDirection=b.ScaleValueType=b.AverageConditionType=b.QuarterType=b.DateOccurringType=b.Top10ConditionType=b.DateExConditionExpectType=b.DateCompareType=b.CustomValueType=b.ColorCompareType=b.TextCompareType=b.TextComparisonOperators=b.ComparisonOperators=b.LogicalOperators=b.GeneralComparisonOperators=b.RuleType=void 0,V=t("Common"),q=t("Core"),D=t("CalcEngine"),r=t("./dist/plugins/conditional/conditional.ns.js"),F=t("CalcEngine"),m=t("Core"),Y=t("SheetsCalc"),G=t("./dist/plugins/conditional/conditionalFormatIcon.js"),L=m.UsedRangeUtil.vh,W=m.UsedRangeUtil.hh,j=m.XFileConstants.Au,P=m.XFileConstants.ju,U=m.Util.mr,o=V.Common.zf.I5,p=q.GC$,K=V.Common.zf,C=null,k=void 0,Z="undefined",z="string",X="true",tt=Math.min,rt=Math.max,nt=Math.abs,et=Math.floor,it=Math.ceil,ot=D.Convert,at=ot.q8,ut=ot.uJ,ft=ot.sJ,st=String.fromCharCode(32),lt=String.fromCharCode(160),t=V.Common.zf,ct=t.cJ,ht=t.fJ,vt=t.dT,dt=t.OS,T=V.Common.lt.ht,yt=V.Common.$T,g=V.Common.ut,x=q.mt,Ct=x.t1,bt=m.mt.getFormulaString,pt=x.vo,gt=x.go,St=x.h1,wt=x.d1,mt=x.xr,kt=x.g1,Tt=x.n1,xt=x.Hue,_t=x.c1,Nt=m.range_parser.Dc,It=m.range_parser.getRangeString,t=q.$e,Rt=x.G0,At=x.C1,Et=x.z0,Ot=!!D,Mt=q.Style,Bt=V.Common.ft,Vt=Bt.j,$=q.Ec,qt=q.Range,Dt=V.Common.ct,Ft=V.Common.Uf,Gt=Ft.VP,Lt=Ft.hD,J=Ft.tR,Wt=D.Functions,jt=D.evaluateOperator,Pt=q.Pf,Ut=m.Util.no,$t=Array.isArray,d=m.NodeHelper.ur,r=new V.Common.ResourceManager(r.SR,"ConditionalFormatting"),Jt=r.getResource.bind(r),Qt=function(t){return/[\f\n\r\t\v]/.test(t)},Ht=function(t){var r,n,r=t.row<0?Y.BAND_INDEX_CONST:t.row,n=t.col<0?Y.BAND_INDEX_CONST:t.col;return(0,F.lJ)(C,C,r,n,r+t.rowCount-1,n+t.colCount-1)},Yt=function(t){var r;if(t instanceof D.Expression)r=t;else if(t instanceof qt)r=Ht(t);else{if(!at(t))throw Jt().Exp_NotSupport;t=ut(t),isNaN(t)||((r=new D.Expression(2)).value=t)}return r},r=function(t,r,o,a){var u,f,t,u=t,f=r,t=function(t,r){var n,e,i,n=this;return n.hasOwnProperty("_ps")||(n._ps={}),e=n._ps,0===arguments.length?e[u]!==k?a?a.call(n,e[u]):e[u]:f:(e[u]!==t&&(i=e[u]!==k?e[u]:f,e[u]=t,!1!==r)&&o&&o.call(n,t,i),n)};return t.isDefault=function(t){return t===f},t},Kt=function(o,t,a){var u=this;return a=a||{},t=t||u,T(u.pivotTableName)||(a.pivot=!0),p.each(t,function(t,r){var n,e,i,n=u[r];T(n)||(e=n.call(u),"formula"===r?(u.getFormulaString?e=u.getFormulaString(o,k,k,!0):u.condition()&&u.condition().getFormulaString&&(e=u.condition().getFormulaString(o,k,k,!0)),e&&(a[r]=e)):"style"===r&&$t(e)?(i=e.map(function(t){return t.toJSON()}),a[r]=i):"iconCriteria"===r||"icons"===r?a[r]=e:Dt.W0(e)?a[r]=Dt.Q0(e):e&&e.toJSON?a[r]=e.toJSON(o):T(e)||n.isDefault(e)||(a[r]=e))}),a},Zt=function(h,t,v,d){var y,C;v&&(y=this,p.each(t=t||y,function(t,r){var n,e,i,o,a,u,f,s,l,c,o;if(C=v[r],!T(C))if("ranges"===r){for(n=[],e=0;e<C.length;e++)i=C[e],n.push($(i.row,i.col,Q(i),H(i)));y.ranges(n,!1)}else if("style"===r)$t(C)?(o=C.map(function(t){var r=new Mt;return r.fromJSON(t,d),r}),y.style(o)):(y.style(new Mt,!1),y.style().fromJSON(C,d));else if("iconCriteria"===r)for(a=C.length,u=0;u<a;u++)f=C[u],y.hJ[u]=new Dr(f.isGreaterThanOrEqualTo,f.iconValueType,f.iconValue);else if("icons"===r)for(s=C.length,l=0;l<s;l++)c=C[l],y.iJ[l]={iconSetType:c.iconSetType,iconIndex:c.iconIndex};else"iconSetType"===r?y[r](C,!0):"item1"===r||"item2"===r?(y[r]((0,b.aJ)(),!1),y[r]().fromJSON(C,h)):"expected"===r?p.getType(C)!==z||5!==v.conType&&13!==v.conType?y[r](C,!1):"/OADate("===C.substr(0,8)?y[r](Dt.dJ(C),!1):y[r](new Date(C)):"condition"===r?((o=new S).fromJSON(C,h),y.condition(o,!1)):p.getType(C)===z&&"/OADate("===C.substr(0,8)?y[r](Dt.dJ(C),!1):y[r](C,!1)}))},n=q.Y8,p.extend(n.prototype,{vJ:function(t){var r,n,r,r=this,n=r.G8;!n||!t&&n.originalConditionalRules||(r=r.mJ.qK.map(function(t){return{rule:t,ranges:t.ranges().slice()}}),t?n.currentConditionalRules=r:n.originalConditionalRules=r)},gJ:function(t){var e=this.mJ,i=this.Mf;i.suspendPaint(),t&&(0===t.length&&e.qK&&1===e.qK.length&&e.constructor.et(i,"onRuleUpdated",{ranges:e.qK[0].ranges()}),e.qK=t.map(function(t){var r,n,r=t.rule,n=t.ranges;return"Object"===r.constructor.name&&(r=e.pJ(t.rule,i,!1),n=n.map(function(t){return new qt(t.row,t.col,t.rowCount,t.colCount)})),r.ranges(n),e.constructor.et(i,"onRuleUpdated",{ranges:r.ranges()}),r}),e.C8()),i.resumePaint()},bJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,n=n.ignoreExpand;this.mJ.JO(t,r,e,i,n),this.vJ(!0)},yJ:function(t,r,n,e){this.vJ(),this.mJ.xP(t,r,n,e),this.vJ(!0)},wJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,n=n.ignoreExpand;this.mJ.qO(t,r,e,i,n),this.vJ(!0)},MJ:function(t,r,n,e){this.vJ(),this.mJ.NP(t,r,n,e),this.vJ(!0)},CJ:function(){this.vJ(),this.mJ.dl(),this.vJ(!0)},SJ:function(){this.vJ(),this.mJ.C8()}}),n.ch("conditionalFormat",{init:function(){this.mJ=new jr(this.Mf)},applyChanges:function(t){var r,t,t,r=t.changes,t=t.isUndo;r&&(t=t?r.originalConditionalRules:r.currentConditionalRules)&&this.gJ(t)},undo:function(t){var t=t.originalConditionalRules;t&&this.gJ(t)},dispose:function(t){var r=this,n;!1!==(t&&t.clearCache)&&r.mJ&&(r.mJ.L0(),r.mJ=C)}}),q.Worksheet.ch("conditionalFormat",zt={init:function(){this.conditionalFormats=this.Ut.mJ},getUsedRange:function(t){var r,n,e;t.type&m.UsedRangeType.conditionFormat&&(e=(n=(r=this).conditionalFormats).getUsedRange(),L(t.range,e))},dispose:function(t){var t;!1!==t.clearCache&&(t=this.conditionalFormats)&&t.TJ()},onLayoutChanged:function(t){var r,n,e,i,o,a,u,t,f,s,r=t.changeType,n=t.row,e=Q(t),i=t.col,o=H(t),a=t.sheetArea,u=T(a)||a===m.SheetArea.viewport,t=t.ignoreExpand,f=this.Ut,s=this.tables;"addRows"===r&&u?f.bJ(n,e,{affectRanges:s&&s.AJ(n,-1,e,-1,!0),isFromTable:!1,ignoreExpand:t}):"deleteRows"===r&&u?f.yJ(n,e):"addColumns"===r&&u?f.wJ(i,o,{ignoreExpand:t}):"deleteColumns"===r&&u?f.MJ(i,o):"clear"===r?f.CJ():"setColumnCount"!==r&&"setRowCount"!==r||3!==a&&1!==a||f.SJ()},toJson:function(t,r){var n,r,n=this.conditionalFormats,r=r&&r.ignoreStyle;n&&!r&&(t.conditionalFormats=n.toJSON(this))},fromJson:function(t,r,n){var n=n&&n.ignoreStyle;t&&t.conditionalFormats&&!n&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,r,!0)},wh:function(t,r,n){var e,i,o,a,u,f,s,l,c,h,v,d,y,C,b,C,i,p,e=this,i=n&&!1===n.includeStyles,o=e.conditionalFormats;if(!i&&o&&Y&&!e.NMi&&(a=o.qK)&&0<a.length){for(u=r.styleManager,f=t.c_,s=[],h=c=l=void 0,v=0,d=a.length;v<d;v++)C=(y=a[v]).ruleType(),b=!0,Tn(y)||kn(y)?(s.push(y.IJ()),Tn(y)&&(b=!1)):C===_.formulaRule&&x.e1(y.D5,e.name(),e.parent&&e.parent.r4())&&(l||(c=new m.SimpleSharedStrings,h=new m.SimpleSharedStrings,l=new m.SharedDxfs(c,h)),s.push(y.IJ(l)),b=!1),xn(y)?(t.lossless||(t.lossless={}),t.lossless.stateRules||(t.lossless.stateRules=[]),t.lossless.stateRules.push(y.toJSON())):b&&(C=y.wh(u,void 0,void 0,n,e))&&(C.lossless?(t.lossless.dateOccurringRules||(t.lossless.dateOccurringRules=[]),t.lossless.dateOccurringRules.push(C.lossless)):f.push(C));0<s.length&&((i=mt(t,j)).c_.push(p={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:s}]}),l)&&(i.lossless={sharedDxfs:l.iv(),sharedColors:c.wh(),commonSharedStrings:h.wh()})}},yh:function(t,i,o){var a,r,u,f,s,l,r,n,e,c,h,a=this,r=o&&!1===o.includeStyles,u=this.conditionalFormats,f=u.qK,s=m.Util.Co(o),l=new Map;if(Y&&u&&!r){for(r=gt(t,P),n=mt(t,j),e=xt(n,"conditionalFormattings"),c=i.styleManager,r&&0<r.length&&r.forEach(function(t){var n,e,r,n=m.NodeHelper.ur(t.pivot),e=Nt(t.sqref);s&&m.Util.Ao(a,e,!0,i),(r=t.c_).forEach(function(t){var r,r,r=e.map(function(t){return new qt(t.row,t.col,t.rowCount,t.colCount)}),r=u.xJ(t,r,c,a,o);r&&(r.pivot=n,T(t.priority)||r.priority(+t.priority),f.push(r),nn(r,l))})}),u.NJ(e,i,a,f,n,l,s),l.clear(),h=f.length-1;-1<h;h--)f[h].pivot&&f.splice(h,1);t.lossless&&t.lossless.stateRules&&0<t.lossless.stateRules.length&&t.lossless.stateRules.forEach(function(t){var r=new Wr;r.fromJSON(t,a),u.qK.push(r)}),t.lossless&&t.lossless.dateOccurringRules&&0<t.lossless.dateOccurringRules.length&&t.lossless.dateOccurringRules.forEach(function(t){var r=new R;r.fromJSON(t,a),u.qK.push(r)}),u.nJ=!gn(u.qK),u.C8()}},fromJsonAfterSJSFormula:function(){this.conditionalFormats.dl()}}),q.Workbook.ch("conditionalFormat",{fromJson:function(t,r,n){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},yh:function(t,r,n){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},onCultureChanged:function(){Jt()}}),(n=_=b.RuleType||(b.RuleType={}))[n.conditionRuleBase=0]="conditionRuleBase",n[n.cellValueRule=1]="cellValueRule",n[n.specificTextRule=2]="specificTextRule",n[n.formulaRule=3]="formulaRule",n[n.dateOccurringRule=4]="dateOccurringRule",n[n.top10Rule=5]="top10Rule",n[n.uniqueRule=6]="uniqueRule",n[n.duplicateRule=7]="duplicateRule",n[n.averageRule=8]="averageRule",n[n.twoScaleRule=10]="twoScaleRule",n[n.threeScaleRule=11]="threeScaleRule",n[n.dataBarRule=12]="dataBarRule",n[n.iconSetRule=13]="iconSetRule",n[n.rowStateRule=14]="rowStateRule",n[n.columnStateRule=15]="columnStateRule",(n=Xt=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.greaterThan=2]="greaterThan",n[n.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",n[n.lessThan=4]="lessThan",n[n.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",tr=[9,10,13,14,11,12],(n=rr=b.LogicalOperators||(b.LogicalOperators={}))[n.or=0]="or",n[n.and=1]="and",(n=nr=b.ComparisonOperators||(b.ComparisonOperators={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.greaterThan=2]="greaterThan",n[n.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",n[n.lessThan=4]="lessThan",n[n.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",n[n.between=6]="between",n[n.notBetween=7]="notBetween",(n=er=b.TextComparisonOperators||(b.TextComparisonOperators={}))[n.contains=0]="contains",n[n.doesNotContain=1]="doesNotContain",n[n.beginsWith=2]="beginsWith",n[n.endsWith=3]="endsWith",(n=v=b.TextCompareType||(b.TextCompareType={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.beginsWith=2]="beginsWith",n[n.doesNotBeginWith=3]="doesNotBeginWith",n[n.endsWith=4]="endsWith",n[n.doesNotEndWith=5]="doesNotEndWith",n[n.contains=6]="contains",n[n.doesNotContain=7]="doesNotContain",(n=ir=b.ColorCompareType||(b.ColorCompareType={}))[n.backgroundColor=0]="backgroundColor",n[n.foregroundColor=1]="foregroundColor",(n=or=b.CustomValueType||(b.CustomValueType={}))[n.empty=0]="empty",n[n.nonEmpty=1]="nonEmpty",n[n.error=2]="error",n[n.nonError=3]="nonError",n[n.formula=4]="formula",(n=ar=b.DateCompareType||(b.DateCompareType={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.before=2]="before",n[n.beforeEqualsTo=3]="beforeEqualsTo",n[n.after=4]="after",n[n.afterEqualsTo=5]="afterEqualsTo",(n=ur=b.DateExConditionExpectType||(b.DateExConditionExpectType={}))[n.dateOccurring=0]="dateOccurring",n[n.yearOccurring=1]="yearOccurring",n[n.quarterOccurring=2]="quarterOccurring",n[n.monthOccurring=3]="monthOccurring",n[n.weekOccurring=4]="weekOccurring",n[n.dayOccurring=5]="dayOccurring",n[n.yearToDate=6]="yearToDate",(n=fr=b.Top10ConditionType||(b.Top10ConditionType={}))[n.top=0]="top",n[n.bottom=1]="bottom",(n=N=b.DateOccurringType||(b.DateOccurringType={}))[n.today=0]="today",n[n.yesterday=1]="yesterday",n[n.tomorrow=2]="tomorrow",n[n.last7Days=3]="last7Days",n[n.thisMonth=4]="thisMonth",n[n.lastMonth=5]="lastMonth",n[n.nextMonth=6]="nextMonth",n[n.thisWeek=7]="thisWeek",n[n.lastWeek=8]="lastWeek",n[n.nextWeek=9]="nextWeek",n[n.nextQuarter=10]="nextQuarter",n[n.thisQuarter=11]="thisQuarter",n[n.lastQuarter=12]="lastQuarter",n[n.nextYear=13]="nextYear",n[n.thisYear=14]="thisYear",n[n.lastYear=15]="lastYear",(n=sr=b.QuarterType||(b.QuarterType={}))[n.quarter1=0]="quarter1",n[n.quarter2=1]="quarter2",n[n.quarter3=2]="quarter3",n[n.quarter4=3]="quarter4",(n=I=b.AverageConditionType||(b.AverageConditionType={}))[n.above=0]="above",n[n.below=1]="below",n[n.equalOrAbove=2]="equalOrAbove",n[n.equalOrBelow=3]="equalOrBelow",n[n.above1StdDev=4]="above1StdDev",n[n.below1StdDev=5]="below1StdDev",n[n.above2StdDev=6]="above2StdDev",n[n.below2StdDev=7]="below2StdDev",n[n.above3StdDev=8]="above3StdDev",n[n.below3StdDev=9]="below3StdDev",(n=lr=b.ScaleValueType||(b.ScaleValueType={}))[n.number=0]="number",n[n.lowestValue=1]="lowestValue",n[n.highestValue=2]="highestValue",n[n.percent=3]="percent",n[n.percentile=4]="percentile",n[n.automin=5]="automin",n[n.formula=6]="formula",n[n.automax=7]="automax",(n=cr=b.BarDirection||(b.BarDirection={}))[n.leftToRight=0]="leftToRight",n[n.rightToLeft=1]="rightToLeft",(n=hr=b.DataBarAxisPosition||(b.DataBarAxisPosition={}))[n.automatic=0]="automatic",n[n.cellMidPoint=1]="cellMidPoint",n[n.none=2]="none",(n=vr=b.IconSetType||(b.IconSetType={}))[n.threeArrowsColored=0]="threeArrowsColored",n[n.threeArrowsGray=1]="threeArrowsGray",n[n.threeTriangles=2]="threeTriangles",n[n.threeStars=3]="threeStars",n[n.threeFlags=4]="threeFlags",n[n.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",n[n.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",n[n.threeSigns=7]="threeSigns",n[n.threeSymbolsCircled=8]="threeSymbolsCircled",n[n.threeSymbolsUncircled=9]="threeSymbolsUncircled",n[n.fourArrowsColored=10]="fourArrowsColored",n[n.fourArrowsGray=11]="fourArrowsGray",n[n.fourRedToBlack=12]="fourRedToBlack",n[n.fourRatings=13]="fourRatings",n[n.fourTrafficLights=14]="fourTrafficLights",n[n.fiveArrowsColored=15]="fiveArrowsColored",n[n.fiveArrowsGray=16]="fiveArrowsGray",n[n.fiveRatings=17]="fiveRatings",n[n.fiveQuarters=18]="fiveQuarters",n[n.fiveBoxes=19]="fiveBoxes",n[n.noIcons=20]="noIcons",(n=dr=b.IconValueType||(b.IconValueType={}))[n.number=1]="number",n[n.percent=4]="percent",n[n.formula=7]="formula",n[n.percentile=5]="percentile",Ur=yr=yr||{},yr[yr.contains=0]="contains",(n=y=b.ConditionType||(b.ConditionType={}))[n.relationCondition=0]="relationCondition",n[n.numberCondition=1]="numberCondition",n[n.textCondition=2]="textCondition",n[n.colorCondition=3]="colorCondition",n[n.formulaCondition=4]="formulaCondition",n[n.dateCondition=5]="dateCondition",n[n.dateExCondition=6]="dateExCondition",n[n.textLengthCondition=7]="textLengthCondition",n[n.top10Condition=8]="top10Condition",n[n.uniqueCondition=9]="uniqueCondition",n[n.averageCondition=10]="averageCondition",n[n.cellValueCondition=11]="cellValueCondition",n[n.areaCondition=12]="areaCondition",n[n.timeCondition=13]="timeCondition",n[n.stateCondition=14]="stateCondition",(n=Cr=Cr||{})[n.automatic=0]="automatic",n[n.middle=1]="middle",n[n.none=2]="none",l=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},c=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},h=function(t,r){t.setDate(r)},br=function(t){return t.getDate()},pr=function(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()},gr=function(t,r){var n;return c(t)<r},Sr=function(t,r){return t<r},wr=function(t,r){var n;return r<l(t)},mr=function(t,r){return r<t},kr=function(t,r){return t.getHours()===r.getHours()&&t.getMinutes()===r.getMinutes()&&t.getSeconds()===r.getSeconds()&&t.getMilliseconds()===r.getMilliseconds()},Tr=function(t,r){var n,e,n,e;return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())<new Date(1899,11,30,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())},xr=function(t,r){return!Tr(t,r)&&!kr(t,r)},b.aJ=_r=function(t,r,n,e,i,o,a,u,f){return new S(t,{compareType:r,expected:n,formula:e,customValueType:i,type:o,ranges:a,item1:u,item2:f})},b.oJ=new Mt,Nr=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],a.prototype.context=function(t){var r,n;return 1===arguments.length&&(this.DJ=t,r=this.item1(),n=this.item2(),r&&r.context&&r.context(t),n)&&n.context&&n.context(t),this.DJ},a.prototype.U0=function(t){var r=this,n=r.item1(),e=r.item2();t?r.G3=!0:r._J=!0,n&&n.U0(t),e&&e.U0(t)},a.prototype.H0=function(){var t=this,r=t.item1(),n=t.item2();delete t.G3,delete t._J,r&&r.H0(),n&&n.H0()},a.prototype.initExpression=function(t,r,n){var e,i,e,i,i,t,o,i,e=this.item1(),i=this.item2();e&&e.initExpression&&e.initExpression(),i&&i.initExpression&&i.initExpression(),t=t||this.DJ,e=this.D5,t&&e&&!this.WK&&(n=this.ranges()?(r=(i=Et(this.ranges())).r,i.c):(r=r||0,n||0),i=t.getCalcService(),t=t.Uw(),i)&&t&&(o=!1,this.G3&&(o=!this._J),this.WK=i.parse(t,e,r,n,!1,!0,o),i={expr:this.WK,baseRow:r,baseCol:n},a.et(t.getSheet(),"initConditionExpression",i))},a.prototype.expression=function(t,r,n,e){var i,i,o;return 1===arguments.length?(this.WK=t,r=r||this.DJ,t?r&&(e=this.ranges()?(n=(i=Et(this.ranges())).r,i.c):(n=n||0,e||0),i=r.getCalcService(),o=r.Uw(),i)&&o&&(this.D5=i.unparse(o,t,n,e)):this.D5=t):this.WK||this.initExpression(r,n,e),this.WK},a.prototype.getFormulaString=function(t,r,n,e){var i,o,a;return t=t||this.DJ,i=this.WK,o=this.D5,!t||!o||(i||(this.initExpression(t,r,n),i=this.WK),o&&(i.value&&14===i.value.type||i.value2&&14===i.value2.type))?o:(a=Et(this.ranges()),r=T(r)?a.r:r,n=T(n)?a.c:n,t.getCalcService().unparse(t.Uw(),i,r,n,k,!!e))},a.prototype.formula=function(t,r,n){var e,i;if("string"!=typeof t)return e=this.item1(),i=this.item2(),0===n&&e&&e.formula?e.formula(t,r,n):1===n&&i&&i.formula?i.formula(t,r,n):this.getFormulaString(k,t,r);this.D5=t,this.WK=C},a.prototype.adjustOffset=function(t,r){var n,e,n=this,e=n.item1();e&&e.adjustOffset&&e.adjustOffset(t,r),(e=n.item2())&&e.adjustOffset&&e.adjustOffset(t,r),n.offsetRow=t,n.offsetCol=r},a.prototype.relationConditionEvaluate=function(e,i,o,n,t){var a,r,t,u,f;function s(t,r){var n;return e&&t&&3===t.conType()&&(n=e.getActualStyle(i,o,3,!0))&&(0===t.ZK()?r=n.backColor:1===t.ZK()&&(r=n.foreColor)),r}function l(t,r){if(t)return t.ignoreBlank(a.ignoreBlank()),arguments.length<5?s(t,n):r}function c(t,r){return!T(t)&&t.evaluate(e,i,o,r)}return r=l((a=this).item1(),n),t=l(a.item2(),t),(u=c(a.item1(),r)?1:0)+(f=c(a.item2(),t)?1:0)>a.ZK()},a.prototype.cellValueConditionEvaluate=function(t,r,n,e){var r=this.getExpected(t,r,n);return!(r!==C||!t||!t.EJ)||this.cellValueConditionCheckCondition(r,e)},a.prototype.cellValueConditionCheckCondition=function(t,r){var n,e,i,o,a,u,n,f,n=this,e=0,i=!1,o=n.ZK();if(T(r)&&T(t))switch(o){case Xt.equalsTo:case Xt.greaterThanOrEqualsTo:case Xt.lessThanOrEqualsTo:return!0;case Xt.notEqualsTo:case Xt.greaterThan:case Xt.lessThan:default:return!1}if(a=tr[o],D.ExcelCompatibleCalcMode)return jt(a,r,t);if("boolean"==typeof t||"boolean"==typeof r)return tn(o,r,t);if(u={},T(r))n.treatNullValueAsZero()?i=!0:e=r;else{if(typeof r===z&&"number"==typeof t)return tn(o,1,0);"boolean"!=typeof r&&ft(r,u)&&(e=u.value,i=!isNaN(e))}return n=0,f=!1,("number"==typeof t||t&&"string"==typeof t&&!Zr(t))&&ft(t,u)&&(n=u.value,f=!0),i?f?tn(o,e,n):jt(a,r,t):"string"==typeof r?f?jt(a,r,n):"string"==typeof t?jt(a,r,t):1===o:!!T(r)&&o===Xt.notEqualsTo},a.prototype.numberConditionEvaluate=function(t,r,n,e){var r=this.numberConditionGetExpected(t,r,n);return!(r!==C||!t||!t.EJ)||(this.integerValue()&&(r=isNaN(r)?C:(0<r?et:it)(r)),this.numberConditionCheckCondition(r,e))},a.prototype.numberConditionCheckCondition=function(t,r){var n,e,i,n=this;if((T(r)||""===r)&&n.ignoreBlank())return!0;if(T(t)){if(n.ignoreBlank())return!0;t=0}try{e=T(r)?0:"string"==typeof r?m.mt.Xf(C,r,!0):parseFloat(r)}catch(t){return!1}return"number"==typeof e&&(!n.integerValue()||(i=e-et(e)==0))&&tn(n.ZK(),e,t)},a.prototype.numberConditionGetExpected=function(t,r,n){var e,i,e=this;return e.D5&&0<e.D5.length&&(i=t.op())?i.evaluate(t.Uw(),e.expression(C,t),r,n):e.expected()},a.prototype.textConditionEvaluate=function(t,r,n,e){var i,o,a,u,t,f;function s(t,r){return i.testTextByCondition(r,t,"^","$",function(){return a?t.toLowerCase()===r.toLowerCase():t===r})}function l(t,r){return i.testTextByCondition(r,t,"^","",function(){return ht(r,t,a)})}function c(t,r){return i.testTextByCondition(r,t,"","$",function(){return vt(r,t,a)})}function h(t,r){return i.testTextByCondition(r,t,"","",function(){return dt(r,t===k||t===C?"":t,a)})}if(o=(i=this).compareType(),a=i.ignoreCase(),!i.forceValue2Text()&&g(e,Date))return o!==v.beginsWith&&o!==v.endsWith&&o!==v.contains&&(o===v.doesNotBeginWith||o===v.doesNotEndWith||o===v.doesNotContain);if(u=T(e)?"":e.toString(),i.ignoreBlank()&&""===u)return!0;if(t=this.getExpected(t,r,n),f=T(t)?"":t.toString(),i.hasWildcard(f)&&"number"==typeof e)return o===v.doesNotBeginWith||o===v.doesNotContain||o===v.doesNotEndWith||o===v.notEqualsTo;switch(o){case v.equalsTo:return s(f,u);case v.notEqualsTo:return!s(f,u);case v.beginsWith:return l(f,u);case v.doesNotBeginWith:return!l(f,u);case v.endsWith:return c(f,u);case v.doesNotEndWith:return!c(f,u);case v.contains:return h(f,u);case v.doesNotContain:return!h(f,u);default:return!1}},a.prototype.hasWildcard=function(t){return-1<t.indexOf("*")||-1<t.indexOf("?")},a.prototype.testTextByCondition=function(t,r,n,e,i){var o,r,o;return this.useWildCards()?this.regex()?yt.qT(this.regex()).test(t):(r=yt.jJ(r))?(r=n+r+e,(this.ignoreCase()?yt.OJ(r):yt.qT(r)).test(t)):i():i()},a.prototype.colorConditionEvaluate=function(t,r,n,e){var i,o,e,t;function a(t){return T(t)||""===t?C:Bt._(t)}if(o=a((i=this).expected()),T(o)||""===o){if(i.ignoreBlank()||T(o)&&T(e))return!0}else if(e=a(e),(T(e)||""===e)&&t&&t.getDefaultStyle&&(t=t.getDefaultStyle(),i.ZK()===ir.backgroundColor?e=t.backColor:i.ZK()===ir.foregroundColor&&(e=t.foreColor)),!T(e)&&""!==e)return V.Common.ft.Tv(e,o);return!1},a.prototype.formulaConditionEvaluate=function(t,r,n,e){var i,o,o,a;if(!Ot)return!1;if((i=this).customValueType()===or.formula)return(o=i.DJ&&i.DJ.getDataSource&&i.DJ.getDataSource())&&o.RJ&&(t.Uw().DJ=o.RJ(r)),o=i.getExpected(t,r,n),!(!i.ignoreBlank()||!T(o)&&""!==o)||(!D.ExcelCompatibleCalcMode||"0"!==o)&&en(o);switch(a=ot.BJ,i.customValueType()){case or.empty:return T(e)||""===e;case or.nonEmpty:return!T(e)&&""!==e;case or.error:return a(e);case or.nonError:return!a(e);default:return!1}},a.prototype.formulaConditionGetExpected=function(t,r,n){var e,i,o,a,u,f,s,l,c,e=this;if(e.D5&&0<e.D5.length){if(!(i=t.op()))return e.expected();if(o=t.Uw(),a=i.evaluateParsedFormula(o,e.expression(k,t),(0,F.eV)(r,n),!0),c=l=s=f=u=void 0,ot.LE(a)){for(u=a.getRowCount(0),f=a.getColumnCount(0),s=[],l=0;l<u;l++)for(s[l]=[],c=0;c<f;c++)s[l][c]=a.getValue(0,l,c);a=s}else if(ot.Nh(a)){for(u=a.getRowCount(),f=a.getColumnCount(),s=[],l=0;l<u;l++)for(s[l]=[],c=0;c<f;c++)s[l][c]=a.getValue(l,c);a=s}return g(a,Array)?a[0][0]:a}return e.expected()},a.prototype.dateOrTimeEvaluate=function(t,r,n,e,i,o,a){var u,f,s,e,u=this;if((T(e)||""===e)&&u.ignoreBlank())return!0;if(!g(f=e,Date)){if(u.ZK()===ar.notEqualsTo)return!0;if(!T(e))return!1;f=Dt.Y0(0)}if(s=C,e=this.getExpected(t,r,n),g(e,Date)?s=e:"string"==typeof e?s=Dt.yU(e):"number"==typeof e&&(s=Dt.Y0(e)),T(s))return!!u.ignoreBlank();switch(u.ZK()){case ar.equalsTo:return i(s,f);case ar.notEqualsTo:return!i(s,f);case ar.after:return a(s,f);case ar.afterEqualsTo:return a(s,f)||i(s,f);case ar.before:return o(s,f);case ar.beforeEqualsTo:return o(s,f)||i(s,f);default:return!1}},a.prototype.dateConditionEvaluate=function(t,r,n,e){var i=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,r,n,e,pr,i?mr:wr,i?Sr:gr)},a.prototype.timeConditionEvaluate=function(t,r,n,e){return this.dateOrTimeEvaluate(t,r,n,e,kr,xr,Tr)},a.prototype.dateExConditionEvaluate=function(t,r,n,e){var t=this.LJ(t,r,n);return!T(t)&&this.dateExConditionCheckCondition(t,e)},a.prototype.getExConditionDateScope=function(t){var r,n,e,i,o,a,o,a,o,a,o,a,o,a,o,a,o,a,u,f,s,a,u,s,f,o,u,s,o,f,a,s,o,a,u,f,s,r=C,n=C,e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());switch(t){case N.last7Days:h(i,br(i)-6),r=l(i),n=c(e);break;case N.yesterday:h(i,br(i)-1),r=l(i),n=c(i);break;case N.today:r=l(e),n=c(e);break;case N.tomorrow:h(i,br(i)+1),r=l(i),n=c(i);break;case N.lastWeek:h(o=e,br(e)-e.getDay()-7),(a=i).setDate(br(i)-i.getDay()-1),r=l(o),n=c(a);break;case N.thisWeek:h(o=e,br(e)-e.getDay()),h(a=i,br(i)-i.getDay()+6),r=l(o),n=c(a);break;case N.nextWeek:h(o=e,br(e)-e.getDay()+7),h(a=i,br(i)-i.getDay()+13),r=l(o),n=c(a);break;case N.lastMonth:h(o=e,1),o.setMonth(e.getMonth()-1),h(a=i,0),r=l(o),n=c(a);break;case N.thisMonth:h(o=e,1),h(a=i,1),a.setMonth(i.getMonth()+1),h(a,0),r=l(o),n=c(a);break;case N.nextMonth:h(o=e,1),o.setMonth(e.getMonth()+1),h(a=i,1),a.setMonth(i.getMonth()+2),h(a,0),r=l(o),n=c(a);break;case N.nextQuarter:u=(a=(o=e).getMonth())%3,o.setDate(1),o.setMonth(a-u+3),s=void 0,(f=i).setDate(1),f.setMonth(a-u+3+2),s=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(s),r=l(o),n=c(f);break;case N.thisQuarter:s=(u=(a=e).getMonth())%3,a.setDate(1),a.setMonth(u-s),o=void 0,(f=i).setDate(1),f.setMonth(u-s+2),o=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(o),r=l(a),n=c(f);break;case N.lastQuarter:o=(s=(u=e).getMonth())%3,u.setDate(1),u.setMonth(s-o-3),a=void 0,(f=i).setDate(1),f.setMonth(s-o-3+2),a=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(a),r=l(u),n=c(f);break;case N.nextYear:(s=e).setDate(1),s.setFullYear(s.getFullYear()+1),s.setMonth(0),(o=i).setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31),r=l(s),n=c(o);break;case N.thisYear:(a=e).setDate(1),a.setMonth(0),(u=i).setMonth(11),u.setDate(31),r=l(a),n=c(u);break;case N.lastYear:(f=e).setFullYear(f.getFullYear()-1),f.setDate(1),f.setMonth(0),(s=i).setFullYear(s.getFullYear()-1),s.setMonth(11),s.setDate(31),r=l(f),n=c(s)}return{from:r,to:n}},a.prototype.dateExConditionCheckCondition=function(t,r){var n,r,e,i,t,e,t,e,t,o,t,n;function a(t,r){switch(t){case sr.quarter1:return 0<=r.getMonth()&&r.getMonth()<=2;case sr.quarter2:return 3<=r.getMonth()&&r.getMonth()<=5;case sr.quarter3:return 6<=r.getMonth()&&r.getMonth()<=8;case sr.quarter4:return 9<=r.getMonth()&&r.getMonth()<=11;default:return!1}}if(r=r,(n=this).ignoreBlank()&&(T(r)||""===r))return!0;try{if(T(r)&&!n.treatNullValueAsZero())return!1;r=ot.r0(r)}catch(t){return!1}if((i=n.expectTypeId())===ur.dateOccurring){if(e=(t=this.getExConditionDateScope(t)).from,t=t.to,!T(e)&&!T(t))return e=(0,b.aJ)(y.dateCondition,ar.afterEqualsTo,e,C),t=(0,b.aJ)(y.dateCondition,ar.beforeEqualsTo,t,C),(o=(0,b.aJ)(y.relationCondition,rr.and,C,C,C,C,C,e,t)).evaluate(C,0,0,r)}else if(e=n.LJ(C,0,0),!T(e)){if(i===ur.yearOccurring)return e===r.getFullYear();if(i===ur.quarterOccurring)return a(e,r);if(i===ur.monthOccurring)return e===r.getMonth();if(i===ur.weekOccurring)return e===r.getDay();if(i===ur.dayOccurring)return e===br(r);if(i===ur.yearToDate)return t=new Date,n=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),n.setHours(23,59,59,999),t<=r&&r<=n}return!1},a.prototype.textLengthConditionEvaluate=function(t,r,n,e){var e,t;return!(!T(e)&&""!==e||!this.ignoreBlank())||(e=T(e)?0:e.toString().length,"number"==typeof(t=this.LJ(t,r,n))&&tn(this.ZK(),e,t))},a.prototype.top10ConditionEvaluate=function(t,r,n,e){var i,r,o,n,i=this;if(T(e)||""===e)return i.ignoreBlank();if(r=i.LJ(t,r,n),!T(r)&&(o=void 0,o=i.FJ?(T(i.PJ)&&(i.PJ=i.getTopValues(t,r,i.ranges())),i.PJ):i.getTopValues(t,r,i.ranges()))){n=0;try{n=i.uJ(e)}catch(t){return!1}if(Ft.OS(o,n))return!0}return!1},a.prototype.LJ=function(t,r,n){var t=this.getExpected(t,r,n),t=parseInt(t,10);return isNaN(t)||!isFinite(t)?C:t},a.prototype.adjustRange=function(t,r){return $(t.row,t.col,Math.min(Q(t),r.getRowCount()),Math.min(H(t),r.getColumnCount()))},a.prototype.getTopValues=function(t,r,n){var e,i,o,a,u,f,s,s,l,c,h,e=0===this.type()?1:-1,i=[];if(n){for(o=this.GJ(t,n),a=J(o),l=0;l<a;l++)for(u=this.adjustRange(o[l],t),c=0;c<Q(u);c++)for(f=c+u.row,h=0;h<H(u);h++)s=h+u.col,s=this.uJ(t.getValue(f,s)),T(s)||i.push(s);i.sort(function(t,r){return(r-t)*e}),J(i)>r&&(i=i.slice(0,r))}return i},a.prototype.uJ=function(t){return("number"==typeof t||g(t,Date))&&Ot?ut(t):C},a.prototype.uniqueConditionEvaluate=function(t,r,n,e){var i,e,r,n,r,n,i=this,e=e;return T(e)||""===e?i.ignoreBlank():(Ot&&at(e)&&!Qt(e)&&!m.mt.isInfinityNumberString(e)&&(e=ut(e)),r=this.getExpected(t,r,n),ot.YK(r,n={}),!T(r=n.value)&&(n=i.duplicatedArrayCached||i.getDuplicated(t,i.ranges()),!T(n)&&Ft.OS(n,e)?!0===r:!0!==r))},a.prototype.getDuplicated=function(t,r){var n,e,i,o,a,u,f,s,l,c,h,v,v,d,n=[],e={},i=this.GJ(t,r);if(i)for(o=J(i),a=0;a<o;a++)for(u=i[a],f=Q(u=this.adjustRange(u,t)),s=H(u),l=0;l<f;l++)for(c=l+u.row,h=0;h<s;h++)v=h+u.col,v=t.getValue(c,v,3),(d=e[v=T(v)||!Ot||!at(v)||Qt(v)||m.mt.isInfinityNumberString(v)?v:ut(v)])?1===d&&n.push(v):e[v]=1;return n},a.prototype.UJ=function(t,r){for(var n,e,n=t.length,e=0;e<n;e++)if(t[e].key===r)return!0;return!1},a.prototype.averageConditionEvaluate=function(t,r,n,e){var i,o,o,a,u,t,f,s;if(!Ot)return!1;if((i=this).ignoreBlank()&&(T(e)||""===e))return!0;if(i.HJ(),o=i.FJ?(T(i.PJ)&&(i.PJ=i.getExpected(t,r,n)),i.PJ):i.getExpected(t,r,n),a=ft(o,o={})?o.value:NaN,u=C,t=i.QK?i.zJ(t,i.QK,r,n):C,T(t)||(u=ft(t,o={})?o.value:NaN),isNaN(a)||!at(e,!0))return!1;switch(f=ut(e),s=isNaN(u),i.type()){case I.above:return a<f;case I.below:return f<a;case I.equalOrAbove:return a<=f;case I.equalOrBelow:return f<=a;case I.above1StdDev:return!s&&a+u<f;case I.below1StdDev:return!s&&f<a-u;case I.above2StdDev:return!s&&a+2*u<f;case I.below2StdDev:return!s&&f<a-2*u;case I.above3StdDev:return!s&&a+3*u<f;case I.below3StdDev:return!s&&f<a-3*u;default:return!1}},a.prototype.HJ=function(){var t=this;t.ranges()&&(t.WK=t.VJ("AVERAGE",t.ranges()),4<=t.type())&&t.type()<=9&&(t.QK=t.VJ("STDEV",t.ranges()))},a.prototype.VJ=function(t,r){var t,n,e,i;if(Ot&&(t=Wt.findGlobalFunction(t))){for(n=[],e=J(r),i=0;i<e;i++)n[i]=Yt(r[i]);return D.YJ(t,n)}return C},a.prototype.averageConditionGetExpected=function(t,r,n){var e=t.op();return e?e.evaluateParsedFormula(t.Uw(),this.expression(k,t),(0,F.eV)(r,n),!1):C},a.prototype.ZJ=function(){var t=this.conType();t!==y.averageCondition&&t!==y.top10Condition||(this.FJ=!0)},a.prototype.WJ=function(){var t=this;t.FJ=!1,t.PJ=k},a.prototype.zJ=function(t,r,n,e){var i=t.op();return i?i.evaluateParsedFormula(t.Uw(),r,(0,F.eV)(n,e),!1):C},a.prototype.QJ=function(t,r){for(var n,e,e=0;e<J(r);e++)n=r[e],g(n,Array)&&0<J(n)?1<J(r)?t.push(n[0]):t.push.apply(t,n):t.push(n)},a.prototype.getValidList=function(t,r,n){for(var e,i,o,a,e=[],i=this.getValidListImp(t,r,n),o=0,a=J(i);o<a;o++)e.push(i[o].value);return e},a.prototype.KJ=function(){return this.D5&&0<this.D5.length},a.prototype.getValidListImp=function(t,r,n){var e,i,t,o,a,u,f,s,l,s,e=this,i=[];if(e.D5&&0<e.D5.length)t=e.getExpected(t,r,n),g(t,Array)?e.QJ(i,t):i.push(t);else if(e.expected()&&0<e.expected().length&&(u=(a=(o=e.expected()).replace(/\\,/g,String.fromCharCode(206))).split(",")))for(f=0;f<J(u);f++)s=u[f],T(s)||(l=new RegExp(String.fromCharCode(206),"g"),""!==(s=p.trim(s).replace(l,","))&&i.push({text:s,value:s}));return i},a.prototype.areaConditionEvaluate=function(t,r,n,e){var i,o,a,u,f,s;function l(t,r,n){return g(t,Date)&&g(r,Date)?t.valueOf()===r.valueOf():n||"string"!=typeof t||"string"!=typeof r?t===r:t.toLowerCase()===r.toLowerCase()}if(i=this,T(e)||""===e)return!0===i.ignoreBlank();for(o=i.getValidList(t,r,n),a=0;a<J(o);a++){if(u=o[a],T(u)&&T(e))return!0;if(i.D5){if(l(u,e,!1))return!0}else if(f=t.getActualStyle(r,n,3,!0),l(s=x.Xf(f,u,!0),e,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(t,r,n){var e,i,o,a,u,f,s,l,c,h,v,d,y,c,t,e=this,i=[];if(e.D5){if(l=s=f=u=a=o=void 0,!(c=t.op()))return i;if(h=c.evaluateParsedFormula(t.Uw(),e.expression(k,t),(0,F.eV)(r,n),!0),ot.LE(h))for(o=h.getRowCount(0),a=h.getColumnCount(0),v=h.getRow(0),d=h.getColumn(0),(y=h.rT&&h.rT.Mf)&&(y.nre&&y.nre(),c=y.getRowCount(),t=y.getColumnCount(),o=c<o?rt(c-v,0):o,a=t<a?rt(t-d,0):a),u=0;u<o;u++)for(i[u]=[],f=0;f<a;f++)s=h.getValue(0,u,f),l=y?y.getText(v+u,d+f):s,i[u][f]={value:s,text:l};else if(ot.Nh(h))for(o=h.getRowCount(),a=h.getColumnCount(),u=0;u<o;u++)for(i[u]=[],f=0;f<a;f++)s=h.getValue(u,f),i[u][f]={value:s,text:s}}else i.push({value:e.expected(),text:e.expected()});return i},a.prototype.stateConditionEvaluate=function(t,r,n,e){var i=this.expected();return!(T(e)||T(i)||isNaN(e)||isNaN(e))&&0<(e&i)},a.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.ZK(1),t.item1(C),t.item2(C),t.value1=C,t.value2=C,t.expected(C),t.ZK(0),t.integerValue(!1),t.operator=0,t.text="",t.ZK(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.WK=C,t.type(0),this.expectTypeId(0),t.ranges(C),t.isPercent(!1),t.regex(C),t.conType()){case y.relationCondition:t.ignoreBlank(!1),t.ZK(1);break;case y.numberCondition:t.ZK(0),t.integerValue(!1);break;case y.textCondition:t.ZK(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case y.colorCondition:t.ZK(0);break;case y.formulaCondition:t.customValueType(0),t.QK=C;break;case y.dateCondition:case y.timeCondition:t.ZK(0);break;case y.dateExCondition:t.expectTypeId(0);break;case y.textLengthCondition:t.ZK(0);break;case y.top10Condition:case y.averageCondition:t.type(0);break;case y.cellValueCondition:t.operator=6;break;case y.areaCondition:}},a.prototype.evaluate=function(t,r,n,e){var i=this.conType();return!T(i)&&this[y[i]+"Evaluate"](t,r,n,e)},a.prototype.getExpectedNormal=function(t,r,n,e,i,o){var a,u,f,u,a=this,u=a.D5,f=a.expected();return(u=u&&t.op())?u.evaluateParsedFormula(t.Uw(),a.expression(k,t),(0,F.eV)(r,n),!1,o):f},a.prototype.getExpected=function(t,r,n){var e=this;switch(e.conType()){case 2:return e.getExpectedNormal(t,r,n,r-e.offsetRow,n-e.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return e.getExpectedNormal(t,r,n,r-e.offsetRow,n-e.offsetCol,!1);case 8:return e.getExpectedNormal(t,r,n,r,n);case 0:return C;case 1:return e.numberConditionGetExpected(t,r,n);case 3:return C;case 4:return e.formulaConditionGetExpected(t,r,n);case 10:return e.averageConditionGetExpected(t,r,n);case 12:return e.areaConditionGetExpected(t,r,n);default:return C}},a.prototype.GJ=function(t,r){for(var n,e,i,o,n=[],e=0,i=J(r);e<i;e++)o=t.JS(r[e]),n.push(o);return n},a.prototype.getExpressions=function(){var t=[],r=this;return 0===r.conType()?(r.item1()&&r.item1().getExpressions&&(t=r.item1().getExpressions()),r.item2()&&r.item2().getExpressions?t.concat(r.item2().getExpressions()):t):(r.WK||r.initExpression(),r.WK?[r.WK]:[])},a.prototype.setExpressions=function(t,r){var n=this,e;r&&r.push({type:"condition",condition:this,expressions:n.getExpressions(),newExpressions:t}),0===n.conType()?(n.item1()&&n.item1().setExpressions&&(e=n.item1().getExpressions().length,n.item1().setExpressions(t.slice(0,e))),n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(t.slice(e))):n.expression(t[0])},a.prototype.toJSON=function(t){var t=Kt.call(this,t,Nr);return t.ignoreBlank&&!isNaN(t.ignoreBlank)&&(t.ignoreBlank=0!==parseInt(t.ignoreBlank,10)),t},a.prototype.fromJSON=function(t,r,n){var e,i;t&&(Zt.call(e=this,r,Nr,t,n),(i=r&&r.Lp&&r.Lp.useR1C1)&&r instanceof m.Worksheet&&(e.context(r),Rt(e)),e.U0(!0),e.initExpression(),e.H0())},a.fromSource=function(t){return(0,b.aJ)(12,C,t,C)},a.fromFormula=function(t){return(0,b.aJ)(12,C,"",t)},a.fromDay=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(5),t},a.fromMonth=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(3),t},a.fromQuarter=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(2),t},a.fromWeek=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(4),t},a.fromYear=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(1),t},S=a,t(b.Condition=S),S.prototype.conType=r("conType",C),S.prototype.ranges=r("ranges",C,function(t){var r=this.item1(),n=this.item2();r&&r.ranges&&r.ranges(t),n&&n.ranges&&n.ranges(t)}),S.prototype.ignoreBlank=r("ignoreBlank",!1),S.prototype.preciseCompareDate=r("preciseCompareDate",!1),S.prototype.compareType=r("compareType",k),S.prototype.ZK=S.prototype.compareType,S.prototype.expected=r("expected",k),S.prototype.item1=r("item1",C),S.prototype.item2=r("item2",C),S.prototype.treatNullValueAsZero=r("treatNullValueAsZero",!1),S.prototype.integerValue=r("integerValue",!1),S.prototype.forceValue2Text=r("forceValue2Text",!1),S.prototype.useWildCards=r("useWildCards",!0),S.prototype.regex=r("regex",C),S.prototype.ignoreCase=r("ignoreCase",!1),S.prototype.customValueType=r("customValueType",k),S.prototype.expectTypeId=r("expectTypeId",0),S.prototype.type=r("type",C),S.prototype.isPercent=r("isPercent",!1),i.prototype.stopIfTrue=function(t){},i.prototype.evaluate=function(t,r,n,e){var i,o,a,a,u,t,i=this,o=i.JJ(r,n);return i.zT(o)?(i.initCondition(),i.getBaseCoordinate(a={baseRow:0,baseCol:0}),i.condition().adjustOffset(r-a.baseRow,n-a.baseCol),a=C,u=ot.BJ,(t=i.condition().evaluate(t,r,n,e))&&!u(t)&&(a=i.getExpected(o)||b.oJ),i.condition().adjustOffset(0,0),a):C},i.prototype.JJ=function(t,r){return this.contains(t,r)},i.prototype.zT=function(t){return t},i.prototype.contains=function(t,r){var n,e,i,o,n=this.ranges();if(n)for(e=J(n),i=void 0,o=0;o<e;o++)if((i=n[o]).contains(t,r))return!0;return!1},i.prototype.createCondition=function(){return this.KK=!1,null},i.prototype.initCondition=function(t){var r=this.condition();r||((r=this.createCondition())&&(r.ranges(this.ranges()),this.condition(r)),t&&this.context(t),this.context()&&r&&r.context(this.context()))},i.prototype.XJ=function(){var t,r,t=this;t.KK&&((r=t.condition())||(t.initCondition(),r=t.condition()),r)&&!r.WK&&r.initExpression()},i.prototype.context=function(t){return 1===arguments.length&&(this.DJ=t,this.condition())&&this.condition().context(t),this.DJ},i.prototype.getExpected=function(t){return this.style()},i.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.stopIfTrue(!1),t.priority(1)},i.prototype.intersects=function(t,r,n,e){var i,o,a,u,i=this.ranges();if(i)for(o=J(i),a=void 0,u=0;u<o;u++)if((a=i[u]).intersect(t,r,n,e))return!0;return!1},i.prototype.isScaleRule=function(){return!1},i.prototype.isStateRule=function(){return!1},i.prototype.getBaseCoordinate=function(t){var r,n,e,i,o,a,o;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,0<(e=(n=(r=this).ranges())?n.length:0))for(i=0;i<e;i++)a=(o=n[i]).row,o=-1===(o=o.col)?0:o,t.baseRow=tt(a=-1===a?0:a,t.baseRow),t.baseCol=tt(o,t.baseCol);else t.baseRow=0,t.baseCol=0},i.prototype.qJ=function(t,r,n){var e,i,o,a,u,f,s,l,c,f,h,v,d,e=this,i=!1;if(e.XJ(),o=e.ranges())for(a=J(o),u=0;u<a;u++)s=(f=o[u]).row,l=Q(f),c=f.col,f=H(f),h=s===t.row&&l===t.rowCount&&t.col<=c&&f<=t.colCount,v=s===r.row&&l===r.rowCount&&r.col<=c&&f<=r.colCount,(d=h||v)&&(o[u]=$(s,c,l+n,f),i=!0);return i},i.prototype.$J=function(t,r,n,e,i,o){var a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,g,m,k,k,T,x,_,a=this,u=n?r:0,f=n?0:r;if(a.XJ(),s=a.ranges()){for(l=[],c=J(s),h=0;h<c;h++)if(v=s[h],d=n?v.row:v.col,y=(n?Q:H)(v),-1!==d){if(e&&0<e.length){for(C=!1,b=0,p=e.length;b<p;b++)if((g=e[b])&&(S=!n&&g.col===t&&g.col===v.col&&g.colCount-r===v.colCount,w=!n&&g.col===t&&g.row===v.row&&g.rowCount===v.rowCount&&v.col>=g.col&&v.col+v.colCount<=g.col+g.colCount,g=n&&g.row===t&&g.row===v.row&&g.rowCount-r===v.rowCount,S||w||g)){s[h]=$(v.row,v.col,Q(v)+u,H(v)+f),C=!0;break}if(C)break}if(m=v,k=i&&e&&e[0]){if((k=n?an(v,k.col,k.col+k.colCount-1):un(v,k.row,k.row+k.rowCount-1))[0]&&l.push(k[0]),k[2]&&l.push(k[2]),!k[1])continue;m=k[1]}t<=d?s[h]=$(m.row+u,m.col+f,Q(m),H(m)):t<d+y?s[h]=$(m.row,m.col,Q(m)+u,H(m)+f):t===d+y&&(s[h]=$(m.row,m.col,Q(m)+(o?0:u),H(m)+(o?0:f)))}for(T=0,x=l;T<x.length;T++)s.push(_=x[T])}},i.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},i.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},i.prototype.tX=function(t,r,n,e,i){var o,a,u,f,s,l,c,h,v,d,y,C,b,p,g,y,g,S,w,m,k,T,x,o=this,a=n?t:0,u=n?0:t,f=n?r:0,s=n?0:r;if(o.XJ(),l=o.ranges()){for(c=[],h=[],v=J(l),d=0;d<v;d++)if(y=l[d],C=n?y.row:y.col,b=(n?Q:H)(y),-1!==C){if(p=y,g=i&&e&&e[0]){if((y=n?an(y,g.col,g.col+g.colCount-1):un(y,g.row,g.row+g.rowCount-1))[0]&&c.push(y[0]),y[2]&&c.push(y[2]),!y[1])continue;p=y[1]}t<C?C+b<=t+r?h.push(p):l[d]=$(p.row-f,p.col-s,Q(p),H(p)):t<C+b&&(g=$(p.row,p.col,Q(p)-tt(p.row+Q(p)-a,f),H(p)-tt(p.col+H(p)-u,s)),0===H(g)||0===Q(g)?h.push(p):l[d]=g)}for(S=0,w=c;S<w.length;S++)l.push(m=w[S]);for(k=J(h),T=0;T<k;T++)Gt(l,x=h[T])}},i.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},i.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},i.prototype.toJSON=function(t){return Kt.call(this,t)},i.prototype.fromJSON=function(t,r,n){t&&(Zt.call(this,r,C,t,n),this.initCondition(r))},i.prototype.kJ=function(){var t=this.condition();t&&Rt(t)},i.prototype.nX=function(){var t,r,n,e,i,t=this.JK,r=this.ranges();if(t){if((n=J(t))!==(e=J(r)))return!0;for(i=0;i<e;i++)if(!t[i].equals(r[i]))return!0}else this.JK=Sn(r);return!1},(e=(b.ConditionRuleBase=n=i).prototype).ruleType=r("ruleType",C),e.ranges=r("ranges",C,function(t){var r,n,r=this.condition();r&&r.ranges()&&((n=r.DJ)&&n.Ut.vJ(),r.ranges(t),n)&&n.Ut.vJ(!0)}),e.condition=r("condition",C),e.style=r("style",C),e.priority=r("priority",1),e.stopIfTrue=r("stopIfTrue",!1),Ir=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Rr={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},Ar={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},(e=Er=Er||{})[e.equal=0]="equal",e[e.notEqual=1]="notEqual",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqual=3]="greaterThanOrEqual",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqual=5]="lessThanOrEqual",e[e.between=6]="between",e[e.notBetween=7]="notBetween",M(u,$r=n),u.prototype.value1=function(t,r){var n,n;if(1!==arguments.length)return(n=this.condition())&&(n=n.formula(t,r,0))&&0<n.length?"="+ct(p.trim(n.toString()),"="):this.eX;this.eX=t},u.prototype.value2=function(t,r){var n,n;if(1!==arguments.length)return(n=this.condition())&&(n=n.formula(t,r,1))&&0<n.length?"="+ct(p.trim(n.toString()),"="):this.iX;this.iX=t},u.prototype.formula=function(t,r){var n=this,e=n.condition();if("string"!=typeof t)return e&&e.formula(t,r)||n.D5;n.D5=t,e&&e.formula(t)},u.prototype.cellValueRuleCreateCondition=function(){var t,r,n,e,i,o,a,u,f,s,l,c,t,h,a,t=this,r=t.value1(),n=t.value2(),e=t.ranges(),i=t.kf(r)?ct(r,"="):C,o=t.kf(n)?ct(n,"="):C,t=t.operator();return t===nr.between?((a=(0,b.aJ)(y.cellValueCondition,3,r,i,k,k,e)).treatNullValueAsZero(!0),(u=(0,b.aJ)(y.cellValueCondition,5,n,o,k,k,e)).treatNullValueAsZero(!0),l=(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,a,u),(f=(0,b.aJ)(y.cellValueCondition,5,r,i,k,k,e)).treatNullValueAsZero(!0),(s=(0,b.aJ)(y.cellValueCondition,3,n,o,k,k,e)).treatNullValueAsZero(!0),c=(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,f,s),(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,l,c)):t===nr.notBetween?((a=(0,b.aJ)(y.cellValueCondition,4,r,i,k,k,e)).treatNullValueAsZero(!0),u=(0,b.aJ)(y.cellValueCondition,2,n,o,k,k,e),a.treatNullValueAsZero(!0),l=(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,a,u),(f=(0,b.aJ)(y.cellValueCondition,2,r,i,k,k,e)).treatNullValueAsZero(!0),(s=(0,b.aJ)(y.cellValueCondition,4,n,o,k,k,e)).treatNullValueAsZero(!0),c=(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,f,s),(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,l,c)):((a=(0,b.aJ)(11,t,r,i,k,k,e)).treatNullValueAsZero(!0),a)},u.prototype.kf=function(t){return!T(t)&&"="===t[0]},u.prototype.specificTextRuleCreateCondition=function(){var t,r,n,e,n,r=this.operator();switch(r){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return n=this.text(),e=C,n&&"="===n[0]&&(e=n),(n=(0,b.aJ)(2,t,n,e,k,k,this.ranges())).ignoreCase(!0),n.useWildCards(2!==r&&3!==r),n},u.prototype.formulaRuleCreateCondition=function(){var t=this,r=t.ranges();return(0,b.aJ)(4,C,C,t.D5,4,C,r)},u.prototype.dateOccurringRuleCreateCondition=function(){return(0,b.aJ)(6,C,this.type(),C,C,k,this.ranges())},u.prototype.top10RuleCreateCondition=function(){return(0,b.aJ)(8,C,this.rank(),C,C,this.type(),this.ranges())},u.prototype.uniqueRuleCreateCondition=function(){return(0,b.aJ)(9,C,!1,C,C,C,this.ranges())},u.prototype.duplicateRuleCreateCondition=function(){return(0,b.aJ)(9,C,!0,C,C,C,this.ranges())},u.prototype.averageRuleCreateCondition=function(){return(0,b.aJ)(10,C,C,C,C,this.type(),this.ranges())},u.prototype.createCondition=function(){return this[_[this.ruleType()]+"CreateCondition"]()},u.prototype.reset=function(){var t=this;switch(t.ranges(C),t.condition(C),t.style(C),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(C),t.value2(C),t.text(""),t.formula(C),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(C);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},u.prototype.evaluate=function(t,r,n,e){return this.rX(t),$r.prototype.evaluate.call(this,t,r,n,e)},u.prototype.rX=function(t){var r,n,r=this;r.initCondition(),9===(n=r.condition()).conType()&&(r.nX()&&(r.dl(),r.JK=Sn(r.ranges())),!1===r.cached)&&(n.duplicatedArrayCached=n.getDuplicated(t,r.ranges()),r.cached=!0)},u.prototype.dl=function(){this.cached=!1},u.prototype.JO=function(t,r,n,e,i){$r.prototype.JO.call(this,t,r,n,e,i),this.dl()},u.prototype.qO=function(t,r,n,e,i){$r.prototype.qO.call(this,t,r,n,e,i),this.dl()},u.prototype.xP=function(t,r,n,e){$r.prototype.xP.call(this,t,r,n,e),this.dl()},u.prototype.NP=function(t,r,n,e){$r.prototype.NP.call(this,t,r,n,e),this.dl()},u.prototype.toJSON=function(t){var r,n,e,i,o,a,r=this;return T(r.condition())&&this.initCondition(),n=Kt.call(r,t,Ir),e=r.value1(),fn(n.ruleType,n.operator)&&(i=r.value2()),o=t&&t.parent&&1===t.parent.options.referenceStyle,T(e)||(r.kf(e)&&o&&(e=cn(t,r,e,o)),n.value1=e),T(i)||(r.kf(i)&&o&&(i=cn(t,r,i,o)),n.value2=i),(a=r.ruleType())===_.conditionRuleBase&&(n.condition=r.condition().toJSON()),n},u.prototype.fromJSON=function(t,r,n){var e=Ir;T(t.condition)||(e=Ir.concat(["condition"])),Zt.call(this,r,e,t,n),T(t.value1)||this.value1(t.value1),T(t.value2)||this.value2(t.value2),this.initCondition(r)},u.prototype.oX=function(t,r,n){var e,i,r,o,t,a,u,f,f,n,s,l,f,c,h,v,d,l,y,C,b,p,g,u,S,w,S,a,r,e=this,i=e.ruleType(),r=m.Util.ko(r),o={n_:P,sqref:It(e.ranges())};return o.pivot=T(e.pivotTableName)?k:"1",t=t.getDxfIndex(e.style(),!0),a=e.operator&&e.operator(),u=e.type&&e.type(),f=[N.nextQuarter,N.thisQuarter,N.lastQuarter,N.nextYear,N.thisYear,N.lastYear],i===_.dateOccurringRule&&-1<f.indexOf(u)?o.lossless=e.toJSON(n):(n=(f=En(i,u,a)).type,s=f.operator,l=e.condition(),f=f.timePeriod,c=e.priority()?""+e.priority():"1",h=e.stopIfTrue()?1:k,v=1===u?1:k,l=(d=l&&l.isPercent())?1:k,y=e.rank&&e.rank()||k,C=e.text&&e.text(),g=p=b=void 0,i===_.averageRule&&(g=0,u!==I.equalOrAbove&&u!==I.equalOrBelow||(p=1),u!==I.above1StdDev&&u!==I.below1StdDev||(g=1),u!==I.above2StdDev&&u!==I.below2StdDev||(g=2),u!==I.above3StdDev&&u!==I.below3StdDev||(g=3),u!==I.below&&u!==I.equalOrBelow&&u!==I.below1StdDev&&u!==I.below2StdDev&&u!==I.below3StdDev||(b=0)),u=[],S=T(e.value1())?e.D5:e.value1(),w=e.value2(),T(S)||u.push({n_:"formula",c_:[_n(r?S:Ct(S))]}),fn(i,a)&&!T(w)&&u.push({n_:"formula",c_:[_n(r?w:Ct(w))]}),S={n_:"cfRule",type:n,dxfId:t!==k?+t:t,priority:c,stopIfTrue:h,aboveAverage:b,equalAverage:p,bottom:v,percent:l,rank:y,operator:s,text:pt(C),stdDev:g,timePeriod:f},i===_.specificTextRule||i===_.dateOccurringRule||i===_.top10Rule||i===_.uniqueRule||i===_.duplicateRule||i===_.averageRule?(a=sn(S,e.ranges(),C))&&(r=[{n_:"formula",c_:[_n(x.getFormulaString(a))]}],S.c_=r):S.c_=u,o.c_=[S]),o},u.prototype.IJ=function(t){var r,n,e,i,e,t,r=this,n={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},e=Ut(),i={n_:"cfRule",type:"expression",id:e};return r.rJ=e,T(r.priority())||(i.priority=r.priority()),e={n_:"f",c_:[pt(bt(r.D5))]},r.style()&&(t={n_:"dxf",v:t.cv(r.style(),!0)},i.c_=[e,t]),n.c_=[i,{n_:"sqref",c_:[It(r.ranges())]}],n},u.prototype.aX=function(){var t=this;if(At(t.value1())||At(t.value2())||At(t.text())||At(t.D5))return!0},u.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),r?o.IJ(n):o.oX(t,e,i)},u.prototype.uX=function(t,r,n,e){var i,o,e,n,a,u,a,f,e,s,l,c,h,a,i=this,o=t.type,e=m.Util.ko(e),n=n.getDxf(t.dxfId,void 0,!0,!0),a=gt(t,"formula"),u=U(a&&_t(a[0])),a=U(a&&_t(a[1]));switch("cellIs"===o?(i.eX=(e?"":"=")+Tt(u),a&&(i.iX=(e?"":"=")+Tt(a))):i.D5=Tt(u),T(t.stopIfTrue)||i.stopIfTrue(1==+t.stopIfTrue),f=t.rank,e=qn(o)){case 8:l=!0,0==+t.aboveAverage&&(l=!1),s=(c=1==+t.equalAverage)?l?2:3:l?0:1,T(t.stdDev)||(h=+t.stdDev,l?1==h?s=4:2==h?s=6:3==h&&(s=8):1==h?s=5:2==h?s=7:3==h&&(s=9));break;case 5:s=0,t.bottom&&(s=1),t.percent&&0===(f=Math.floor(r[0].rowCount*r[0].colCount*f/100))&&(f=1);break;case 4:s=0,"timePeriod"===t.type&&t.timePeriod&&(s=Rr[t.timePeriod])}i.type(s),T(f)||i.rank(+f),a=An(o,t.operator,t.timePeriod),i.operator(a),i.text(Tt(t.text)),i.ranges(r),i.ruleType(e),i.style(ln(n)),T(t.priority)||i.priority(+t.priority)},u.prototype.sX=function(t,r,n){var e,i,o,a,u,f,s,l,c,c,h,c,i,h,e=this,i=t.type,o=qn(i);switch(T(t.stopIfTrue)||e.stopIfTrue(1==+t.stopIfTrue),u=t.rank,o){case 8:f=!0,0==+t.aboveAverage&&(f=!1),a=(s=1==+t.equalAverage)?f?2:3:f?0:1,T(t.stdDev)||(l=+t.stdDev,f?1==l?a=4:2==l?a=6:3==l&&(a=8):1==l?a=5:2==l?a=7:3==l&&(a=9));break;case 5:a=0,t.bottom&&(a=1),t.percent&&0===(u=Math.floor(r[0].rowCount*r[0].colCount*u/100))&&(u=1);break;case 4:a=0,"timePeriod"===t.type&&t.timePeriod&&(a=Rr[t.timePeriod])}e.type(a),T(u)||e.rank(+u),c=An(i,t.operator,t.timePeriod),e.operator(c),e.ruleType(o),h=(c=gt(t,"f"))&&Tt(kt(_t(c[0]))),c=c&&Tt(kt(_t(c[1]))),"cellIs"===i?(e.eX=h,e.iX=c):e.D5=h,o===_.specificTextRule&&e.text(c),(i=mt(t,"dxf"))&&(h=i.v,e.style(ln(n.fv(h,k,k,!0)))),e.ranges(r)},u.prototype.yh=function(t,r,n,e,i,o,a){var u=this;i?u.sX(t,r,o):u.uX(t,r,n,a),u.initCondition(e)},R=u,b.NormalConditionRule=R,e={operator:r("operator",C),text:r("text",C),type:r("type",C),rank:r("rank",C),priority:r("priority",1)},p.extend(R.prototype,e),b.ScaleValue=hn,Mr=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],M(f,Jr=n),f.prototype.stopIfTrue=function(t){return!1},f.prototype.isScaleRule=function(){return!0},f.prototype.createCondition=function(){return C},f.prototype.cX=function(t){var t=(0,b.aJ)(8,C,C,C,C,1).getTopValues(t,1,this.ranges());return 0<J(t)?t[0]:C},f.prototype.fX=function(t){var t=(0,b.aJ)(8,C,C,C,C,0).getTopValues(t,1,this.ranges());return 0<J(t)?t[0]:C},f.prototype.rX=function(t){var r=this;r.nX()&&(r.dl(),r.JK=Sn(r.ranges())),!1===r.cached&&(r.lowestValueCached=r.cX(t),r.highestValueCached=r.fX(t),r.cached=!0)},f.prototype.dl=function(){this.lowestValueCached=C,this.highestValueCached=C,this.XK={},this.cached=!1},f.prototype.lX=function(t,r,n,e){var i,e;return e&&(i=t.op())?(e=i.parse(t.Uw(),e,r,n),i.evaluateParsedFormula(t.Uw(),e,(0,F.eV)(r,n),!1)):C},f.prototype.kf=function(t){return t&&"="===t[0]},f.prototype.hX=function(t){return T(t)||""===t?C:"="===t[0]?t.substr(1):t},f.prototype.dX=function(t,r,n,e){var t;return this.kf(e)?this.lX(t,r,n,this.hX(e.toString())):ft(e,t={})?t.value:NaN},f.prototype.vX=function(t){return this.rX(t),this.highestValueCached},f.prototype.mX=function(t){return this.rX(t),this.lowestValueCached},f.prototype.gX=function(t,r,n,e){var r,n,e,r=this.dX(t,r,n,e);return!isNaN(r)&&0<=r&&r<=100&&(n=this.mX(t),e=this.vX(t),typeof n!=Z)&&n!==C&&typeof e!=Z&&e!==C?n+(e-n)*r/100:C},f.prototype.pX=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,l,l,c,h,i=this.XK;if(void 0===i[e])if(o=this.dX(t,r,n,e),!isNaN(o)&&0<=o&&o<=100){for(a=0,u=this.ranges(),f=J(u),s=0;s<f;s++)l=this.VJ("PERCENTILE",[t.JS(u[s]),o/100]),c=t.op(),h=t.Uw(),l=c.unparse(h,l,r,n),l=c.parse(h,l,r,n),c=c.evaluateParsedFormula(h,l,(0,F.eV)(r,n),!1),a+=ft(c,h={})?h.value:0;i[e]=a/f}else i[e]=C;return i[e]},f.prototype.bX=function(t,r,n,e,i){var o,a,a,o=this;switch(e){case lr.formula:return o.kf(i)||(i="="+i),o.dX(t,r,n,i);case lr.highestValue:return o.vX(t);case lr.lowestValue:return o.mX(t);case lr.number:return o.dX(t,r,n,i);case lr.percent:return o.gX(t,r,n,i);case lr.percentile:return o.pX(t,r,n,i);case lr.automax:return(a=o.vX(t))<0?0:a;case lr.automin:return 0<(a=o.mX(t))?0:a;default:return C}},f.prototype.yX=function(t,r,n){return t===r&&t===n?1:t<=r?0:n<=t?1:(t-r)/(n-r)},f.prototype.wX=function(t,r,n){var r,n,e,i,o,r;return 0<=t&&t<=1?(r=Bt._(r),n=Bt._(n),e=r.a*(1-t)+n.a*t,i=r.r*(1-t)+n.r*t,o=r.g*(1-t)+n.g*t,r=r.b*(1-t)+n.b*t,Vt(parseFloat(e/255+""),parseInt(i+"",10),parseInt(o+"",10),parseInt(r+"",10))):C},f.prototype.VJ=function(t,r){var t,n,e,i;if(Ot&&(t=Wt.findGlobalFunction(t))){for(n=[],e=J(r),i=0;i<e;i++)n[i]=Yt(r[i]);return D.YJ(t,n)}return C},f.prototype.JO=function(t,r,n,e,i){Jr.prototype.JO.call(this,t,r,n,e,i),this.dl()},f.prototype.qO=function(t,r,n,e,i){Jr.prototype.qO.call(this,t,r,n,e,i),this.dl()},f.prototype.xP=function(t,r,n,e){Jr.prototype.xP.call(this,t,r,n,e),this.dl()},f.prototype.NP=function(t,r,n,e){Jr.prototype.NP.call(this,t,r,n,e),this.dl()},f.prototype.scaleEvaluate=function(t,r,n,e){var i,o,a,u,f,i=this;if(i.rX(t),i.contains(r,n)){if(T(e))return C;try{if(o=ut(e),a=i.bX(t,r,n,i.minType(),i.minValue()),u=i.bX(t,r,n,i.midType(),i.midValue()),(f=i.bX(t,r,n,i.maxType(),i.maxValue()))<a)return C;if(isNaN(u)){if(!isNaN(a)&&!isNaN(f))return i.yX(o,a,f)}else if(!isNaN(a)&&!isNaN(f))return o<a?0:f<=o?2:a<=o&&o<=u?i.yX(o,a,u):1+i.yX(o,a,f)}catch(t){}}return C},f.prototype.twoScaleRuleEvaluate=function(t,r,n,e){var i,e,i,o,t,r;if(!T(e)){if(i={},e=at(e)&&ft(e,i)?i.value:NaN,isNaN(e))return C;if(o=(i=this).bX(t,r,n,i.minType(),i.minValue()),t=i.bX(t,r,n,i.maxType(),i.maxValue()),!T(o)&&!T(t))return r=i.yX(e,o,t),i.wX(r,i.minColor(),i.maxColor())}return C},f.prototype.threeScaleRuleEvaluate=function(t,r,n,e){var i,o,e,o,a,t,r,i=this;if(i.MX=t,!T(e)){if(o={},e=at(e)&&ft(e,o)?o.value:NaN,isNaN(e))return C;if(o=i.bX(t,r,n,i.minType(),i.minValue()),a=i.bX(t,r,n,i.midType(),i.midValue()),t=i.bX(t,r,n,i.maxType(),i.maxValue()),!T(o)&&!T(t)&&!T(a))return r=void 0,t<o?C:e<=o||o===t?t<=e?i.maxColor():i.minColor():t<=e?i.maxColor():e<=a?(r=i.yX(e,o,a),i.wX(r,i.minColor(),i.midColor())):(r=i.yX(e,a,t),i.wX(r,i.midColor(),i.maxColor()))}return C},f.prototype.evaluate=function(t,r,n,e){return this[_[this.ruleType()]+"Evaluate"](t,r,n,e)},f.prototype.Hc=function(){var t=this;t.minValue(C),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(C),t.maxType(2),10===t.ruleType()&&(t.minColor(Vt(0,255,255,255)),t.maxColor(Vt(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(Vt(255,248,105,107)),t.midColor(Vt(255,255,235,132)),t.maxColor(Vt(255,99,190,123)))},f.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.Hc(),t.MX=C,t.stopIfTrue(!1),t.priority(1)},f.prototype.toJSON=function(t){return Kt.call(this,t,Mr)},f.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Mr,t,n),this.initCondition(r)},f.prototype.aX=function(){var t=this;if(At(t.minValue())||At(t.midValue())||At(t.maxValue()))return!0},f.prototype.wh=function(t,r,n,e,i){var o,e,a,u,f,s,l,c,h,u,f,s,o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),e=o.ruleType(),(a={n_:P,sqref:It(o.ranges())}).pivot=T(o.pivotTableName)?k:"1",u=Mn(o.minType()),f=o.minValue(),s=Mn(o.maxType()),l=o.maxValue(),c=o.minColor(),h=o.maxColor(),!T(u)&&"autoMin"!==u||(u="min"),!T(s)&&"autoMax"!==s||(s="max"),a.c_=[{n_:"cfRule",type:"colorScale",priority:o.priority()?""+o.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:u,val:T(f)||Gn(u)?k:pt(Ct(f))},{n_:"cfvo",type:s,val:T(l)||Gn(s)?k:pt(Ct(l))}]}]}],T(c)||a.c_[0].c_[0].c_.push(St(c)),T(h)||a.c_[0].c_[0].c_.push(St(h)),11===e&&(u=Mn(o.midType()),f=o.midValue(),s=o.midColor(),a.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:u,val:T(f)?50:pt(Ct(f))}),T(s)||a.c_[0].c_[0].c_.splice(4,0,St(s))),a},f.prototype.yh=function(t,r,n,e){var i,o,a,u,f,s,o,a,l,i=this,o=In(t),a=Rn(t),u=o[0],o=2===o.length?o[1]:(f=o[1],o[2]),l=a[0],a=f?(s=a[1],a[2]):a[1];f?i.ruleType(_.threeScaleRule):i.ruleType(_.twoScaleRule),i.minColor(l),i.minValue(Ln(u.val)),i.minType(On(u.type)),i.midColor(s),f&&!T(f.val)&&i.midValue(Ln(f.val)),i.midType(On(f&&f.type)),i.maxColor(a),i.maxValue(Ln(o.val)),i.maxType(On(o.type)),i.ranges(r),i.initCondition(e),T(t.priority)||i.priority(+t.priority)},Br=f,b.ScaleRule=Br,e={minValue:r("minValue",C),minType:r("minType",5),minColor:r("minColor",C),midValue:r("midValue",50,C,function(t){var r=this;if(r.MX){if(2===r.midType())return r.vX(r.MX);if(1===r.midType())return r.mX(r.MX)}return t}),midType:r("midType",C),midColor:r("midColor",C),maxType:r("maxType",7),maxValue:r("maxValue",C),maxColor:r("maxColor",C)},p.extend(Br.prototype,e),Vr=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],M(s,Qr=Br),s.prototype.Hc=function(t){var r=this;r.gradient(!0),r.color(t),r.showBorder(!1),r.borderColor("black"),r.dataBarDirection(0),r.negativeFillColor("red"),r.useNegativeFillColor(!0),r.negativeBorderColor("black"),r.useNegativeBorderColor(!1),r.axisPosition(0),r.axisColor("black"),r.showBarOnly(!1)},s.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.Hc(Vt(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(C),t.minType(5),t.midValue(C),t.midType(C),t.maxValue(C),t.maxType(7),t.minColor(C),t.midColor(C),t.maxColor(C)},s.prototype.CX=function(t,r,n,e){var i,o,a,u,f,s,o,i=this,a=e?i.maxType():i.minType(),u=e?i.maxValue():i.minValue();if(6!==a&&4!==a)return i.bX(t,r,n,a,u);for(f=0;f<J(i.ranges());f++)if(i.ranges()[f].intersect(r,-1,1,-1)&&(o=i.ranges()[f]))return s=o.row,o=o.col,i.bX(t,s=-1===s?0:s,o=-1===o?0:o,a,u)},s.prototype.SX=function(t,r,n){var e=0;return n<=t&&r<t?[1,0]:t<=r&&t<n?[0,0]:n===r?[.5,0]:[(t-r)/(n-r),0]},s.prototype.TX=function(t,r,n){var e,i,o,i,e=.5,i=nt(n-r);return 0<n&&0<=r?n===r||n<=t?[.5,.5]:t<=r?[r/n*.5,.5]:[.5*nt(t/n),.5]:0<n&&r<0?(o=n>nt(r)?.5:n/i,i=n>nt(r)?r/i:-.5,0<t?n<=t?[o,.5]:[t/n*o,.5]:t<0?t<=r?[i,.5]:[t/r*i,.5]:[0,.5]):n<=0&&r<0?n===r?[-.5,.5]:n<=t?[-n/r*.5,.5]:t<=r?[-.5,.5]:[-t/r*.5,.5]:0===n&&0===r?[0,.5]:[e=-1,-1]},s.prototype.AX=function(t,r,n){var e,i,o,a,u,f,i,o,e=-1,i=nt(r),o=nt(n),a=nt(n-r),u=r<0?-1:1;return 0<n&&0<=r||n<=0&&r<0?(f=rt(i,o),i=tt(i,o),e=r<0?1:0,(o=nt(t))<=i&&o<f?[0,e]:f<=o&&i<o?[u,e]:i===f?[.5*u,e]:[u*(nt(t)-i)/a,e]):0<n&&r<0?(e=nt(r)/a,0===t?[0,e]:n<=t?[1-e,e]:[rt(t,r)/a,e]):0===n&&0===r?(e=.5,0===t?[0,e]:[.5*u,e]):[-1,e]},s.prototype.IX=function(t,r,n){var e=this;return 0===e.axisPosition()?e.AX(t,r,n):1===e.axisPosition()?e.TX(t,r,n):e.SX(t,r,n)},s.prototype.evaluate=function(t,r,n,e){var i,e,i,o,r,n,n,o,r,o,e,a;if(!T(e)){if(i={},e=at(e,!0)&&ft(e,i)?i.value:NaN,isNaN(e))return C;if(o=(i=this).CX(t,r,n,!1),r=i.CX(t,r,n,!0),g(o,Date)&&(o=Dt.o0(o)),g(r,Date)&&(r=Dt.o0(r)),!T(o)&&!T(r))return r<o&&(n=r,r=o,o=n),n=void 0,!(o=i.IX(e,o,r))||J(o)<2?C:(r=o[0],n=o[1],o=e<0&&i.useNegativeFillColor()?i.negativeFillColor():i.color(),e=e<0&&i.useNegativeBorderColor()?i.negativeBorderColor():i.borderColor(),a=i.axisColor(),o=Pt.vl(t,o),e=Pt.vl(t,e),a=Pt.vl(t,a),{fillColor:o,borderColor:e,showBorder:i.showBorder(),axisColor:a,isGradient:i.gradient(),direction:i.dataBarDirection(),axisLocation:n,scale:r,showBarOnly:i.showBarOnly()})}return C},s.prototype.toJSON=function(t){return Kt.call(this,t,Vr)},s.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Vr,t,n),this.initCondition(r)},s.paintDataBar=function(t,r,n,e,i,o){var e,a,u,f,s,l,c,h,v,d,e,o,a,y,o,o,C,b,p,e=new q.Rect(n+2,e+2,i-4,o-4),a=e.x,u=e.y,f=et(nt(e.width*r.scale)),s=e.height;if(0===r.axisLocation)r.scale<=0&&(f=0);else if(1===r.axisLocation)r.scale<0?a=a+e.width-f:f=0;else{for(l=et(e.width*r.axisLocation+a)+.5,c=e.y,v=o-2,t.lineWidth=h=1,t.strokeStyle=r.axisColor,t.beginPath(),d=0;d<=v;d+=2)1===r.direction?(t.moveTo(2*n+i-l,c+d),t.lineTo(2*n+i-l,c+d+1)):(t.moveTo(l,c+d),t.lineTo(l,c+d+1));t.stroke(),0<r.scale?a=l+1:r.scale<0?a=l-f:f=0}r.showBorder&&(a=et(a)+.5,--f,u+=.5,--s),o=(e=a)+f,1===r.direction&&(e=2*n+i-a-f,o=2*n+i-a),0<=f&&0<=s&&(a=r.fillColor,r.isGradient&&(y=.9,a=t.createLinearGradient(e,u,o,u),o=Bt._(r.fillColor),o=Vt(o.a,et(229.5+o.r*(1-.9)),et(229.5+o.g*(1-.9)),et(229.5+o.b*(1-.9))),C=r.scale<0?1-.9:.9,b=r.fillColor,p=r.scale<0?1:0,1===r.direction?(a.addColorStop(C,b),a.addColorStop(p,o)):(a.addColorStop(C,o),a.addColorStop(p,b))),t.fillStyle=a,t.fillRect(e,u,f,s),r.showBorder)&&0<f&&0<s&&(t.strokeStyle=r.borderColor,t.strokeRect(e,u,f,s))},s.prototype.oX=function(){var t,r,n,e,i,o,a,u,f,t=this,r={n_:P,sqref:It(t.ranges())};return r.pivot=T(t.pivotTableName)?k:"1",n=t.showBarOnly()?0:k,e=Mn(t.minType()),i=t.minValue(),o=Mn(t.maxType()),a=t.maxValue(),u=t.color(),!T(e)&&"autoMin"!==e||(e="min"),!T(o)&&"autoMax"!==o||(o="max"),(f=[]).push({n_:"cfvo",type:e,val:T(i)||zr(i)||Gn(e)?k:pt(Ct(i))}),f.push({n_:"cfvo",type:o,val:T(a)||zr(a)||Gn(o)?k:pt(Ct(a))}),u&&f.push(St(u)),r.c_=[{n_:"cfRule",type:"dataBar",priority:t.priority()?""+t.priority():"1",c_:[{n_:"dataBar",showValue:n,c_:f}]}],t.rJ&&r.c_[0].c_.push({n_:j,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),r},s.prototype.IJ=function(){var t,r,n,e,n,i,i,o,o,a,u,f,t=this,r={n_:"conditionalFormatting",r_:[2]};return r.pivot=T(t.pivotTableName)?k:"1",e={n_:"cfRule",type:"dataBar",id:n=Ut()},t.rJ=n,n={n_:"dataBar",minLength:0,maxLength:100},t.showBarOnly()&&(n.showValue="0"),t.showBorder()&&(n.border="1"),!1===t.gradient()&&(n.gradient="0"),!1===t.useNegativeFillColor()&&(n.negativeBarColorSameAsPositive="1"),t.useNegativeBorderColor()&&(n.negativeBarBorderColorSameAsPositive="0"),n.direction=1===t.dataBarDirection()?"rightToLeft":"leftToRight",1===(i=t.axisPosition())?n.axisPosition="middle":2===i&&(n.axisPosition="none"),i=[],(o=t.color())&&i.push(St(o)),o=t.minType(),a=t.minValue(),u=t.maxType(),f=t.maxValue(),T(o)||5===o?i.push({n_:"cfvo",type:"autoMin"}):T(a)||zr(a)?i.push({n_:"cfvo",type:Mn(o)}):i.push({n_:"cfvo",type:Mn(o),c_:[{n_:"f",c_:[pt(bt(a))]}]}),T(u)||7===u?i.push({n_:"cfvo",type:"autoMax"}):T(f)||zr(f)?i.push({n_:"cfvo",type:Mn(u)}):i.push({n_:"cfvo",type:Mn(u),c_:[{n_:"f",c_:[pt(bt(f))]}]}),t.showBorder()&&t.borderColor()&&i.push(St(t.borderColor(),k,"borderColor")),T(t.negativeFillColor())?i.push(St("red",k,"negativeFillColor")):i.push(St(t.negativeFillColor(),k,"negativeFillColor")),T(t.negativeBorderColor())?i.push(St("black",k,"negativeBorderColor")):i.push(St(t.negativeBorderColor(),k,"negativeBorderColor")),2!==t.axisPosition()&&i.push(St(t.axisColor(),k,"axisColor")),n.c_=i,e.c_=[n],r.c_=[e,{n_:"sqref",c_:[It(t.ranges())]}],r},s.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return r?o.IJ():o.oX()},s.prototype.uX=function(t,r){var n,e,i,i,e,i,n=this,e=In(t),i=Rn(t);n.color(i[0]),i=e[0],e=e[1],n.minType(On(i.type)),n.minValue(Ln(i.val)),n.maxType(On(e.type)),n.maxValue(Ln(e.val)),n.priority(+t.priority),n.ranges(r),i=mt(t,"dataBar"),T(i.showValue)||n.showBarOnly(!d(i.showValue,!0)),t.c_[1]&&t.c_[1].n_===j&&(n.rJ=vn(t.c_[1]))},s.prototype.sX=function(t,r){var n,e,i,o,a,a,i,o,a,i,o,a,n=this,e=mt(t,"dataBar");T(e.showValue)||n.showBarOnly(!d(e.showValue,!0)),T(e.border)||n.showBorder(d(e.border,!1)),T(e.gradient)||n.gradient(d(e.gradient,!0)),T(e.direction)||n.dataBarDirection("rightToLeft"===e.direction?1:0),T(e.axisPosition)||n.axisPosition(+Cr[e.axisPosition]),T(e.negativeBarColorSameAsPositive)||n.useNegativeFillColor(!d(e.negativeBarColorSameAsPositive,!1)),T(e.negativeBarBorderColorSameAsPositive)||n.useNegativeBorderColor(!d(e.negativeBarBorderColorSameAsPositive,!0)),2===(i=gt(e,"cfvo")).length&&(n.minType(On(i[0].type)),o=gt(i[0],"f"),a=Wn(i[0],o&&o[0]),T(a)||n.minValue(Ln(a)),n.maxType(On(i[1].type)),o=gt(i[1],"f"),a=Wn(i[1],o&&o[0]),T(a)||n.maxValue(Ln(a))),(i=mt(e,"fillColor"))&&n.color(wt(i)),(o=mt(e,"borderColor"))&&n.borderColor(wt(o)),(a=mt(e,"negativeFillColor"))&&n.negativeFillColor(wt(a)),(i=mt(e,"negativeBorderColor"))&&n.negativeBorderColor(wt(i)),(o=mt(e,"axisColor"))&&n.axisColor(wt(o)),(a=Rn(t))&&0<a.length&&n.color(a[0]),n.ranges(r)},s.prototype.yh=function(t,r,n,e,i,o){var a=this;i?a.sX(t,r):a.uX(t,r),a.initCondition(e)},qr=s,b.DataBarRule=qr,e={gradient:r("gradient",!0),color:r("color",C),showBorder:r("showBorder",!1),borderColor:r("borderColor","black"),dataBarDirection:r("dataBarDirection",0),negativeFillColor:r("negativeFillColor","red"),useNegativeFillColor:r("useNegativeFillColor",!0),negativeBorderColor:r("negativeBorderColor","black"),useNegativeBorderColor:r("useNegativeBorderColor",!1),axisPosition:r("axisPosition",0),axisColor:r("axisColor","black"),showBarOnly:r("showBarOnly",!1)},p.extend(qr.prototype,e),Dr=dn,b.IconCriterion=Dr,Fr=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],M(w,Hr=Br),w.prototype.xX=function(t){var r=this;r.iconSetType(t,!1),r.iconSetType()>=vr.threeArrowsColored&&r.iconSetType()<=vr.threeSymbolsUncircled?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,33),r.hJ[1]=new Dr(!0,dr.percent,67),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2}):r.iconSetType()>=vr.fourArrowsColored&&r.iconSetType()<=vr.fourTrafficLights?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,25),r.hJ[1]=new Dr(!0,dr.percent,50),r.hJ[2]=new Dr(!0,dr.percent,75),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3}):r.iconSetType()>=vr.fiveArrowsColored&&r.iconSetType()<=vr.fiveBoxes?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,20),r.hJ[1]=new Dr(!0,dr.percent,40),r.hJ[2]=new Dr(!0,dr.percent,60),r.hJ[3]=new Dr(!0,dr.percent,80),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3},r.iJ[4]={iconSetType:t,iconIndex:4}):r.iconSetType()>vr.fiveBoxes&&(r.hJ=[],r.iJ=[])},w.prototype.Hc=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xX(t)},w.prototype.NX=function(t){var r=J(this.hJ)+1;return this.reverseIconOrder()&&2<r?r-1-t:t},w.prototype.bX=function(t,r,n,e){var i,o,i=this,o=i.hJ[e];if(o)switch(o.iconValueType){case dr.formula:case dr.number:return i.dX(t,r,n,o.iconValue);case dr.percent:return i.gX(t,r,n,o.iconValue);case dr.percentile:return i.pX(t,r,n,o.iconValue);default:return C}},w.prototype.evaluate=function(t,r,n,e){var i,o,a,u,o,e,f,s,l,c,h,s,a,e,i=this,o=e;if(T(o))return C;if(a={},u=at(e,!0)&&"boolean"!=typeof o&&ft(e,a)?a.value:NaN,isNaN(u))return C;if(o=0,e=i.iconSetType(),f=i.hJ,e>=vr.fiveArrowsColored?o=5:e>=vr.fourArrowsColored?o=4:e>=vr.threeArrowsColored&&(o=3),!f)return 0;for(l=0,c=o-1;0<c;c--)if(c<J(f)+1&&(s=f[c-1],!T(s&&s.iconValue))&&(h=i.bX(t,r,n,c-1),!T(h))&&(s=s.isGreaterThanOrEqualTo?h<=u:h<u,u<Number.MAX_VALUE)&&s){l=c;break}return a=i.NX(l),(e=i.iJ)?{iconSetType:e[a]?e[a].iconSetType:vr.noIcons,iconIndex:e[a]?e[a].iconIndex:0,showIconOnly:i.showIconOnly()}:{iconSetType:vr.noIcons,iconIndex:0,showIconOnly:i.showIconOnly()}},w.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,C),t.hJ=C,t.stopIfTrue(!1),t.priority(1),t.minColor(C),t.minValue(C),t.minType(5),t.midColor(C),t.midValue(C),t.midType(C),t.maxColor(C),t.maxValue(C),t.maxType(7),t.iJ=C},w.prototype.icons=function(t){return 1===arguments.length&&(this.iJ=t),this.iJ},w.prototype.iconCriteria=function(){return this.hJ},w.prototype.toJSON=function(t){return Kt.call(this,t,Fr)},w.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Fr,t,n),this.initCondition(r)},w.prototype.aX=function(){var t,r,n,e,t,r=this.hJ;if(r&&0<r.length)for(n=0;n<r.length;n++)if(e=r[n].iconValue,At(e))return!0},w.prototype.oX=function(){var t,r,n,e,i,o,a,u,t=this,r={n_:P,sqref:It(t.ranges())};for(r.pivot=T(t.pivotTableName)?k:"1",n=t.iconSetType(),T(n)&&(n=0),r.c_=[{n_:"cfRule",type:"iconSet",priority:t.priority()?""+t.priority():"1",c_:[{n_:"iconSet",iconSet:Vn(n),reverse:t.reverseIconOrder()?"1":k,showValue:t.showIconOnly()?"0":k,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],e=r.c_[0].c_[0].c_,o=0,a=(i=t.hJ).length;o<a;o++)u=i[o],e.push({n_:"cfvo",type:Dn(u.iconValueType),val:pt(bt(u.iconValue)),gte:!1===u.isGreaterThanOrEqualTo?"0":k});return t.rJ&&r.c_[0].c_.push({n_:j,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),r},w.prototype.IJ=function(){var t,r,n,e,n,i,n,o,a,u,f,s,l,c,h,v,d,h,h,t=this,r={n_:"conditionalFormatting",r_:[2]};for(r.pivot=T(t.pivotTableName)?k:"1",e={n_:"cfRule",type:"iconSet",id:n=Ut()},t.rJ=n,T(t.priority())||(e.priority=t.priority()),i={n_:"iconSet",iconSet:Vn(n=t.iconSetType())},(n=mn(n,t))&&(i.custom="1"),t.showIconOnly()&&(i.showValue="0"),!t.reverseIconOrder()||n||(i.reverse="1"),o=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:["0"]}]}],a=t.hJ,n&&t.reverseIconOrder()&&(a=a.concat([]).reverse()),u=0;u<a.length;u++)!(s={n_:"cfvo",type:Dn((f=a[u]).iconValueType),c_:[{n_:"f",c_:[pt(Ct(f.iconValue))]}]})===f.isGreaterThanOrEqualTo&&(s.gte="0"),o.push(s);for(l=t.iJ,c=0;c<l.length;c++)h={n_:"cfIcon",iconSet:Vn((h=$n(v=(h=l[c]).iconSetType,d=h.iconIndex)).iconSetType),iconId:h.iconIndex},o.push(h);return i.c_=o,e.c_=[i],r.c_=[e,{n_:"sqref",c_:[It(t.ranges())]}],r},w.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),r?o.IJ():o.oX()},w.prototype.uX=function(t,r){var n,e,i,o,a,u,f,s,n=this,e=t.c_[0];if(e)for(i=Bn(e.iconSet||"3TrafficLights1"),n.showIconOnly(!d(e.showValue,!0)),n.reverseIconOrder(d(e.reverse,!1)),n.iconSetType(i),n.ranges(r),a=1,u=(o=In(t)).length;a<u;a++)f=n.hJ[a-1],s=o[a],f?(s.type&&(f.iconValueType=Fn(s.type)),T(s.val)||(f.iconValue=Kr(s.val)),T(s.gte)||(f.isGreaterThanOrEqualTo=d(s.gte))):(f=new Dr(d(s.gte),Fn(s.type),Kr(s.val)),n.hJ[a-1]=f);t.c_[1]&&t.c_[1].n_===j&&(n.rJ=vn(t.c_[1]))},w.prototype.sX=function(t,r){var n,e,i,o,a,u,f,s,l,c,h,v,n=this,e=mt(t,"iconSet");for(n.iconSetType(Bn(e.iconSet)),n.ranges(r),T(e.showValue)||n.showIconOnly(!d(e.showValue,!0)),T(e.reverse)||n.reverseIconOrder(d(e.reverse,!1)),o=1,a=(i=gt(e,"cfvo")).length;o<a;o++)u=n.hJ[o-1],s=(f=i[o]).val,T(s)&&(l=mt(f,"f"),s=U(l&&l.c_&&l.c_[0])),u?(f.type&&(u.iconValueType=Fn(f.type)),T(s)||(u.iconValue=0===s?"=0":Kr(s)),T(f.gte)||(u.isGreaterThanOrEqualTo=d(f.gte))):(u=new Dr(d(f.gte),Fn(f.type),Kr(s)),n.hJ[o-1]=u);for(o=0,a=(c=gt(e,"cfIcon")).length;o<a;o++)h=n.iJ[o],v=c[o],h&&(T(v.iconSet)||(h.iconSetType=Bn(v.iconSet)),T(v.iconId)||(h.iconIndex=+v.iconId));T(t.priority)||n.priority(+t.priority)},w.prototype.yh=function(t,r,n,e,i,o){var a=this;i?a.sX(t,r):a.uX(t,r),a.initCondition(e)},w.getIcon=function(t,r){return C},w.kX=function(t,r,n,e,i,o,a){var u;a.getState(r)?(u=a.getImage(r),t.drawImage(u,n,e,i,o)):a.addImage(r)},w.paintIconSet=function(t,r,n,e,i,o,a,u,f,s){var l,a,c,h,v,d,u,c,h=m.W.Lge(a,1).fontSize,v=2,d=2,l=n+2;if(r.showIconOnly&&(1===a.hAlign?l=n+i/2-h/2:2===a.hAlign&&(l=n+i-2-h-2)),a=1===a.vAlign?e+o/2-h/2:2===a.vAlign?e+o-2-u/2-h/2:e+2+u/2-h/2,r.iconSetType!==vr.noIcons)if((u=w.getIcon(r.iconSetType,r.iconIndex))&&"string"===p.getType(u)&&s)try{w.kX(t,u,l,a,h,h,s)}catch(t){}else on(t,r,l,a,h,n,e,i,o)},Gr=w,b.IconSetRule=Gr,e={iconSetType:r("iconSetType",vr.threeArrowsColored,function(t){this.xX(t)}),reverseIconOrder:r("reverseIconOrder",!1),showIconOnly:r("showIconOnly",!1)},p.extend(Gr.prototype,e),Lr=["ruleType","state","style","priority","stopIfTrue","ranges"],M(A,Yr=n),A.prototype.JJ=function(t,r){var n,e,i,o,n=this.ranges();if(n)for(e=J(n),i=void 0,o=0;o<e;o++)if((i=n[o]).contains(t,r))return o;return-1},A.prototype.zT=function(t){return-1<t},A.prototype.getExpected=function(t){void 0===t&&(t=0);var r=this.style();return $t(r)?r[t]:r},A.prototype.isRow=function(){var t,r,t=this,r=t.ruleType();return T(t.DX)&&(r===_.rowStateRule?t.DX=!0:r===_.columnStateRule&&(t.DX=!1)),this.DX},A.prototype.isStateRule=function(){return!0},A.prototype._X=function(){var t,r,t,t=this,r=t.state(),t=t.ranges();return(0,b.aJ)(y.stateCondition,yr.contains,r,k,k,k,t)},A.prototype.rowStateRuleCreateCondition=function(){return this._X()},A.prototype.columnStateRuleCreateCondition=function(){return this._X()},A.prototype.createCondition=function(){return this[_[this.ruleType()]+"CreateCondition"]()},A.prototype.EX=function(t){var r;return A.StatesPriority.indexOf(this.state())<A.StatesPriority.indexOf(t.state())},A.prototype.fromJSON=function(t,r,n){var e=Lr;T(t.condition)||(e=Lr.concat(["condition"])),Zt.call(this,r,e,t,n),this.initCondition(r)},A.prototype.toJSON=function(t){var r,t,n,r=this;return T(r.condition())&&this.initCondition(),t=Kt.call(r,t,Lr),(n=r.ruleType())===_.conditionRuleBase&&(t.condition=r.condition().toJSON()),t},A.StatesPriority=[4,m.RowColumnStates.invalid,m.RowColumnStates.dirty,m.RowColumnStates.invalidFormula,m.RowColumnStates.inserted,256,m.RowColumnStates.selected,m.RowColumnStates.active,m.RowColumnStates.hover,m.RowColumnStates.edit],Wr=A,(b.StateRule=Wr).prototype.state=r("state",C),E.prototype.getUsedRange=function(){var t,r,n,e,i,o,a,u,f,s,t,r=this.getRules(),n={};if(r)for(e=void 0,i=0,o=r;i<o.length;i++)for(u=0,f=e=(a=o[i]).ranges();u<f.length;u++)s=f[u],L(n,W(s));return n},E.prototype.L0=function(){this.eJ=C},E.prototype.getRule=function(t){return this.qK[t]},E.prototype.count=function(t){var r,n,e,i,o;if(T(t))return J(this.qK);for(e=n=0,i=(r=this.qK).length;e<i;e++)Xr((o=r[e]).nT)===t&&n++;return n},E.prototype.qve=function(t){var r,n,e,i;if(T(t))return 0<J(this.qK);for(n=0,e=(r=this.qK).length;n<e;n++)if(Xr((i=r[n]).nT)===t)return!0;return!1},E.prototype.jX=function(){return this.qK},E.prototype.GJ=function(t){for(var r,n,e,i,o,r=[],n=this.eJ,e=J(t),i=0;i<e;i++)o=n.JS(t[i]),r.push(o);return r},E.prototype.OX=function(t){for(var r,n,e,i,o,a,r=[],n=this.eJ,e=0,i=J(t);e<i;e++)o=t[e],a=new qt(o.row,o.col,Q(o),H(o)),0===o.row&&Q(o)===n.getRowCount()&&(a.row=-1),0===o.col&&H(o)===n.getColumnCount()&&(a.col=-1),r.push(a);return r},E.prototype.Ige=function(t,r,n){var e,n,n,e=this;-1!==n&&(n=e.xge[n])&&bn(t,n),-1!==r&&(n=e.Nge[r])&&bn(t,n),0<e.kge.length&&bn(t,e.kge)},E.prototype._ge=function(t,r,n,e,i){var o,a,u,f,s,l,c,h,v,d,o=this,a=o.xge,u=o.Nge,f=function(t){var r=t.indexOf(i);-1<r&&t.splice(r,1)};if(-1===t&&-1!==r&&0<e)for(l=(s=r)+e;s<l;s++)(c=a[s])&&(i?f(c):delete a[s]);if(-1!==t&&-1===r&&0<n)for(l=(h=t)+n;h<l;h++)(v=u[h])&&(i?f(v):delete u[h]);if(-1===t&&-1===r)if(i){for(d in f(o.kge),a)a.hasOwnProperty(d)&&f(a[d]);for(d in u)u.hasOwnProperty(d)&&f(u[d])}else o.kge=[],o.xge={},o.Nge={}},E.prototype.sE=function(){this.tJ={},this.kge=[],this.Nge={},this.xge={}},E.prototype.C8=function(){if(this.nJ&&(this.sE(),this.qK))for(var t=0;t<J(this.qK);t++)this.fE(this.qK[t])},E.prototype.TJ=function(){this.nJ&&(this.tJ={})},E.prototype.fE=function(t){var r,n,e,i,o,a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,m,k,T,x,_;if(this.nJ){for(n=(r=this).tJ,u=t.ranges(),f=[],s=0;s<J(u);s++)if(c=-1===(l=u[s]).col,(h=-1===l.row)&&c)r.kge.push(t);else if(h){if(0<l.colCount)for(d=(v=l.col)+l.colCount;v<d;v++)(y=r.xge[v])||(r.xge[v]=y=[]),y.push(t)}else if(c){if(0<l.rowCount)for(d=(C=l.row)+l.rowCount;C<d;C++)(b=r.Nge[C])||(r.Nge[C]=b=[]),b.push(t)}else f.push(l);for(f=r.GJ(f),g=(p=r.eJ).getRowCount(),S=p.getColumnCount(),s=0;s<J(f);s++)for(w=(l=f[s]).row,m=l.col,g<=w+(k=Q(l))-1&&(k=g-w),S<=m+(T=H(l))-1&&(T=S-m),x=0;x<k;x++)for((e=n[o=x+w])||(n[o]=e=[]),_=0;_<T;_++)(i=e[a=_+m])||(e[a]=i=[]),i.push(t)}},E.prototype.RX=function(t){var r,n,e,i,o,a,u,f,s,l,c,h,v,d,y,C;if(this.nJ){for(r=t.ranges(),n=0,e=J(r);n<e;n++)i=r[n],this._ge(i.row,i.col,i.rowCount,i.colCount,t);for(o=this.tJ,l=this.GJ(t.ranges()),c=0;c<J(l);c++)for(h=l[c],v=0;v<Q(h);v++)if(a=o[f=v+h.row])for(d=0;d<H(h);d++)if(u=a[s=d+h.col]){for(y=[],C=0;C<J(u);C++)u[C]!==t&&y.push(u[C]);0===J(y)&&(y=k),a[s]=y}}},E.prototype.BX=function(t,r,n,e){var i,o,a,u,f,s;if(this.nJ)for(this._ge(t,r,n,e),-1===r&&(r=0,e=this.eJ.getColumnCount()),-1===t&&(t=0,n=this.eJ.getRowCount()),a=this.tJ,f=0;f<n;f++)if(u=a[i=f+t])for(s=0;s<e;s++)u[o=s+r]=k},E.prototype.LX=function(r,n){var t,e,i,o,t=this.qK;return-1===r&&-1===n?B([],t,!0):(e=this.eJ,-(o=i=1)===r?i=e.getRowCount():-1===n&&(o=e.getColumnCount()),t.filter(function(t){return t.intersects(r,n,i,o)}))},E.prototype.addSpecificTextRule=function(t,r,n,e){var e=new R(2,e,n,t,C,C,r);return this.addRule(e)},E.prototype.addCellValueRule=function(t,r,n,e,i){var i=new R(1,i,e,t,yn(r),yn(n));return this.addRule(i)},E.prototype.addDateOccurringRule=function(t,r,n){var n=new R(4,n,r,C,C,C,C,C,t);return this.addRule(n)},E.prototype.addFormulaRule=function(t,r,n){var n=new R(3,n,r,C,C,C,C,t);return this.addRule(n)},E.prototype.addTop10Rule=function(t,r,n,e){var e=new R(5,e,n,C,C,C,C,C,t,r);return this.addRule(e)},E.prototype.addUniqueRule=function(t,r){var r=new R(6,r,t);return this.addRule(r)},E.prototype.addDuplicateRule=function(t,r){var r=new R(7,r,t);return this.addRule(r)},E.prototype.addAverageRule=function(t,r,n){var n=new R(8,n,r,C,C,C,C,C,t);return this.addRule(n)},E.prototype.add3ScaleRule=function(t,r,n,e,i,o,a,u,f,s){var t,t=0===arguments.length?new Br(11):new Br(11,t,r,n,e,i,o,a,u,f,s);return this.addRule(t)},E.prototype.add2ScaleRule=function(t,r,n,e,i,o,a){var t,t=0===arguments.length?new Br(10):new Br(10,t,r,n,C,C,C,e,i,o,a);return this.addRule(t)},E.prototype.addDataBarRule=function(t,r,n,e,i,o){var t,t=0===arguments.length?new qr:new qr(t,r,n,e,i,o);return this.addRule(t)},E.prototype.addIconSetRule=function(t,r){var t=new Gr(t,r);return this.addRule(t)},E.prototype.addRowStateRule=function(t,r,n){var e,t,e=this,t=new Wr(_.rowStateRule,t,r,n);return e.addRule(t)},E.prototype.addColumnStateRule=function(t,r,n){var e,t,e=this,t=new Wr(_.columnStateRule,t,r,n);return e.addRule(t)},E.prototype.addRule=function(t){var r,n,e,i,o,a,a,a,i,o,u,f,s,l,c,h,r=this,n=r.eJ;if(n){if(!t)throw new Error(Jt().Exp_RuleIsNull);for(o=i=void 0,(e=t.ranges())&&(i=(a=Et(e)).r,o=a.c,t.ranges(e.slice(0))),(a=(a=t.getExpected())&&a.formatter)&&"string"==typeof a&&n.SL(i||0,o||0,a),t.isStateRule()&&(i=t.state(),o=t.isRow(),n._1)&&n._1.enableState(i,o),n.Ut.vJ(),u=1,f=void 0,s=J(r.qK),f=0;f<s;f++)h=(c=(l=r.qK[f])._ps).priority||1,c.priority=h+1,t.isStateRule()&&l.isStateRule()&&t.EX(l)&&(u=rt(u,c.priority),--c.priority);return t.priority(u),r.qK.push(t),E.et(n,"onRuleAdded",{ranges:e}),t.context(n),r.fE(t),n.Ut.vJ(!0),n.zw(),t}},E.prototype.removeRule=function(t){var r,n,e,i,i,o,e,a,u,f,s,r=this,n=r.eJ,e=n.parent;if(n){if(t&&((i=(i=t.getExpected())&&i.formatter)&&"string"==typeof i&&e.bp[i]&&e.o3(i),n.Ut.vJ(),r.RX(t),Gt(r.qK,t),n.Ut.vJ(!0),E.et(n,"onRuleRemoved",{priority:t.priority(),ranges:t.ranges()}),t.isStateRule())){for(o=t.state(),e=t.isRow(),a=!1,u=0,f=r.qK;u<f.length;u++)if((s=f[u]).isStateRule()&&s.state()===o){a=!0;break}a||n._1.disableState(o,e)}n.zw()}},E.prototype.FX=function(t,r,n,e,i){var o,a,u,f,r,e,n,i,s,l,l,l,r;return t.intersect(r,n,e,i)?(o=t.row,a=t.row+Q(t)-1,u=t.col,f=t.col+H(t)-1,e=(r=r)+e-1,i=(n=n)+i-1,s=[],-1!==o&&-1!==u&&-1!==r&&-1!==n&&(0<n-u&&(l=$(o,u,Q(t),n-u),s.push(l)),0<f-i&&(l=$(o,1+i,Q(t),f-i),s.push(l)),0<r-o&&(l=$(o,rt(n,u),r-o,tt(i,f)-rt(n,u)+1),s.push(l)),0<a-e)&&(r=$(1+e,rt(n,u),a-e,tt(i,f)-rt(n,u)+1),s.push(r)),0<J(s)?s:C):[t]},E.prototype.removeRuleByRange=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,v,d,y,C,b,i=this,o=i.eJ;if(o){if(a=[],i.qK)for(o.Ut.vJ(),i.BX(t,r,n,e),u=0,f=J(i.qK);u<f;u++)if(s=i.qK[u],E.et(o,"onRuleRemoved",{ranges:[new qt(t,r,n,e)]}),s&&s.ranges()&&s.intersects(t,r,n,e))if(o.pivotTables&&s.pivotTableName)(l=o.pivotTables.get(s.pivotTableName)).tqt(s,t,r,n,e);else{for(c=[],h=i.GJ(s.ranges()),v=0,d=J(h);v<d;v++)(y=i.FX(h[v],t,r,n,e))&&(c=c.concat(y));0<J(c)?s.ranges(i.OX(c)):a.push(s)}for(C=0,b=J(a);C<b;C++)Gt(i.qK,a[C]);o.Ut.vJ(!0),o.zw()}},E.prototype.clearRule=function(){var t,r,n,e,i,o,a,a,u,f,t=this,r=t.eJ,n=r.parent;if(r){for(e=t.qK,r.Ut.vJ(),i=0;i<e.length;i++)a=(a=(o=e[i]).getExpected())&&a.formatter,E.et(r,"onRuleRemoved",{ranges:o.ranges()}),a&&"string"==typeof a&&n.bp[a]&&n.o3(a);if(r.pivotTables)for(u=r.pivotTables.all(),i=0;i<u.length;i++)(f=u[i]).iqt();t.qK.length=0,t.C8(),r.Ut.vJ(!0),r.zw()}},E.prototype.getRules=function(t,n){var r,e,i,e,o,a,r=this,e=r.qK;return 0===arguments.length||0===J(e)?e:(t=t===k?-1:t,n=n===k?-1:n,i=[],r.nJ?(e=r.tJ,a=void 0,-1!==t&&-1!==n?(a=e[t])&&(o=a[n],bn(i,o)):-1===t?p.each(e,function(t,r){o=r[n],bn(i,o)}):(a=e[t])&&p.each(a,function(t,r){bn(i,r)}),r.Ige(i,t,n),i):r.LX(t,n))},E.prototype.containsRule=function(t,r,n){return!(!t||!Ft.OS(this.qK,t))&&t.contains(r,n)},E.prototype.PX=function(t,r){var n,e,i,o,a,i,i,i,u,f,s,l,n=this,e=n.eJ;if(e){if(!t)throw new Error(Jt().Exp_RuleIsNull);for(a=o=void 0,(i=t.ranges())&&(o=(i=Et(i)).r,a=i.c),(i=(i=t.getExpected())&&i.formatter)&&"string"==typeof i&&e.SL(o||0,a||0,i),e.Ut.vJ(),u=0,f=J(n.qK);u<f;u++)r<=(l=(s=n.qK[u]._ps).priority||1)&&(s.priority=l+1);return t.priority(r),(n.qK[r]=t).context(e),n.fE(t),e.zw(),t}},E.prototype.qJ=function(t,r,n){var e,i,o,a,u,f,s,l,e=this,i,o=e.eJ.Ut,a=e.qK,u=J(a),f=!1;for(o.vJ(),s=0;s<u;s++)(l=a[s])&&l.qJ(t,r,n)&&(f=!0);f&&e.C8()},E.prototype.$J=function(t,r,n,e,i,o){var a,u,f,s,a=this;if(a.qK&&a.eJ)for(u=J(a.qK),f=0;f<u;f++)(s=a.qK[f])&&(n?s.JO(t,r,e,i,o):s.qO(t,r,e,i,o));a.C8()},E.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},E.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},E.prototype.tX=function(t,r,n,e,i){var o,a,u,f,o=this;if(o.qK&&o.eJ)for(u=(a=J(o.qK))-1;0<=u;u--)(f=o.qK[u])&&(n?f.xP(t,r,e,i):f.NP(t,r,e,i),f.ranges().length<=0)&&(o.RX(f),o.qK.splice(u,1));o.C8()},E.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},E.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},E.prototype.dl=function(){var t,r,n,e,t=this.qK;if(t!==C&&0<J(t))for(n=0,e=J(t);n<e;n++)(r=t[n]).dl&&r.dl()},E.prototype.jB=function(t,r,q,n,e,i,o,D,a,u){var a,f,s,l,c,F,h,v,d,G,y,C,b,p,g,S,w,m,k,T,f,x,_,T,L,N,I,R,W,A,R,A,j,E,O,P,M,B,V,M,U,V,M,V,M,s=[],l=[],c=[],F=[],h=[],v=this,d=v.eJ,G=!a&&d.o5();for(u&&(i=(a=[o,i])[0],o=a[1]),-1===t&&(n=t=0,i=d.getRowCount()),-1===r&&(e=r=0,o=d.getColumnCount()),y=0;y<i;y++)for(C=0;C<o;C++)for(b=v.getRules(t+y,r+C),p=0;p<J(b);p++)if(S=(g=b[p]).ranges(),!g.isStateRule()){for(w=[],m=0;m<J(S);m++)k=S[m],f=(T=d.JS(k)).row,x=T.col,_=Q(T),T=H(T),(L=Lt(c,k)<=-1||-1<Lt(c,k)&&Lt(F,g)<=-1)&&k.contains(t+y,r+C)&&(c.push(k),F.push(g),N=$(n+y,e+C,-1,-1),(N=u?$(n+C,e+y,-1,-1):N).rowCount=i+t<=f+_?i-y:t<f?_:f+_-t,N.colCount=o+r<=x+T?o-C:r<x?T:x+T-r,u&&(f=[N.colCount,N.rowCount],N.rowCount=f[0],N.colCount=f[1]),v===q&&k.containsRange(N)||w.push(N),D)&&jn(h,N,g);0<w.length&&((I=s.indexOf(g))<0?(G&&(w=v.GX(w)),s.push(g),l.push(w)):(G&&(W=R=void 0,A=l[I][0].row,j=l[I][0].col,R=(E=w[0]).row-A,W=E.col-j,A=d.lT(A,R,!(R=A=void 0)),R=d.lT(j,W),E.row+=A,E.col+=R,w=v.GX(w)),l[I]=l[I].concat(w)))}for(O=0,P=s.length;O<P;O++)V=(B=v.pJ((M=s[O]).toJSON(),M.context())).ranges(),Pn(h,M,B),B.ranges(l[O]),(M=B.D5)&&(U=1===d.parent.options.referenceStyle,V=Et(V),M=Y.formulaToExpression(d,M,V.r,V.c,U),V=Et(l[O]),M=Y.expressionToFormula(d,M,V.r,V.c,U),B.formula(M)),q.addRule(B);return v.C8(),h},E.prototype.GX=function(t){var r,n,t,e,i,o,a,u,f,s,l,c,h,r,n=this.eJ,e=[];if(0<t.length){for(i=(t=t[0]).row,o=t.col,a=t.rowCount,u=t.colCount,a+=n.lT(i,a,!0),u+=n.lT(o,u),f=[],s=void 0,l=0;l<u;l++)0===l?s=new qt(i,o,1,1):0!==n.getColumnWidth(o+l)?s.colCount++:(f.push(s),l=n.O5(o+l-1)-1-o,s=new qt(i,o+l+1,1,0));for(f.push(s),c=0;c<a;c++)if(0!==c)if(0!==n.getRowHeight(i+c))for(h=0;h<f.length;h++)f[h].rowCount++;else for(e=e.concat(Sn(f)),c=n.j5(i+c-1)-1-i,h=0;h<f.length;h++)f[h].rowCount=0,f[h].row=i+c+1;e=e.concat(f)}return e},E.prototype.OB=function(t,r,n,e,i,o){var a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,m,k,T,x,_,N,I,R,A,N,E,a=this,u=a.eJ,f=u.getRowCount(3),s=u.getColumnCount(3);for(-1===t&&(t=0,n=u.getRowCount()),-1===r&&(r=0,e=u.getColumnCount()),l=[],c=[],h=0,v=i;h<v.length;h++)for(y=0,C=(d=v[h]).ranges;y<C.length;y++)wn(l,b=C[y])||l.push(b),c.push({range:b,rule:d.rule});for(p=0;p<n;p++)for(g=0;g<e;g++)for(S=a.getRules(t+p,r+g),w=0;w<J(S);w++)if(k=(m=S[w]).ranges(),T=[],!m.isStateRule()){for(x=[],_=0;_<J(k);_++)b=k[_],I=(N=u.JS(b)).row,R=N.col,A=Q(N),N=H(N),Un(i,b,m)||Lt(T,b)<=-1&&b.contains(t+p,r+g)&&(T.push(b),I<t&&x.push($(I,R,t-I,N)),R<r&&x.push($(rt(t,I),R,tt(t+n,I+A)-rt(t,I),r-R)),r+e<R+N&&x.push($(rt(t,I),r+e,tt(t+n,I+A)-rt(t,I),R+N-(r+e))),t+n<I+A)&&x.push($(t+n,R,I+A-(t+n),N));u&&u.Ut.vJ(),a.UX(u,T,c,k,f,s,o,new qt(t,r,n,e),m),0<(E=k.concat(x)).length?(m.XJ(),m.ranges(E)):a.removeRule(m)}a.C8()},E.prototype.UX=function(t,r,n,e,i,o,a,u,f){for(var s,l,c,h,v,d,d,y,s=0;s<J(r);s++){if(c=[l=r[s]],a)for(h=0;h<J(n);h++)v=n[h].range,d=n[h].rule,l.intersect(v.row,v.col,v.rowCount,v.colCount)&&(c=c.concat(t.BR(l,v,i,o)),d===f)&&(d=u.getIntersect(v,i,o))&&e.push(d);for(y=0;y<J(c);y++)Gt(e,c[y])}},E.prototype._e=function(t,r,n,e,i,o,a,u){var f,s,l,c,h,v,h,v,d,c,f=16,s=!1,l=!1,c=u.sheet,h=u.row,v=u.col,d=c.zoom(),c=this.U(c,h,v,r,u.sheetArea),h=c&&c.iconSet,v=c&&c.dataBar;return(v||h)&&(t.save(),t.beginPath(),v&&(qr.paintDataBar(t,v,n,e,i,o),s=v.showBarOnly),h&&((i<(f=parseInt(16*d+"",10))||o<f)&&(t.rect(n,e,i,o),t.clip(),t.beginPath()),Gr.paintIconSet(t,h,n,e,i,o,a,u.lineHeight,d,u.imageLoader),l=h.showIconOnly),t.restore()),s||l},E.prototype.U=function(t,r,n,e,i){var i,o,a,u,f,s,l,c,h,v,d,y;if(T(i)||3===i){if(i=this,f=(o=t.Jt).yl(r,n))a=f.i,u=f.d;else{if(s=i.getRules(r,n),0<(l=J(s))){for(s.sort(function(t,r){return t.priority()-r.priority()}),h=c=C,y=d=v=void 0,y=0;y<l&&(!c||!h);y++)(v=s[y])&&(g(v,qr)&&(c=v),g(v,Gr))&&(h=v);if(c||h)for(c=h=C,y=0;y<l&&(!c||!h)&&!((v=s[y])&&(!c&&g(v,qr)&&(c=v),!h&&g(v,Gr)&&(h=v),v.stopIfTrue())&&(d=v.evaluate(t,r,n,e)));y++);c&&(u=c.evaluate(t,r,n,e)),h&&(a=h.evaluate(t,r,n,e))}o.Ml(r,n,u,a)}return{dataBar:u,iconSet:a}}},E.prototype.O=function(t,r,n){var e,i,o;if(T(n)||3===n)for(e=this.getRules(t,r),i=0,o=J(e);i<o;i++)if(e[i]instanceof Gr)return!0;return!1},E.prototype.toJSON=function(t){for(var r,n,e,r=[],n=0;n<J(this.qK);n++)e=this.qK[n],r.push(e?e.toJSON(t):C);return 0===J(r)?k:{rules:r}},E.prototype.fromJSON=function(t,r,n,e){var i,o,a,u,u;if(t&&(i=t.rules)){for(this.qK=[],o=J(i),a=0;a<o;a++)(u=i[a]).pivot&&e||(u=this.pJ(u,r,n))&&this.qK.push(u);this.nJ=!pn(i),this.C8()}},E.prototype.xJ=function(t,r,n,e,i,o){var a,u;switch(t.type){case"dataBar":u=new qr;break;case"iconSet":u=new Gr;break;case"colorScale":u=new Br;break;default:u=new R}return u&&u.yh(t,r,n,e,o,void 0,i),u},E.prototype.pJ=function(t,r,n){var e,i,o,o,t,e=C;return t&&(o=(i=this.HX())[t.ruleType])&&(e=new o).fromJSON(t,r,n),e.isStateRule()&&(o=e.state(),t=e.isRow(),r)&&r._1&&r._1.enableState(o,t),e},E.prototype.HX=function(){var t;return this.$K||((t={})[0]=R,t[1]=R,t[2]=R,t[3]=R,t[4]=R,t[5]=R,t[6]=R,t[7]=R,t[8]=R,t[9]=Br,t[10]=Br,t[11]=Br,t[12]=qr,t[13]=Gr,t[14]=Wr,t[15]=Wr,this.$K=t),this.$K},E.prototype.NJ=function(t,r,n,e,i,o,a){var u,f,s,l,c,h,v,d,y,C,b,p,g,p,S,S,w;if(t&&t.c_&&!(t.c_.length<=0))for(s=0,l=(u=t.c_).length;s<l;s++)for(c=u[s],h=m.NodeHelper.ur(c.pivot),d=void 0,(v=mt(c,"sqref"))&&(d=Nt(v.c_[0]),a)&&m.Util.Ao(n,d,!0,r),y=gt(c,"cfRule"),C=0;C<y.length;C++)g=void 0,"dataBar"===(p=(b=y[C]).type)?(g=o.get(b.id))||(g=new qr,this.qK.push(g),nn(g,o)):"iconSet"===p?(g=o.get(b.id))||(g=new Gr,this.qK.push(g),nn(g,o)):(S=qn(p)===_.specificTextRule,((p="expression"===p||"cellIs"===p)||S)&&(!f&&i.lossless&&((S=new m.SimpleSharedStrings).yh(i.lossless.sharedColors),(w=new m.SimpleSharedStrings).yh(i.lossless.commonSharedStrings),(f=new m.SharedDxfs(S,w)).rv(i.lossless.sharedDxfs)),g=p?new R(3):new R(_.specificTextRule,d,void 0),this.qK.push(g),nn(g,o))),g&&(g.pivot=h,g.yh(b,d,r.styleManager,n,!0,f),T(b.priority)||g.priority(+b.priority))},E.prototype.bL=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,v,c,h,i=this;if(i&&i.qve(e)&&(o=i.getRules(r,n),a=J(o),u=void 0,f=C,0<a))for(e=Xr(e),o.sort(function(t,r){return t.priority()-r.priority()}),s=0;s<a&&!((u=o[s])&&e===Xr(u.nT)&&(l=i.eJ,u.isScaleRule()?10!==u.ruleType()&&11!==u.ruleType()||(f=u.evaluate(l,r,n,l.getValue(r,n,e)))&&(t=t||new Mt).backColor===k&&(t.backColor=f):u.isStateRule()?(c=u.state(),h=u.isRow(),v=u.ranges(),c=l._1.getState(r,n,c,h,v,e),(f=u.evaluate(l,r,n,c))&&(t=t||new Mt,h=l.NMi&&e===m.SheetArea.colHeader,t.h5(f,!1,1,k,h))):(f=u.evaluate(l,r,n,l.getValue(r,n,e)))&&(t=t||new Mt).h5(f,!1,1),u.stopIfTrue())&&f);s++);return t},E.prototype.wL=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,h,v,d,v,y,i={yL:!1},o=this;if(o&&o.qve(e)&&(a=o.getRules(t,r),u=J(a),f=void 0,s=C,0<u))for(e=Xr(e),a.sort(function(t,r){return t.priority()-r.priority()}),l=0;l<u;l++)if((f=a[l])&&e===Xr(f.nT)){if(c=o.eJ,f.isScaleRule()){if(h=f.ruleType(),"backColor"===n&&(10===h||11===h)&&(s=f.evaluate(c,t,r,c.getValue(t,r,e)))){i.Y6=s,i.yL=!0;break}}else if(f.isStateRule()){if(h=f.state(),v=f.isRow(),d=f.ranges(),v=c._1.getState(t,r,h,v,d,e),!((y=f.style())&&void 0!==Cn(n,y,d,t,r)||f.stopIfTrue()))continue;if((s=f.evaluate(c,t,r,v))&&s[n]!==k){i.Y6=s[n],i.yL=!0;break}}else{if(!((y=f.style())&&void 0!==y[n]||f.stopIfTrue()))continue;if((s=f.evaluate(c,t,r,c.getValue(t,r,e)))&&s[n]!==k){i.Y6=s[n],i.yL=!0;break}}if(f.stopIfTrue()&&s)break}return i},jr=E,t(b.ConditionalFormats=jr)},"./dist/plugins/conditional/conditional.ns.js":function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.SR=void 0;var n=n("./dist/plugins/conditional/conditional.res.en.js");r.SR={en:n}},"./dist/plugins/conditional/conditional.res.en.js":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Exp_NotSupported=r.Exp_RuleIsNull=void 0,r.Exp_RuleIsNull="The argument 'rule' is null",r.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(q,t){var f,s,l,c,r,n,e,i,o,a,u,h,v,d,d,y,C,b;function p(t,r,n,e,i){t.beginPath(),t.moveTo(r,n),t.lineTo(r+e,n),t.lineTo(r+e,n+i),t.lineTo(r,n+i),t.lineTo(r,n),t.closePath(),t.fill(),t.stroke()}function g(t,r,n,e,i,o){var e,i;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,e=b[r][n].fillColor.split(" "),i=s(.2*o),t.fillStyle=e[0],p(t,i+.5,3*i+.5,i,2*i),t.fillStyle=e[1],p(t,2*i+.5,2*i+.5,i,3*i),t.fillStyle=e[2],p(t,3*i+.5,i+.5,i,4*i),t.fillStyle=e[3],p(t,4*i+.5,.5,i,5*i)}function S(t,r,n,e,i,o){var e,i;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,e=b[r][n].fillColor.split(" "),t.fillStyle=b[r][n].strokeStyle,i=s(o/2),t.fillStyle=e[0],p(t,.5,.5,i,i),t.fillStyle=e[1],p(t,i+.5,.5,i,i),t.fillStyle=e[2],p(t,.5,i+.5,i,i),t.fillStyle=e[3],p(t,i+.5,i+.5,i,i)}function w(t,r,n,e,i,o){t.translate(e+o/2,i+o/2),t.strokeStyle=b[r][n].strokeStyle,4===n?(t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.closePath(),t.stroke()):0===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.stroke(),t.closePath()):1===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,0),t.lineTo(0,0),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke()):2===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,.5*f),t.moveTo(0,0),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke()):3===n&&(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,f),t.lineTo(0,0),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke(),t.closePath())}function m(t,r,n){t.moveTo(l(.1*f)*r,-c(.1*f)*r),t.lineTo(l(.3*f)*n,-c(.3*f)*n),t.lineTo(0*r,-c(.5*f)*r),t.lineTo(l(.7*f)*n,-c(.7*f)*n),t.lineTo(l(.9*f)*r,-c(.9*f)*r),t.lineTo(l(1.1*f)*n,-c(1.1*f)*n),t.lineTo(l(1.3*f)*r,-c(1.3*f)*r),t.lineTo(0*n,-c(1.5*f)*n),t.lineTo(l(1.7*f)*r,-c(1.7*f)*r),t.lineTo(l(1.9*f)*n,-c(1.9*f)*n),t.lineTo(l(.1*f)*r,-c(.1*f)*r)}function k(t,r,n,e,i,o){var a,o,u,a,o=o/1.8,u=o/2.5;t.translate(o+e,o+i),t.strokeStyle="#727272",t.fillStyle=b[r][n].fillColor,t.beginPath(),2===n&&(t.strokeStyle="#727272",m(t,o,u),t.fill(),t.stroke(),t.strokeStyle=b[r][n].strokeStyle,m(t,o,u),t.stroke(),t.closePath()),0===n&&(t.fillStyle="white",m(t,o,u),t.fill(),t.stroke(),t.strokeStyle="#727272",m(t,o,u),t.stroke(),t.closePath()),1===n&&(t.strokeStyle=b[r][n].fillColor,t.moveTo(0*o,-c(.5*f)*o),t.lineTo(l(.7*f)*u,-c(.7*f)*u),t.lineTo(l(.9*f)*o,-c(.9*f)*o),t.lineTo(l(1.1*f)*u,-c(1.1*f)*u),t.lineTo(l(1.3*f)*o,-c(1.3*f)*o),t.lineTo(0*u,-c(1.5*f)*u),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*o,-c(.5*f)*o),t.lineTo(-l(.7*f)*u,-c(.7*f)*u),t.lineTo(-l(.9*f)*o,-c(.9*f)*o),t.lineTo(-l(1.1*f)*u,-c(1.1*f)*u),t.lineTo(-l(1.3*f)*o,-c(1.3*f)*o),t.lineTo(0*u,-c(1.5*f)*u),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",m(t,o,u),t.stroke(),t.closePath())}function T(t,r,n,e,i,o){2===n?N(t,r,n,e,i,o):0===n?x(t,r,n,e,i,o):1===n&&_(t,r,n,e,i,o)}function x(t,r,n,e,i,o){var o,a,o=o,a=s(o/2);t.translate(e+a,i+a),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.arc(0,0,a,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a,0,2*f),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.375*-o,.1*-o,.75*o,.2*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.1*-o,.375*-o,.2*o,.75*o),t.closePath(),t.fill(),t.stroke()}function _(t,r,n,e,i,o){var o=o;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*f),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(o/3,.1*o),t.lineTo(o/1.5,.1*o),t.lineTo(.625*o,.6*o),t.lineTo(.375*o,.6*o),t.lineTo(o/3,.1*o),t.moveTo(.625*o,.85*o),t.arc(.5*o,.8*o,.15*o,0,2*f),t.fillStyle=b[r][n].fillColor2,t.fill(),t.closePath()}function N(t,r,n,e,i,o){var o=o;t.translate(s(e+o/2),s(o/2+i)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,2*f),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.325*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.325*-o,.05*o,.65*o,.2*o),t.closePath(),t.fill(),t.stroke()}function I(t,r,n,e,i,o){2===n?E(t,r,n,e,i,o):0===n?A(t,r,n,e,i,o):1===n&&R(t,r,n,e,i,o)}function R(t,r,n,e,i,o){var o=o;t.translate(e,i),t.beginPath(),t.strokeStyle=b[r][n].strokeStyle,t.moveTo(o/3,.5),t.lineTo(o/1.5,.5),t.lineTo(.625*o,.65*o),t.lineTo(.375*o,.65*o),t.lineTo(o/3,.5),t.moveTo(.65*o,.85*o),t.arc(.5*o,.85*o,.15*o,0,2*f),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function A(t,r,n,e,i,o){var o,e,i,o=o;t.translate(s(e+o/2),s(i+o/2)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),V(t,-(e=.5*o),-(i=.075*o)),B(t,-e,i),B(t,-i,i),B(t,-i,e),B(t,i,e),B(t,i,i),B(t,e,i),B(t,e,-i),B(t,i,-i),B(t,i,-e),B(t,-i,-e),B(t,-i,-i),B(t,-e,-i),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function E(t,r,n,e,i,o){var o=o;t.translate(s(e+o/2),s(i+o/2)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.fillStyle=b[r][n].fillColor,t.fillRect(.375*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor,t.fillRect(.375*-o,.05*o,.75*o,.2*o),t.closePath(),t.fill(),t.stroke()}function O(t,r,n,e,i,o){var o=1.2*o;t.translate(e,i),t.strokeStyle=v,t.fillStyle=v,p(t,s(.2*o)+.5,.5,s(.06*o),s(.8*o)),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),V(t,.4*o,.5),B(t,.4*o,.5*o),B(t,.9*o,.25*o),B(t,.4*o,.5),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function D(t,r,n,e,i,o){(2===n?M:1===n?W:L)(t,r,n,e,i,o)}function F(t,r,n,e,i,o){var o=s(o);t.strokeStyle=b[r][n].strokeStyle,t.fillStyle=b[r][n].fillColor,p(t,e+.5,i+.5,o,o),t.beginPath(),t.arc(o/2+e+.5,o/2+i+.5,.375*o,0,2*f),t.fillStyle=b[r][n].fillColor2,t.fill(),t.stroke()}function M(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.arc(o/2+e,o/2+i,o/2,0,2*f),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function G(t,r,n,e,i,o){1===n?j(t,r,n,e,i,o):0===n?P(t,r,n,e,i,o):2===n&&U(t,r,n,e,i,o)}function L(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.translate(e+s(o/2),i+s(o/2)),t.beginPath(),V(t,0,-o/2),B(t,o/2,0),B(t,0,o/2),B(t,-o/2,0),B(t,0,-o/2),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function W(t,r,n,e,i,o){var o=s(o);t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),V(t,0,o),B(t,o/2,o-o/2*Math.sqrt(3)),B(t,o,o),B(t,0,o),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function j(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),t.rotate(b[r][n].rotate),V(t,-o/2,-o/5.4),B(t,o/2,-o/5.4),B(t,o/2,o/5.4),B(t,-o/2,o/5.4),B(t,-o/2,-o/5.4),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function P(t,r,n,e,i,o){t.strokeStyle=b[r][n].strokeStyle;var o=o;t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),V(t,-o/2,-o/3),B(t,o/2,-o/3),B(t,0,o/3),B(t,-o/2,-o/3),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function U(t,r,n,e,i,o){t.strokeStyle=b[r][n].strokeStyle;var o=o;t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),V(t,-o/2,o/3),B(t,o/2,o/3),B(t,0,-o/3),B(t,-o/2,o/3),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function $(t,r,n,e,i,o){var o,a,e,i,u,o,o=o/3.5,a=b[r].length-1;t.strokeStyle=b[r][a-n].strokeStyle,t.translate(s(1.75*o+e),s(1.75*o+i)),t.rotate(b[r][a-n].rotate),t.beginPath(),e=.25*o,i=1.25*o,V(t,-(u=.75*o),-(o=1.75*o)),B(t,e,-o),B(t,e,e),B(t,i,-u),B(t,i,e),B(t,-e,o),B(t,-o,e),B(t,-o,-u),B(t,-u,e),B(t,-u,-o),t.fillStyle=b[r][a-n].fillColor,t.fill(),t.stroke()}function B(t,r,n){t.lineTo(s(r)+.5,s(n)+.5)}function V(t,r,n){t.moveTo(s(r)+.5,s(n)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=t.drawIconTypeIsTwo=t.drawCircle=t.drawTrafficLight=t.drawIconTypeIsSen=t.drawFlag=t.drawIconTypeIsNine=t.drawIconTypeIsEight=t.drawStar=t.drawSector=t.drawMagicCube=t.drawSignal=void 0,f=Math.PI,s=Math.round,l=Math.cos,c=Math.sin,b=[[{strokeStyle:n="#326f5b",fillColor:e="#76a797",fillColor2:"",rotate:f},{strokeStyle:i="#A4802b",fillColor:o="#EAC282",fillColor2:"",rotate:-.5*f},{strokeStyle:a="#9E381C",fillColor:u="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:h="#646262",fillColor:v="#808080",fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.5*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f}],[{strokeStyle:i,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:d="#303030",fillColor:y="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:d,fillColor:y,fillColor2:"#eac282",rotate:0},{strokeStyle:d,fillColor:y,fillColor2:e,rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"white",rotate:.25*f},{strokeStyle:i,fillColor:o,fillColor2:"white",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"white",rotate:-.25*f}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:.25*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:-.25*f}],[{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.75*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.25*f},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:v,fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.75*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.25*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:d="#353535",fillColor:y,fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:C="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:y,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.75*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.5*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.25*f},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:v,fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.75*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.5*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.25*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r,fillColor2:"",rotate:0}],[{strokeStyle:y,fillColor:y,fillColor2:"",rotate:2*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:.5*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:.5*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:+f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:2*f}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r,fillColor2:"",rotate:0}]],t.drawSignal=g,t.drawMagicCube=S,t.drawSector=w,t.drawStar=k,t.drawIconTypeIsEight=T,t.drawIconTypeIsNine=I,t.drawFlag=O,t.drawIconTypeIsSen=D,t.drawTrafficLight=F,t.drawCircle=M,t.drawIconTypeIsTwo=G,t.drawArrows=$},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},e={},t=i("./dist/plugins/conditional/conditional.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ConditionalFormatting=t}();
/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){var n,e,t;function s(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,s)),i.exports}n={"./dist/plugins/celltype/actionUtils.js":function(t,i){"use strict";function n(t,i){t&&t.suspendCalcService(i)}function e(t,i){t&&t.resumeCalcService(i)}function s(t,i){var n,t,n=t._f(i);return n||(t=t.Ofe(i))&&(n=t.Mf),n}function o(t,i){if(t.sheets){var i=s(t,i.sheetName);if(i)return i}return t}function c(t,i,n,e){var t,i,t=o(t,n),i=new i(t,n,e);return e?i.undo(t):i.execute(t)}function r(t,i){t.suspendPaint(),i||t.suspendEvent()}function u(t,i){i||t.resumeEvent(),t.resumePaint()}Object.defineProperty(i,"__esModule",{value:!0}),i.afterAction=i.beforeAction=i.executeCommand=i.getWorksheet=i.resumeCalcService=i.suspendCalcService=void 0,i.suspendCalcService=n,i.resumeCalcService=e,i.getWorksheet=o,i.executeCommand=c,i.beforeAction=r,i.afterAction=u},"./dist/plugins/celltype/addrowcolumnbuttoncelltype.js":function(t,i,n){"use strict";var e,s,n,o,s,c,r,u,a,l,M,g,h;function I(t){return o(t)||"string"==typeof t&&""===t.trim()}function N(t){var i,t=t.sheet.Dg();return t&&(t.style.cursor="pointer"),!0}function f(t){var t=t.sheet;return t.isEditing()&&t.endEdit(),!0}function D(t,i){var n,i,e,i,s,e,n=t.sheet;return!o(n)&&(e=(i=i(n)).cmd,i=i.selection,!I(e))&&(s=n.rt,n.Qy().execute({cmd:e,sheetName:n.name(),selections:[i],hitInfo:{x:t.x,y:t.y,row:t.row,col:t.col,cellRect:t.cellRect,sheetArea:t.sheetArea,cellStyle:t.cellStyle}}),(e=n.hitTest((s.fk||t).x,(s.fk||t).y))&&(s.cw(e),s.fw(e)),!0)}function d(){var t=null!==g&&g.apply(this,arguments)||this;return t.typeName="96",t.qu="add-column-button",t}function v(){var t=null!==h&&h.apply(this,arguments)||this;return t.typeName="97",t.qu="add-row-button",t}e=this&&this.__extends||(M=function(t,i){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}M(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.AddRowButton=i.AddColumnButton=void 0,s=n("Common"),n=n("Core"),o=s.Common.lt.ht,s=n.CellTypes.ti,c=n.CellTypes.ColumnHeader,r=n.CellTypes.RowHeader,e(d,g=c),d.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:1}}},d.prototype.processMouseMove=N,d.prototype.processMouseDown=f,d.prototype.processMouseUp=function(t){return D(t,function(t){return{cmd:t.u9e(),selection:{row:-1,rowCount:t.getRowCount(),col:t.getColumnCount(),colCount:1}}})},u=d,i.AddColumnButton=u,s[96]=u,e(v,h=r),v.prototype.getHitInfo=function(t,i,n,e,s){return{x:t,y:i,row:s.row,col:s.col,sheet:s.sheet,cellRect:e,sheetArea:s.sheetArea,isReservedLocation:!0,cellStyle:n,addRowColumnButtonHitInfo:{addRowColumnButtonType:2}}},v.prototype.processMouseMove=N,v.prototype.processMouseDown=f,v.prototype.processMouseUp=function(t){return D(t,function(t){return{cmd:t.a9e(),selection:{row:t.getRowCount(),rowCount:1,col:-1,colCount:t.getColumnCount()}}})},a=v,i.AddRowButton=a,s[97]=a,n.Worksheet.ch(l="addRowColumnButton",{init:function(){var t=this;t.c9e=new u,t.f9e=new a}})},"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){"use strict";var e,s,D,r,u,l,o,a,d,n,s,c,M,g,h,I,v,w,N,f,j,A,T;function b(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,h,g,e),s=t.getValueForKey(i,n,I,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,I,g,e))}function y(){var t,n,t=T.call(this)||this;return t.typeName="6",n=t,c(f,function(t,i){n["_"+t]=i}),t}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,s=n("Common"),D=n("Core"),r=n("./dist/plugins/celltype/cellbuttons.js"),u=D.Events.SelectionChanged,l=s.Common.lt.ht,o=D.mt.vi,a=D.CellTypes.Context,d=D.CellTypes.Text,n=D.CellTypes.Base,s=D.GC$,c=s.each,g=void 0,h="_isFirstMouseUp",I="_mouseupToken",v="#707070",w="#34B4E3",N=".buttonCellType",f={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:M=null,buttonClickColor:M,buttonState:0},e(y,T=n),y.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,a,l,a,f;t&&(a=(u=this)._marginLeft,l=u._marginTop,M=n+a,g=e+l,h=s-a-u._marginRight,I=o-l-u._marginBottom,0<h-2)&&0<I-2&&(N=n<M+h&&M<n+s&&e<g+I&&g<e+o)&&(t.save(),(M<n||n+s<M+h||g<e||e+o<g+I)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.strokeStyle!==(a=v)&&(t.strokeStyle=a),t.strokeRect(M+.5,g+.5,h-1,I-1),l=void 0,a=u._buttonState,f=u._text,l=2===a?u._buttonClickColor||w:(l=u._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==l&&(t.fillStyle=l),D.W.setFillStyle(t,l,n,e,s,o,function(){t.fillRect(M+1,g+1,h-2,I-2)}),t.restore(),f)&&d.prototype.paintValue.call(u,t,f,M,g,h,I,c,r)},y.prototype.getText=function(t,i){return t},y.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},y.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,u,a,o,e,o=this;return s&&(c=s.sheetArea,l(c)||3===c)&&e?(r=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:c,sheet:s.sheet,cellStyle:n},r<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):M},y.prototype.processMouseDown=function(t){var i,n,i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG||(i.pG=!0,i._buttonState=2,(0,r.XCe)(n,t.cellRect),0))},y.prototype.processMouseUp=function(t){var i,n,e,s,o,c,t,i=this,n=t&&t.sheet;if(i.pG&&n&&t.isReservedLocation){if((i._buttonState=0,r.XCe)(n,t.cellRect),i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(c=n.Ut.getValueForKey(e,s,h,o)))return i.j3(n,e,s,o),n.Ut.do("setValueForKey",e,s,h,!0,o),t=setTimeout(function(){b(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,I,t,o),!0;b(n,e,s,o)}return!1},y.prototype.processMouseLeave=function(t){var i,n,i=this,n=t&&t.sheet;n&&i.pG&&((i._buttonState=0,r.XCe)(n,t.cellRect),i.pG=!1)},y.prototype.processKeyDown=function(t,i){var n,e,s,n=i.sheet,e=this;return!(!n||e.bG)&&(s=n.getCellRect(i.row,i.col),e._buttonState=2,n.repaint(s),n.D3(u+N,function(){n._3(u+N),e.bG=!1,e._buttonState=0,n.repaint(s)}),e.bG=!0)},y.prototype.processKeyUp=function(t,i){var n,e,s,o,c,n=i.sheet,e=this;return!(!n||!e.bG||(s=i.row,o=i.col,c=n.getCellRect(s,o),e._buttonState=0,n.repaint(c),n._3(u+N),e.j3(n,s,o,i.sheetArea),e.bG=!1))},y.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},y.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,c,o=this,c;return a.Bt(t,o._text,n,e,s)+o._marginLeft+o._marginRight},y.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,c,o=this,c;return a.tn(t,o._text,n,e,s)+o._marginTop+o._marginBottom},y.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},y.prototype.isImeAware=function(t){return!1},y.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return c(f,function(t,i){"buttonState"!==t&&(s=n["_"+t])!==i&&(e[t]=s)}),e},y.prototype.fromJSON=function(n){var e=this;c(f,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},y.prototype.jn=function(t){},y.prototype.Ke=function(){},j=y,i.Button=j,c(f,function(i){j.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),D.CellTypes.ti[6]=j},"./dist/plugins/celltype/cellbuttons.js":function(n,o,t){"use strict";var b,i,t,A,W,T,y,I,c,H,V,J,F,X,f,D,g,_,z,h,K,C,q,m,$,s,d,v,w,j,p,L,x,S,u,N,a,O,i,l,k,e,t;function tt(t){switch(t){case p:return b.ButtonPosition.left;case L:return b.ButtonPosition.right;case x:return b.ButtonPosition.leftOfText;case S:return b.ButtonPosition.rightOfText}}function it(t){switch(t){case b.ButtonPosition.left:return p;case b.ButtonPosition.right:return L;case b.ButtonPosition.leftOfText:return x;case b.ButtonPosition.rightOfText:return S}}function nt(t){for(var i,n,e,i=t.split(" "),e=0;e<i.length;e++)if(0<=i[e].indexOf(s)){n=i[e];break}switch(n){case d:return p;case v:return L;case w:return x;case j:return S}}function et(t){switch(t){case p:return d;case L:return v;case x:return w;case S:return j}}function st(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,f,T,e),s=t.getValueForKey(i,n,D,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,D,T,e))}function ot(t,i,n){var e,s;switch(n){case k.topLeft:return new b.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),new b.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topRight:return e=t.width-i.width,e=Math.max(0,e),new b.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleLeft:return s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleRight:return e=t.width-i.width,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomLeft:return s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomRight:return e=t.width-i.width,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new b.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function M(t,i,n){for(var e,s,e=[],s=0;s<t.length;s++)e.push({width:Q(t[s].button,i,n),height:jt(t[s].button,n),isStick:t[s].button.v_i});return e}function E(t,i,n,e,s,o){for(var c,r,u,a,l,M,g,c=[],r=[],u=0;u<t.length;u++)a=i[t[u].index],A(a)?r.push(t[u]):c.push(a);for(l=ut(c),u=0;u<r.length;u++)M=Q(r[u].button,n,e),(g=!o||l.width+M<=o.width)&&(l.width+=M);return l.height=l.height||(o?o.height:0),l}function ct(t,i,n,e,s,o,c,r,u,a,l,M){var n,g,r,i,c,h,n,a,s,I,N,f,n=Y(i,n,c,r,!0,[t]);if(0<n.length){switch(Z(n,i,c),t){case b.ButtonPosition.left:g=d;break;case b.ButtonPosition.right:g=v;break;case b.ButtonPosition.leftOfText:g=w;break;case b.ButtonPosition.rightOfText:g=j;break;default:return}switch(r=E(n,a,s,e,!0,o),i="0",c=W(),((h=b.mt.Tt).mozilla||1<c)&&(i="1px"),n=r.width,a=r.height,s=it(t),A(u.canvasSizes)&&(u.canvasSizes={}),(I=u.canvasSizes)[s]={width:n,height:a},f=rt(g,n,a,N={width:n+"px",height:a+"px",display:"block",position:"absolute",bottom:i,overflow:"hidden",paddingTop:"0"}),t){case b.ButtonPosition.left:f.style.left="0";break;case b.ButtonPosition.right:f.style.right="0";break;case b.ButtonPosition.leftOfText:f.style.left="0";break;case b.ButtonPosition.rightOfText:f.style.right="0";break;default:return}l.appendChild(f)}}function rt(t,i,n,e){var s,o,s=document.createElement("canvas");for(o in s.className=t+" "+$,e)e.hasOwnProperty(o)&&(s.style[o]=e[o]);return s.width=i,s.height=n,s}function ut(t){var i,n,e,s,o;if(t.length<=0)return new b.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,e=t[0].x+t[0].width,s=t[0].y+t[0].height,o=1;o<t.length;o++)i=Math.min(i,t[o].x),n=Math.min(n,t[o].y),e=Math.max(e,t[o].x+t[o].width),s=Math.max(s,t[o].y+t[o].height);return new b.Rect(i,n,e-i,s-n)}function U(t,i,n,e,s,o,c,r){var u,c,a,l,M,g,h;if(!A(t))for(A(r[n])&&(r[n]={}),Z(i,e.sheet,e.row),u=t.getContext("2d"),c=E(i,c,s,e,!0),u.setTransform(parseFloat(t.style.width)/c.width,0,0,parseFloat(t.style.height)/c.height,0,0),M=new b.Rect(l=a=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),g=0;g<i.length&&(h=B(u,a,0,Q(i[g].button,s,e),e.sheet.getRowHeight(e.row),i[g].button,s,e,o,r[n],i[g].index,M),!A(h));g++)a+=h.width}function at(n,e,s,o,c,t){var t,i,i,i,i;A(t.eventListeners)&&(t.eventListeners={}),A(t.eventListeners[e])&&(t.eventListeners[e]={}),i=(t=t.eventListeners[e]).mouseDownListener=function(t){var i;yt(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousedown",i),i=t.mouseUpListener=function(t){var i;zt(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mouseup",i),i=t.mouseMoveListener=function(t){var i;Ct(r({x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousemove",i),i=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:s,cellRect:c,cellStyle:o,buttonArea:e};t.x<0&&(t.x=0),t.x>=parseFloat(n.style.width)&&(t.x=parseFloat(n.style.width)-1),mt(r(t,!0),!0,n)},n.addEventListener("mouseleave",i)}function lt(t,i,n,e,s,o,c,r,u,a,l,M){var i,g,h,n,I,N,f,D,i=Y(i,n,c,r,!0,[t]);if(0<i.length){switch(h=g=void 0,t){case b.ButtonPosition.left:g=d,h=p;break;case b.ButtonPosition.right:g=v,h=L;break;case b.ButtonPosition.leftOfText:g=w,h=x;break;case b.ButtonPosition.rightOfText:g=j,h=S;break;default:return}if(n=M.querySelector("."+g),!A(n)){switch(I=parseFloat(n.style.width),N=o.options.contentRect,f=o.options.leftExternalRect,D=o.options.rightExternalRect,t){case b.ButtonPosition.left:N.x+=I,N.width-=I;break;case b.ButtonPosition.right:N.width-=I;break;case b.ButtonPosition.leftOfText:f.width+=I;break;case b.ButtonPosition.rightOfText:D.width+=I}U(n,i,h,e,s,u,a,l),at(n,h,e,s,o.options.cellRect,u)}}}function Mt(t,i,n,e,s,o,c){var i,n,r,u,a,l,M,i=Y(i,n,e,s,!0,[t]);if(i&&0<i.length)switch(n=it(t),r=o&&o[n]&&o[n].width||0,u=c.contentContainer,a=c.contentRect,l=c.leftExternalRect,M=c.rightExternalRect,t){case b.ButtonPosition.left:ht(u,"left",r),a.x+=r,a.width-=r;break;case b.ButtonPosition.leftOfText:ht(u,"left",r),l.width+=r;break;case b.ButtonPosition.right:a.width-=r;break;case b.ButtonPosition.rightOfText:M.width+=r}}function gt(t){return+t.replace("px","")||0}function ht(t,i,n){var e=0;t.style[i]&&(e=gt(t.style[i])),t.style[i]="".concat((e+=n)-1,"px")}function It(t,i){A(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),A(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),A(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),A(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function Z(t,i,n){for(var e,s,o,e=i.BO(),s=0;s<t.length;s++)(o=Ot(t[s].button,n))&&e.addImage(o)}function G(t){var i=t.isPrinting,t=t.printZoomFactor;return i&&"number"==typeof t&&1!==t}function Nt(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function ft(t,i,n){switch(n){case b.ButtonPosition.leftOfText:return new b.Rect(t.x,t.y,i.x-t.x,t.height);case b.ButtonPosition.rightOfText:return new b.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function Dt(t,i,n,e,s,o,c){var r,u,a,l,M,g,h,I,N;if(t&&!(i.length<=0)){if(s=Lt(s),Z(i,r=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(u=o.cellRect.x+o.cellRect.width-(n.x+n.width),(n=n.clone()).width=o.cornerX-n.x-u,n.height=n.height-(o.cornerY-n.y)-1,n.y=o.cornerY-1),a=ft(n,e,c?b.ButtonPosition.leftOfText:b.ButtonPosition.rightOfText),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),l=P(r,o.row,o.col,o.sheetArea),M=Lt(s),A(l.layout)&&(l.layout={}),c){for(g=a.x+a.width,h=i.length-1;0<=h&&(N=B(t,g-=I=Q(i[h].button,M,o),n.y,Q(i[h].button,M,o),a.height,i[h].button,M,o,l,l.layout,i[h].index,n),!A(N));h--);e.x=g}else{for(g=a.x,h=0;h<i.length&&(N=B(t,g,n.y,Q(i[h].button,M,o),a.height,i[h].button,M,o,l,l.layout,i[h].index,n),!A(N));h++)g+=N.width;e.width=g-e.x}t.restore()}}function dt(t,i,n,e,s){if(!(t+n<s.x||t>s.x+s.width||i+e<s.y||i>s.y+s.height))return t+n>s.x+s.width&&(n=s.x+s.width-t),i+e>s.y+s.height&&(e=s.y+s.height-i),t<s.x&&(t=s.x),i<s.y&&(i=s.y),new b.Rect(t,i,n,e)}function B(t,i,n,e,s,o,c,r,u,a,l,M){var g,u,g=h;if(u.buttonDownIndex===l?g=K:u.buttonHoverIndex===l&&(g=C),u=dt(i,n,e,s=c.vAlign===b.VerticalAlign.center?M.height:s,M),!A(u))return vt(t,u.x,u.y,u.width,u.height,o,c,r,g,M),a[l]=new b.Rect(u.x,u.y,u.width,u.height),a[l].offsetX=u.x-M.x,a[l].offsetY=u.y-M.y,r.cornerY&&(a[l].offsetY+=r.cornerY),a[l]}function vt(t,i,n,e,s,o,c,r,u,a){var l,M,g,g,h,h,I,h,N,l,l,u,I,l,N,f,D,d,v,d,i,d,w,n,e,j;t.save(),t.beginPath(),l=o.useButtonStyle,M=G(r),g=r.printZoomFactor,g=M?g:r.sheet.zoom(),i+=h=l?z*g:0,n+=h,e-=2*h,s-=2*h,h=H,I=o.hoverBackColor||F,h&&t.strokeStyle!==h&&(t.strokeStyle=h),l&&t.strokeRect(i+.5,n+.5,e-1,s-1),h=kt(o.enabled,r.row),l?N=!1===o.enabled?o.buttonBackColor||J:u===K?V:u===C||r.visualState===b.VisualState.hover?I:((l=t.createLinearGradient(i+e/2,n,i+e/2,n+s)).addColorStop(.125,"#F6FAFB"),l.addColorStop(1,"#D2DBEB"),o.buttonBackColor||l):(N=o.buttonBackColor||"white",u===C&&(o.enabled||A(o.enabled))&&(N=I)),(l=c.font)&&t.font!==l&&(t.font=l),t.fillStyle!==N&&(t.fillStyle=N),t.rect(i+=1,n+=1,e-=2,s-=2),t.clip(),t.beginPath(),t.fillRect(i,n,e,s),u=new b.Rect(i,n,e,s),I=new b.Rect(i,n,e,s),l=_*g,N=Ot(o,r.row),o.caption&&N&&(f=(m.Bt(y,o.caption,c,g,r)+2*z)*g,D=At(o)*g,d=new b.Rect(0,0,f+D+l,s),d=ot(v=new b.Rect(i,n,e,s),d,k.MiddleCenter),o.captionAlign===b.CaptionAlignment.left?(I=new b.Rect(d.x,n,f,s),u=d.x+f+l<i+e-2?new b.Rect(d.x+f+l,n,Math.max(0,D),s):new b.Rect(0,0,0,0)):(u=new b.Rect(d.x,n,Math.min(D,e),s),I=d.x+D+l<i+e-2?new b.Rect(d.x+D+l,n,Math.min(e-2-D-l,f),s):new b.Rect(0,0,0,0))),o.caption&&(i=(m.Bt(y,o.caption,c,g,r)+2*z)*g,d=(m.tn(y,o.caption,c,g,r)+2*z)*g,n=ot(I,w=new b.Rect(0,0,i,d),k.MiddleCenter),e=new q,c=c.clone(),!1===h&&(c.foreColor=X),c.cellButtons=T,c.decoration=T,e.paintValue(t,o.caption,n.x,n.y-(j=M?0:2),n.width,n.height,c,r)),N&&wt(t,o,u.x,u.y,u.width,u.height,N,r,a),t.restore()}function wt(t,i,n,e,s,o,c,r,u){var a,l,a,n,s,o,M,g,r,r,M,e,n,h;t.save(),t.rect(n+2,e+2,s-4,o-4),t.clip(),t.beginPath(),(l=(a=r.sheet).BO()).getState(c)?l.qh(c)&&(a=G(r)?r.printZoomFactor:a.zoom(),n=new b.Rect(n,e,s,o),s=At(i)-2,o=Tt(i)-2,g=ot(n,M=new b.Rect(0,0,s*a,o*a),k.MiddleCenter),i.position!==b.ButtonPosition.leftOfText&&i.position!==b.ButtonPosition.rightOfText||((r=r.textRect)&&(g.y=I(r.y-r.height/2-M.height/2,e+4)),g.y+g.height>n.y+n.height&&(g.y=I(g.y-(g.y+g.height-n.y-n.height),n.y))),M=(r=l.getImage(c)).width,e=r.height,b.mt.Tt.msie&&i.imageType&&(e=i.imageType===b.ButtonImageType.custom?(N[c]||(r.style.position="absolute",r.style.left="-10000px",r.style.top="-100000px",document.body.appendChild(r),N[c]={width:r.width,height:r.height},document.body.removeChild(r)),M=N[c].width,N[c].height):M=12),u&&b.mt.Tt.msie&&g.x+g.width>u.x+u.width?0<(n=u.x+u.width-g.x)&&t.drawImage(r,0,0,n*(h=M/(s*a)),e,g.x,g.y,n,o*a):t.drawImage(r,0,0,M,e,g.x,g.y,s*a,o*a)):l.addImage(c),t.restore()}function Q(t,i,n,e){var s,o,i,c,r,n;return void 0===e&&(e=!0),s=G(n)?n.printZoomFactor:n.sheet.zoom(),o=2*z+3,A(t.width)?(i=m.Bt(y,t.caption,i,s,n),c=t.useButtonStyle,(r=Ot(t,n.row))&&(i=At(t)+i,o=(c?o:0)+_),e?(i+o+7)*s:i+o+7):(n=I(1,t.width),isNaN(n)&&(n=1),e?n*s:n)}function jt(t,i,n){var e,s,e,i,t;return void 0===n&&(n=!0),e=i.sheet,s=G(i)?i.printZoomFactor:e.zoom(),e=e.getRowHeight(i.row),i=t.imageSize?t.imageSize.height:y,t=I(1,i||e),isNaN(t)&&(t=1),n?t*s:t}function Y(t,i,n,e,s,o){var c,r,u,a,l,M,c=[];if(!i||0===i.length)return[];for(r=!1,u=t.Ut.getValueForKey(n,e,g),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===e&&!0!==u&&(r=!0),a=0;a<i.length;a++)if(l=i[a].visible,!s||!i[a].i4i)for(M=0;M<o.length;M++)(i[a].position===o[M]||A(i[a].position)&&o[M]===b.ButtonPosition.right)&&(l&&"function"==typeof l&&l(n)||i[a].visibility===b.ButtonVisibility.onEditing&&s||i[a].visibility!==b.ButtonVisibility.onEditing&&r||i[a].visibility===b.ButtonVisibility.always||A(i[a].visibility))&&c.push({index:a,button:i[a]});return c}function At(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.width&&(i=c(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:i)===y||isNaN(i)||i<0?16:i}function Tt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.height&&(i=c(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:i)===y||isNaN(i)||i<0?16:i}function P(t,i,n,e,s){var o,c,o={isMouseDownReservedLocation:!1};return e===b.SheetArea.corner?o:((c=t.Ut.getValueForKey(i,n,u,e))||s||bt(t,i,n,e,c=o),c)}function bt(t,i,n,e,s){t.Ut.setValueForKey(i,n,u,s,e)}function r(t,i){var n,e,s,o,c,r,u,a,a,l,M,g,h,I,N,f,D,d,v,w,j,A,T,a,t,l,t,l;if(void 0===i&&(i=!1),n=t.context.row,e=t.context.col,s=t.cellRect,o=t.cellStyle,c=t.context,u=(r={x:t.x,y:t.y,row:n,col:e,cellRect:s,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:c}).sheet,!1!==t.cellStyle.locked&&u.isActualProtected()&&!u.NMi&&(a={row:n,col:e,sheetArea:t.context.sheetArea,isLocked:!0},b.Worksheet.et(u,"getCellActualLockedInfo",a),a.isLocked))return null;if(a=P(u,r.row,r.col,r.sheetArea,!0),l=t.cellStyle.cellButtons,!a||!l||l.length<=0)return null;if(M=a.layout,!(M=i?a.editorLayout[t.buttonArea]:M))return null;for(N in g=-1,h=r.x,I=r.y,M)if(M.hasOwnProperty(N)){if(f=void 0,D=M[N],i)f=new b.Rect(D.x,D.y,D.width,D.height);else{if(d=D.offsetX,u.parent&&!u.parent.options.scrollByPixel&&0<(v=u.frozenColumnCount())&&v<(w=u.getViewportLeftColumn(1))&&(j=u.getSpan(n,e,r.sheetArea))&&j.col<=w&&w<j.col+j.colCount)for(A=w-v,T=0;T<A;T++)d-=u.getColumnWidth(v+T+1,r.sheetArea);f=new b.Rect(s.x+d,s.y+D.offsetY,D.width,D.height)}if(f&&f.contains(h,I)){g=+N;break}}return-1!==g?r.cellButtonHitInfo={hitButtonIndex:g,buttonConfig:l[g],buttonArea:t.buttonArea}:(a=u.getCellType(r.row,r.col))&&(t=E(Y(u,l,n,e,i,[b.ButtonPosition.left]),M,o,c,!1),l=E(Y(u,l,n,e,i,[b.ButtonPosition.right]),M,o,c,!1),t=new b.Rect(s.x+t.width,s.y,s.width-t.width-l.width,s.height),l=a.getHitInfo(r.x,r.y,o,t,c))&&l.isReservedLocation&&(r.isReservedLocation=!0),r}function yt(t,i,n){var e,s,o,c,r,r,u,a,l,s,u,l,a,i,M,g;return void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(e=t.sheet,o=t.row,c=t.col,r=t.sheetArea,o===e.ui&&c===e.ci||r!==b.SheetArea.viewport||e.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(s=t.cellButtonHitInfo.buttonConfig.hasOverLay),r=P(e,o,c,t.sheetArea),t.cellButtonHitInfo&&(a=t.cellButtonHitInfo.hitButtonIndex,u=t.cellButtonHitInfo.buttonConfig),l=kt(u&&u.enabled,t.row),e)&&(!r.isMouseDownReservedLocation||s)&&u&&(l||A(l))&&0<=a&&(r.buttonDownIndex=a,r.isMouseDownReservedLocation=!0,i&&n?(s=t.cellStyle,u=r.layout,l=t.context,a=r.editorLayout,i=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,M=s.cellButtons,i&&U(n,g=Y(e,M,o,c,!0,[tt(i)]),i,l,s,r,u,a)):R(e,t.cellRect),1)}function zt(t,i,n){var e,s,o,c,r,u,u,a,l,M,r,g,h,I,N,n;if(void 0===i&&(i=!1),t&&(e=t&&t.sheet,s=t.row,o=t.col,c=P(e,t.row,t.col,t.sheetArea),r=t.cellButtonHitInfo,c.isMouseDownReservedLocation)&&e){if(r&&0<=r.hitButtonIndex&&r.buttonConfig.command&&(u=r.buttonConfig.command,i||e.getActiveRowIndex()===s&&e.getActiveColumnIndex()===o||e.eR(s,o,1,1,2),"string"==typeof u?e.getParent().commandManager().execute({cmd:u,row:s,col:o,sheetName:e.name(),sheetArea:t.sheetArea}):"function"==typeof u&&u.call(y,e,s,o,t.sheetArea)),i&&0<=c.buttonDownIndex&&n&&(c.buttonDownIndex=-1,u=t.cellStyle,a=c.layout,l=t.context,M=c.editorLayout,r=r&&r.buttonArea,g=u.cellButtons,r)&&U(n,h=Y(e,g,s,o,!0,[tt(r)]),r,l,u,c,a,M),c.buttonDownIndex=-1,i||R(e,t.cellRect),c.isMouseDownReservedLocation=!1,I=t.sheetArea,!(N=e.Ut.getValueForKey(s,o,f,I)))return xt(e,s,o,I),e.Ut.do("setValueForKey",s,o,f,!0,I),n=setTimeout(function(){st(e,s,o,I)},250),void e.Ut.do("setValueForKey",s,o,D,n,I);st(e,s,o,I)}}function Ct(t,i,n){var e,s,o,o,i,c,r,u,a,l,M;void 0===i&&(i=!1),t&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(A(s.buttonHoverIndex)?-1:s.buttonHoverIndex))&&(s.buttonHoverIndex=o,i?(o=t.cellStyle,i=s.layout,c=t.context,r=s.editorLayout,u=o.cellButtons,a=t.row,l=t.col,n&&pt(u,e,a,l,M=n.parentElement,c,o,s,i,r)):R(e,t.cellRect))}function R(t,i){var n,e,s,i,n,n=i.x-(0<i.x?2:0),e=i.y-(0<i.y?2:0),s=i.width+4,i=i.height+4,n=new b.Rect(n,e,s,i);t.repaint(n)}function mt(t,i,n){var e,s,i,o,c,r,u,a,l,M;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(s.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,o=s.layout,c=t.context,r=s.editorLayout,u=i.cellButtons,a=t.row,l=t.col,n)&&pt(u,e,a,l,M=n.parentElement,c,i,s,o,r)):(e&&(s.buttonHoverIndex=-1,s.buttonDownIndex=-1,s.isMouseDownReservedLocation=!1),R(e,t.cellRect)))}function pt(t,i,n,e,s,o,c,r,u,a){for(var l,M,g,h,l=0;l<O.length;l++)M=it(O[l]),U(g=s.querySelector("."+et(M)),h=Y(i,t,n,e,!0,[tt(M)]),M,o,c,r,u,a)}function Lt(t){var t=t.clone(!0);return t.hAlign=b.HorizontalAlign.left,t.vAlign=b.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function xt(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)}function St(t,i,n,e,s){var o,c,r,o=t.Il(i,n,s);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(c=o.cellButtons.filter(function(t){return 1===t.visibility})).length){e&&t.Ut.do("setValueForKey",i,n,g,!0,s);try{r=t.getCellRect(i,n,1===s?-1:void 0,2===s?-1:void 0),t.repaint(r)}finally{e&&t.Ut.do("setValueForKey",i,n,g,T,s)}}}function Ot(t,i){var n,e,i,s,n=null,e=t.imageType;if(A(t.imageType))return null;switch(s=(i=kt(t.enabled,i))||A(i),e){case b.ButtonImageType.dropdown:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.left:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.right:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.clear:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.ok:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.plus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.minus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.redo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.undo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.search:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.separator:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.spinLeft:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case b.ButtonImageType.spinRight:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case b.ButtonImageType.ellipsis:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case b.ButtonImageType.expand:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case b.ButtonImageType.collapse:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case b.ButtonImageType.custom:n=t.imageSrc}return n}function kt(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(o,"__esModule",{value:!0}),o.XCe=void 0,b=t("Core"),i=t("Common"),t=t("./dist/plugins/celltype/celltypes.ns.js"),A=i.Common.lt.ht,W=b.Bf.Zl,T=void 0,y=null,I=Math.max,c=parseInt,H="#707070",V="#34B4E3",J="#e6e6e6",F="lightgray",X="#CACACA",f="_isFirstMouseUp",D="_mouseupToken",g="_leaveCell",h=_=0,K=z=2,C=3,q=b.CellTypes.Base,m=b.CellTypes.Context,$="gc-cell-button-canvas",d=(s="gc-editor-")+"left-cellbuttons",v=s+"right-cellbuttons",w=s+"left-of-text-cellbuttons",j=s+"right-of-text-cellbuttons",p="leftButtonArea",L="rightButtonArea",x="leftOfTextButtonArea",S="rightOfTextButtonArea",u="_cellButtonParam",N={},a=b.GC$,O=[b.ButtonPosition.left,b.ButtonPosition.right,b.ButtonPosition.leftOfText,b.ButtonPosition.rightOfText],i=new i.Common.ResourceManager(t.SR,"CellTypes"),l=i.getResource.bind(i),(t=k=k||{})[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight",b.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,e,s,o,c,r,u,a,l,c,M,g,h,I,N,f,D,d,i=t.options.context,n=t.options.style;if(!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.options.context.sheet,s=i.row,o=i.col,c=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.left,b.ButtonPosition.right]))&&0<c.length&&(r=Lt(n),Z(c,e,t.options.context.row),u=t.ctx)){for(a=Nt(t.options.rect.clone(),i),u.save(),u.rect(a.x,a.y,a.width,a.height),u.clip(),u.beginPath(),l=a.x,c=a.x+a.width,M=P(e,i.row,i.col,i.sheetArea),A(M.layout)&&(M.layout={}),g=M.layout,h=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.left]),I=0;I<h.length&&(N=B(u,l,a.y,Q(h[I].button,r,i),a.height,h[I].button,r,i,M,g,h[I].index,a),!A(N));I++)l+=N.width;for(f=l,l=c,I=(D=Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.right])).length-1;0<=I&&(N=B(u,l-=d=Q(D[I].button,r,i),a.y,d,a.height,D[I].button,r,i,M,g,D[I].index,a),!A(N));I--);u.restore(),(a=t.options.rect).width=a.x+a.width-(c-l)-f,a.x=f}},beforePaintText:function(t){var i,n,e,s,o,t,i=t.context,n=t.style;!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.context.sheet,s=i.row,o=i.col,(t=t.externals).left=t.left.concat(M(Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.leftOfText]),n,i)),t.right=t.right.concat(M(Y(e,n.cellButtons,s,o,!1,[b.ButtonPosition.rightOfText]),n,i)))},beforeFillTextArea:function(t){var i,n,e,s,o,e,c,r,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,Dt(e,a=Y(c=(e=t.context).sheet,n,r=e.row,u=e.col,!1,[b.ButtonPosition.leftOfText]),s,o,i,e,!0))},afterFillTextArea:function(t){var i,n,e,s,o,e,c,r,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,Dt(e,a=Y(c=(e=t.context).sheet,n,r=e.row,u=e.col,!1,[b.ButtonPosition.rightOfText]),s,o,i,e,!1))},onCreateCellEditor:function(t){var i,n,e,s,o,c,r,u,a,t,l,M,g,h,I,i=t.options.dom;if(i&&i.children&&(n=i.children[0])&&n.children&&(e=n.children[0])&&(o=(s=t.context).sheet,c=s.row,r=s.col,u=t.options.cellStyle,a=(u=A(u)?o.getActualStyle(c,r):u).cellButtons,!(A(a)||a&&a.length<=0))){for(t=t.options.cellRect,l=new b.Rect(t.x,t.y,t.width,t.height),M=P(o,c,r,s.sheetArea),A(M.layout)&&(M.layout={}),g=M.layout,h=!1,I=0;I<a.length;I++)a[I].position!==b.ButtonPosition.leftOfText&&a[I].position!==b.ButtonPosition.rightOfText||(h=!0);for(h&&(n.style.overflow="hidden"),I=0;I<O.length;I++)ct(O[I],o,a,s,u,l,c,r,M,g,i,n)}},onActivateCellEditor:function(t){var i,n,e,s,o,c,r,u,a,l,M,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o=t.options.cellStyle,c=o.cellButtons;if(!(A(c)||c.length<=0))for(r=P(n,e,s,i.sheetArea),A(r.editorLayout)&&(r.editorLayout={}),u=r.layout,a=r.editorLayout,l=Lt(o),M=t.options.dom,g=0;g<O.length;g++)lt(O[g],n,c,i,l,t,e,s,r,u,a,M)},onDeactivateCellEditor:function(t){var i,n,e,s,o,n,c,r,u,a,l,M,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o,n=n.getActualStyle(e,s,i.sheetArea).cellButtons;if(n&&0<n.length)for(r=(c=P(i.sheet,e,s,i.sheetArea,!0))&&c.eventListeners,a=(u=t.options.dom).querySelectorAll("."+$),l=0;l<a.length;l++)g=nt((M=a[l]).className),A(g)||A(r)||A(r[g])||(It(M,r[g]),delete c.eventListeners[g])},onUpdateContainer:function(t){var i,n,e,s,i,o,c,r,i=t.context,n=i.sheet,e=i.row,s=i.col,i=P(i.sheet,e,s,i.sheetArea,!0),o=i&&i.canvasSizes,c=t.cellStyle.cellButtons;if(!(A(c)||c.length<=0))for(t.context.preventOverflow=!c.every(function(t){return t.i4i}),r=0;r<O.length;r++)Mt(O[r],n,c,e,s,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=r(t)},processMouseDownOnCellPadding:function(t){yt(t)},processMouseUpOnCellPadding:function(t){zt(t)},processMouseMoveOnCellPadding:function(t){Ct(t)},processMouseLeaveOnCellPadding:function(t){mt(t)},getCellButtonAutoHeight:function(e){var s,o,t,c,t,r,s=e.context.sheet,o=e.context.row,t=e.context.col,c=e.cellStyle;c.cellButtons&&0!==c.cellButtons.length&&(t=Y(s,c.cellButtons,o,t,!1,[b.ButtonPosition.left,b.ButtonPosition.right]),r=0,t.forEach(function(t){var i,n,i=m.tn(y,t.button.caption,c,s.zoom(),e.context)-2,n;Ot(t.button,o)&&(i=I(i,At(t.button))),r=I(i,r)}),e.value=r+ +z)},getCellButtonAutoWidth:function(i){var t,n,e,s,t,o,t=i.context.sheet,n=i.context.row,e=i.context.col,s=i.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=Y(t,s.cellButtons,n,e,!1,[b.ButtonPosition.left,b.ButtonPosition.right,b.ButtonPosition.leftOfText,b.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=Q(t.button,s,i.context,!1)}),i.value=o)}}),o.XCe=R,b.Worksheet.ch(e="cellButtons",{setHost:function(){var n=this;n.bind(b.Events.EnterCell+"."+e,function(t,i){St(n,i.row,i.col,!1,i.sheetArea)}),n.bind(b.Events.LeaveCell+"."+e,function(t,i){St(n,i.row,i.col,!0,i.sheetArea)}),n.bind(b.Events.TopRowChanged+"."+e,function(t,i){St(n,i.row,i.col,!0,i.sheetArea)})},dispose:function(t){var i=this;i.unbind(b.Events.EnterCell+"."+e),i.unbind(b.Events.LeaveCell+"."+e),i.unbind(b.Events.TopRowChanged+"."+e)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&yt(i)&&(t.r=!0)}}),b.Workbook.ch(e,{onCultureChanged:function(){l()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var s=Object.getOwnPropertyDescriptor(i,n);s&&("get"in s?i.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,s)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),s=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.x9e=i.ti=i.EditorType=i.Context=i.Base=void 0,c=(o=n("Core")).CellTypes.Base,r=o.CellTypes.Context,u=o.CellTypes.EditorType,a=o.CellTypes.ti,i.Base=c,i.Context=r,i.EditorType=u,i.ti=a,i.Hi=o.CellTypes.Hi,i.zi=o.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),s(n("./dist/plugins/celltype/checkboxcelltype.js"),i),s(n("./dist/plugins/celltype/buttoncelltype.js"),i),s(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),s(n("./dist/plugins/celltype/comboboxcelltype.js"),i),s(n("./dist/plugins/celltype/addrowcolumnbuttoncelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),s(n("./dist/plugins/celltype/editor/colorpicker.js"),i),s(n("./dist/plugins/celltype/editor/timepicker.js"),i),s(n("./dist/plugins/celltype/editor/calendar.js"),i),s(n("./dist/plugins/celltype/editor/calculator.js"),i),s(n("./dist/plugins/celltype/editor/monthPicker.js"),i),s(n("./dist/plugins/celltype/editor/listControl.js"),i),s(n("./dist/plugins/celltype/dropdown-action.js"),i),s(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),s(n("./dist/plugins/celltype/celltypes.ns.js"),i),s(n("./dist/plugins/celltype/rangecelltype.js"),i),s(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),s(n("./dist/plugins/celltype/editor/popupControl.js"),i),s(n("./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js"),i),l=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),Object.defineProperty(i,"x9e",{enumerable:!0,get:function(){return l.x9e}})},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.FileUpload_Title=i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way.",i.FileUpload_Title="+ Upload"},"./dist/plugins/celltype/checkboxcelltype.js":function(U,t,i){"use strict";var n,e,b,s,a,v,c,u,i,d,o,w,r,l,M,y,g,h,j,A,T,z,C,I,N,Z,f,G,D,m,p,L,B,x,S,O,k,e,Q;function Y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,p,l,e),s=t.getValueForKey(i,n,L,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,L,l,e))}function E(){var t,n,t=Q.call(this)||this;return t.typeName="5",t._boxSize=x,t.Jtu=!0,n=t,o(S,function(t,i){n["_"+t]=i}),t}function P(t){return 5*t}function R(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,n,N,f,D,d,v,w,j,c,A,a,e,T,i,u=5*c,a=i.hAlign,l=n.x,M=n.width,g=0,h=i.vAlign,I=n.y,n=n.height,N=0,f=0,D=1<e.split("\n").length,d=l,v=I,w=M,j=n,c=x*c;return 0===t||1===t?(1===a?g=l+M/2-c/2:w=2===a?(g=l+M-u-c,M-u+2):(d=(g=l+u)-1,M-u+1),j=(a=b.q.un(e,A=w-3-1,i.font)).length*o,D=D||1<a.length,N=c+j,v=0===t?(1===h?(f=I+n/2-N/2+j-3,j+=6):f=2===h?I+n-u-N+j:I+u+j,f-j):(1===h?(f=I+n/2-N/2-3,j+=6):f=2===h?I+n-u-N:I+u,f+c)):(f=1===h?I+n/2-c/2:2===h?I+n-u-c:I+u,i=o/2-(e=y(r.fontInfo.fontSize))/2+(T=8<e?Math.floor((e-8)/5+2):1)-1,D=D||M-c-u-4<s,w=M-c-u,2===h?j=n+i+2-u:0===h&&(j=n-((v=I-(2+i)+u)-I)),2===t?(g=l+M-u-c,w=M-c):d=(g=l+u)+c+1),{multiLine:D,startX:g,startY:f,textX:d,textY:v,textW:w,textH:j}}function W(t,i,n,e,s){var o,i,c,n,r,u,o=5*s,i=i.hAlign,c=n.x-1,n=n.width+1,r=0,u=0;return 0===t||1===t?(u=c+o,1===i?u=c+n/2-x*s/2:2===i&&(u=c+n-o-x*s)):2===t?(r=x*s+e,u=c+o+e,1===i?u=c+n/2-r/2+e:2===i&&(u=c+n-o-r+e)):(r=x*s+e,u=c+o,1===i?u=c+n/2-r/2:2===i&&(u=c+n-o-r)),u-c}function H(t,i,n,e,s){var o,i,c,n,r,u,o=5*s,i=i.vAlign,c=n.y-1,n=n.height+1,r=0,u=0;return 0===t?(r=x*s+e,u=c+o+e,1===i?u=c+n/2-r/2+e:2===i&&(u=c+n-o-r+e)):1===t?(r=x*s+e,u=c+o,1===i?u=c+n/2-r/2:2===i&&(u=c+n-o-r)):(u=c+o,1===i?u=c+n/2-x*s/2:2===i&&(u=c+n-o-x*s)),u-c}function V(t,i,n,e,s){var o,o,o;t.enable()&&(o=i.getValue(n,e,s),o=t.wG(o),o={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:o,autoFormat:!0},i.Qy().execute(o),t.j3(i,n,e,s))}function J(t,i,n,e,s){var o,c;!1!==t.enable()&&(o=s&&s.sheet,c=t.getEditorValue(i,s),t.setEditorValue(i,c,s),t.updateEditor(i,n,e,s),t.j3(o,o.ui,o.ci,s.sheetArea))}n=this&&this.__extends||(k=function(t,i){return(k=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}k(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,e=i("Common"),b=i("Core"),s=b.mt.En,a=e.Common.lt.ht,v=b.mt.vt,c=b.mt.vi,u=b.CellTypes.Context,i=b.CellTypes.Base,d=b.GC$,o=d.each,w=b.mt.yt,r=null,l=void 0,M=Math.max,y=parseInt,g="position",h="absolute",j="font",A="left",T="right",z="top",C="alphabetic",I=".gcEditingInput",N="background-color",Z="white",f="green",G="div",D="normal 11pt calibri",m="white-space",p="_isFirstMouseUp",L="_mouseupToken",(e=B=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right",S={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(x=12),boxSize:x},n(E,Q=i),E.prototype.Poe=function(t,i,n,e,s,o,c,r){var u=this,a=y(n.startX),l=y(n.startY),M=y(n.textX),g=y(n.textY),h=y(n.textW),n=y(n.textH);u.Goe(t,a,l,s,o,c),u.paintText(t,i,M,g,h,n,r,e,i,null)},E.prototype.Goe=function(t,i,n,e,s,o){t.save(),t.strokeStyle=this.Jtu?"black":"#B3B3B3",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=Z,t.fillRect(i+1,n+1,2*e-1,2*e-1),this._isThreeState&&a(o)?(t.beginPath(),t.fillStyle=f,t.rect(i+3*s,n+3*s,2*(e-2.5*s),2*(e-2.5*s)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*s,t.moveTo(i+3*s,n+e),t.lineTo(i+e,n+2*e-3.5*s),t.lineTo(i+2*e-1.5*s,n+3*s),t.stroke()),t.restore()},E.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,f,f,D,d,D,d,D,s,o,o,s,D,n,o,e,s,u,a,c;t&&(t.save(),t.rect(n,e,s,o),t.clip(),t.beginPath(),u=c.hAlign,a=c.font,l=c.foreColor,g=(M=this)._textAlign,h=M.getText(i,r),N=I=0,(f=r.sheet)&&(I=f.Qt(h,a),N=v(a)),f=f.zoom(),D=r.isPrinting,d=r.printZoomFactor,++n,++e,--s,--o,d=(D=this.CG(N,f=D&&"number"==typeof d&&1!==d?d:f)).radius,D=D.scaleFactor,s=new b.Rect(n,e,s,o),c.wordWrap&&(o=R(g,c,s,h,I,N,f*D,r)).multiLine?M.Poe(t,h,o,r,d,f,i,c):(o=W(g,c,s,I,f*D),s=H(g,c,s,N,f*D),D=y((n+o).toString()),n=y((e+s).toString()),o=A,e=D+1,1===u?(o="center",e+=d):2===u&&(o=T,e+=2*d),a&&t.font!==a&&b.mt.bt(t,a),l&&(t.fillStyle=l),s=c.textDecoration,c=N/2-(u=parseInt(r.fontInfo.fontSize,10))/2+(a=8<u?Math.floor((u-8)/5+2):1)-1,t.textBaseline!==C&&(t.textBaseline=C),2===g?(t.textAlign=T,t.fillText(h,D+1-2,n+d+N/2-c),s&&M.le(t,s,D+1-2,n+d+N/2-c,I,u,a)):0===g&&(t.textAlign=o,t.fillText(h,e,n-2-c),s)&&M.le(t,s,e,n-2-c,I,N),M.Goe(t,D,n,d,f,i),l&&(t.fillStyle=l),3===g?(t.textAlign=A,t.fillText(h,D+1+2*d+2,n+d+N/2-c),s&&M.le(t,s,D+1+2*d+2,n+d+N/2-c,I,u,a)):1===g&&(t.textAlign=o,t.fillText(h,e,n+2*d+2+N-c),s)&&M.le(t,s,e,n+2*d+2+N-c,I,u,a)),t.restore())},E.prototype.CG=function(t,i){var n,e,s,o,n,e=this._boxSize,s=x/2,o=1;return"auto"===e&&(s=t/4,o=t/2/x),"number"==typeof e&&0<e&&(s=i*e/2,o=e/x),{radius:s,scaleFactor:o}},E.prototype.bi=function(t,i,n){var e,i,t,s,o,c,e,i=i.font,t=this.getText(t,n),s=0,o;return n.sheet&&(s=v(i),t)&&(s*=(c=t.split(/\r\n|\r|\n/)).length),s},E.prototype.getText=function(t,i){return this.SG(t)},E.prototype.focus=function(t,i){t&&t.parentNode.focus()},E.prototype.createEditorElement=function(t,i){var n,n,n,i,t,e,e,i,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,n=b.mt.gi(n)+1e3;return d(i).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=d(i.firstChild)).css("overflow","hidden"),(i=d(s("input"))).attr("type","checkbox"),i.attr("class","gc-checkbox-cell-type-input"),e=(t=this.TG(t))/x,i.css("transform","scale("+e+")"),n.append(i),(e=d(s("span"))).css(g,h).css(j,w(D)).css("cursor","default").css(m,"nowrap").css("word-break","break-all"),n.append(e),(i=d(s(G))).css(g,h).css(N,f).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),n.append(i),r},E.prototype.TG=function(t){var i,n,i,e,i=t.sheet,n=i.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*n:"auto"===this._boxSize?(e="",e=(i=i.Z_(t.row,t.col))&&i.font?i.font:D,n*v(e)/2):x/2},E.prototype.wG=function(t){var t,t=this._isThreeState?!a(t)&&(!0!=!!t||r):!t;return t},E.prototype.setEditorValue=function(t,i,n){var t,e,s,t,o,n,c,r,u;t&&this.Jtu&&(e=(t=t.parentNode.children)[0],s=t[1],t=t[2],e)&&s&&t&&(o=this,u=r=void 0,(c=(n=n&&n.sheet)&&n.Ai)||(u=o.wG(i)),o._isThreeState?a(u)?(r=!1,d(t).show()):(r=!!u,d(t).hide()):r=!!u,e.checked=r,d(s).text(o.SG(u)))},E.prototype.getEditorValue=function(t,i){if(t){var t=t.parentNode.children,n=t[0],e=t[1],t=t[2];if(n&&e&&t&&(!this._isThreeState||!d(t).isVisible()))return n.checked}return r},E.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},E.prototype.activateEditor=function(i,n,e,s){var t,t,o,t=s&&s.sheet;i&&t&&(t=d(i.parentNode.parentNode),o=this,t.bind("mousedown"+I,function(t){c(t)}),t.bind("mouseup"+I,function(){J(o,i,n,e,s)}),t.bind("keydown"+I,function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return o.AG=!0,c(t),!1;8===i&&c(t)}}),t.bind("keyup"+I,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,J(o,i,n,e,s))}),d(i).bind("click",function(t){c(t)}))},E.prototype.updateEditor=function(t,i,n,e){var s,o,t,c,r,u,c,t,u,a,l,M,g,a,l,o,s,h,a,u,e,I,N,n,l,N,n,r,f,D,M,u,s=e&&e.sheet;t&&s&&(o=s.Dn,r=(c=(t=t.parentNode).children)[0],u=c[1],c=c[2],r)&&u&&c&&(d(t).width(n.width).height(n.height),u=(t=d(u)).text(),a=i.foreColor,l=i.font,M=i.hAlign,g=i.textDecoration,a&&t.css("color",a),a=void 0,a=l||o.Nn(),1<(l=s.zoom())&&(a=o._n(a)),t.css(j,w(a)),o=s.Gi(u,a),s=v(a),u&&(s*=(h=u.split(/\r\n|\r|\n/)).length),N=W(u=(a=this)._textAlign,i,n,o,l*(I=(e=this.TG(e))/x)),n=H(u,i,n,s,l*I),d(r).css("margin-left",N).css("margin-top",n),l=r.offsetLeft,N=r.offsetTop,n=r.offsetWidth,r=r.offsetHeight,(D=f=0)===u?(f=l,1===M?f=l+e/2-o/2:2===M&&(f=l+e-o),D=N-s,f-=(I-1)*x/2,D-=(I-1)*x/2):1===u?(f=l,1===M?f=l+e/2-o/2:2===M&&(f=l+e-o),D=N+r,f-=(I-1)*x/2,D+=(I-1)*x/2):(2===u?(f=l-o-2,D=N+e/2-s/2,f-=(I-1)*x/2):(f=l+n+2,D=N+e/2-s/2,f+=(I-1)*x/2),D-=(I-1)*x/2),t.css(A,f).css(z,D),i.wordWrap?t.css(m,"normal"):t.css(m,"nowrap"),a._isThreeState?(M=l+(n-c.offsetWidth)/2,u=N+(r-c.offsetHeight)/2,d(c).css(A,M).css(z,u).toggle().toggle()):d(c).hide(),g)&&a.Qe(t,g)},E.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&a(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},E.prototype.getHitInfo=function(t,i,n,e,s){if(s&&this.Jtu){var o=s.sheetArea;if(a(o)||3===o)return{x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:3,isReservedLocation:!0,sheet:s.sheet,cellStyle:n}}return r},E.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},E.prototype.processMouseUp=function(t){var i,n,e,s,o,c,t,i=this,n=t&&t.sheet;if(n&&i.pG&&t.isReservedLocation){if(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(c=n.Ut.getValueForKey(e,s,p,o)))return V(i,n,e,s,o),n.Ut.do("setValueForKey",e,s,p,!0,o),t=setTimeout(function(){Y(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,L,t,o),!0;Y(n,e,s,o)}return!1},E.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},E.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},E.prototype.processKeyUp=function(t,i){return V(this,i.sheet,i.row,i.col,i.sheetArea),!0},E.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,c,r,t,n,o=this,c=o._textAlign,r=u.Bt(t,o.SG(t),n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===c||1===c?r=M(r,n):r+=n,r+5+2},E.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,c,r,r,t,n,o=this,c=o._textAlign,r=o.SG(t),r=u.tn(r,r,n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===c||1===c?r+=n:r=M(r,n),r+5},E.prototype.QD=function(t){this.isReservedKey(t)&&c(t)},E.prototype.isImeAware=function(t){return!1},E.prototype.Ke=function(){},E.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&B[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},E.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return o(S,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},E.prototype.fromJSON=function(n){var e=this;o(S,function(t){var i=n[t];a(i)||(e["_"+t]=i)})},E.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?x*t+5*t:0},E.prototype.enable=function(t){if(!(0<arguments.length))return this.Jtu;this.Jtu=Boolean(t)},O=E,t.CheckBox=O,o(S,function(i){O.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:("boxSize"===i&&("number"==typeof t&&0<t&&(this["_"+i]=t),"auto"!==t)||(this["_"+i]=t),this)}}),b.CellTypes.ti[5]=O},"./dist/plugins/celltype/comboboxcelltype.js":function(s,t,i){"use strict";var o,G,d,B,l,M,Q,a,r,g,c,Y,P,R,W,h,I,v,u,N,f,D,w,H,V,J,F,j,A,T,b,X,y,z,C,_,K,m,p,q,$,tt,L,it,nt,x,et,S,st,ot,ct,O,rt,ut,at,lt,Mt,gt,ht,It,Nt,k,ft,Dt,dt,vt,wt,jt,i,At;function E(t,i){t.appendChild(i)}function Tt(t,i){t.removeChild(i)}function U(t){return t&&t.parentNode.parentNode.comboBox}function bt(t,i,n,e){var s=t.cellPadding,o=0,t=t.labelOptions;return(s=n?t?t.margin:"0":s)&&(o=typeof(o=parseInt(zt(s)[i],10))===V&&0<o?o:0),e===I?o:o*e}function n(t,i,n,e,s,o,c,r,u){var a,i,u,t,n,e,n,t,u,a=this;a.xG=t,a.sfe=i,a.dfe=u,i=t.firstChild,g(t).bind(f,function(t){a.NG(t)}).css([q,A,T,z,C,"overflow"],[c||0,n,e,s,o,"visible"]).attr([b],["gcComboBox"]),u=v(0,s-17),a._editable=!1,a.DG=t=l(x),a._G=n=l("textarea"),E(i,a.EG=t),yt(t),yt(n),g(n).bind("keyup",function(){var t,i,t=a.EG.value;a._text=t,i=a.jG(t),a.editorValue(i),a.OG(t,!0,i),a.RG()}).bind(D,function(){a.BG()}).bind(w,function(){a.RG()}),g(t).bind(N,function(){a.LG?a.ki(k,{isMouse:!0}):a.PG()}).bind(D,function(){a.BG()}).bind(w,function(){a.RG()}),a.GG(0,0,u,o),E(i,e=a.UG=l(x)),g(e).css([ot,J,p,K],[y,F,L,tt]).attr(b,"gcDropDownButton").bind(N,function(){var t,i;!M(a.HG)&&(t=a.HG,a.HG=I,(i=(new Date).valueOf())-t<100)||(a.LG?a.ki(k,{isMouse:!0}):a.PG())}),n=l("canvas"),a.fg=n,a.zG(u,0,s-u,o),E(e,n),E(i,t=a.VG=l(x)),a.YG=!1,a.ZG=r||s,g(t).css([J,ot,p,q,_,$,"cursor",K,C,ct],[F,"1px solid",L,c||0,y,y,"default",tt,o,a.ZG+O]),g(t).attr(b,"gcDropDownWindow").attr(X,-1),a.WG(0,+o),a.QG=0,E(t,u=a.KG=l(x)),a.JG=new d.x4(t,u),a._itemHeight=22,a.qG=20,a.$G=-1,a._editorValueType=0,a._items=[],a.eU=ft,a.iU=""}function yt(t){g(t).css(["margin","overflow","resize",J,"padding",_,p,"white-space",K,ot],[0,"hidden",y,F,ht+"px 0px 0px "+gt+O,y,L,"nowrap",tt,y]).attr(b,"gcComboBoxEditor").attr(X,-1)}function e(){var t,n,t=At.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,n=t,c(dt,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function zt(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===H&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function Z(t,i){return t.hasOwnProperty(i)}o=this&&this.__extends||(jt=function(t,i){return(jt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}jt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,G=i("Common"),d=i("Core"),B=d.CellTypes.Base,l=d.mt.En,M=G.Common.lt.ht,Q=G.Common.ft,a=d.mt,r=a.vi,g=d.GC$,c=g.each,Y=a.yt,P=a.Ct,R=a.M0,W=document,h=null,I=void 0,v=Math.max,u=parseInt,N="click",f="keydown",D="mouseover",w="mouseout",H="string",V="number",J="position",F="absolute",j="font",A="left",T="top",b="gcUIElement",X="tabindex",y="none",z="width",C="height",_="outline",K="box-sizing",m="color",p="background-color",q="z-index",$="display",tt="content-box",L="white",it="black",nt="title",x="div",et="span",S="text",st="value",ot="border",ct="min-width",O="px",rt=a.wt,(i=ut=t.EditorValueType||(t.EditorValueType={}))[i.text=0]="text",i[i.index=1]="index",i[i.value=2]="value",at=17,ht=gt=1,It=gt,Nt=18,k="EndEdit.gcEditingInput",ft="lightgrey",dt={editorValueType:Mt=0,items:h,itemHeight:22,editable:!(Dt="#1E90FF"),maxDropDownItems:lt=20,allowFloat:!0},n.prototype.getComboBox=function(){return this.xG},n.prototype.dispose=function(){var t=this;g(t.xG).unbind(f),g(t._G).unbind("keyup").unbind(D).unbind(w),g(t.DG).unbind(N).unbind(D).unbind(w),g(t.UG).unbind(N),g(t.KG).find("div").forEach(function(t){g(t).unbind(D).unbind(w).unbind(N)}),t.JG.dispose()},n.prototype.updateLocationAndSize=function(t,i,n,e,s){var o,c,o=this,c=v(0,n-17);o.GG(0,0,c,e),o.zG(c,0,n-c,e),o.WG(0,+e+(s||0))},n.prototype.updateStyle=function(t,i,n){var e=this;n=Y(n),t=t||I,g(e.EG).css(p,t).css(m,i).css(j,n),g(e.UG).css(p,t).css(m,i).css(j,n),g(e.VG).css(p,t).css(m,i).css(j,n),e.iU=i,g(e.xG).css(p,"transparent"),e.eU=Q.Tv(Q._(t),Q._(ft))?L:ft},n.prototype.updateImeMode=function(t){g(this.EG).css("ime-mode",t)},n.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},n.prototype.editorValue=function(t){var i,n,i=this;return 0===arguments.length?i.oU:(t!==i.oU&&(i.oU=t,n=i.aU(t),i.text(n),i.OG(n,!0,t)),i)},n.prototype.aU=function(t){var i,n=this,e=n._items,s=e.length,o=n._editorValueType,c,r,u;if(n.uU=!0,1===o)(i=(c=e[t])&&Z(c,S)?c.text:c)===I&&(i=t,n.uU=!1);else if(0===o){for(i=t,u=0;u<s&&!((c=e[u])&&Z(c,S)&&c.text===t||c===t);u++);s<=u&&(n.uU=!1)}else if(2===o){for(r=0;r<s;r++)if((c=e[r])&&Z(c,st)&&c.value===t){i=c.text;break}s<=r&&(i=t,n.uU=!1)}return i=M(t)?"":i},n.prototype.jG=function(t){var i,n,e,i,s,o,c,r,i=this,n=i._items,e=n.length,i=i._editorValueType,s=t;if(1===i)for(c=0;c<e;c++)((o=n[c])&&Z(o,S)&&o.text===t||o===t)&&(s=c);else if(2===i)for(r=0;r<e;r++)(o=n[r])&&Z(o,S)&&o.text===t?s=o.value:o===t&&(s=I);return s},n.prototype.OG=function(t,i,n){var e,s,o,c,r,u,a,l,s=-1;if(!M(t)&&""!==t)for(c=(o=this._items).length,e=0;e<c;e++)if(a=u=void 0,u=Z(r=o[e],S)?r.text:r,Z(r,st)&&(a=r.value),(l=i?u:u.toString().substr(0,t.length))===t){if(s=e,M(n))break;if(!M(a)&&a===n)break}this.sU(s)},n.prototype.RG=function(){g(this.EG).removeAttr(nt)},n.prototype.BG=function(){var t,i,n,e,t=this,i=t.Wt(t._text),n=g(t.EG),e;n.width()+gt<i?n.attr(nt,t._text):n.removeAttr(nt)},n.prototype.GG=function(t,i,n,e){n-=0,e-=0,g(this.EG).css(A,t).css(T,i).css(z,n-gt).css(C,e-ht)},n.prototype.editable=function(t){var i,n,e,s,o,s,i=this;return 0===arguments.length?i._editable:i._editable!==t?(i._editable=t,n=i.xG.firstChild,e=i.EG,s=g(e),o={left:u(s.css(A)),top:u(s.css(T)),width:u(s.css(z)),height:u(s.css(C))},s={backColor:s.css(p),foreColor:s.css(m),font:e.style.font},Tt(n,e),i.EG=t?i._G:i.DG,E(n,i.EG),g(i.EG).css(p,s.backColor).css(m,s.foreColor).css(j,s.font),i.GG(o.left,o.top,o.width,o.height),i):void 0},n.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},n.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},n.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},n.prototype.zG=function(t,i,n,e){var s,o,s,t,i;n-=0,e-=0,o=(s=this).fg,g(s.UG).css(A,t).css(T,i).css(z,n).css(C,e),g(o).attr(z,n).attr(C,e),s=o.width,t=o.height,(i=o.getContext("2d"))&&(i.beginPath(),i.lineWidth=2,i.fillStyle=it,i.moveTo(s-17+4,(t-2)/2-2.5),i.lineTo(s-17+7,(t-2)/2+3.5),i.lineTo(s-17+10,(t-2)/2-2.5),i.fill())},n.prototype.showDropDownList=function(){var i=this,t=i.JG;i.YG=!0,g(i.VG).bind(f,function(t){i.NG(t)}).show(),i.cU=!1,i.fU(),this.adjustPosition(),i.cU&&t.pS(g(i.KG.children).height()),t.w4(!1),i.lU(Dt,L),i.hU(i.$G),i.focus()},n.prototype.adjustPosition=function(){var t,i,n,e,s,o,c,r,u,a,l,a,M,M,M,a,t=this,i=g(t.VG);i&&(n=parseInt(i.css("left"),10),e=parseInt(i.css("top"),10),s=i.width(),o=i.height(),isNaN(n)||isNaN(e)||isNaN(s)||isNaN(o)||(r=c=0,!(u=.8)!==this.dfe?(l=(a=W.documentElement).clientWidth,a=a.clientHeight,M=i[0].getBoundingClientRect(),a<o&&(i.css("max-height",Math.round(.8*a)+O),o=Math.round(.8*a)),l<s&&(i.css("max-width",Math.round(.8*l)+O),s=Math.round(.8*l)),M.left+s>l&&(r=M.left+s-l),M.top+o>a&&(c=M.top+o-a)):(a=(M=t.sfe).clientHeight,l=M.clientWidth,a<o&&(o=Math.round(.8*a),i.css("max-height",o+O)),l<s&&(s=Math.round(.8*l),i.css("max-width",s+O)),M=i[0].getBoundingClientRect(),a=t.sfe.getBoundingClientRect(),c=v(0,M.bottom-a.bottom),r=v(0,M.right-a.right)),(n<0||e<0||0<c||0<r)&&((n-=r)<0&&(n-=22),i.css({left:n+O,top:(e-=c+5)+O}))))},n.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===A?g(n).css({left:(+g(n).css(A).replace(O,"")||0)-i}):t===T&&g(n).css({top:(+g(n).css(T).replace(O,"")||0)-i})},n.prototype.closeDropDownList=function(){var t=this;t.YG=!1,g(t.VG).unbind(f).hide(),t.lU("",t.iU),t.focus()},n.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},n.prototype.listHeight=function(t){var i=this,n=g(i.VG);if(0===arguments.length)return n.height();0<t&&(n.height(t),i.JG.w4(!1))},n.prototype.WG=function(t,i){g(this.VG).css(A,t).css(T,i)},n.prototype.items=function(t){var i,n,e,s,o,c,i=this;if(0===arguments.length)return i._items;if(t){for(i._items=t,n=i.KG,e=void 0,g(n).find("div").forEach(function(t){g(t).unbind(D).unbind(w).unbind(N)}),e=n.firstChild;e;)Tt(n,e),e=n.firstChild;for(s=i.QG=0,o=t.length;s<o;s++)c=t[s],i.dU(Z(c,S)?c.text:c);return i}},n.prototype.dU=function(t){var i,n,e,i=this,n=l(x),e=l(et);e.textContent=t.toString(),e.style.padding="0 18px 0 "+It+O,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",E(n,e),E(i.KG,n),i.QG++,g(n).bind(N,function(){var t=g(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(k,{isMouse:!0})}).bind(D,function(){var t=g(n);n.oldBackColor=t.css(p),t.css(p,i.eU)}).bind(w,function(){g(n).css(p,n.oldBackColor||"")}).css(ct,i.ZG+"px")},n.prototype.vU=function(){var t=this;t.S5=l(et),g(t.S5).css([$,j],[y,t.VG.style.font]).appendTo(W.body)},n.prototype.mU=function(){Tt(W.body,this.S5)},n.prototype.Mt=function(t){return this.S5.textContent=t,g(this.S5).width()+2+It},n.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&g(n.KG.children[e]).css([p,m],[t,i])},n.prototype.NG=function(t){var i,n,e,s,o,c,i=this,n=t.keyCode,e=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===e||39===e)&&9!==e&&i.editable()||(s=i.QG,o=i.$G,c=0,38===e||40===e?(0<=(c=0<=o&&o<s?o+(38===e?-1:1):c)&&c<s&&i.selectedIndex(c),i.YG&&i.hU(c),r(t)):13===e||37===e||39===e||9===e?(i.selectedIndex(i.$G),(i.YG||i.editable())&&i.closeDropDownList(),i.ki(k,{keyCode:n,shiftKey:t.shiftKey}),(i.YG||i.editable())&&r(t)):27===e?(i.closeDropDownList(),i.ki(k,{keyCode:n}),r(t)):i.editable()||32!==e||r(t))},n.prototype.getSelectedValue=function(t,i,n){var i,e,i=i[t];return M(i)||(1===n?e=t:0===n?e=Z(i,S)?i.text:i:2===n&&Z(i,st)&&(e=i.value)),e},n.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(Dt,L),i.hU(t)},n.prototype.selectedIndex=function(t){var i,t,i=this;if(0===arguments.length)return i.$G;0<=t&&t<i.QG&&(i.sU(t),t=i.getSelectedValue(i.$G,i._items,i._editorValueType),M(t)||i.editorValue(t))},n.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},n.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},n.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},n.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},n.prototype.fU=function(){var t,i,i,n,e,s,t=this;t.vU(),i=t._items[0],i=v(t._itemHeight,g(t.S5).text(M(i)?"":i).height()),g(t.KG.children).css(C,i),(e=t.QG)<=(s=t.qG)?n=e*i:(n=s*i,t.cU=!0),t.listHeight(n),t.mU()},n.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},n.prototype.bind=function(t,i,n){g(this.xG).bind(t,i,n)},n.prototype.unbind=function(t,i){g(this.xG).unbind(t,i)},n.prototype.ki=function(t,i){g(this.xG).trigger(t,i)},vt=n,o(e,At=B),e.prototype.isReservedKey=function(t,i){return this.rU},e.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,a,l,M,g,h,g,h,I,N,f,D,I,N,f,I,N,u=this,a=r.sheet,a=a.zoom?a.zoom():1,l=17,M=v(0,s-17-1);3===c.hAlign&&(c.hAlign=0),c.wordWrap&&(c.wordWrap=!1),g=r.isPrinting,h=r.printZoomFactor,g&&"number"==typeof h&&1!==h&&(a=h),0<M&&0<o&&(g={},h=void 0,r.quotePrefix=c.quotePrefix,I=c.formatter&&"General"!==c.formatter,N=c._autoFormatter&&c._autoFormatter.formatCached&&"General"!==c._autoFormatter.formatCached,f=void 0,D=this.getItemValue(i),f=I?c.formatter:N?c._autoFormatter:d.CellTypes.Context.Nt(t,D,M+1,c,a),h=this.format(rt(i),f,g,r),h=(I=u.getText(i,r))!==i?h||(i=I):h)&&(N=new d.Rect(n,e,s,o),At.prototype.adjustRectForIconSet.call(this,c.hAlign,r.sheet,r.row,r.col,r.sheetArea,N,g.content&&At.prototype.hasInfilling.call(this,g.content)),n=N.x,s=N.width,f=c.isVerticalText,P(D)&&!f&&!0!==c.shrinkToFit&&(h!==(I=d.CellTypes.Context.Et(t,h,M+1,c,a))&&(delete g.content,c.textIndent=0),h=I),N=u.Pn(t,h,c,r,n,e,s,o),this.paintText(t,i,n,e,M,o,c,r,h,g,void 0,N.externals)),t.save(),(s<17||o<17)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=it,t.moveTo(n+s-17+3,e+(o-2)/2-2.5),t.lineTo(n+s-17+6,e+(o-2)/2+3.5),t.lineTo(n+s-17+9,e+(o-2)/2-2.5),t.fill(),t.restore()},e.prototype.getText=function(t,i){return t},e.prototype.createEditorElement=function(t,i){var n,e,e,e,s,o,c,r,c,u,u,t,n=t&&t.sheet,e=n&&n.parent,e=e&&e.Ti,e=a.gi(e)+1e3,s=n.defaults,o=this,c=n.getActualStyle(t.row,t.col).cellPadding,r=0;return c&&(r=parseFloat(zt(c)[3])||0),c=0,c=(u=n.getSpan(t.row,t.col))?R(n,u.col,u.col+u.colCount,!1):n.nn(t.col)-r,(u=new vt(i,n.qc(),0,0,s.colWidth,s.rowHeight,e,c)).editorValueType(o._editorValueType),u.items(o._items),u.itemHeight(o._itemHeight),u.itemCountPerPage(o._maxDropDownItems),u.editable(o._editable),u.allowFloat(o.allowFloat()),t=u.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=u,h},e.prototype.getEditorValue=function(t,i){var t=U(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},e.prototype.setEditorValue=function(t,i,n){var t=U(t);t&&t.editorValue(i)},e.prototype.focus=function(t,i){var t=U(t);t&&t.focus()},e.prototype.selectAll=function(t,i){var t=U(t);t&&t.selectAll()},e.prototype.activateEditor=function(t,i,n,e){var s,u,a,s=this,u=e.sheet,a=U(t);a&&(a.editorValueType(s._editorValueType),a.items(s._items),a.itemHeight(s._itemHeight),a.itemCountPerPage(s._maxDropDownItems),a.editable(s._editable),a.bind(k,function(t,i){var n,e,s,n,o,c,r,n=i.keyCode,e=i.shiftKey;if(n){if(n=(s=u.Qy()).getShortcutKey(n,!1,e||!1,!1,!1),o=s.getCommands(n))for(c=0,r=o.length;c<r;c++)if("navigationLeft"!==o[c].Zc&&"navigationRight"!==o[c].Zc||(u.Di=1),o[c].execute(u.parent,{sheetName:u.name()}))return!0}else i.isMouse&&a.LG&&u.endEdit()})),s.rU=!0},e.prototype.deactivateEditor=function(t,i){var n,e,s,o,c,r;if(t&&(n=U(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(s=[A,T],o=[3,0],c=0;c<s.length;c++)r=typeof(r=parseInt(zt(e)[o[c]],10))===V&&0<r?r:0,n.shiftPadding(s[c],r);n.unbind(k),n.closeDropDownList(),n.LG=!1}this.rU=!1},e.prototype.updateImeMode=function(t,i){var t;this.isImeAware()&&(t=U(t))&&t.updateImeMode(i)},e.prototype.updateEditor=function(t,i,n,e){var s,t,s,s,o,s=t&&e&&e.sheet;s&&(t=U(t),i&&t&&(s=s.Dn,t.updateStyle(i.backColor,i.foreColor||it,s._n(i.font||s.Nn()))),n)&&t&&(s=0,i&&e&&e.sheet&&e.sheet.NMi&&(s=bt(i,0,!1,o=e.sheet.zoom())),t.updateLocationAndSize(n.x,n.y,n.width,n.height,s))},e.prototype.format=function(t,i,n,e){var s,t;return M(t)?"":(t=(s=this).getItemValue(t),B.prototype.format.call(s,t,i,n))},e.prototype.getItemValue=function(t){var i,n,e,s,o,c,i,r,i=this,n=i._editorValueType,e=i._items;if(e)if(c=e.length,1===n){if(0<=(i=u(t))&&i<c&&(s=e[i])!==I&&s!==h)return o=Z(s,S)?s.text:s}else if(2===n)for(r=0;r<c;r++)if((s=e[r])&&Z(s,st)&&s.value===t)return o=s.text;return t},e.prototype.parse=function(t,i,n){var e,s,o,c,r,u,a,e=this,s=e._editorValueType,o=e._items,u=B.prototype.parse.call(e,t,i);if(o){if(a=o.length,0===s)return u;if(1===s){for(r=0;r<a;r++)if((c=o[r])&&Z(c,S)&&c.text===u||c===u)return r}else if(2===s)for(r=0;r<a;r++)if((c=o[r])&&Z(c,S)&&c.text===u)return c.value}return u},e.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,r,r,i;return s&&(o=s.sheetArea,c=s.sheet,M(o)||3===o)&&e&&(r=zt(n.cellPadding),r=parseInt(r[1],10)||0,r=e.x+e.width-r,i={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,sheet:c},r-17<=t)&&t<r?(i.isReservedLocation=!0,i):h},e.prototype.processMouseDown=function(t){var i,n,n,i=t.sheet,n=t.sheetArea;(M(n)||3===n)&&t.isReservedLocation&&i&&(t.row===i.ui&&t.col===i.ci||i.setActiveCell(t.row,t.col),i.startEdit(),n=U(i.li))&&(a.Tt.mozilla&&(n.HG=(new Date).valueOf()),n.showDropDownList(),n.LG=!0)},e.prototype.getAutoFitWidth=function(t,i,n,e,s){var o;return n&&n.wordWrap&&(n.wordWrap=!1),d.CellTypes.Context.Bt(t,i,n,e,s)+17},e.prototype.getAutoFitHeight=function(t,i,n,e,s){return n&&n.wordWrap&&(n.wordWrap=!1),d.CellTypes.Context.tn(t,i,n,e,s)},e.prototype.isImeAware=function(t){return!0},e.prototype.lfe=function(t,i){var i=At.prototype.lfe.call(this,t,i);return t.readonly||this._editable||(i.readonly=!0),i},e.prototype.Ke=function(){},e.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&ut[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},e.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return c(dt,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]=o)}),s},e.prototype.fromJSON=function(n){var e=this;c(dt,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},wt=e,t.ComboBox=wt,c(dt,function(i){wt.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),d.CellTypes.ti[7]=wt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,l){"use strict";var n,e,s,M,o,o,g,u,o,h,I,s,c,a;function N(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function r(t){return N(t)?f(t,""):[]}function f(t,i){for(var n,e,s,o,c,r,u,a,n=[],e,s=0,o=Object.keys(t);s<o.length;s++)c=o[s],u=i?i+"."+c:c,"function"!=typeof(r=t[c])&&(N(r)?(a=f(r,u),n.push({text:c,value:r,path:u,layout:{displayAs:M.LayoutDisplayAs.popup},items:a})):n.push({text:c,value:r,path:u}));return n}function D(t){var i=a.call(this)||this;return i.typeName="18",i.pU=t,i}n=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=l("CalcEngine"),s=l("Common"),M=l("Core"),o=l("./dist/plugins/celltype/celltypes.ns.js"),o=new s.Common.ResourceManager(o.SR,"CellTypes"),g=o.getResource.bind(o),u="vc",o=M.CellTypes.Text,h=s.Common.lt.ht,I=void 0,n(D,a=o),D.prototype.Xe=function(t,i,n,e,s){var o=t.Z_(i,n,s,!0);o||((o=new M.Style).cellType=this),t.Ut.do("setStyle",i,n,o,s)},D.prototype.qe=function(u,a,t,i,n){var e,n,e,n=r(u.getValue(a,t,n));0<n.length?(i.formatter=this.pU,i.cellButtons=[{command:"openList",imageType:M.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],i.dropDowns=[{type:M.DropDownType.list,option:{items:n,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,i,n){for(var e,s,o,c,r,e=l("SheetsCalc"),s=n.sheetArea,o=n.col+1;o<t.getColumnCount(s);o++){if(t.isActualProtected()&&t.getCell(n.row,o,s).locked()){t.jT(16,g().DataObject_MeetLock);break}if(t.Ut.findSpan(n.row,o,s)){t.jT(16,g().DataObject_MeetSpan);break}if(3===s&&t.tables&&t.tables.find(n.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(n.row,o)){t.jT(16,g().DataObject_MeetTable);break}if(h(t.getValue(n.row,o,s))){c=e.rangesToFormula([new M.Range(n.row,n.col,1,1)],a,o,15,1===u.parent.options.referenceStyle),r=n.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:n.row,col:o,sheetArea:s,newValue:"="+c+'."'+r+'"',autoFormat:!1});break}}}}]):(i.cellButtons=I,i.dropDowns=I),i.formatter&&M.util.St(i.formatter)&&u.SL(a,t,i.formatter)},D.prototype.paint=function(t,i,n,e,s,o,c,r){this.pU!==c.formatter||this.bU?(this.Xe(r.sheet,r.row,r.col,i,r.sheetArea),this.bU=!1):r.sheet.Ut.W_(r.sheetArea).getValueForKey(r.row,r.col,u)&&(this.Xe(r.sheet,r.row,r.col,i,r.sheetArea),r.sheet.Ut.W_(r.sheetArea).setValueForKey(r.row,r.col,u,I)),a.prototype.paint.call(this,t,i,n,e,s,o,c,r)},D.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},D.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i.DataObject=s=D,M.CellTypes.ti[18]=s},"./dist/plugins/celltype/dropdown-action.js":function(a,t,i){"use strict";var T,b,y,z,C,m,p,f,L,t,D,x,S,O,e,s,o,k,i,d,E,U,Z,G,B,Q,Y,P,R,n,c,v,r;function W(t,i){return n.createElement(t,i)}function u(A){return{canUndo:!1,execute:function(t,i,n){var e,t,s,o,c,r,u,a,l,M,g,h,I,l,N,f,D,d,v,l,M,t,w,s,j,l,M,e=(0,T._f)(t,i.sheetName);if(!e||t.jg().name()!==i.sheetName)return!1;if(t=i.row,s=i.col,(O(t)||O(s))&&(t=e.getActiveRowIndex(),s=e.getActiveColumnIndex()),o=i.sheetArea,O(o)&&(o=3),t<0||t>=e.getRowCount(o)||s<0||s>=e.getColumnCount(o))return!1;if(e.showCell(t,s,T.VerticalPosition.nearest,T.HorizontalPosition.nearest),u=e.getCellRect(t,s,c=1===o?-1:void 0,r=2===o?-1:void 0),e.parent&&!e.parent.options.scrollByPixel&&!e.isEditing()){if(0<(a=e.frozenColumnCount())&&a<(l=e.getViewportLeftColumn(1))&&(M=e.getSpan(t,s,o))&&M.col<=l&&l<M.col+M.colCount&&0<(g=l-a))for(h=0;h<g;h++)u.width=u.width-e.getColumnWidth(a+h+1,o);if(0<(I=e.frozenRowCount())&&I<(l=e.getViewportTopRow(1))&&(M=e.getSpan(t,s,o))&&M.row<=l&&0<(N=(l<M.row+M.rowCount?l:M.rowCount)-I))for(h=0;h<N;h++)u.height=u.height-e.getRowHeight(I+h+1,o)}switch(f=W("div"),D=V(e,t,s,o),(O(i.row)||O(i.col))&&(i.row=e.getActiveRowIndex(),i.col=e.getActiveColumnIndex()),l=i.row,M=i.col,t=e.Il(l,M,o),w=J(A),(l=(s=t.dropDowns)&&0<s.length)&&(M=s.filter(function(t){return t.type===w})[0])&&(void 0!==M.option&&null!==M.option&&(v=M.option),j=M),A){case E:d=new p.ColorPicker(f);break;case U:d=v&&v.showDateRange?(D=H(D,"dateRange"),new L.RangeCalendar(f,v)):(D=H(D,"date"),new L.Calendar(f));break;case Z:D=H(D,"date"),d=new C.TimePicker(f);break;case G:D=(D=H(D,"number")).toString(),d=new b.Calculator(f);break;case B:D=H(D,"date"),d=new m.MonthPicker(f);break;case Q:(d=new y.List(f)).formula=e.getFormula(i.row,i.col);break;case Y:D=v&&v.showNumberRange?H(D,"numberRange"):H(D,"number"),d=new z.Slider(f);break;case P:d=new x.WorkFlow(f),"string"!=typeof D&&D!==k&&(D=D.toString());break;case R:d=new S.MultiColumn(f,k,e)}return F(d,D,u,e,i,t,l,j,v),!0}}}function V(t,i,n,e){var s,o;return t.isEditing()?(s=t.getCellType(i,n)).getEditorValue(t.li,o={sheet:t,row:i,col:n,sheetArea:e}):t.getValue(i,n,e)}function H(t,i){var i,n;return"date"===i?"string"==typeof t?(t=s.yU(t))===k&&(t=new Date):t instanceof Date||(t=new Date):"dateRange"===i?t&&"object"==typeof t&&(t={start:o(t.start),end:o(t.end)}):"number"===i?"string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0):"numberRange"===i&&(n=i=0,t&&"object"==typeof t&&("string"===t.start?i=e.yU(t.start):isNaN(t.start)||(i=t.start),"string"===t.end?n=e.yU(t.end):isNaN(t.end)||(n=t.end)),t={start:i,end:n}),t}function w(t,i,n,e){var s,o,c,r,n,i,r,c,u,a,s=n.row,o=n.col;(O(s)||O(o))&&(s=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),c=n.sheetArea,O(c)&&(c=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:s,col:o,newValue:e.value}):"function"==typeof i.submitCommand&&((r={}).row=n.row,r.col=n.col,r.sheetArea=c,r.path=e.path,i.submitCommand.call(null,t,e.value,r)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:s,col:o,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:c,isUndo:!1}),t.ci===o&&t.ui===s&&(n=t.getCellType(s,o),i={sheet:t,row:s,col:o,sheetArea:T.SheetArea.viewport},r=n.isImeAware(i),t.isEditing()?(c=t.Il(s,o,c),u=t.getCellRect(s,o),t.li.Li=e.value,a=n.je(t.li,c,e.value,i),n.updateEditor(t.li,c,u,i),n.setEditorValue(t.li,a||e.text,i)):r&&t.rt.ATe(n,s,o,e.text)))}function J(t){var i=-1;switch(t){case E:i=T.DropDownType.colorPicker;break;case U:i=T.DropDownType.dateTimePicker;break;case Z:i=T.DropDownType.timePicker;break;case G:i=T.DropDownType.calculator;break;case B:i=T.DropDownType.monthPicker;break;case Q:i=T.DropDownType.list;break;case Y:i=T.DropDownType.slider;break;case P:i=T.DropDownType.workflowList;break;case R:i=T.DropDownType.multiColumn}return i}function j(t,i,n,e,s){var i,i,i=i.cellButtons;t&&i&&0<i.length&&(i=t.Ut.getValueForKey(n,e,c,s))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function F(i,t,n,e,s,o,c,r,u){var a,l,M,g,h,u,t,u,I,I,t,u,n,N;d.ef(),a=e.parent,l=e.qc(),M=s.row,g=s.col,h=s.sheetArea,u&&(u.row=M,u.col=g),i.setOptions(u),i.setValue(t),u=l.getBoundingClientRect(),t=n.x+u.left,u=n.y+u.top,(I=A(a))&&(t+=I.x,u+=I.y),I=new f.Rectangle(t,u,n.width,n.height),u=(t=i.getOptions())&&!O(t.dropDownAlignment)?t.dropDownAlignment:T.DropDownAlignment.Far,n=t&&!O(t.dropDownDirection)?t.dropDownDirection:void 0,N=new f.PopupControl(i.getContainer(),I,{align:u,hostElement:l,direction:n}),v+=1,c&&i.wU(),N.open(),i.scrollToSelect(),c&&i.refresh(),i.on(D.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||N.close(),X(s,t)&&w(e,r,s,t)}),a&&(a.CC=a.CC||[],a.CC.push(N)),i.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),N.on("close",function(){j(e,o,M,g,h),i&&i.dispose(),--v,N=null;var t=a.CC.indexOf(N);a.CC.splice(t,1),d.cf()})}function A(t){var i,n,e,s;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},s=t.w2.ot(),n){case 1:e.y=s.height;break;case 2:e.x=s.width}return e}}function X(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==G||!isNaN(i.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,T=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return T.Commands}}),b=i("./dist/plugins/celltype/editor/calculator.js"),y=i("./dist/plugins/celltype/editor/listControl.js"),z=i("./dist/plugins/celltype/editor/slider.js"),C=i("./dist/plugins/celltype/editor/timepicker.js"),m=i("./dist/plugins/celltype/editor/monthPicker.js"),p=i("./dist/plugins/celltype/editor/colorpicker.js"),f=i("./dist/plugins/celltype/editor/popupControl.js"),L=i("./dist/plugins/celltype/editor/calendar.js"),t=i("Common"),D=i("./dist/plugins/celltype/editor/baseControl.js"),x=i("./dist/plugins/celltype/editor/workflowPicker.js"),S=i("./dist/plugins/celltype/editor/multiColumnPicker.js"),O=t.Common.lt.ht,e=t.Common.st,s=t.Common.ct,o=T.mt.Eve,k=null,i=window,d=i.gcGlobal,E="openColorPicker",U="openDateTimePicker",Z="openTimePicker",G="openCalculator",B="openMonthPicker",Q="openList",Y="openSlider",P="openWorkflowList",R="openMultiColumn",n=document,c="_cellButtonParam",T.Commands[E]=u(E),T.Commands[U]=u(U),T.Commands[Z]=u(Z),T.Commands[G]=u(G),T.Commands[B]=u(B),T.Commands[Q]=u(Q),T.Commands[Y]=u(Y),T.Commands[P]=u(P),T.Commands[R]=u(R),v=0,T.Workbook.ch("registerOpendropdownCommand",r={init:function(){this.commandManager().register(E,T.Commands[E]),this.commandManager().register(U,T.Commands[U]),this.commandManager().register(Z,T.Commands[Z]),this.commandManager().register(G,T.Commands[G]),this.commandManager().register(B,T.Commands[B]),this.commandManager().register(Q,T.Commands[Q]),this.commandManager().register(Y,T.Commands[Y]),this.commandManager().register(P,T.Commands[P]),this.commandManager().register(R,T.Commands[R])}}),T.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<v&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){"use strict";var e,n,s,o,c,r,u;function a(t){var i=r.call(this)||this;return i.Wc=t,i}function l(t){var i=u.call(this)||this;return i.Ti=t,i}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,n=n("./dist/plugins/celltype/editor/eventbase.js"),r=n.EventBase,e(a,r),a.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},a.prototype.GetContainer=function(){return this.Wc},a.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},a.prototype.CreateElement=function(t,i,n,e){var s,o,s=document.createElement(t);if(i&&(s.className=i),n)for(o in n)n[o]&&s.setAttribute(o,n[o]);return e&&e.appendChild(s),s},i.BaseControl=a,u=n.EventBase,e(l,u),l.prototype.getOptions=function(){return this.MU},l.prototype.updateStyle=function(t,i,n){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this.Ti},l.prototype.refresh=function(){},l.prototype.wU=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",i.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){"use strict";var e,s,u,n,M,g,h,o,c,I,N,f,r,a,l;function D(t,i,n){var t=l.call(this,t)||this;return t.setOptions(i),t.CU=n,t}function d(t,i,n){var e={sheet:t};M(n)||(e.isEsc=n),t.ki(i,e)}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("Core"),n=n("Common"),M=n.Common.lt.ht,g=Math.min,h=Math.max,o=null,c=".baseSpreadNS",I=800,N=400,f=100,l=s.BaseDropdown,e(D,l),D.prototype.setOptions=function(t){var i,t,i,i=this;(i.MU=t)&&(t=i.Ti,(i=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(i),this.SU=i,this.TU=this.AU(i))},D.prototype.setValue=function(t){var i,n,i=this;i.MU&&(n=i.TU,setTimeout(function(){var t;window.gcGlobal.cf(),n&&n.focus(!0)},1e3))},D.prototype.wU=function(){var t,i,n,e,s,n,t=this;t.SU&&(i=t.Ti,(n=t.MU)&&(e=n.width,s=n.height),n=t.IU(e,s),M(e)&&(e=n.width),M(s)&&(s=n.height),(0,u.GC$)(i).width(e).height(s))},D.prototype.refresh=function(){this.TU&&this.TU.refresh()},D.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=o),t.SU&&(t.SU=o),t.TU&&(t.TU.unbind(u.Events.DropdownSpreadMouseClick+c),t.TU.unbind(u.Events.DropdownSpreadKeyboardEnter+c),t.TU.L0(),t.TU=o)},D.prototype.IU=function(t,i){for(var n,e,s,o,c,r,u,a,a,t,t,i,l,n,e=this.TU,s=e.getActiveSheet(),o=s.getColumnCount(),c=0,r=0;r<o;r++)c+=s.getColumnWidth(r,3);return u=c,a=s.getRowCount(3)+s.getRowCount(1),a=s.getRowHeight(0,3)*a,u<I&&M(t)||u<=t?e.options.showHorizontalScrollbar=!1:(t=0,a+=t=e.zb?e.zb.ZC():t),a<N&&M(i)||a<i?e.options.showVerticalScrollbar=!1:(t=0,u+=t=(i=e.Xb)?(l=i.lS(!1))||e.NC():t),{width:g(u,I),height:g(h(a,f),N)}},D.prototype.AU=function(t){var t,i,n,e,t=new u.Workbook(t,{sheetCount:1});return t.xU=!0,(i=t.options).allowUserDragDrop=!1,i.allowDragHeaderToMove=u.AllowDragHeaderToMove.none,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=t.getActiveSheet()).RD=!0,e=this,t.bind(u.Events.DropdownSpreadMouseClick+c,function(t,i){e.submitData(i)}),t.bind(u.Events.DropdownSpreadKeyboardEnter+c,function(t,i){e.submitData(i)}),t},D.prototype.submitData=function(t){},i.BaseSpreadPicker=D,u.GC$.extend(u.Worksheet.prototype,{BD:function(){d(this,u.Events.DropdownSpreadMouseClick)},GD:function(t){d(this,u.Events.DropdownSpreadKeyboardEnter,t)},Lpe:function(t,i,n){var r,e,e,r=this,e=r.Rpe(),e=e&&e[t]&&e[t][i];e&&(r.suspendPaint(),e.forEach(function(t){var i,n,e,s,o,c,s,o,i=t.row,n=t.col,e=t.dataSource,s=t.dependSheetName,o=t.targetSheetName;s===r.name()&&(s=(s=(c=r.getParent()).Gm(o))._gi===u.SheetType.reportSheet&&s.getSheet?s.getSheet():s)&&(o=s.getStyle(i,n))&&o.dropDowns&&o.dropDowns.some(function(t){return t.type===u.DropDownType.multiColumn&&t.option.dataSource===e})&&s.YI(t.row,t.col,null)}),r.resumePaint())},Rpe:function(){var t,i,t=this,i=t.Fpe;return i=i||(t.Fpe=[])}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){"use strict";var e,o,s,c,r,n,u,a,l,M,g,h,I,N,f,D,d,v,w,j,A,T;function b(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function y(){}function z(){}function C(){}function m(t,i,n,e,s,o,c,r,u,a,l){var M=this;M.Y6=t,M._x=i,M._y=n,M.NU=e,M.kU=s,M.DU=o,M._U=c,M.EU=r,M.jU=u,M.OU=a,M.RU=l,M.BU=f}function p(t){var i,n,e,i=T.call(this,t)||this,n=i;return n.Ti=document.createElement("div"),n.Ti.classList.add("gc-calculator-container"),n.Ti.innerHTML=a,(e=n.Ti.querySelector(".okbtn")).textContent=u().OK,t.appendChild(i.Ti),n.LU(),n.FU(),n.PU(),n.GU(),n.UU("0"),i}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,o=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),c=n("Common"),r=n("Core"),n=new c.Common.ResourceManager(s.SR,"CellTypes"),u=n.getResource.bind(n),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,M=Math.abs,g=Math.pow,h=Math.round,I=Math.sqrt,N=Math.max,f=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),y.Init=function(){var t;y.GetBrowserType(),y.IsIE=void 0!==y.ie||void 0!==y.edge},y.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?y.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?y.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(y.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(y.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(D=y).Init(),z.IsErrorText=function(t){return t===u().Calculator_DivideByZeroInfo||t===u().Calculator_InvalidInputInfo||t===u().Calculator_SqrtParameterException||t===u().Calculator_OverFlowInfo},d=z,i.CalculatorErrorInfo=d,C.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},C.GetDotPosition=function(t){var i,n,e,i=t+"",n=0,e=0;for(e=i.length;0<e;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},C.FormatOutput=function(t){var i,n,e;if(null==t)return null;if(n=0,e=(i=t+"").length,C.IsDotContained(i))for(;"0"===i.substring(e-1,e)&&""!==i&&-1===i.indexOf("e");)i=i.substring(0,e-1),e--;return i},C.FormatResult=function(t){var i,n,t,e,s,o,s,i=(t=isNaN(t)?0:t)+"",n="";return t<0&&(n="-",i=i.substring(1,i.length)),t=i.length,e="",-1!==(s=i.indexOf("e"))&&(e=i.substring(s,t),t=(i=i.substring(0,s)).length),C.IsDotContained(i)&&16<t&&(o=0,i=1<parseFloat(i)?(o=C.GetDotPosition(i)-(t-16),i.toString().substring(0,17)):(o=C.GetDotPosition(i)-(t-17),i.toString().substring(0,18)),i=(0<o?h(parseFloat(i)*g(10,o))/g(10,o):h(parseFloat(i))).toString()),t=i.length,!C.IsDotContained(i)&&15<t&&(o=t-15,i=(h(parseFloat(i)/g(10,o))*g(10,o)).toString()),i=n+i+e,s=parseFloat(i),C.IsOverFlow(s.toString())?u().Calculator_OverFlowInfo:s},C.SingleMathOperation=function(t,i){var t,i,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===i){if(t<0)return u().Calculator_InvalidInputInfo;t=I(t)}if("POW"===i&&(t=g(t,2)),"1/x"===i){if(0===t)return u().Calculator_DivideByZeroInfo;i=C.GetDotPosition(t.toString()),t=g(10,i)/(g(10,i)*t)}return C.FormatResult(t)},C.DoubleMathOperation=function(t,i,n){var t,i,e,s,o,c,t=parseFloat(t),i=parseFloat(i);if(C.IsDotContained(t.toString())||C.IsDotContained(i.toString())){if(o=s=0,C.IsDotContained(t.toString())&&(s=C.GetDotPosition(t.toString())),C.IsDotContained(i.toString())&&(o=C.GetDotPosition(i.toString())),c=N(s,o),"+"===n&&(e=((t*=g(10,c))+(i*=g(10,c)))/g(10,c)),"-"===n&&(e=((t*=g(10,c))-(i*=g(10,c)))/g(10,c)),"*"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o)),"/"===n){if(t*=g(10,c),0===(i*=g(10,c)))return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o+2))}else{if("+"===n&&(e=t+i),"-"===n&&(e=t-i),"*"===n&&(e=t*i),"/"===n){if(0===i)return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=t*i/100)}return C.FormatResult(e)},C.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},v=C,m.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},m.prototype.Click=function(t){var i,t,i=this;return 0<=t&&t<=11&&(i.OU&&(i.zU(t),i.OU=!1),i.VU(t),10!==t)&&(i.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(i.OU?(i.zU(t),i.OU=!1):(i.YU(t),i.RU="ClickMathButton")),24===t&&(i.OU&&(i.zU(t),i.OU=!1),i.ZU()),25!==t&&26!==t||(i.zU(t),i.OU=!1),i.OU?null:((t={}).outputText=i.WU(),d.IsErrorText(i.Y6)&&(i.OU=!0),t.result=void 0===i.Y6||null===i.Y6?"":i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,t)},m.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(14<i.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||v.IsDotContained(i.Y6)?""!==i.Y6&&v.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:0<=t&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},m.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=v.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),12<=t&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),d.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),d.IsErrorText(i.Y6)||(i._y=i.Y6)),12<=t&&t<=15&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),d.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),d.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},m.prototype.ZU=function(){var t,i,n,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(i=0)<(n=t.Y6.length)&&(t.Y6=t.Y6.substring(0,n-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},m.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1!==i.kU||null===i.NU||void 0===i.NU||i.jU||(i._y=0),2===i.kU)&&(i.kU=3),26===t&&i.HU()},m.prototype.WU=function(){var t,i,t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},m.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(D.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&D.firefox||187===i&&!D.firefox?19:-1}},w=m,T=o.BaseDropdown,e(p,T),p.prototype.setValue=function(t){var i,t,i=this;t=i.QU(t);try{if(!i.q8(t))throw new Error(u().Calculator_InvalidInputInfo);t=""===t?"0":t,i.Y6=i.KU(t),i._text=i.JU(t),i._x=parseFloat(i.Y6),i._y=null,i.NU=null,i.kU=0,i.DU=i.XU(parseFloat(i.Y6)),0<i.DU?i.EU=!0:i.EU=!1,i.jU=!1,i.OU=!1,i.RU=null}catch(t){i._text=u().Calculator_InvalidInputInfo,i.Y6="",i._x=null,i._y=null,i.OU=!0}return i.qU(i.OU),i.UU(i._text),(t={}).outputText=i._text,t.result=i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,i.$U=new w(i.Y6,i._x,i._y,i.NU,i.kU,i.DU,i._U,i.EU,i.jU,i.OU,i.RU),i},p.prototype.setOptions=function(){},p.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},p.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},p.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},p.prototype.PU=function(){var t=this;t.qU(t.OU)},p.prototype.GU=function(){var n,e,s,t,i,n=this,e=this,s=e.Ti,t,i=function(t){!0!==e.mf(t)&&(t.preventDefault(),t.stopPropagation())};s.addEventListener("click",function(t){for(var i,t,t,i=t.srcElement||t.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(t=i.getAttribute("data-value"),t=p.eH(t),s.focus(),-1!==t&&e.iH(t)):i.classList.contains("okbtn")&&("ClickNumericButton"===e.RU&&e.iH(19),n.fire(o.BaseDropdown.Event_ValueChanged,{value:e._text,text:e._text})))}),s.addEventListener("keydown",i),s.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},p.prototype.UU=function(t){var i,n,i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},p.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=b(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},p.prototype.oH=function(t){var i,n,e,i,s,o;return 1<t.scrollWidth-t.clientWidth||!(!r.mt.Tt.edge&&!r.mt.Tt.msie||t.clientWidth<=0)&&(n=(i=window.getComputedStyle(t)).fontWeight,e=i.fontSize,i=i.fontFamily,(o=r.q.Wt(t.value,s=n+" "+e+" "+i))+40>t.clientWidth)},p.prototype.aH=function(t){var i=b(t);t.style.fontSize="".concat(i-1,"px")},p.prototype.uH=function(t){for(var i,n,i=this,n=b(t);!i.oH(t)&&n<i.rH;)if(t.style.fontSize="".concat(++n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},p.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},p.prototype.sH=function(t,i){var n,e,s,o;if(0===i.length)return"";for(n="",s=e=0;e<i.length;e++){for(o=!1,s=0;s<t.length;s++)i.substring(e,e+1)===t.substring(s,s+1)&&(o=!0);!0===o&&(n+=i.substring(e,e+1))}return n},p.prototype.q8=function(t){var i;return this.sH("-.0123456789",t)===t&&(-1===(i=t.indexOf("-"))||0===i)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},p.prototype.KU=function(t){var t,i,t,n,e,s,o,t=parseFloat(t),i=t<0?!0:!1,t=M(t),n=l(t),e=v.GetDotPosition(t.toString()),s=(t*g(10,e)-n*g(10,e))/g(10,e);if(999999999999999<n)throw new Error(u().Calculator_InvalidInputInfo);return 999999999999999!==n?(o=0===n?15:15-n.toString().length,s=h(s*g(10,o))/g(10,o),e=v.GetDotPosition(s.toString()),t=(n*g(10,e)+s*g(10,e))/g(10,e),n=l(t),e=v.GetDotPosition(t.toString()),0===(s=(t*g(10,e)-n*g(10,e))/g(10,e))&&(t=n),i?"-"+t:""+t):0===s?n:void 0},p.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},p.prototype.XU=function(t){var t,i,n,t,e,s,t=M(t),i=l(t),n=v.GetDotPosition(t.toString()),t=(t*g(10,n)-i*g(10,n))/g(10,n),e,s;return(0===i?0:i.toString().length)+(0==t?0:n)},p.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},p.prototype.cH=function(t,i){var t,t,t=f[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(i?t.classList.add("disabled"):t.classList.remove("disabled"))},p.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},p.prototype.iH=function(t){var i,t,i=this,t=i.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(i.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(i.nH=t.outputText,i._text=i.nH,i.UU(i.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==i.OU&&(i.OU=t.isOperationInvalid,i.qU(i.OU)),t.memoryNumber!==i._U&&(i._U=t.memoryNumber),t.lastOperation!==i.RU)&&(i.RU=t.lastOperation)},p.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},i.Calculator=p},"./dist/plugins/celltype/editor/calendar.js":function(U,t,i){"use strict";var n,Z,G,o,e,c,r,i,N,e,u,B,a,Q,Y,P,R,W,H,V,J,F,X,l,f,_,K,q,$,tt,it,nt,et,st,D,d,M,g,ot,h,I,ct,s,rt,ut,v,w,at,j,A,T,lt,Mt,gt,ht,It,Nt,ft,Dt,dt,vt,wt,jt,At,b,Tt,y,bt,yt,zt,Ct,z,mt,C,m,pt,Lt,xt,St,p,Ot,kt,Et,Ut,Zt,Gt,Bt,Qt,i,Yt,Pt,Rt;function L(t){return B.createElement(t)}function Wt(){}function Ht(){this.yearTds=[]}function Vt(){this.monthTds=[]}function Jt(){this.weekThs=[],this.dayTds=[]}function Ft(){this.calendarYearSection=new pt,this.calendarMonthSection=new Lt,this.calendarDaySection=new xt,this.timeItemLIs=[]}function x(){}function Xt(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function _t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function Kt(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function S(t){this.owner=t,this.calendarPage=r.CalendarPage.month,this.oldSelectedData=null,this.S1e=null,this.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},this.selectedDate=new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,m.initResource()}function O(t){var i=Yt.call(this)||this;return i.fH=40,i.lH=100,i.hH=!1,i.jS=t,i}function k(t,i,n,e){var s=Pt.call(this,t)||this;return s.dH=7,s.HG=!0,n&&(s.parent=n,s.A1e=!0,s.HG=!1,s.N1e=e),s._data=new Ut(s),s.Dn=new Zt(s),s.Dn.on(o.BaseDropdown.Event_ValueChanged,function(t){var i,i,i=c.Common.CultureManager.getCultureInfo().DateTimeFormat,i=new c.Formatter.GeneralFormatter(i.defaultDatePattern).format(t.newValue);s.fire(o.BaseDropdown.Event_ValueChanged,{text:i,value:t.newValue})}),s.Dn.on(Zt.Event_GetHost,function(t){t.host=s.Ti}),s.A1e||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.A1e||s.setValue(new Date),s.Dn.showCalendarPage(r.CalendarPage.day),s.Dn.setCalendarActivePart(C.Date),i&&s.setOptions(i),s}function E(t,i){var t=Rt.call(this,t)||this;return t.D1e=0,t.S1e=null,t.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},t._1e(i),t.aY(),t}n=this&&this.__extends||(Qt=function(t,i){return(Qt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Qt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RangeCalendar=t.Calendar=void 0,Z=i("./dist/plugins/celltype/editor/eventbase.js"),G=i("./dist/plugins/celltype/editor/timepicker.js"),o=i("./dist/plugins/celltype/editor/baseControl.js"),e=i("./dist/plugins/celltype/celltypes.ns.js"),c=i("Common"),r=i("Core"),i=new c.Common.ResourceManager(e.SR,"CellTypes"),N=i.getResource.bind(i),e=c.Common.lt,u=e.ht,B=document,a="gc-calendar-container",Q="gc-date-ranges-calendar",Y="gc-range-calendar-container",P="gc-date-range-container",R="gc-date-time-container",W="gc-date-part-container",H="gc-time-part-container",V="gc-ok-button-container",J="gc-date-container",F="gc-week-container",X="gc-today-container",l="gc-content-container",f="gc-header-container",_="gc-header-title",K="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",it="gc-year-page",nt="gc-year-select-div",et="gc-month-page",st="gc-day-page",D="gc-left-arrow",d="gc-right-arrow",M="gc-arrow-disable",g="gc-is-focused",ot="gc-cl-select",h="gc-cl-is-selected",I="gc-cl-disabled-text",ct="gc-cl-select-container",s="gc-focus-part-indicator",rt="gc-cl-datepicker",ut="gc-cl-dropdown",v="gc-cl-datepicker-filter",w="gc-cl-datepicker-filter-month",at="gc-cl-grid-align-spread",j="gc-cl-align-middle",A="gc-cl-button-icon-container",T="gc-cl-datepicker-month",lt="gc-cl-day",Mt="gc-cl-week",gt="gc-cl-show-inline-block",ht="gc-builtIn-date-Range-child-div",It="gc-builtIn-date-ranges-div",Nt="gc-date-ranges-result-div",ft="gc-date-ranges-result-button",Dt="gc-builtIn-date-range-childDiv-select",dt="gc-date-ranges-result-buttonDiv",vt="gc-date-ranges-result-input",wt="gc-cl-p-bottom-x-small",jt="gc-cl-shrink-none",At="gc-cl-grow",b="gc-cl-grid",Tt="gc-uiButton",y="gc-cl-button",bt="gc-cl-button-brand",yt="year-index",zt="month-index",Ct="week-index",z="day-index",mt="dateRange-index",(i=C=C||{})[i.Date=1]="Date",i[i.Time=2]="Time",Wt.initResource=function(){Wt.resource={shortWeeks:[N().Calendar_ShortWeeks_1,N().Calendar_ShortWeeks_2,N().Calendar_ShortWeeks_3,N().Calendar_ShortWeeks_4,N().Calendar_ShortWeeks_5,N().Calendar_ShortWeeks_6,N().Calendar_ShortWeeks_7],shortMonths:[N().Calendar_ShortMonths_1,N().Calendar_ShortMonths_2,N().Calendar_ShortMonths_3,N().Calendar_ShortMonths_4,N().Calendar_ShortMonths_5,N().Calendar_ShortMonths_6,N().Calendar_ShortMonths_7,N().Calendar_ShortMonths_8,N().Calendar_ShortMonths_9,N().Calendar_ShortMonths_10,N().Calendar_ShortMonths_11,N().Calendar_ShortMonths_12],weeks:[N().Calendar_Weeks_7,N().Calendar_Weeks_1,N().Calendar_Weeks_2,N().Calendar_Weeks_3,N().Calendar_Weeks_4,N().Calendar_Weeks_5,N().Calendar_Weeks_6],months:[N().Calendar_Months_1,N().Calendar_Months_2,N().Calendar_Months_3,N().Calendar_Months_4,N().Calendar_Months_5,N().Calendar_Months_6,N().Calendar_Months_7,N().Calendar_Months_8,N().Calendar_Months_9,N().Calendar_Months_10,N().Calendar_Months_11,N().Calendar_Months_12],timePrefix:[N().Calendar_Time_AM,N().Calendar_Time_PM],eraNames:[N().Calendar_EraName_1,N().Calendar_EraName_2,N().Calendar_EraName_3,N().Calendar_EraName_4],earFirstYear:N().Calendar_FirstYear,today:N().Calendar_Today,lastMonth:N().Calendar_LastMonth,nextMonth:N().Calendar_NextMonth,lastYear:N().Calendar_LastYear,nextYear:N().Calendar_NextYear,lastTenYears:N().Calendar_LastTenYear,nextTenYears:N().Calendar_NextTenYear}},Wt.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},m=Wt,pt=Ht,Lt=Vt,xt=Jt,St=Ft,x.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},x.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},x.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},x.addMilliseconds=function(t,i){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+i),new Date(t.valueOf())},x.getEraDate=function(t){var i,n,e,i={era:-1,eraYear:-1};if(x.isValidEraDate(t))for(n=0;n<x.eraCount;n++)if(t<(e=n+1!==x.eraCount?x.eraDates[n+1]:x.addMilliseconds(x.eraMax,1))){i.era=n,i.eraYear=t.getFullYear()-x.eraDates[n].getFullYear()+1;break}return i},x.getEraYearString=function(t){var i,i,i=new Date(t,5,30),i=x.getEraDate(i);return-1===i.era||-1===i.eraYear?t.toString():t.toString()+"\u5e74"},x.getShortEraYearString=function(t){var t,t,i,t=new Date(t,11,31),t=x.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(i=1===t.eraYear?m.resource.earFirstYear:t.eraYear,m.resource.eraNames[t.era]+i+"\u5e74")},x.getDateLocaleLabel=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?m.resource.timePrefix[0]:m.resource.timePrefix[1])+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},x.getBuiltInDateRanges=function(){var t,i,n,e,s,o,c,e,t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setDate(t.getDate()-1),(n=new Date(t)).setDate(t.getDate()-6),e=t.getFullYear(),s=t.getMonth(),o=new Date(e,s,1),c=new Date(e,s-1,1),e=new Date(e,s+1,0),[[N().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[N().Calendar_BuiltIn_Yesterday,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:i}],[N().Calendar_BuiltIn_Last7Days,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[N().Calendar_BuiltIn_ThisMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),e.getDate())}],[N().Calendar_BuiltIn_LastMonth,{start:new Date(c.getFullYear(),c.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),0)}]]},x.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},x.getNextMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()+1,n=new Date(i,t,1);return 12===t&&(n.setFullYear(i+1),n.setMonth(0)),n},x.getPreviousMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()-1,n=new Date(i,t,1);return-1==t&&(n.setFullYear(i-1),n.setMonth(11)),n},x.getFirstDayOfMonth=function(t){var i,t,i=t.getFullYear(),t=t.getMonth();return new Date(i,t,1)},x.getShortDate=function(t){var i,t;return u(t)?t:(i=t.start,t=t.end,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},x.eraCount=4,x.eraMax=new Date(2087,11,31,23,59,59),x.eraMin=new Date(1868,8,8),x.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),p=x,Xt.prototype.getLabel=function(){return this.year.toString()},Ot=Xt,_t.prototype.getLabel=function(){return m.resource.shortMonths[this.month]},kt=_t,Kt.prototype.getLabel=function(){return this.date.getDate().toString()},Et=Kt,S.getMonthName=function(t){return m.resource.months[t]},S.getShortMonthName=function(t){return m.resource.shortMonths[t]},Object.defineProperty(S.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),S.prototype.updateDayFocusDate=function(){var t,i;this.owner.A1e?(t=this.T1e,1===this.owner.N1e?this.focusDate=p.getFirstDayOfMonth(t.start):2===this.owner.N1e&&(i=void 0,i=t.end.getFullYear()===t.start.getFullYear()&&t.end.getMonth()===t.start.getMonth()?p.getNextMonth(t.start):p.getFirstDayOfMonth(t.end),this.focusDate=i)):this.focusDate=new Date(this.selectedDate.valueOf())},S.prototype.updateDayItems=function(){var t,i,n,e,s,o,c,r,u,a,l;for(this.dayItems=[],t=this.focusDate.getFullYear(),i=this.focusDate.getMonth(),r=c=((o=(e=(n=new Date(t,i,1)).getDay())-(s=this.owner.dH))<0?7+o:o)%7;0<r;r--)(u=new Date(t,i,1)).setDate(u.getDate()-r),a=new Et(u,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-c;r++)u=new Date(t,i,r),a=new Et(u),u.getMonth()!==i&&(a.disabled=!0),this.owner.A1e?(l=this.T1e,(p.dateEqual(u,l.start)||p.dateEqual(u,l.end))&&(a.selected=!0),u>l.start&&(u<l.end||this.E1e&&u<=this.E1e)&&!a.disabled&&(a.focused=!0)):(p.dateEqual(u,this.selectedDate)&&(a.selected=!0),p.dateEqual(u,this.focusDate)&&(a.focused=!0)),this.dayItems.push(a)},S.prototype.updateMonthItems=function(){var t,i,n,n,e;for(this.monthItems=[],t=0;t<12;t++)i=new kt(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getMonth()===t||n.end.getMonth()===t,i.focused=n.start.getMonth()<t&&n.end.getMonth()>t):(n=this.selectedDate,e=this.focusDate,i.selected=n&&n.getMonth()===t&&n.getFullYear()===e.getFullYear(),i.focused=e&&e.getMonth()===t),this.monthItems.push(i)},S.prototype.updateYearItems=function(){var t,i,n;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)i=new Ot(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getFullYear()===t||n.end.getFullYear()===t,i.focused=n.start.getFullYear()<t&&n.end.getFullYear()>t):(i.selected=this.selectedDate&&this.selectedDate.getFullYear()===t,i.focused=this.focusDate&&this.focusDate.getFullYear()===t,i.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd),this.yearItems.push(i)},S.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},S.prototype.getShortWeekName=function(t){var i,n,i,n;return m.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},S.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return S.getMonthName(t)},S.prototype.updateCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):this.RangeCalendar.notifyCalendarData({selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e})},Ut=S,Yt=Z.EventBase,n(O,Yt),Object.defineProperty(O.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),O.prototype.createCalendarDom=function(){var t,i,n,e,s,e,t,t=this.jS;return this.mH=new St,i=L("div"),this.jS.A1e?i.className=a+" "+P:i.classList.add(a),t.HG?i.classList.add(R):i.classList.add(J),n=L("table"),e=L("tr"),(s=L("td")).classList.add(K),t.HG&&s.classList.add(q),s.appendChild(this.gH()),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.HG&&(e=L("tr"),t=L("td"),s.appendChild(this.pH()),s.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),e.appendChild(t),n.appendChild(e)),this.mH.outerContainerDiv=i},O.prototype.wH=function(){var t,i,t=L("div");return t.classList.add(V),(i=L("button")).textContent=N().OK,i.className=y+" "+bt+" "+Tt,t.appendChild(i),this.mH.okButton=i,t},O.prototype.pH=function(){var t=L("div");return t.classList.add($),t},O.prototype.yH=function(){var t=L("div");return t.classList.add(tt),t},O.prototype.gH=function(){var t=L("div");return t.className=W+" "+rt+" "+ut,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},O.prototype.MH=function(){var t=L("div");return t.classList.add(it),t.appendChild(this.TH()),t.appendChild(this.AH()),t},O.prototype.TH=function(){var t,i,n,e,s,s,o,c,c,t=L("div");return t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastTenYear,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).classList.add(j),(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextTenYear,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=this.mH.calendarYearSection).headerDiv=t,c.lastYearRangeButton=e,c.focusDateYearRangeName=s,c.nextYearRangeButton=o,t.appendChild(i),t},O.prototype.AH=function(){var t,i,t=L("table");return t.className=l+" "+T,(i=L("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),i},O.prototype.IH=function(){for(var t,i,n,e,s,o,c,t=this.mH.calendarYearSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(o=L("td")).setAttribute(yt,(4*n+s).toString()),(c=L("span")).classList.add(lt),c.setAttribute(yt,(4*n+s).toString()),c.innerText=(4*n+s+1).toString(),o.appendChild(c),e.appendChild(o),t.yearTds.push(o);i.appendChild(e)}t.currentYearRangeTable.appendChild(i)},O.prototype.CH=function(){var t=L("div");return t.classList.add(et),t.appendChild(this.xH()),t.appendChild(this.NH()),t},O.prototype.xH=function(){var t,i,n,e,s,s,o,c,c,t=L("div");return t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastYear,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).className=_+" "+j,(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextYear,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=this.mH.calendarMonthSection).headerDiv=t,c.lastYearButton=e,c.currentYearName=s,c.nextYearButton=o,t.appendChild(i),t},O.prototype.NH=function(){var t,i,t=L("table");return t.className=l+" "+T,(i=L("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),i},O.prototype.kH=function(){for(var t,i,n,e,s,o,c,t=this.mH.calendarMonthSection,i=L("tbody"),n=0;n<3;n++){for(e=L("tr"),s=0;s<4;s++)(o=L("td")).setAttribute(zt,(4*n+s+1).toString()),(c=L("span")).classList.add(lt),c.setAttribute(zt,(4*n+s+1).toString()),c.innerText=(4*n+s+1).toString(),o.appendChild(c),e.appendChild(o),t.monthTds.push(o);i.appendChild(e)}t.currentYearTable.appendChild(i)},O.prototype.SH=function(){var t=L("div");return t.classList.add(st),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.A1e||t.appendChild(this.OH()),t},O.prototype._H=function(){var t,i,n,e,s,s,o,c,c,r,u,a,l,M,g,h,I,a,t=L("div");for(t.className=f+" "+v+" "+b,(i=L("div")).className=w+" "+b+" "+at+" "+At,(n=L("div")).classList.add(j),(e=L("button")).className=y+" "+A,e.title=N().Calendar_LastMonth,e.setAttribute("type","button"),(s=L("div")).classList.add(D),e.appendChild(s),(s=L("span")).className=_+" "+j,(o=L("button")).className=y+" "+A,o.title=N().Calendar_NextMonth,o.setAttribute("type","button"),(c=L("div")).classList.add(d),o.appendChild(c),i.appendChild(e),i.appendChild(s),i.appendChild(o),(c=L("div")).className=nt+" "+jt,(r=L("div")).classList.add(ct),(u=L("select")).classList.add(ot),l=(a=new Date).getFullYear()-this.lH,M=a.getFullYear()+this.fH,g=l;g<=M;g++)(h=L("option")).text=g.toString(),h.value=g.toString(),u.options.add(h);return(I=L("div")).classList.add(ct),r.appendChild(u),c.appendChild(r),t.appendChild(c),t.appendChild(i),(a=this.mH.calendarDaySection).headerDiv=t,a.lastMonthButton=e,a.currentMonthName=s,a.nextMonthButton=o,a.yearSelect=u,t},O.prototype.EH=function(){var t,i,n,e,s,o,c,t=L("div");for(t.className=F+" "+v+" "+b,(i=L("table")).className=l+" "+T,n=L("thead"),e=L("tr"),s=0;s<7;s++)(o=L("th")).setAttribute(Ct,s.toString()),(c=L("span")).classList.add(Mt),c.setAttribute(Ct,s.toString()),c.innerText=this.jS._data.getShortWeekName(s),o.appendChild(c),e.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return n.appendChild(e),i.appendChild(n),t.appendChild(i),t},O.prototype.jH=function(){var t,i,n,e,s,o,c,r,u,a,t=this.mH.calendarDaySection,i=L("div"),n=L("div"),e=L("table");for(e.className=l+" "+T,s=L("tbody"),o=0;o<6;o++){for(c=L("tr"),r=0;r<7;r++)(u=L("td")).setAttribute(z,(7*o+r).toString()),(a=L("span")).classList.add(lt),a.setAttribute(z,(7*o+r).toString()),u.appendChild(a),c.appendChild(u),t.dayTds.push(u);s.appendChild(c)}return e.appendChild(s),n.appendChild(e),i.appendChild(n),t.dayContentTable=e,i},O.prototype.OH=function(){var t,i,n,e,s,o,t=L("div");return t.classList.add(X),(i=L("table")).classList.add(l),n=L("tbody"),e=L("tr"),s=L("td"),(o=L("i")).className=gt+" "+wt,o.innerText=m.resource.today,s.appendChild(o),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.appendChild(i),this.mH.calendarDaySection.todayTd=s,this.mH.calendarDaySection.todayTable=i,t},O.prototype.bH=function(){var i,t,i=this,t=L("div");return t.className=H+" "+rt+" "+ut,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new G.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(o.BaseDropdown.Event_ValueChanged,function(t){i.BH(t)}),t},O.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},O.prototype.LH=function(){switch(this.jS._data.calendarPage){case r.CalendarPage.year:this.PH();break;case r.CalendarPage.month:this.GH();break;case r.CalendarPage.day:this.UH()}},O.prototype.HH=function(){var t,i,n,e,s,o,t,c,r,c,t,i,u,a,l,t=this.jS._data,i=this.mH.calendarDaySection,n=!1;for(i.currentMonthName.innerText=t.getCurrentMonthName(),e=t.focusDate.getFullYear(),s=i.yearSelect,o=0;o<s.options.length;o++)if(e.toString()===s.options[o].value){s.selectedIndex=o,n=!0;break}if(t=this.fH+this.lH+1,n?s.options[t]&&s.selectedIndex<=t-1&&s.options[t].remove():((c=L("option")).text=e.toString(),c.value=e.toString(),s.options[t]=c,s.selectedIndex=t),this.jS.A1e&&(r=this.jS.parent).R1e&&r.B1e)if(c=i.lastMonthButton,t=i.nextMonthButton,i=this.jS.N1e,u=r.R1e._data.focusDate,a=r.B1e._data.focusDate,1===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))>a.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&u.getMonth()>=a.getMonth()-1?(t.disabled=!0,t.classList.add(M)):(t.disabled=!1,t.classList.remove(M))}else if(2===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))<u.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&a.getMonth()<=u.getMonth()+1?(c.disabled=!0,c.classList.add(M)):(c.disabled=!1,c.classList.remove(M))}},O.prototype.PH=function(){var t,i,n,e,s,o,c,r,c,u,t=this.jS._data,i=this.mH.calendarYearSection;if(t.updateYearItems(),i.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),n=i.yearTds,0!==(e=t.yearItems).length)for(s=0;s<3;s++)for(o=0;o<4;o++)r=e[c=4*s+o],(u=(c=n[c]).querySelector("span")).innerText=r.getLabel(),r.disabled?c.classList.add(I):c.classList.remove(I),r.selected?c.classList.add(h):c.classList.remove(h),r.focused?u.classList.add(g):u.classList.remove(g)},O.prototype.GH=function(){var t,i,n,e,s,o,c,r,u,r,a,t=this.jS._data,i=this.mH.calendarMonthSection;for(t.updateMonthItems(),n=t.focusDate.getFullYear(),e=t.monthItems,s=i.monthTds,i.currentYearName.innerText=n.toString(),o=0;o<3;o++)for(c=0;c<4;c++)u=e[r=4*o+c],(a=(r=s[r]).querySelector("span")).innerText=u.getLabel(),u.selected?r.classList.add(h):r.classList.remove(h),u.focused?a.classList.add(g):a.classList.remove(g)},O.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(O.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),O.prototype.zH=function(){var t,i,n,e,s,o,c,o,r,t=this.jS._data;if(t.updateDayItems(),0!==(i=t.dayItems).length)for(n=this.mH.calendarDaySection.dayTds,e=0;e<6;e++)for(s=0;s<7;s++)c=i[o=7*e+s],(r=(o=n[o]).querySelector("span")).innerText=c.getLabel(),c.disabled?o.classList.add(I):o.classList.remove(I),c.focused?r.classList.add(g):r.classList.remove(g),c.selected?o.classList.add(h):o.classList.remove(h)},O.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},O.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},O.prototype.VH=function(){var i=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){i.YH(t)})},O.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===C.Date?this.setCalendarActivePart(C.Time):this.setCalendarActivePart(C.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==C.Date||this.jS.A1e||this.ZH(t)},O.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case r.CalendarPage.year:this.WH(t);break;case r.CalendarPage.month:this.QH(t);break;case r.CalendarPage.day:this.KH(t)}},O.prototype.WH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(r.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},O.prototype.QH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(r.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},O.prototype.KH=function(t){var i,n,e,s,o,c,i=this.jS._data,n=i.focusDate,e=n.getFullYear(),s=n.getMonth(),o=n.getDate(),c=p.getMonthMaxDay(e,s+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(o-1);break;case 39:n.setDate(o+1);break;case 38:n.setDate(o-7);break;case 40:n.setDate(o+7);break;case 36:n.setDate(1);break;case 35:n.setDate(c);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.LH()},O.prototype.attachDateEvent=function(){var i=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===i.mH.calendarDaySection.yearSelect||t.parentElement===i.mH.calendarDaySection.yearSelect)||i.setCalendarActivePart(C.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},O.prototype.attachYearEvent=function(){var i=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){i.$H(),i.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){i.tz(),i.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){i.az(t)})},O.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},O.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},O.prototype.qH=function(){this.showCalendarPage(r.CalendarPage.month)},O.prototype.az=function(t){var t,t,i,i,t=t.srcElement||t.target;t&&(t=+t.getAttribute(yt),0!==(i=this.jS._data.yearItems).length)&&(i=i[t],this.jS._data.focusDate.setFullYear(i.year),this.qH())},O.prototype.attachMonthEvent=function(){var i=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){i.JH(),i.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){i.XH(),i.LH()}),this.jS.A1e||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){i.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){i.uz(t)})},O.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},O.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},O.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(r.CalendarPage.year)},O.prototype.rz=function(){this.showCalendarPage(r.CalendarPage.day)},O.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(zt),this.jS._data.focusDate.setMonth(t-1),this.rz())},O.prototype.attachDayEvent=function(){var i,t,i=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){i.nz(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.nextMonthButton.addEventListener("click",function(t){i.ez(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){i.fz()}),this.jS.A1e?t.dayContentTable.addEventListener("mouseover",function(t){i.j1e(t)}):t.currentMonthName.addEventListener("click",function(t){i.cz()}),t.dayContentTable.addEventListener("click",function(t){i.jS.A1e?i.O1e(t):i.lz(t)}),t.yearSelect.addEventListener("change",function(t){i.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},O.prototype.nz=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()-t,e=i.focusDate.getDate();t<0&&(t+=12,--n),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s)),i.focusDate=n},O.prototype.ez=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()+t,e=i.focusDate.getDate();11<t&&(t-=12,n+=1),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s),i.focusDate.getHours(),i.focusDate.getMinutes(),i.focusDate.getSeconds()),i.focusDate=n},O.prototype.cz=function(){this.showCalendarPage(r.CalendarPage.month)},O.prototype.lz=function(t){var i,t,t,n,e,n,t,t,i=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(z),u(t))return;if(0===(n=i.dayItems).length)return;n=(e=n[+t]).date,t=(t=i.selectedDate)?new Date(t.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},O.prototype.O1e=function(t){var i,t,t,n,n,t,n,e,s,s,e,s,i,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(t=(n=n[+t]).date,n=n.disabled,s=(e=i.T1e)?new Date(e.start.valueOf()):p.getDefaultDate(),0===this.RangeCalendar.D1e?(e.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.end=e.start,this.RangeCalendar.D1e++):1===this.RangeCalendar.D1e&&(s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.start<=s?(e.end=s,this.RangeCalendar.D1e=0):(e.end=e.start=s,this.RangeCalendar.D1e=1)),i.updateCalendarData(),n&&(e=this.jS._data.focusDate,s=this.jS.parent,i=p.getFirstDayOfMonth(t),1===this.jS.N1e?e<t?s.B1e._data.focusDate=i:t<this.jS._data.focusDate&&(this.jS._data.focusDate=i):2===this.jS.N1e&&(n=s.R1e,e<t?(n._data.focusDate=p.getPreviousMonth(t),this.jS._data.focusDate=i):t<this.jS._data.focusDate&&(n._data.focusDate=i))),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.j1e=function(t){var i,t,t,n,e,n,t,s,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(n=(e=n[+t]).date,t=i.T1e,i.E1e=null,t.start&&1===this.RangeCalendar.D1e&&(s=t?new Date(t.start.valueOf()):p.getDefaultDate(),(n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))>t.start)&&(i.E1e=n),i.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},O.prototype.fz=function(){var t,i,i,n,t=this.jS,i=t._data.selectedDate,i=i?new Date(i.valueOf()):null,n=new Date;i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(0)),t._data.selectedDate=n,t._data.focusDate=new Date(n.valueOf()),this.LH(),t.HG||this.oz()},O.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.jS.A1e?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},O.prototype.attachTimeEvent=function(){var i=this;this.mH.timeContainerDiv.addEventListener("click",function(t){i.setCalendarActivePart(C.Time)}),this.mH.okButton.addEventListener("click",function(t){i.oz()})},O.prototype.BH=function(t){var i,n,t,i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,t=t.value;n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},O.prototype.oz=function(){var t=this.jS._data;this.fire(o.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},O.prototype.showCalendarPage=function(t){var i,n,e,i=this.host.querySelector("."+it),n=this.host.querySelector("."+et),e=this.host.querySelector("."+st);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case r.CalendarPage.year:i.style.display="";break;case r.CalendarPage.month:n.style.display="";break;case r.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},O.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(s),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(s),t){case C.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus();break;case C.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus()}},O.Event_GetHost="GetHost",Zt=O,Pt=o.BaseDropdown,n(k,Pt),k.prototype.setOptions=function(t){var i,t;t&&(t.showTime||this.A1e||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),i=t&&t.calendarPage?t.calendarPage:r.CalendarPage.day,(t=t&&t.startDay?t.startDay:r.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(i),this.Dn.setCalendarActivePart(C.Date))},k.prototype.setValue=function(t){var i=this._data;if(t){if(this.A1e&&t instanceof Object){if(!t.start||!t.end)return;i.S1e={start:t.start,end:t.end},i.T1e={start:t.start,end:t.end},i.updateCalendarData()}else t instanceof Date&&(i.selectedDate=t,i.oldSelectedData=new Date(t.valueOf()),i.focusDate=new Date(t.valueOf()),i.updateYearRange());i.updateDayFocusDate()}},k.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},Gt=k,t.Calendar=Gt,Rt=o.BaseDropdown,n(E,Rt),E.prototype.setOptions=function(t){u(t.showBuiltInDateRange)&&(t.showBuiltInDateRange=!0),t.showTime=!1,t.calendarPage=r.CalendarPage.day,this.R1e.setOptions(t),this.B1e.setOptions(t)},E.prototype.setValue=function(t){this.R1e.setValue(t),this.B1e.setValue(t),this.updateRangeCalendarDom()},E.prototype.updateRangeCalendarDom=function(){this.R1e.Dn.updateCalendarDom(),this.B1e.Dn.updateCalendarDom(),this.updateDataRangeResult(this.T1e)},E.prototype.L1e=function(){var t,e,t=p.getBuiltInDateRanges(),e=L("div");return e.className=a+" "+It,t.forEach(function(t,i){var n,i,n=L("div");n.className=ht,n.setAttribute(mt,i+""),i=B.createTextNode(t[0]),n.appendChild(i),e.appendChild(n)}),this.P1e=e},E.prototype._1e=function(t){var i,n,n;this.Ti.innerHTML="",(i=L("div")).className=a+" "+Y,t&&!1===t.showBuiltInDateRange||i.appendChild(this.L1e()),(n=L("div")).classList.add(Q),this.R1e=new Gt(n,t,this,1),i.appendChild(n),(n=L("div")).classList.add(Q),this.B1e=new Gt(n,t,this,2),i.appendChild(n),this.Ti.appendChild(i),this.Ti.appendChild(this.G1e())},E.prototype.aY=function(){var i=this;this.P1e&&this.P1e.addEventListener("click",function(t){i.U1e(t)}),this.H1e.addEventListener("click",function(t){i.onOkButtonClick(t)}),this.z1e.addEventListener("click",function(t){i.onCancelButtonClick(t)}),this.on(Zt.Event_GetHost,function(t){t.host=i.Ti})},E.prototype.G1e=function(){var t,i,i,n,i,n,t=L("div");return t.className=Nt,(i=L("div")).classList.add(vt),t.appendChild(i),this.V1e=i,this.updateDataRangeResult(this.T1e),(i=L("div")).className=dt,(n=L("button")).textContent=N().Cancel,n.className=ft,i.appendChild(n),t.appendChild(i),this.z1e=n,(i=L("div")).className=dt,(n=L("button")).textContent=N().OK,n.className=ft,i.appendChild(n),t.appendChild(i),this.H1e=n,t},E.prototype.U1e=function(t){var t,t,i,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(mt),u(t)||(t=(i=p.getBuiltInDateRanges())[t],this.T1e={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})))},E.prototype.updateDataRangeResult=function(t){var i,n,e,s,s;if(t&&t.start instanceof Date&&t.end instanceof Date&&(this.V1e.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.P1e)for(i=p.getBuiltInDateRanges(),n=0;n<this.P1e.children.length;n++)e=this.P1e.children[n],s=parseInt(e.getAttribute(mt),10),e.className=ht,s=i[s]&&i[s][1],p.dateEqual(s.start,t.start)&&p.dateEqual(s.end,t.end)&&(e.className=ht+" "+Dt)},E.prototype.onOkButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})},E.prototype.onCancelButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.S1e)})},E.prototype.checkFocusDateValid=function(){var t,i,t,t=this.R1e._data.focusDate,i;this.B1e._data.focusDate<=t&&(t=p.getNextMonth(t),this.B1e._data.focusDate=t)},E.prototype.notifyCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):t={selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e},this.R1e&&this.R1e._data.updateCalendarData(t),this.B1e&&this.B1e._data.updateCalendarData(t)},t.RangeCalendar=E},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){"use strict";var e,s,o,c,r,n,u,l,n,a,M,g,h;function I(t,i){var t=h.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("Core"),c=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),n=n("Common"),u=n.Common.lt.ht,l="group-name",n=new n.Common.ResourceManager(r.SR,"CellTypes"),a=n.getResource.bind(n),h=c.BaseDropdown,e(I,h),I.prototype.setOptions=function(t){var i;t&&(this.options=this.options||{},u(t.colorBlockSize)||(i=parseInt(t.colorBlockSize,10),!isNaN(i)&&0<=i&&(this.options.colorBlockSize=t.colorBlockSize)),u(t.groups)||(this.options.groups=t.groups)),this._6()},I.prototype.setValue=function(t){u(t)||(this.vz=t,this.mz=null,this._6())},I.prototype.Hc=function(){for(var i,t,n,e,i=this,t=I.DefaultColorGroup(),n=[],e=0;e<t.length;e++)n.push({name:t[e].name,colors:t[e].colors,needScaleColor:t[e].needScaleColor});this.options={colorBlockSize:I.DefaultCellWidth,groups:n},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},I.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.bz()),this.yz()},I.prototype.yz=function(){var t,i,n,e,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=t[i].getAttribute("color"),e=t[i].getAttribute(l),this.vz===n&&(!this.mz||this.mz&&this.mz===e)&&t[i].classList.add("selected")},I.prototype.wz=function(){for(var t,i,n,e,s,o,t=0,i=this.options.groups,n=0;n<i.length;n++)for(e=i[n],s=0;s<e.colors.length;s++)o=e.colors[s],t=Math.max(t,o.length);return t},I.prototype.bz=function(){for(var t,i,n,e,s,o,o,t=[],i=this.options.colorBlockSize||I.DefaultCellWidth,n=this.wz(),e=this.options.groups,s=0;s<e.length;s++)o=this.Mz(e[s],i,n),t.push(o),e[s].needScaleColor&&(o=this.Cz(e[s].colors[0]),t.push(this.Mz(o,i,n)));return{items:t}},I.prototype.Cz=function(t){var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,i={},n=[],s=[-(e=n.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],c=[80,60,40,-25,-50],r=document.createElement("span"),u=t.length;r.style.display="none",document.body.appendChild(r);try{for(a=0;a<u;a++)for(M=(l=this.Sz(t[a],r))[0],g=l[1],h=l[2],I=this.Tz(M,g,h),N=0;N<5;N++)n[N]||((f=[]).length=u,n[N]=f),n[N][a]=1===I?this.Az(M,g,h,s[N]):.8<=I?this.Az(M,g,h,o[N]):0===I?this.Az(M,g,h,Math.abs(s[5-N-1])):I<=.2?this.Az(M,g,h,Math.abs(o[5-N-1])):this.Az(M,g,h,c[N]);i.colors=n}finally{document.body.removeChild(r)}return i},I.prototype.Sz=function(t,i){var n,e,s,o,t;return i.style.color=t,t=(o=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(t[0],10),e=parseInt(t[1],10),s=parseInt(t[2],10)]},I.prototype.Az=function(t,i,n,e){var t,i,n;return e/=100,t=this.Iz(t,i,n),i=parseInt((0<e?(240-t.luminosity)*e:t.luminosity*e).toString(),10),n=this.xz(t.hue,t.luminosity+i,t.saturation),this.Nz(n.r,n.g,n.b)},I.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},I.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},I.prototype.xz=function(t,i,n){var e,s,o,c,r;return 0===n?e=s=o=parseInt((255*i/240).toString(),10):(r=c=void 0,c=2*i-(r=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(c,r,t+80)+120)/240).toString(),10),s=parseInt(((255*this.Dz(c,r,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(c,r,t-80)+120)/240).toString(),10)),{a:255,r:e,g:s,b:o}},I.prototype.Dz=function(t,i,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},I.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},I.prototype.Iz=function(t,i,n){var e,s,o,c,r,u,r,u,a,n,c=Math.max(Math.max(t,i),n),r=Math.min(Math.min(t,i),n),u=c+r,e=parseInt(((240*u+255)/510).toString(),10),r=c-r;return 0==r?(s=0,o=160):(s=e<=120?parseInt(((240*r+u/2)/u).toString(),10):parseInt(((240*r+(510-u)/2)/(510-u)).toString(),10),u=(40*(c-t)+r/2)/r,a=(40*(c-i)+r/2)/r,n=(40*(c-n)+r/2)/r,(o=t===c?parseInt((n-a).toString(),10):i===c?parseInt((80+u-n).toString(),10):parseInt((160+a-u).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:e,saturation:s,hue:o}},I.prototype.Mz=function(c,r,u){var a,t,a=this,t={items:function(){var t,i,n,e,s,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(r+7)*u+"px",i=0;i<c.colors.length;i++){for((n=document.createElement("div")).classList.add("gc-color-picker-color-row"),e=c.colors[i],s=0;s<e.length;s++)(o=document.createElement("div")).setAttribute(l,c.name),o.setAttribute("color",e[s]),o.style.backgroundColor=e[s],o.style.width=r+"px",o.style.height=r+"px",o.classList.add("gc-color-picker-color-cell"),a.vz===e[s]&&a.mz===c.name&&o.classList.add("selected"),n.appendChild(o);t.appendChild(n)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return c.name&&(t.text=c.name),t},I.prototype.pz=function(t){var t,i,t,t=t.srcElement||t.target;t&&(i=t.getAttribute("color"),t=t.getAttribute(l),i)&&t&&(this.vz=i,this.mz=t,this._z(i),this.yz())},I.prototype._z=function(t){this.fire(c.BaseDropdown.Event_ValueChanged,{value:t,text:t})},I.DefaultCellWidth=10,I.DefaultColorGroup=function(){return[{name:a().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:a().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i.ColorPicker=I},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){"use strict";var n;function e(){this.Ez={}}Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0,e.prototype.on=function(t,i){var n=this.Ez[t];(n=null==n?this.Ez[t]=[]:n).push(i)},e.prototype.off=function(t,i){var n,i;t?null!=(n=this.Ez[t])&&(i?(i=n.indexOf(i),n.splice(i,1)):n=[],this.Ez[t]=n):this.Ez={}},e.prototype.fire=function(t,i){var n,t,n=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(n,i)}catch(t){}})},i.EventBase=e},"./dist/plugins/celltype/editor/listControl.js":function(U,t,i){"use strict";var n,r,u,o,M,g,c,e,s,a,l,h,I,N,f,D,d,v,w,j,A,T,b,y,z,C,m,Z,G,p,B,L,x;function S(t){return e.createElement(t)}function Q(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function Y(t,i){if(o.Common.Uf.OS(t,i))return 1;if(o.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i==0)return 1}function P(t,i){for(var n,e,n=o.Common.ct.W0(i),e=t.length-1;0<=e;e--)(t[e]===i||n&&t[e]-i==0)&&t.splice(e,1)}function R(t){var i,n,e,s,o;if(g(t)||0===t.length)return[];for(i=[],e=n=0;e<t.length;e++)"\\"===(s=t.charAt(e))?","!==(o=t.charAt(e+1))&&"\\"!==o||(t=Q(t,e)):","===s&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function W(t){for(var i,n,e,i=[],n=0;n<t.length;n++)(e=t[n])&&"string"==typeof e&&(e=e.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),i[n]=e;return i.join(",")}function O(){this.jz=new WeakMap}function k(t,i,n){var e=x.call(this,t)||this;return e.Ti=S("div"),e.Ti.classList.add(a),t.appendChild(e.Ti),e.cE=new s,e.Oz=n&&n.Oz||{y4:void 0},e.Rz={items:[],doms:[]},e.setOptions(i),e}function E(t){if(t.hasOwnProperty("items"))E(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?E(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}n=this&&this.__extends||(L=function(t,i){return(L=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}L(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,r=i("./dist/plugins/celltype/editor/popupControl.js"),u=i("./dist/plugins/celltype/editor/baseControl.js"),o=i("Common"),M=i("Core"),g=o.Common.lt.ht,c=o.Common.Uf.hD,e=document,O.prototype.set=function(t,i,n){var e=this.jz.get(t);e||this.jz.set(t,e={}),e[i]=n},O.prototype.get=function(t,i){var t=this.jz.get(t);return t&&t[i]},O.prototype.clear=function(){this.jz=new WeakMap},s=O,a="gc-list-control",l="gc-list-control-container",h="gc-list-control-group",I="gc-list-control-group-text",N="gc-list-control-item",f="gc-list-control-hassubitem",D="gc-list-control-selected-item",d="gc-list-control-item-text",v="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",j="gc-list-control-item-icon",A="gc-list-control-emptyicon",T="gc-list-control-subitem",b="gc-list-alignment-horizontal",y="gc-list-alignment-vertical",z="gc-list-control-noitem",C="gc-list-control-listseparator",m="hide-children",Z="gc-list-control-tree",G="gc-list-control-tree-text",p="gc-list-control-tree-content",x=u.BaseDropdown,n(k,x),k.prototype.setOptions=function(t){g(t)||(this.MU=E(t),this.Ti.innerHTML="",this.Dn())},k.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=R(t);else if(g(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},k.prototype.scrollToSelect=function(){},k.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},k.prototype.Dn=function(){var t=S("div");t.classList.add(l),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},k.prototype.Lz=function(t,i){var n;i&&(this.Pz(t,i.layout),i.items)&&(Array.isArray(i.items)?this.Gz(t,i.items):(n=i.items())instanceof HTMLElement&&(t.appendChild(n),t.classList.add(N),this.Pz(n,i.layout)))},k.prototype.Pz=function(t,i){i&&i.direction===M.LayoutDirection.horizontal?t.classList.add(b):t.classList.add(y)},k.prototype.Gz=function(t,i){for(var n,e,s,o,c,r,u,o,a,l,l,n=i.some(function(t){return!!t.icon}),e=0;e<i.length;e++)i[e].items?(s=i[e]).layout&&s.layout.displayAs===M.LayoutDisplayAs.inline?((o=S("div")).classList.add(h),(c=S("span")).innerText=s.text,!g(s.text)&&""!==s.text||c.classList.add(m),c.classList.add(I),o.appendChild(c),Array.isArray(s.items)?this.Lz(o,s):(r=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(N),this.Pz(r,s.layout),u.appendChild(r),o.appendChild(u)),t.appendChild(o)):s.layout&&s.layout.displayAs===M.LayoutDisplayAs.tree?((o=S("div")).classList.add(Z),(a=S("div")).classList.add(N),a.classList.add(f),(c=S("span")).innerText=s.text,c.classList.add(G),a.appendChild(c),s.layout.collapsible&&((l=S("span")).classList.add(T),a.appendChild(l),this.Uz(a)),o.appendChild(a),(l=S("div")).classList.add(p),Array.isArray(s.items)?this.Lz(l,s):(r=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(N),this.Pz(r,s.layout),u.appendChild(r),l.appendChild(u)),o.appendChild(l),t.appendChild(o)):this.Hz(t,i[e],!1,!0):this.Hz(t,i[e],n)},k.prototype.Hz=function(t,i,n,e){var s,o,o,n,o,n,o,n,o;void 0===e&&(e=!1),(s=S("div")).classList.add(N),this.MU.textEllipsis&&s.classList.add(w),"-"===i.text?(s.classList.add(z),(o=S("div")).classList.add(C),s.appendChild(o)):(n&&((o=S("div")).classList.add(j),i.icon?o.style.backgroundImage="url(".concat(i.icon,")"):o.classList.add(A),s.appendChild(o)),(n=S("span")).classList.add(d),this.MU.textEllipsis&&n.classList.add(v),o=i.text,g(i.text)&&(o=g(i.value)?"":i.value),n.innerText=o,s.appendChild(n),s.setAttribute("text",o),n=g(i.value)?null:i.value,(o=c(this.Rz.items,n))<0&&(o=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(n)),this.Rz.doms[o].push(s),this.cE.set(s,"items",i),e&&((n=S("span")).classList.add(T),s.classList.add(f),this.cE.set(s,"sub-items",i),s.appendChild(n),this.zz(s))),this.MU.Oue&&(s.setAttribute("role","option"),s.setAttribute("tabindex","0"),o=i.text||i.value,g(o)||s.setAttribute("aria-label",o)),t.appendChild(s)},k.prototype.qj=function(t,i){var n,e,n=this.Rz.doms[t];if(i)for(e=0;e<n.length;e++)n[e].classList.contains(f)||n[e].classList.add(D);else for(e=0;e<n.length;e++)n[e].classList.contains(D)&&n[e].classList.remove(D)},k.prototype.Bz=function(){for(var t,i,n,e,s,o,i=this,n=i.MU,t=g(i.formula)?n&&n.multiSelect?e=i.Oz.y4:[i.Oz.y4]:["="+i.formula],s=0;s<i.Rz.items.length;s++)o=i.Rz.items[s],Y(t,o=n&&n.multiSelect&&1!==n.valueType?""+o:o)?i.qj(s,!0):i.qj(s,!1)},k.prototype.Fz=function(){var s=this;this.Ti.querySelector("."+l).addEventListener("click",function(t){var i,i,n,t,i,e,i=s.Vz(t.target,".".concat(N));i&&(i.classList.contains(f)?s.Yz(t):(i=s.cE.get(i,"items"),n=s.MU,!i&&o.Common.lt.Eh(n&&n.onItemSelected)&&(i={value:n.onItemSelected(t)}),g(i)||(t=i.value,i=i.path,n&&n.multiSelect&&(Y(e=(e=s.Oz.y4).slice(0),t=n.multiSelect&&1!==n.valueType?""+t:t)?P(e,t):o.Common.Uf.ZP(e,t),s.Oz.y4=t=e,s.Bz(),1!==n.valueType)&&(t=W(t)),s.fire(u.BaseDropdown.Event_ValueChanged,{path:i,value:t,text:t,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))))})},k.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},k.prototype.Yz=function(t){var i,n,e,s,o,o,c,i=this,n=this.Vz(t.target,".".concat(N));n.classList.contains(f)&&(e=this.cE.get(n,"sub-items"))&&e.items&&(s=S("div"),o=this.MU,e.multiSelect=o&&o.multiSelect,e.valueType=o&&o.valueType,e.onItemSelected=o&&o.onItemSelected,(o=new k(s,e,this)).Bz(),(c=new r.PopupControl(s,n,{align:M.DropDownAlignment.Near,hostElement:n,direction:M.DropDownDirection.Right})).open(),o.on(u.BaseDropdown.Event_ValueChanged,function(t){i.fire(u.BaseDropdown.Event_ValueChanged,t),i.MU&&i.MU.multiSelect?i.Bz():c.close()}),this.cE.set(n,"sub-items-popup",c),t.stopPropagation(),t.preventDefault())},k.prototype.zz=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,i,t=t.target;t.classList.contains(f)&&(i=n.cE.get(t,"sub-items-popup"))&&(i.close(),n.cE.set(t,"sub-items-pop",void 0))})},k.prototype.Uz=function(t){var e=this;t.addEventListener("click",function(t){var i,i,n,i=t.target,i=e.Vz(i,".".concat(f));i&&(n=i.parentElement.querySelector("."+p))&&(i.parentElement.classList.contains(m)?i.parentElement.classList.remove(m):i.parentElement.classList.add(m),t.stopPropagation(),t.preventDefault())})},t.List=k},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){"use strict";var e,r,s,u,o,n,a,c,l,M,g,h,I,N,f,D,d,v;function w(t){return c.createElement(t)}function j(t,i){var t=v.call(this,t)||this;return t.setOptions(i),t.Fz(),t}e=this&&this.__extends||(d=function(t,i){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}d(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,r=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),u=n("Common"),o=u.Common.lt.ht,n=new u.Common.ResourceManager(s.SR,"CellTypes"),a=n.getResource.bind(n),c=document,l="gc-month-picker-separator",M="gc-month-picker-year-item",g="gc-month-picker-month-item",h="gc-month-picker-qtr-item",I="selected",N="data-month",f="data-qtr",v=r.BaseDropdown,e(j,v),j.prototype.setOptions=function(t){var i,n,n,e,e,e,i=this,n=new Date,n={startYear:n.getFullYear()-10,stopYear:n.getFullYear(),height:300};t&&(o(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e))||(n.startYear=e),!o(t.stopYear)&&0<t.stopYear&&(e=parseInt(t.stopYear,10),isNaN(e)||(n.stopYear=e)),n.stopYear<n.startYear&&(n.stopYear=t.startYear),o(t.height)||(e=parseInt(t.height,10),isNaN(e))||(n.height=e)),n.height=Math.max(1,n.height),i.MU=n,i.Ti.innerHTML="",i.Zz()},j.prototype.setValue=function(t){var i,n,e,s,t,o,i=this;t&&(n=t.getMonth()+1,e=t.getFullYear()),this.MU.startYear&&this.MU.stopYear&&this.MU.startYear<this.MU.stopYear&&e>this.MU.stopYear&&(e=this.MU.stopYear),"number"==typeof n&&(t=i.Ti.querySelector("[".concat(N,"='").concat(e,"-").concat(n,"']")))&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),i.Wz=t)},j.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},j.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},j.prototype.Fz=function(){var c=this;this.Ti.addEventListener("click",function(t){var i,t,n,e,s,t,t,e,o,n,i=c,t=i.Qz(t.target,".".concat(g,",.").concat(h));t&&!t.getAttribute(f)&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),e=n=null,(i.Wz=t).getAttribute(N)&&(n=+(t=(s=t.getAttribute(N)).split("-"))[1],e=+t[0]),t=new Date(e,n-1,1,0,0,0,0),e=u.Common.CultureManager.Fe().DateTimeFormat,n=(o=new u.Formatter.GeneralFormatter(e.shortDatePattern)).format(t),i.fire(r.BaseDropdown.Event_ValueChanged,{text:n,value:t}))})},j.prototype.Zz=function(){var t,i,n,e,s,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),i=t.MU.startYear;i<=t.MU.stopYear;i++)n=document.createElement("div"),t.Jz(n),(e=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(i,e),(s=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(i,1,s),t.qz(i,2,s),t.qz(i,3,s),t.qz(i,4,s),n.appendChild(e),n.appendChild(s),this.Ti.appendChild(n)},j.prototype.Jz=function(t){var i=w("div");i.classList.add(l),t.appendChild(i)},j.prototype.Xz=function(t,i){var n=w("div");n.classList.add(M),n.innerText="".concat(t),i.appendChild(n)},j.prototype.qz=function(t,i,n){var e,s,o,c,r,e=document.createElement("div"),s=w("div"),o=w("div"),c=w("div"),r=w("div");switch(s.classList.add(g),o.classList.add(g),c.classList.add(g),r.classList.add(h),i){case 1:s.innerText=a().Calendar_ShortMonths_1,s.setAttribute(N,"".concat(t,"-").concat(1)),o.innerText=a().Calendar_ShortMonths_2,o.setAttribute(N,"".concat(t,"-").concat(2)),c.innerText=a().Calendar_ShortMonths_3,c.setAttribute(N,"".concat(t,"-").concat(3)),r.innerText=a().Quarter_Format_1,r.setAttribute(f,"".concat(t,"-").concat(1));break;case 2:s.innerText=a().Calendar_ShortMonths_4,s.setAttribute(N,"".concat(t,"-").concat(4)),o.innerText=a().Calendar_ShortMonths_5,o.setAttribute(N,"".concat(t,"-").concat(5)),c.innerText=a().Calendar_ShortMonths_6,c.setAttribute(N,"".concat(t,"-").concat(6)),r.innerText=a().Quarter_Format_2,r.setAttribute(f,"".concat(t,"-").concat(2));break;case 3:s.innerText=a().Calendar_ShortMonths_7,s.setAttribute(N,"".concat(t,"-").concat(7)),o.innerText=a().Calendar_ShortMonths_8,o.setAttribute(N,"".concat(t,"-").concat(8)),c.innerText=a().Calendar_ShortMonths_9,c.setAttribute(N,"".concat(t,"-").concat(9)),r.innerText=a().Quarter_Format_3,r.setAttribute(f,"".concat(t,"-").concat(3));break;case 4:s.innerText=a().Calendar_ShortMonths_10,s.setAttribute(N,"".concat(t,"-").concat(10)),o.innerText=a().Calendar_ShortMonths_11,o.setAttribute(N,"".concat(t,"-").concat(11)),c.innerText=a().Calendar_ShortMonths_12,c.setAttribute(N,"".concat(t,"-").concat(12)),r.innerText=a().Quarter_Format_4,r.setAttribute(f,"".concat(t,"-").concat(4))}e.appendChild(s),e.appendChild(o),e.appendChild(c),e.appendChild(r),n.appendChild(e),i<4&&this.Jz(n)},i.MonthPicker=j},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){"use strict";var e,a,l,s,M,o,c,r,n,d,o,g,h,u,I,N,f;function D(t){return Array.isArray(t)}function v(t){return"string"==typeof t}function w(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function j(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function A(t,i){var n,s,o,c,e,r,u,n=t[0],s=[];if(D(n))for(c=T(o=t,i),e=function(t,i){var n=o[t],e={};c.forEach(function(t,i){e[t]=n[i]}),s.push(e)},r=0,u=o.length;r<u;r++)e(r,u);else s=t;return s}function T(t,i){var n=[];return i&&0<i.length?i.forEach(function(t){n.push(t.name)}):n=t.shift(),n}function b(t,i,n){return f.call(this,t,i,n)||this}function y(t,i){var n=[];return t.yMt(i,0,0,n),n=z(n)}function z(t){for(var i,n,e,s,o,i=[],n=[],e=0;e<t.length;e++)o=""+(s=t[e]).row+s.col+s.rowCount+s.colCount+s.sheetName,i.indexOf(o)<0&&(i.push(o),n.push(s));return n}function C(s,t,o,c,r,u){var a={row:o,col:c,dataSource:r,dependSheetName:void 0,targetSheetName:u.name()};t.forEach(function(t){var t,i,n,e,i=t.row,n=t.col,e=null!=(t=t.sheetName)?t:u.name();void 0===s[i]&&(s[i]=[]),void 0===s[i][n]&&(s[i][n]=[]),s[i][n].some(function(t){return t.row===o&&t.col===c&&t.dataSource===r&&t.dependSheetName===e})||(a.dependSheetName=e,s[i][n].push(a))})}function m(t,i,n){var e,s,o,c,r,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o]))for(r=0,u=c;r<u.length;r++)(a=u[r]).row>=i&&(a.row+=n)}function p(t,i,n){var e,s,o,c,r,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o])){for(r=[],u=0,a=c;u<a.length;u++)(l=a[u]).row<i?r.push(l):l.row<i+n||(l.row-=n,r.push(l));s[o]=r}}function L(t,i,n){var e,s,o,c,r,u,a;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o]))for(r=0,u=c;r<u.length;r++)(a=u[r]).col>=i&&(a.col+=n)}function x(t,i,n){var e,s,o,c,r,u,a,l;if(t)for(e in t)if(t.hasOwnProperty(e)&&(s=t[e]))for(o in s)if(s.hasOwnProperty(o)&&(c=s[o])){for(r=[],u=0,a=c;u<a.length;u++)(l=a[u]).col<i?r.push(l):l.col<i+n||(l.col-=n,r.push(l));s[o]=r}}e=this&&this.__extends||(N=function(t,i){return(N=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}N(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,a=n("Core"),l=n("SheetsCalc"),s=n("CalcEngine"),M=n("CalcEngine"),o=n("Common"),c=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),n=n("./dist/plugins/celltype/celltypes.ns.js"),d=o.Common.lt.ht,o=new o.Common.ResourceManager(n.SR,"CellTypes"),g=o.getResource.bind(o),h=!!s,u=".multiColumnNS",f=r.BaseSpreadPicker,e(b,f),b.prototype.setOptions=function(t){var i,n,e,s,t,o,n,c,e;if(f.prototype.setOptions.call(this,t),(i=this).MU=t){if(n=i.TU,e=t.dataSource,s=t.bindingInfos,t=t.border,o=i.SU,n=n.getActiveSheet(),e){c=!0,w(n),n.options.isProtected=!0,n.options.rowHeaderVisible=!1,n.selectionPolicy(a.SelectionPolicy.single),n.selectionUnit(a.SelectionUnit.row);try{i.$z(n,e,s)}catch(t){c=!1,i.dispose()}finally{c&&n&&((e=new a.Style)._showTip=!1,n.setStyle(-1,-1,e,a.SheetArea.viewport),j(n))}}d(t)||(o.style.border=t)}},b.prototype.setValue=function(t){var i,n,e,n,i,i=this;i.MU&&(f.prototype.setValue.call(this,t),n=i.TU,e=n.getActiveSheet(),n=i.tV(t),e.suspendPaint(),-1!==n?(e.clear(0,-1,-1,-1,a.SheetArea.colHeader,a.StorageType.style),e.setSelection(n,-1,1,-1)):(e.clearSelection(),(i=new a.Style).backColor="rgb(225, 225, 225)",i.foreColor="rgb(33, 115, 70)",i.font="bold 11pt Calibri",i.borderBottom=new a.LineBorder("rgb(33, 115, 70)",a.LineStyle.medium),e.setStyle(0,-1,i,a.SheetArea.colHeader),e.D3(a.Events.ActiveCellChanged+u,function(t,i){e.setSelection(0,-1,1,-1),e._3(a.Events.ActiveCellChanged+u)})),e.resumePaint())},b.prototype.dispose=function(){var t,i,n,t,i,n;this.TU.getActiveSheet()._3(a.Events.ActiveCellChanged+u),f.prototype.dispose.call(this)},b.prototype.$z=function(t,i,n){var e,i;i&&(i=this.nV(i))&&(t.setDataSource(A(i,n)),n)&&t.bindColumns(n)},b.prototype.nV=function(t){var t,i,n,e,s,e,n,o,c,r,s,u,e,o,s,e,o,t=t,i=this.CU;if(v(t)){if(h){if(s=(e=this.MU).row,e=e.col,n=(0,l.formulaToExpression)(i,t),o=void 0,i.reportDataModel?(o=i.reportDataModel.xCi.POt)&&o.setContext&&o.setContext({row:s,col:e,formula:t,triggerUpdatePrecedents:!0}):(o=i.Uw(),C(c=i.Rpe(),r=y(i,n),s,e,t,i)),s=i.getCalcService().evaluateParsedFormula(o,n,(0,M.eV)(0,0),!0),e=!1,o=void 0,!(e=!(u=M.Convert.LE(s)||M.Convert.Nh(s))||(o=M.Convert.iV(s,0,!1,!1,!1)).isError||o.isConvertError?e:!0))throw new Error(g().MultiColumn_InvalidDataSource);n=o}}else t instanceof a.Range?n=i.getArray(t.row,t.col,t.rowCount,t.colCount):D(t)?n=t:t.viewName&&(n=(o=(e=(s=i.parent)&&s.dataManager().rV)&&e[t.viewName])&&o.oV());return n},b.prototype.tV=function(t){var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,D,i=this,n=-1;if(t)if(s=(e=i.TU).getActiveSheet(),c=(o=Object.keys(t)).length,u=(r=s.getDataSource()).length,a=!1,l=i.MU.valuePath,d(l))for(M=0;M<u;M++){for(g=r[M],a=!0,h=0;h<c;h++)if(g[l=o[h]]!==t[l]&&void 0!==g[l]){a=!1;break}if(a){n=M;break}}else for(N=(I=t instanceof Date)?t+"":t,M=0;M<u;M++)if(f=r[M][l],(D=I&&f instanceof Date?f+"":f)===N){n=M;break}return n},b.prototype.submitData=function(t){var i,n,e,s,o,t,n,t,i=this,n=t.sheet,e;t.isEsc?s={notSubmit:!0}:-1<(t=(o=n.getSelections()[0]).row)&&(n=n.getDataItem(t),t=i.MU.valuePath,s={value:n=d(t)?n:n[t],text:n}),d(s)||i.fire(c.BaseDropdown.Event_ValueChanged,s)},i.MultiColumn=b,a.Worksheet.ch("dropDowns",{onLayoutChanged:function(t){var i,n,e,s,o,c,t;!d(t.sheetArea)&&3!==t.sheetArea||(n=(i=this).Rpe(),e=t.changeType,s=t.row,o=t.rowCount,c=t.col,t=t.colCount,"addRows"===e?m(n,s,o):"deletingRows"===e?p(n,s,o):"addColumns"===e?L(n,c,t):"deletingColumns"===e&&x(n,c,t))},updatePrecedents:function(t){var i,n,e,s,o,c,t,i=this,n=i.Rpe(),e=t.row,s=t.col,o=t.cells,c=t.formula,t=i.getStyle(e,s);t&&t.dropDowns&&t.dropDowns.some(function(t){return t.type===a.DropDownType.multiColumn&&t.option.dataSource===c})&&C(n,o,e,s,c,i)}})},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){"use strict";var e,w,n,j,A,s,o,c,r,u;function a(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}function l(t,i,n){var e=u.call(this,null)||this;return e.sourceElement=t,e.target=i,e.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:j.Flip|j.Slide,verAdj:j.Flip|j.Slide},e.globalMousedownEventHandler=function(t){var i,n;if(e.rf){for(n=i=t.target;n&&n!==e.sourceElement;)n=n.parentElement;n||(e.close(),t.stopPropagation(),t.preventDefault())}},e.windowResizeEventHandler=function(){e.rf&&e.close()},e.MU=e.defaultOption,e.rf=!1,n&&e.mergeOption(n),e.aV=null===e.MU.hostElement||void 0===e.MU.hostElement||!(e.MU.hostElement instanceof HTMLElement),e}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,w=n("Core"),n=n("./dist/plugins/celltype/editor/baseControl.js"),(r=j=i.DropDownAdjustment||(i.DropDownAdjustment={}))[r.None=0]="None",r[r.Flip=1]="Flip",r[r.Slide=2]="Slide",a.CreateFromDom=function(t){return new a(t.left,t.top,t.width,t.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),a.prototype.Offset=function(){for(var t,i,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},A=a,i.Rectangle=A,s="ribbon-dropdowngroup-popup",u=n.BaseControl,e(l,u),l.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},l.prototype.beforeOpen=function(){this.bindEvent()},l.prototype.dispose=function(){var i=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,i.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(s),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this._oldPosition):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},l.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},l.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},l.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},l.prototype.calcPosition=function(){var t,i,n,n,t,e,s,o,c,o,c,n,i=this.target instanceof A,t=i?this.target:A.CreateFromDom(this.target.getBoundingClientRect()),n=new A(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(n,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,e=t.getBoundingClientRect(),s=t===document.body,o=document.documentElement,c=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),o=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),c=n.X-(s?-c:e.left-t.scrollLeft),n=n.Y-(s?-o:e.top-t.scrollTop);i&&(c<0&&(c=0),n<0)&&(n=0),this.cV.style.left="".concat(c,"px"),this.cV.style.top="".concat(n,"px")},l.prototype.calculateDropDownLocation=function(t,i,n,e,s,o,c){var r,u,a,l,M,g,h,I,N,f,D,c,o,d,v,i,r={X:t.x,Y:t.y};switch(t.Offset(-r.X,-r.Y),i.Offset(-r.X,-r.Y),u=i.left,a=i.right,l=i.top,M=i.bottom,g=l,h=t.height-M,I=u,N=t.width-a,f=(c&j.Flip)===j.Flip,D=(o&j.Flip)===j.Flip,c=(c&j.Slide)===j.Slide,o=(o&j.Slide)===j.Slide,e){case w.DropDownDirection.Up:n.height>g&&f&&(e=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:n.height>h&&f&&(e=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:n.width>I&&D&&(e=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:n.width>N&&D&&(e=w.DropDownDirection.Left)}switch(v=d=0,e){case w.DropDownDirection.Up:v=l-n.height;break;case w.DropDownDirection.Down:v=M;break;case w.DropDownDirection.Left:d=u-n.width;break;case w.DropDownDirection.Right:d=a}return e===w.DropDownDirection.Up||e===w.DropDownDirection.Down?s===w.DropDownAlignment.Near?d=u:s===w.DropDownAlignment.Center?d=u-(n.width-i.width)/2:s===w.DropDownAlignment.Far&&(d=a-n.width):e!==w.DropDownDirection.Right&&e!==w.DropDownDirection.Left||(s===w.DropDownAlignment.Near?v=l:s===w.DropDownAlignment.Center?v=l-(n.height-i.height)/2:s===w.DropDownAlignment.Far&&(v=M-n.height)),i=new A(d,v,n.width,n.height),o&&(i.width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width))),c&&(i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height))),i.Offset(r),i.Location},l.prototype.render=function(){var i=this;this.aV?(this._oldPosition=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(s),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(s),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;i.cV&&(t=i.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},l.prototype.bindEvent=function(){var i=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,i.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i.PopupControl=l},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,M,g,h,I,N,f,D,d,v,w,j,A;function T(t){return document.createElement(t)}function b(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(l(0,(i[1]||"").length-parseInt(i[2],10)))}function y(t){var t,i,t=b(t||0),i=0;return i=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:i}function z(){}function C(t,i){this.Wc=i,this.fV={},this.fV=h.extend(this.fV,t)}function m(t,i){this.Wc=i,this.lV={},this.lV=h.extend(this.lV,t)}function p(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=h.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function L(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=a,this.isSelected=!1,this.yme=a,this.vV=h.extend(this.vV,t),this.gV=new f(this.Wc,this.pV())}function x(t,i){this.Wc=i,this.bV={},this.bV=h.extend(this.bV,t)}function S(t,i,n,e,s){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=s,this.MV=a,this.CV=a,this.MV=new N(this.SV(),this.Wc),this.CV=new d(this.TV(),this.Wc)}function O(t,i){var e=A.call(this,t)||this;return e.yV=a,e.wV=a,e.Y1e=a,e.Z1e=a,e.AV=a,e.Mme=function(t){var t,t,t;h.pauseEvent(t),t=e.AV.getKeyboardValueMutator(t),h.isEmpty(t)||(t=t(e._V.value),(t=e.AV.trimAlignValue(t))!==e._V.value&&(e.setValue(t),e._V.onChange(t),e._V.onAfterChange(t),e.fire(s.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},e.IV=function(t){0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){var t,i,t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.xV=function(t){var i,n;e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV),i=e.kV(t,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),h.pauseEvent(t)},e.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),i.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t,i,t=t.targetTouches[0],t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.jV=function(t){var i,i,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),i=t.changedTouches[0],i=e.kV(i,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),h.pauseEvent(t)},e.init(i),e}e=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),c=n("Core"),r=o.Common.lt.ht,u=o.Common.zf.j0,a=null,l=Math.max,M=Math.min,g=Math.abs,z.isEmpty=function(t){return void 0===t||t===a||""===t||Array.isArray(t)&&0===t.length},z.isEmptyObject=function(t){var i,n,i=!0;for(n in t)if(n){i=!1;break}return i},z.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},z.isObject=function(t){var i=typeof t;return"function"==i||"object"==i&&!!t},z.allKeys=function(t){var i,n,i=[];if(!z.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return i},z.parseStyleObject=function(t){var i,n,e,s,o,c,o;if(!z.isObject(t))return"";for(i="",e=0,s=(n=z.allKeys(t)).length;e<s;e++)c=t[o=n[e]],o=o.replace(/([A-Z])/g,"-$1"),i+="".concat(o.toLowerCase(),": ").concat(c,"; ");return i.trim()},z.extend=function(t,i,n){var e,s,o,c,r;for(void 0===n&&(n={}),e=z.allKeys(t),o=0,c=(s=z.allKeys(i)).length;o<c;o++)n[r=s[o]]=i[r];for(o=0,c=e.length;o<c;o++)void 0===n[r=e[o]]&&(n[r]=t[r]);return n},z.noop=function(){},z.measureWidth=function(t,i){var n,e,n=0,e=T("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,c.GC$)(e).width()}finally{document.body.removeChild(e)}return n},h=z,C.prototype.render=function(){var t,i;if(!this.fV.included)return a;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===a&&((i=T("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",h.parseStyleObject(t))},C.prototype.setLength=function(t,i){this.fV.length=t,r(i)||(this.fV.offset=i),this.render()},C.prototype.RV=function(){return this.fV.direction===c.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},I=C,m.prototype.render=function(){var t,i,n,e,s,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===a){for((t=T("div")).className="".concat(this.lV.className),n=0,e=(i=this.BV()).length;n<e;n++)s=this.LV(i[n]),t.appendChild(s);this.Wc.appendChild(t)}},m.prototype.LV=function(t){var i,n,n,n,i=T("span"),n=this.lV.max-this.lV.min,n=g(t-this.lV.min)/n*100+"%",n=this.lV.direction===c.LayoutDirection.vertical?{bottom:n}:{left:n};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",h.parseStyleObject(n)),i.setAttribute("key",t.toString()),i},m.prototype.BV=function(){var t,i,n,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,i){return t-i}),i=t,this.lV.dots)for(n=this.lV.min;n<=this.lV.max;n+=this.lV.step)-1===i.indexOf(n)&&i.push(n);return i},N=m,p.prototype.render=function(t,i){var t,i,n,n,e,n;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),i=new o.Formatter.GeneralFormatter(this.hV.formatString).format(i),h.isEmpty(t)&&(n=u(i),this.dV=this.dV.replace(/{{value}}/,n),(n=T("div")).innerHTML=this.dV,this.Wc.appendChild(n.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(e=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=i,n=this.GV(i),t.setAttribute("style",h.parseStyleObject(n)),this.hV.tooltipVisible?this.show():this.hide()},p.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));h.isEmpty(t)||(t.style.display="inline-block")},p.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));h.isEmpty(t)||(t.style.display="none")},p.prototype.GV=function(t){var t,t=0===(t=h.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===c.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},f=p,L.prototype.render=function(){var t,i,n,e,t=this.UV(),i=this.GV(),n=this.vV.tabIndex||0;!this.vV.disabled&&n!==a||(n=a),(e=this.Wc.querySelector(".".concat(this.vV.className)))===a&&((e=T("div")).className=t,this.Wc.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",this.vV.min.toString()),e.setAttribute("aria-valuemax",this.vV.max.toString()),e.setAttribute("aria-valuenow",this.vV.value.toString()),e.setAttribute("aria-disabled",String(this.vV.disabled)),e.addEventListener("blur",this.Sme.bind(this)),e.addEventListener("mouseenter",this.Tme.bind(this)),e.addEventListener("keydown",this.Sme.bind(this)),e.addEventListener("mousedown",this.Ame.bind(this)),e.addEventListener("touchstart",this.Ame.bind(this)),document.addEventListener("touchend",this.Ime.bind(this)),document.addEventListener("mouseup",this.Ime.bind(this))),e.tabIndex=n,e.setAttribute("style",h.parseStyleObject(i)),this.yme=e},L.prototype.Ame=function(t){this.yme.focus(),this.isSelected=!0,this.gV.show()},L.prototype.Ime=function(t){var i=this.yme;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},L.prototype.Sme=function(){this.HV(!1)},L.prototype.Tme=function(){this.gV.show()},L.prototype.isSelectedByMouse=function(t){return r(t)||(this.isSelected=t),this.isSelected},L.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},L.prototype.HV=function(t){this.mV=t},L.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},L.prototype.GV=function(){return this.vV.direction===c.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},L.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},L.prototype.dispose=function(){this.yme&&(this.yme.removeEventListener("blur",this.Sme.bind(this)),this.yme.removeEventListener("mouseenter",this.Tme.bind(this)),this.yme.removeEventListener("keydown",this.Sme.bind(this)),this.yme.removeEventListener("mousedown",this.Ame.bind(this)),this.yme.removeEventListener("touchstart",this.Ame.bind(this))),this.yme=a,document.removeEventListener("touchend",this.Ime.bind(this)),document.removeEventListener("mouseup",this.Ime.bind(this))},D=L,x.prototype.render=function(){var t,i,n,e,s,s,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===a){for((t=T("div")).className="".concat(this.bV.className),i=this.zV(),this.VV(i),n=0,e=i.length;n<e;n++)s=i[n],(s=this.YV(s))!==a&&t.appendChild(s);this.Wc.appendChild(t)}},x.prototype.VV=function(t){var i,n,e,e;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(e=h.measureWidth(e.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<e)&&(this.ZV=e)},Object.defineProperty(x.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),x.prototype.zV=function(){var t;return h.allKeys(this.bV.marks).sort(function(t,i){return t-i})},x.prototype.YV=function(i){var n,t,e,s,o,o,t,n=this,t=this.bV.marks[i],e=h.isObject(t)?t.label:t;return h.isEmptyObject(e)?a:(s="".concat(this.bV.className,"-text"),o=this.WV(i),o=h.extend(o,t.style),(t=T("span")).classList.add(s),t.setAttribute("style",h.parseStyleObject(o)),t.setAttribute("key",i.toString()),t.addEventListener("mousedown",function(t){n.bV.onClickLabel(t,i)}),t.innerHTML=u(e),t)},x.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===c.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},d=x,S.prototype.render=function(){var t=T("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===c.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},S.prototype.calcValueByPosition=function(t,i){var t,t,t=t-this.QV(),t=this.KV(t);return i?t:this.trimAlignValue(t)},S.prototype.trimAlignValue=function(t){return h.isEmpty(t)?a:this.JV(t)},S.prototype.calcOffset=function(){var t;return 100*(l(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},S.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},S.prototype.calculateNextValue=function(t,i){var n,e,e,e,n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),e=n[t](e,1),e=Object.keys(this.MU.marks)[e];return this.MU.step?n[t](i,this.MU.step):!h.isEmptyObject(this.MU.marks)&&this.MU.marks[e]?this.MU.marks[e]:i},S.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===a?t:parseFloat(t.toFixed(this.qV()))},S.prototype.qV=function(){var t,i;if(r(this.MU.precision)){for(i in t=l(y(this.MU.max),y(this.MU.min),y(this.MU.step)),this.MU.marks)t=l(y(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},S.prototype.XV=function(i){var t,n,n,n,n,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==a&&(n=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=M((i-this.MU.min)/this.MU.step,n),n=Math.round(n)*this.MU.step+this.MU.min,t.push(M(n,this.MU.max))),n=t.map(function(t){return g(i-t)}),t[n.indexOf(M.apply(void 0,n))]},S.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.TV=function(){var n=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?h.noop:function(t,i){n.$V(t,i)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.$V=function(t,i){},S.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===c.LayoutDirection.vertical?t.top:t.left},S.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===c.LayoutDirection.vertical?t.height:t.width},S.prototype.KV=function(t){var i,n,t,i=this.MU.min,n=this.MU.max,t=g(l(t,0)/this.tY());return(t=this.MU.direction===c.LayoutDirection.vertical?l(1-t,0):t)*(n-i)+i},v=S,A=s.BaseDropdown,e(O,A),O.prototype.setValue=function(t){var i,n,i;this._V.disabled||(this._V.showNumberRange?(r(this.W1e)&&(this.W1e={}),i=t.start,n=t.end,i=parseFloat(i),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.numberRange.start=i,this.W1e.start=i,this.Y1e.setOffset(this.calcOffset(i),i),n=parseFloat(n),n=isNaN(n)?this._V.max:(n=l(this._V.min,n),M(this._V.max,n)),n=l(i,n),this._V.numberRange.end=n,this.W1e.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.Z1e.setOffset(this.calcOffset(n),n)):(i=parseFloat(t),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),M(this._V.max,i)),this._V.value=i,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),i)))},O.prototype.calcOffset=function(t){var t,t,t=r(t)?this._V.value:t,t=l(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},O.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=l(t,0)/(this._V.max-this._V.min);return 100*(t=M(t,1))},O.prototype.setOptions=function(t){this.init(t)},O.prototype.init=function(t){var t,i,t,n,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=T("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===c.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(i=T("div")).className=this.UV(),t.appendChild(i),this.yV=new I(this.iY(),i),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,n=T("div"),i.appendChild(n),this.Y1e=new D(t,n),t.tabIndex++,t.value=this._V.numberRange.end,n=T("div"),i.appendChild(n),this.Z1e=new D(t,n),this.AV=new v(i,this.yV,this.Y1e,this.Z1e,this.oY())):(this.wV=new D(this.rY(),i),this.AV=new v(i,this.yV,this.wV,a,this.oY())),this.AV.render(),this.aY(i)},O.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Mme))},O.prototype.Cme=function(t,i){var n,e,n,s,i,o,c,o,c,n=this._V.numberRange,e=n.start,n=n.end,s=g(i-e),i=g(n-i),o=this.Y1e,c=this.Z1e;e===n?(n<t?(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})):t<e&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})),o.isSelectedByMouse(!1),c.isSelectedByMouse(!1)):(o=this.Z1e.isSelectedByMouse(),c=this.Y1e.isSelectedByMouse(),(o&&s<i||i<s&&!c)&&n!==t&&(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})),(c&&i<s||s<i&&!o)&&e!==t&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})))},O.prototype.kV=function(t,i){var n=0,n;return n=this._V.direction===c.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},O.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:c.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},O.prototype.eY=function(){(h.isEmpty(this._V)||h.isEmptyObject(this._V))&&(this._V={}),this._V=h.extend(this.uY(),this._V)},O.prototype.nY=function(t){var n=this;t&&(r(t.scaleVisible)||(this._V.dots=t.scaleVisible),r(t.direction)||(this._V.direction=t.direction),r(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),r(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),r(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,i,t=parseFloat(t);isNaN(t)||t>=n._V.min&&t<=n._V.max&&(i=new o.Formatter.GeneralFormatter(n._V.formatString),n._V.marks[t]={label:i.format(t)})})},O.prototype.sY=function(t,i){var t;r(t)||(t=parseFloat(t),isNaN(t))||(this._V[i]=t)},O.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},O.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},O.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},O.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===c.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),h.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},O.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Mme)),this.yV.Wc=a,this.wV&&this.wV.dispose(),this.wV=a,this.Y1e&&this.Y1e.dispose(),this.Y1e=a,this.Z1e&&this.Z1e.dispose(),this.Z1e=a,A.prototype.dispose.call(this)},i.Slider=O},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){"use strict";var e,s,o,c,r,u,a,l,M;function g(t,i){var t=M.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),c="undefined",r=n("Common"),u=r.Common.lt.ht,M=o.BaseDropdown,e(g,M),g.prototype.setOptions=function(t){var i,i,i,i;t&&(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(i=this.cY(t.max))&&(this.MU.max=i),null!==(i=this.cY(t.step))&&(this.MU.step=i),u(t.formatString)||(this.MU.formatString=t.formatString),u(t.height)||(i=parseInt(t.height,10),isNaN(i))||(this.MU.height=i),this.MU.height=Math.max(1,this.MU.height)),this._6()},g.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},g.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},g.prototype.Hc=function(){var i=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},g.prototype.cY=function(t){var i,n,n,n,i=null;return u(t)||(i={},u(t.hour)||(n=parseInt(t.hour,10),isNaN(n))||(i.hour=n),u(t.minute)||(n=parseInt(t.minute,10),isNaN(n))||(i.minute=n),u(t.second))||(n=parseInt(t.second,10),isNaN(n))||(i.second=n),i},g.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.lY()),this.yz()},g.prototype.yz=function(){var t,i,n,e,s,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=+t[i].getAttribute("hour"),e=+t[i].getAttribute("minute"),s=+t[i].getAttribute("second"),this.hY(this.Bz,{hour:n,minute:e,second:s})&&t[i].classList.add("selected")},g.prototype.lY=function(){var s=this;return{items:function(){var t,i,n,e,t=s.dY(),i=document.createElement("div");for(i.classList.add("gc-time-picker-container"),s.Wc=i,s.MU.height<0?i.style.height="auto":i.style.maxHeight=s.MU.height+"px",(n=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<t.length;e++)n.appendChild(s.vY(t[e]));return 24*t.length>s.MU.height&&0<=s.MU.height?i.style.overflowY="scroll":i.style.overflowY="hidden",i.appendChild(n),i}}},g.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},g.prototype.dY=function(){for(var t,i,n,t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},g.prototype.pY=function(t,i){return typeof i.hour!=c&&t.setHours(t.getHours()+i.hour),typeof i.minute!=c&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!=c&&t.setSeconds(t.getSeconds()+i.second),t},g.prototype.mY=function(t){var i,n,t,i=new Date;return i.setHours(t.hour),i.setMinutes(t.minute),i.setSeconds(t.second),(t=(n=new r.Formatter.GeneralFormatter(this.MU.formatString)).format(i))&&""!==t&&null!==t?t:this.bY(i)},g.prototype.bY=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?"AM":"PM")+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},g.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},g.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour)&&t.minute===i.minute&&t.second===i.second},g.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},g.prototype.pz=function(t){var t,i,n,t,e,s,s,t=t.target;t&&(i=+t.getAttribute("hour"),n=+t.getAttribute("minute"),t=+t.getAttribute("second"),(e=this.fY||new Date).setHours(i),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),s=(new r.Common.CultureInfo).DateTimeFormat,s=new r.Formatter.GeneralFormatter(s.defaultDatePattern).format(e),this.fire(o.BaseDropdown.Event_ValueChanged,{value:e,text:s}),this.Bz={hour:i,minute:n,second:t},this.yz())},i.TimePicker=g},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){"use strict";var e,s,o,n,u,c,r,a;function l(t,i){var n=a.call(this,t)||this;return n.wY=new o.List(t),n.wY.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t)}),n.setOptions(i),n}function M(t,i){var e,s,o,n,c,r,e={items:[]},s=t.items,o=s.filter(function(t){return t.value===i})[0];if(u(o)&&s&&0<s.length)(n=e.items).push({text:s[0].value,value:s[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(c=function(t){var i,t,n,i=o.transitions[t];"number"==typeof i&&s[i]&&(i=s[i].value),(t=s.filter(function(t){return t.value===i})[0])&&(n=e.items).push({text:t.value,value:t.value})},r=0;r<o.transitions.length;r++)c(r);return e}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/editor/listControl.js"),n=n("Common"),u=n.Common.lt.ht,a=s.BaseDropdown,e(l,a),l.prototype.setOptions=function(t){this.MU=t},l.prototype.setValue=function(t){var t;this.MU&&(t=M(this.MU,t),this.wY.setOptions(t))},l.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i.WorkFlow=l},"./dist/plugins/celltype/fileUploadCellType/action.js":function(t,i,n){"use strict";var I,N,f,e;function s(t,i){this.X5=N.beforeAction,this.q5=N.afterAction;var n=this;n.Mf=t,n.tT=i}Object.defineProperty(i,"__esModule",{value:!0}),i.UPLOAD_FILE=void 0,I=n("Core"),N=n("./dist/plugins/celltype/actionUtils.js"),f=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),s.prototype.execute=function(){var t,i,n,e,s,o,c,r,u,a,l,M,g,h,t=this,i=t.Mf,n=t.tT,e=i.parent.i4(),s=!0;I.Commands.II(e),t.X5(i,!0),(0,N.suspendCalcService)(i);try{o=n.row,c=n.col,r=n.newValue,u=n.fileGUID,a=n.newFileWrapper,l=n.oldFileWrapper,M=n.valuePath,g=i.getValue(o,c),(h=(0,f.getValueByValuePath)(r,M))?(a.id=u,i.Ut.setFileGUID(o,c,u),i.setValue(o,c,h),i.Ut.UHe(a)):(i.setValue(o,c,h),i.Ut.setFileGUID(o,c,void 0),i.Ut.GHe(l)),i.eT(n.row,n.col,g,h)}catch(t){s=!1}finally{I.Commands.xI(e,n),(0,N.resumeCalcService)(i,!1),t.q5(i,!0)}return s},s.prototype.undo=function(){var t,i,n,e,s,t=this,i=t.Mf,n=t.tT,e=!0;t.X5(i,!0),(0,N.suspendCalcService)(i);try{s=I.Commands.TI(i.name()),i.Ut.undo(n[s]),i.eT(n.row,n.col,n.newValue,n.oldValue)}catch(t){e=!1}finally{(0,N.resumeCalcService)(i,!1),t.q5(i,!0)}return e},s.prototype.canExecute=function(){return!0},s.prototype.canUndo=function(){return!0},e=s,i.UPLOAD_FILE="uploadFile",I.Commands[i.UPLOAD_FILE]={canUndo:!0,execute:function(t,i,n){return(0,N.executeCommand)(t,e,i,n)}}},"./dist/plugins/celltype/fileUploadCellType/definition-comments.js":function(){},"./dist/plugins/celltype/fileUploadCellType/feature-register.js":function(t,i,n){"use strict";var e,s;function o(){e.Worksheet.ch("fileUploadCellType",{preUploadFile:function(t){var i,i,i,n,i,n=t.sheet.isReportTemplateSheet,i="19"===(null==(i=null==(i=null==(i=t.sheet.sw.cellTypeHitInfo)?void 0:i.cellStyle)?void 0:i.cellType)?void 0:i.typeName);t.cancel=n&&i}}),e.Workbook.ch("registerUploadFileCommand",{init:function(){this.commandManager().register(s.UPLOAD_FILE,e.Commands[s.UPLOAD_FILE])}})}Object.defineProperty(i,"__esModule",{value:!0}),i.registerFeatures=void 0,e=n("Core"),s=n("./dist/plugins/celltype/fileUploadCellType/action.js"),i.registerFeatures=o},"./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js":function(t,i,n){"use strict";var e,n,s,o,c;function r(){return null!==c&&c.apply(this,arguments)||this}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.T9e=void 0,n=n("Core"),c=n.Ase,e(r,c),r.prototype.rQ=function(t,i){this.Dn(),this.I9e(t,i),this.q2e(),this.$2e(i)},r.prototype.Dn=function(){this.Wc.html(this.k9e())},r.prototype.I9e=function(t,i){var n,e,s,n;c.prototype.$c.call(this),e=(n=this.Wc.get(0)).querySelector(".gc-sjs-file-preview-dialog-title-text"),s=n.querySelector(".gc-sjs-file-preview-dialog-image"),n=n.querySelector(".gc-sjs-file-preview-dialog-container"),e.textContent=t,s.src=i,s.alt=i,n.style.maxHeight=this.Fc.height()-50+"px"},r.prototype.rpe=function(t){var i,t,i,t=t.target.dataset.cmd;t&&"close"===t&&this.close()},r.prototype.q2e=function(){var i,t,n,e,i=this,t=function(t){i.rpe(t)},n=function(t){"Escape"!==t.key&&27!==t.keyCode||i.close()};this.Wc.bind("click",t),document.addEventListener("keyup",n),e=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-file-preview-dialog-title")),this.wpt=function(){i.Wc.unbind("click",t),document.removeEventListener("keyup",n),e()}},r.prototype.$2e=function(t){var o,c,o=this,c=new Image;o.Wc.css(["display"],["none"]),c.onload=function(){var t,i,n,i,t,e,s,i,t=c.width,i=c.height,n=o.Wc.width(),i=i/t*n,t=o.Fc.width(),e,s,i=(o.Fc.height()-i)/2;o.Wc.css(["position","left","top","display"],["absolute",(t-n)/2+"px",(0<i?i:20)+"px","block"])},c.src=t},r.prototype.close=function(){this.wpt&&this.wpt(),c.prototype.close.call(this)},r.prototype.k9e=function(){return'\n<div class="gc-sjs-file-preview-dialog-container">\n  <div class="gc-sjs-file-preview-dialog-title">\n      <span class="gc-sjs-file-preview-dialog-title-text"></span>\n      <span class="cancel-icon" data-cmd="close">\xd7</span>\n  </div>\n  <div class="gc-sjs-file-preview-dialog-content">\n        <img class="gc-sjs-file-preview-dialog-image" src="#" alt="#" width="100%" />\n  </div>\n</div>\n      '},i.T9e=r},"./dist/plugins/celltype/fileUploadCellType/fileUploadCellType.js":function(t,i,n){"use strict";var e,s,o,g,c,r,w,l,j,n,o,u,M,a,h,I;function N(){var t=I.call(this)||this;return t.typeName="19",t._text=(0,w.getSR)().FileUpload_Title,t.N9e=M,t.j9e=M,t._9e=22,t.Hc(),t}e=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var i,n,e,s,n=1,e=arguments.length;n<e;n++)for(s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)},Object.defineProperty(i,"__esModule",{value:!0}),i.FileUpload=void 0,o=n("Common"),g=n("Core"),c=n("./dist/plugins/celltype/fileUploadCellType/filePreviewDialog.js"),r=n("./dist/plugins/celltype/fileUploadCellType/feature-register.js"),w=n("./dist/plugins/celltype/fileUploadCellType/utils.js"),n("./dist/plugins/celltype/fileUploadCellType/definition-comments.js"),l=o.Common.lt.ht,j=g.CellTypes.Text,n=g.CellTypes.Base,o=g.GC$,u=o.each,M=null,e(N,I=n),N.prototype.x9e=function(t,i){(0,w.x9e)(t,i)},N.prototype.thumbnailSize=function(t){return t&&(t.width?this.D9e.width=t.width:delete this.D9e.width,t.height?this.D9e.height=t.height:delete this.D9e.height),this.D9e},N.prototype.Hc=function(){var n=this;u(w.defaultFileUploadProps,function(t,i){n["_"+t]=i}),n.D9e={}},N.prototype.O9e=function(t,i,n){var e;return this.E9e(this.R9e(t,i,n))&&(this._isPreviewEnabled||this._isDownloadEnabled||this._isClearEnabled)},N.prototype.F9e=function(t,i,n){var e,e,s,o,c,s,o=t.Oi&&t.HO(i,n),c;return((null==(e=this.N9e)?void 0:e.row)===i&&(null==(e=this.N9e)?void 0:e.col)===n||o)&&this.O9e(t,i,n)},N.prototype.B9e=function(t,i){var t,n,t,n="",t=null==t?void 0:t.split(".");return(n=t&&1<t.length?t.pop():null!=(t=w.MIMETYPE_TO_FILE_EXTENSION_MAP[i])?t:"").toLowerCase()},N.prototype.L9e=function(t,i,n){var t,t,t,n,t,t=null!=(t=null==(t=null==(t=t.getParent())?void 0:t.options)?void 0:t.builtInFileIcons)?t:n;return null!=(n=null==t?void 0:t[i])?n:w.ICON_MAP.commonFile},N.prototype.E9e=function(t){return(0,w.E9e)(t)},N.prototype.P9e=function(t,i,n){var e,i,s,n,t,t,e=[],i=this.R9e(t,i,n,!0);return i?(s=this.B9e(i.name,i.type),n=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return s===t}),t=(t=t.BO()).getState(i.dataUrl)&&!t.qh(i.dataUrl),this._isPreviewEnabled&&(n&&!t||this.previewCommand)&&e.push("preview"),!this._isDownloadEnabled||n&&t||e.push("download"),e):[]},N.prototype.G9e=function(t,i,n){return this.P9e(t,i,n).map(function(t){return w.ICON_MAP[t]})},N.prototype.U9e=function(t,i,n,e){var t,i,s,t=this.G9e(t,i,n).length,i=.2*e>this._9e?this._9e:.2*e,s;return{iconSize:i,space:(e-i*t)/(t+1)}},N.prototype.H9e=function(t){var i=t.BO();Object.values(w.ICON_MAP).forEach(function(t){i.addImage(t,"anonymous")})},N.prototype.R9e=function(t,i,n,e,s){var o,c,r,u,c,a,c,e,o=t.Ut.getFileGUID(i,n),c=t.VTe(),r=t.getValue(i,n),u=c.Wxn(o,!0),c=c.FHe(o),a=this._valuePath;if(c||!r)return u&&(e?u:(c={dataUrl:u.dataUrl,blob:u.blob,name:u.name},e=(0,w.getValueByValuePath)(c,a,u),(0,w.isFileInfoEqual)(e,r)||s?c:void(0,w.x9e)({row:i,col:n,value:r,valuePath:a,fileGUID:o},t,void 0,!0)));(0,w.x9e)({row:i,col:n,value:r,fileGUID:o,valuePath:a},t,void 0,!0)},N.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,l,M,g,h,I,N,N,u=this;t&&(a=n+u._marginLeft,l=e+u._marginTop,M=s-u._marginLeft-u._marginRight,g=o-u._marginTop-u._marginBottom,h=n<a+M&&a<n+s&&e<l+g&&l<e+o,I=u._text,N=u.R9e(r.sheet,r.row,r.col,void 0,r.isPrinting),N=u.E9e(N),0<M-2)&&0<g-2&&h&&(t.save(),(a<n||n+s<a+M||l<e||e+o<l+g)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),N?(u.V9e(t,a,l,M,g,c,r),this.F9e(r.sheet,r.row,r.col)&&u.z9e(t,n,e,s,o,c,r)):u.Y9e(t,I,a,l,M,g,c,r),t.restore())},N.prototype.getText=function(t){return t},N.prototype.Fn=function(t,i,n,e,s){var o,c,r,r,u,n,a,e,l,M,o=s.sheet,c=s.row,r=s.col,r=this.R9e(o,c,r,!0),u=this.marginTop()+this.marginBottom(),n=I.prototype.Fn.call(this,t,r&&t?r.name:(0,w.getSR)().FileUpload_Title,n,e,s)+u;return r&&t&&(a=3,e=parseFloat(o.getRowHeight(c,g.SheetArea.viewport)+"")-3,l=this.B9e(r.name,r.type),(M=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?n=e:n*=2.5),n},N.prototype.Ln=function(t,i,n,e,s){var o,c,r,c,u,n,a,e,l,M,o=s.sheet,c=s.row,r=s.col,c=this.R9e(o,c,r,!0),u=this.marginTop()+this.marginBottom(),n=I.prototype.Ln.call(this,t,c&&t?c.name:(0,w.getSR)().FileUpload_Title,n,e,s)+u;return n=c&&t&&(a=3,e=parseFloat(o.getColumnWidth(r,g.SheetArea.viewport)+"")-3,l=this.B9e(c.name,c.type),M=-1!==w.IMAGE_FILE_EXTENSIONS.findIndex(function(t){return l===t}))?e:n},N.prototype.Y9e=function(t,i,n,e,s,o,c,r){var u,u,a,l,u,M,g,h,I,M,u,g,h,I,M,I,M,g,h,u,a=this,l=3,u=(null==(u=a.N9e)?void 0:u.row)===r.row&&(null==(u=a.N9e)?void 0:u.col)===r.col,M=r.sheet.currentTheme().colors().accent1(),g=M.r,h=M.g,I=M.b,M=M.a,u=u?"rgba(".concat(g,",").concat(h,",").concat(I,",").concat(M,")"):"rgb(217,217,217)",g=n+1,h=e+1,I=s-2,M=o-2;t.setLineDash([3,2]),t.moveTo(g+3,h),t.lineTo(g+I-3,h),t.arc(g+I-3,h+3,3,1.5*Math.PI,2*Math.PI),t.lineTo(g+I,h+M-3),t.arc(g+I-3,h+M-3,3,0,.5*Math.PI),t.lineTo(g+3,h+M),t.arc(g+3,h+M-3,3,.5*Math.PI,Math.PI),t.lineTo(g,h+3),t.arc(g+3,h+3,3,Math.PI,1.5*Math.PI),t.lineTo(g,h+3),t.closePath(),u&&t.strokeStyle!==u&&(t.strokeStyle=u),t.lineWidth=2,t.stroke(),M=(I=r.sheet.currentTheme().colors().background2()).r,g=I.g,h=I.b,u=I.a,t.fillStyle="rgba(".concat(M,", ").concat(g,", ").concat(h,", ").concat(u,")"),t.fill(),j.prototype.paintValue.call(a,t,i,n,e,s,o,c,r)},N.prototype.V9e=function(t,i,n,e,s,o,c){var r,u,u,r,r,a,l,M,g,h,a,g,h,I,u,M,h,I,M,r,N,f,r,D,u,r,a,u,d,v,l=this,M=c.sheet,g=c.row,h=c.col;this.H9e(M),a=l.thumbnailSize(),(g=this.R9e(M,g,h,!0))&&(h=g.dataUrl,u=(I=l.B9e(g.name,g.type))&&-1<w.IMAGE_FILE_EXTENSIONS.indexOf(I),M=l.L9e(M,I,c.builtInFileIcons),(M=(I=c.imageLoader).getImage(h=u?h:M))||I.addImage(h,"anonymous"),r=I.getState(h),"string"!=typeof h&&h&&h.toString&&!r&&(h=h.toString(),r=u=!0),r)&&(u?I.qh(h)?(N=null!=(r=a.width)?r:e-2,f=null!=(u=a.height)?u:s-2,t.drawImage(M,0,0,M.width,M.height,i+1,n+1,N,f)):(r=I.getImage(w.ICON_MAP.errorFile))&&t.drawImage(r,0,0,r.width,r.height,i+1,n+1,null!=(u=a.width)?u:e-2,null!=(r=a.height)?r:s-2):(D=4,u=e<.6*(s-2)?.6*(e-2):.6*(s-2)-8,r=(e-2-(N=null!=(r=a.width)?r:u))/2+1,a=(.6*(s-2)-(f=null!=(a=a.height)?a:u))/2+1,I.qh(h)?t.drawImage(M,0,0,M.width,M.height,i+r,n+a,N,f):(u=I.getImage(w.ICON_MAP.commonFile),t.drawImage(u,0,0,u.width,u.height,i+r,n+a,N,f)),j.prototype.paintValue.call(l,t,g.name,i,v=n+.6*(s-2),e,.4*(s-2),o,c)))},N.prototype.z9e=function(t,i,n,e,s,o,c){this.Z9e(t,i,n,e,s),this.Q9e(t,i,n,e,s,o,c)},N.prototype.Z9e=function(t,i,n,e,s){t.save(),t.beginPath(),t.rect(i,n,e,s),t.fillStyle="rgba(0, 0, 0, 0.3)",t.fillRect(i,n,e,s),t.restore()},N.prototype.Q9e=function(t,i,n,e,s,o,c){this.W9e(t,i,n,e,s,c),this.J9e(t,i,n,e,s,c)},N.prototype.W9e=function(e,s,t,o,i,c){var r,u,n,a,l,M,g,r=this,u=c.sheet.BO();e.save(),e.beginPath(),n=this.U9e(c.sheet,c.row,c.col,o),a=n.iconSize,l=n.space,M=t+(i-a)/2,g=this.P9e(c.sheet,c.row,c.col),this.G9e(c.sheet,c.row,c.col).forEach(function(t,i){var t,n,i;u.getImage(t)||r.H9e(c.sheet),u.getState(t)&&u.qh(t)&&(t=u.getImage(t),n=s+(i+1)*l+i*a,g[i]===r.j9e&&(e.fillStyle="rgba(255, 255, 255, 0.3)",i=.2*o>r._9e?4:2,e.fillRect(n-i,M-i,a+2*i,a+2*i)),e.drawImage(t,n,M,a,a))}),e.restore()},N.prototype.J9e=function(t,i,n,e,s,o){var c,i,r,u,e,n,a,o;this.isClearEnabled()&&(c=o.sheet.BO(),t.save(),t.beginPath(),e=i+e-(i=this.U9e(o.sheet,o.row,o.col,e).iconSize)-4,n=n+(u=r=2)+2,a=w.ICON_MAP.clear,c.getImage(a)||this.H9e(o.sheet),c.getState(a)&&c.qh(a)&&(o=c.getImage(a),"clear"===this.j9e&&(t.fillStyle="rgba(255, 255, 255, 0.3)",t.fillRect(e-2,n-2,i+4,i+4)),t.drawImage(o,e,n,i,i)),t.restore())},N.prototype.processMouseUp=function(t){var i,i,n,e,s,i={cancel:!1,sheet:t.sheet};if(g.Worksheet.et(t.sheet,"preUploadFile",i),!i.cancel&&this.K9e(t))return i=t.sheet,n=t.row,e=t.col,this.F9e(i,n,e)?(this.X9e(t),!0):!(this.O9e(i,n,e)||(this.H9e(i),!i)||!t.isReservedLocation||((s=this.q9e(t)).click(),0))},N.prototype.processMouseEnter=function(t){var i,n,t;return!!this.K9e(t)&&(i=t.sheet,n=t.row,t=t.col,this.N9e={row:n,col:t},i.zw(),!0)},N.prototype.processMouseLeave=function(t){return this.K9e(t)&&(this.N9e=M,t.sheet.zw()),!1},N.prototype.processMouseMove=function(t){var i,i,n,e,s,i;return!!this.K9e(t)&&(n=t.sheet,e=t.row,s=t.col,this.N9e&&(null==(i=this.N9e)?void 0:i.col)===s&&(null==(i=this.N9e)?void 0:i.row)===e||(this.N9e={row:e,col:s}),!!this.F9e(n,e,s))&&((i=this.$9e(t))!==this.j9e&&(this.j9e=i,n.zw()),!0)},N.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,u,a,o,e,o=this;return s&&(c=s.sheetArea,l(c)||3===c)&&e?(r=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:c,sheet:s.sheet,cellStyle:n},r<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):M},N.prototype.getOperationRects=function(t){var i,n,e,s,o,n,e,s,n,c,s,n,i={},n=t.sheet,e=t.row,s=t.col,o=this.P9e(n,e,s),n=this.U9e(n,e,s,t.cellRect.width),e=n.iconSize,s=n.space,n=t.cellRect.y+(t.cellRect.height-e)/2,c={x:t.cellRect.x+s-2,y:n-2,width:e+4,height:e+4},s={x:t.cellRect.x+e+2*s-2,y:n-2,width:e+4,height:e+4};return 2===o.length?(i[o[0]]=c,i[o[1]]=s):1===o.length&&(i[o[0]]=c),this.isClearEnabled()&&(n={x:t.cellRect.x+t.cellRect.width-e-6,y:t.cellRect.y-2,width:e+4,height:e+8},i.clear=n),i},N.prototype.$9e=function(t){var i,n,e,s,o,s,i,n,e,s,n,t,o,i=t.sheet,n=t.row,e=t.col,s=this.U9e(i,n,e,t.cellRect.width),o=s.iconSize,s=s.space,i=this.P9e(i,n,e),n=t.cellRect.y+(t.cellRect.height-o)/2,e=t.x>=t.cellRect.x+s-2&&t.x<=t.cellRect.x+o+s+2,s=t.x>=t.cellRect.x+o+2*s-2&&t.x<=t.cellRect.x+2*o+2*s+2,n=t.y>=n-2&&t.y<=n+o+2,t=t.x>=t.cellRect.x+t.cellRect.width-o-6&&t.x<=t.cellRect.x+t.cellRect.width-2&&t.y>=t.cellRect.y-2&&t.y<=t.cellRect.y+o+6&&this.isClearEnabled(),o=e&&n?i[0]:s&&n?i[1]:t?"clear":M;return o},N.prototype.q9e=function(t){var i,n,e,i=this,n="sjs-fake-file-upload-dom";return document.getElementById(n)&&document.getElementById(n).remove(),(e=document.createElement("input")).type="file",e.style.display="none",e.accept=i.accept(),e.id=n,e.addEventListener("change",function(){i.D7e(t,e),e.remove()}),document.body.appendChild(e),e},N.prototype.G7e=function(t,i,n,e){var s=this.R9e(t,i,n);(0,w.x9e)({row:i,col:n,value:e,oldValue:s,valuePath:this._valuePath},t,!0)},N.prototype.D7e=function(t,i){var n,e,t,i,s,s,n=t.sheet,e=t.row,t=t.col,i=i.files[0];i&&(i.size>1024*this.maxSize()?(s={row:e,col:t,maxSize:this.maxSize(),fileSize:i.size},n.jT(g.InvalidOperationType.sizeLimitExceeded,n.A9e(),s)):(s={name:i.name,blob:i},this.G7e(n,e,t,s)))},N.prototype.U7e=function(t,i){var n,e,s,o,n=t.sheet,e=t.col,s=t.row,o=this.R9e(n,s,e);if(this.E9e(o)){switch(i){case"preview":this.V7e(o,t);break;case"download":this.Y7e(n,s,e);break;case"clear":this.Z7e(n,s,e)}this.N9e=M,this.j9e=M}},N.prototype.K9e=function(t){var i=t.sheet,n=t.col,t=t.row;return!(i.isActualProtected()&&i.getCell(t,n).locked())},N.prototype.Q7e=function(t){var i;new c.T9e(document.body,2e3,!0).rQ(t.name,t.dataUrl)},N.prototype.V7e=function(t,i){var n,e,i,i,e;this.previewCommand?(n=i.sheet,e=i.col,i=i.row,i=s(s({},t),{sheetName:n.name(),row:i,col:e}),"function"==typeof this.previewCommand?this.previewCommand(i):"string"==typeof this.previewCommand&&null!=(e=n.getParent())&&e.commandManager().execute(s({cmd:this.previewCommand},i))):this.Q7e(t)},N.prototype.Y7e=function(t,i,n){var t,e,i,t=this.R9e(t,i,n,!0);t&&(e=window.URL.createObjectURL(t.blob),(i=document.createElement("a")).href=e,i.download=t.name,i.type=t.type,i.click(),setTimeout(function(){window.URL.revokeObjectURL(e)}))},N.prototype.Z7e=function(t,i,n){this.G7e(t,i,n)},N.prototype.X9e=function(t){this.j9e===M&&(this.j9e=this.$9e(t)),this.U7e(t,this.j9e)},N.prototype.Je=function(t){var t,i,i={marginTop:t.marginTop,marginRight:t.marginRight,marginBottom:t.marginBottom,marginLeft:t.marginLeft,maxSize:t.maxSize,accept:t.accept,isPreviewEnabled:t.isPreviewEnabled,isDownloadEnabled:t.isDownloadEnabled,isClearEnabled:t.isClearEnabled};t.hasOwnProperty("valuePath")&&(i.valuePath=null!=(t=t.valuePath)?t:null),this.fromJSON(i)},N.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(w.defaultFileUploadProps,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},N.prototype.fromJSON=function(n){var e=this;u(w.defaultFileUploadProps,function(t){var i=n[t];void 0!==i&&(e["_"+t]=i)})},a=N,i.FileUpload=a,u(w.defaultFileUploadProps,function(i){a.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t="valuePath"===i&&void 0===t?null:t,this)}}),(0,r.registerFeatures)(),g.CellTypes.ti[19]=a},"./dist/plugins/celltype/fileUploadCellType/utils.js":function(t,N,i){"use strict";var n,i,i,e,s,f,o,c;function r(t,i,n){if(n||t){if("string"==typeof i)return(n||t)[i];if(n&&n.hasOwnProperty(i))return n[i];if(e(i)&&n)return n.cellValue}return t}function u(t,i){var n,e,s,o,n=typeof t,e;if(n!=typeof i)return!1;if("string"==n)return t===i;if("object"==n){if(t instanceof Blob||i instanceof Blob)return t===i;if(t&&i)return t.blob===i.blob&&t.dataUrl===i.dataUrl&&t.name===i.name}return!0}Object.defineProperty(N,"__esModule",{value:!0}),N.isFileInfoEqual=N.getValueByValuePath=N.x9e=N.Hne=N.E9e=N.defaultFileUploadProps=N.MIMETYPE_TO_FILE_EXTENSION_MAP=N.IMAGE_FILE_EXTENSIONS=N.ICON_MAP=N.getSR=void 0,n=i("Common"),i=i("./dist/plugins/celltype/celltypes.ns.js"),i=new n.Common.ResourceManager(i.SR,"CellTypes"),e=n.Common.lt.ht,N.getSR=i.getResource.bind(i),N.ICON_MAP={commonFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y29tbW9uIGZpbGUgaW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImNvbW1vbi1maWxlLWltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNTAsMiBDNTIuMjA5MTM5LDIgNTQsMy43OTA4NjEgNTQsNiBMNTQsNTggQzU0LDYwLjIwOTEzOSA1Mi4yMDkxMzksNjIgNTAsNjIgTDE0LDYyIEMxMS43OTA4NjEsNjIgMTAsNjAuMjA5MTM5IDEwLDU4IEwxMCwxOC4xMDEwNzQyIEwyMS45NjMzNzg5LDE4LjEwMTA3NDIgQzI0LjE3MjUxNzksMTguMTAxMDc0MiAyNS45NjMzNzg5LDE2LjMxMDIxMzIgMjUuOTYzMzc4OSwxNC4xMDEwNzQyIEwyNS45NjMzNzg5LDIgTDUwLDIgWiBNMjMsMiBMMjMsMTUgTDEwLDE1IEwyMywyIFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70iIGZpbGw9IiM1MTUxNTEiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",errorFile:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZXJyb3IgSW1hZ2U8L3RpdGxlPgogICAgPGcgaWQ9ImVycm9yLUltYWdlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgOC4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cG9seWdvbiBpZD0i5b2i54q257uT5ZCILXBhdGjlpIfku70tMiIgZmlsbD0iI0ZGRkZGRiIgcG9pbnRzPSI2MCA0LjI2MzI1NjQxZS0xNCAwIDQuMjYzMjU2NDFlLTE0IDAgNDguOTQ3MzY4NCA2MCA0OC45NDczNjg0Ij48L3BvbHlnb24+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0yNi44MjYsMCBMMzIsMTEuMzMwMDc4MSBMMjIsMjMuMTIxMDkzNyBMMjksMzguODQzNzUgTDI0LjEyOCw0OCBMNCw0OCBDMS43OTA4NjEsNDggLTEuMTk2OTk2ODhlLTE1LDQ2LjIwOTEzOSAwLDQ0IEwwLDQgQy0yLjcwNTQxNWUtMTYsMS43OTA4NjEgMS43OTA4NjEsLTEuMDYxNzI2MTNlLTE1IDQsMCBMMjYuODI2LDAgWiBNNTYsMCBDNTguMjA5MTM5LC00LjA1ODEyMjUxZS0xNiA2MCwxLjc5MDg2MSA2MCw0IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDk0LDQ4IEwzNiwzOC42MjY5NTMxIEwyOSwyMy40OTgwNDY5IEwzOSwxMS4yNTM5MDYyIEwzMy44MzYsMCBMNTYsMCBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjRTVFNUU1Ij48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNi4zNjU2ODUxLDE1IEwyMy4wMzEsMjIuMDA3IEwyMiwyMy4xMjEwOTM3IEwyOSwzOC44NDM3NSBMMjQuMTI3LDQ4IEw0LDQ4IEMxLjc5MDg2MSw0OCAyLjc2Njg4MDE4ZS0xNCw0Ni4yMDkxMzkgMi44NDIxNzA5NGUtMTQsNDQgTDIuODQyMTcwOTRlLTE0LDMxLjIxMTA3MTIgTDE2LjM2NTY4NTEsMTUgWiBNNDguMzkxNjc2OCwyNi4wMTg3NTQyIEw2MCwzNS42NDIyNzM1IEw2MCw0NCBDNjAsNDYuMjA5MTM5IDU4LjIwOTEzOSw0OCA1Niw0OCBMMzEuMDkzLDQ4IEwzNiwzOC42MjY5NTMxIEwzMy4zMDcsMzIuODA4IEwzNy44MjA3NjkyLDM3LjU1MjcyODggTDM3LjgyMjI2NTUsMzcuMDA5MzkxNCBMNDguMzkxNjc2OCwyNi4wMTg3NTQyIFogTTQ4LDcgQzUwLjIwOTEzOSw3IDUyLDguNzkwODYxIDUyLDExIEM1MiwxMy4yMDkxMzkgNTAuMjA5MTM5LDE1IDQ4LDE1IEM0NS43OTA4NjEsMTUgNDQsMTMuMjA5MTM5IDQ0LDExIEM0NCw4Ljc5MDg2MSA0NS43OTA4NjEsNyA0OCw3IFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNEM0QzRDMiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",preview:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cHJldmlldyBpbWFnZTwvdGl0bGU+CiAgICA8ZyBpZD0icHJldmlldy1pbWFnZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTEwLjAwMDE0NzMsMyBDMTIuMjM1MDA1NSwzIDE0LjI1ODM2MzUsMy45OTU2OCAxNS44Njk3MjE0LDUuMTYyMDIgQzE3LjQ4NzcyMjEsNi4zMzMyNiAxOC43NTY4NjU1LDcuNzI0NTggMTkuNDk4NTA4Nyw4LjYyNjYgTDE5LjMxMiw4Ljc3MyBMMTkuNDk4OTM3Myw4LjYyNzE2IEMyMC4xMjc1NzYyLDkuMzkzMjQgMjAuMTY0OTM0NiwxMC40MjkxMTIxIDE5LjYwOTY0MjgsMTEuMjI2Njk4OSBMMTkuNDk4NTgwMSwxMS4zNzMzMyBMMTkuMzQzMTk5NywxMS41NjAxMTc4IEMxOC41ODYwOTU5LDEyLjQ1OTk1MTIgMTcuMzc5ODU1NCwxMy43NDQ4MjI3IDE1Ljg2OTcyMTQsMTQuODM3OTggQzE0LjI1ODM2MzUsMTYuMDA0MzIgMTIuMjM1MDA1NSwxNyAxMC4wMDAxNDczLDE3IEM3Ljc2NTI4OTE4LDE3IDUuNzQxOTMxMTMsMTYuMDA0MzIgNC4xMzA2NDQ3LDE0LjgzNzk4IEMyLjUxMzU3MjU1LDEzLjY2NzQ0IDEuMjQ1MDAwNTYsMTIuMjc3MSAwLjUwMzE0MzA4MiwxMS4zNzUwOCBDMC4xNzk1MDAwOCwxMC45ODU5NSAwLDEwLjUwMjMyIDAsMTAgQzAsOS40OTc2OCAwLjE3OTUwMDA4LDkuMDE0MDUgMC41MDMyMTQ1MSw4LjYyNDkyIEMxLjI0NTAwMDU2LDcuNzIyODMgMi41MTM2NDM5OCw2LjMzMjU2IDQuMTMwNjQ0Nyw1LjE2MjAyIEM1Ljc0MTkzMTEzLDMuOTk1NjggNy43NjUyODkxOCwzIDEwLjAwMDE0NzMsMyBaIE0xMC4wMDAxNTQ3LDQgQzguMTA1MDUzNyw0IDYuMjkyMDc3NzYsNC44NjgwNSA0LjcyODMyNjk0LDYuMDIzMDUgQzMuMTcxNjI2MTMsNy4xNzI4NzUgMS45MzA1MjU0OCw4LjU1NjcgMS4xOTQ5MjUxLDkuNDY5Njc1IEMxLjA2NDgwMDAzLDkuNjI4ODI1IDEsOS44MTQxNSAxLDEwIEMxLDEwLjE4NTg1IDEuMDY0ODAwMDMsMTAuMzcxMTc1IDEuMTkxNjI1MSwxMC41MjYzNSBDMS45MzA1MjU0OCwxMS40NDMzIDMuMTcxNjI2MTMsMTIuODI3MTI1IDQuNzI4MzI2OTQsMTMuOTc2OTUgQzYuMjkyMDc3NzYsMTUuMTMxOTUgOC4xMDUwNTM3LDE2IDEwLjAwMDE1NDcsMTYgQzExLjg5NTMzMDcsMTYgMTMuNzA4MjMxNiwxNS4xMzE5NSAxNS4yNzE5ODI0LDEzLjk3Njk1IEMxNi44Mjg2MDgyLDEyLjgyNzIgMTguMDY5NzA4OSwxMS40NDM0NSAxOC44MDUzMDkzLDEwLjUzMDQ3NSBDMTkuMDY0NzM0NCwxMC4yMDg0MjUgMTkuMDY1MTg0NCw5Ljc5MjcgMTguODA0OTM0Myw5LjQ2OTA3NSBDMTguMDY5MjU4OSw4LjU1NjEgMTYuODI4MzgzMiw3LjE3MjY1IDE1LjI3MTk4MjQsNi4wMjMwNSBDMTMuNzA4MjMxNiw0Ljg2ODA1IDExLjg5NTMzMDcsNCAxMC4wMDAxNTQ3LDQgWiBNOS45OTk5NjA0NSw2IEMxMi4xNzA5ODU2LDYgMTQsNy43NTIwNzQyOCAxNCwxMCBDMTQsMTIuMjQ3OTI1NyAxMi4xNzA5ODU2LDE0IDkuOTk5OTYwNDUsMTQgQzcuODI5MDE0MzcsMTQgNiwxMi4yNDc5MjU3IDYsMTAgQzYsNy43NTIwNzQyOCA3LjgyOTAxNDM3LDYgOS45OTk5NjA0NSw2IFogTTkuOTk5OTUwOTMsNyBDOC4yOTU3MTY2LDcgNyw4LjM5MjUzMDg5IDcsMTAgQzcsMTEuNjA3NDY5MSA4LjI5NTcxNjYsMTMgOS45OTk5NTA5MywxMyBDMTEuNzA0MTg1MywxMyAxMywxMS42MDc0NjkxIDEzLDEwIEMxMyw4LjM5MjUzMDg5IDExLjcwNDE4NTMsNyA5Ljk5OTk1MDkzLDcgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=",download:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQgZmlsZXM8L3RpdGxlPgogICAgPGcgaWQ9ImRvd25sb2FkLWZpbGVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTEuMDg4Nzc5NSwyLjM3ODY0NTkgTDE1Ljk2NTI4NTUsNyBMMTUuOTY1Mjg1NSw3IEwxNS45NjUyODU1LDggTDExLjA4ODc3OTUsMTIuNjIxMzU0MSBDMTAuODg2Nzg2NiwxMi44MTI3NzgxIDEwLjU2OTA4NTEsMTIuODA4NTExNSAxMC4zNzIzMDU3LDEyLjYxMTczMjEgQzEwLjE4MDkxNTIsMTIuNDIwMzQxNiAxMC4xODA5MTUyLDEyLjExMDAzNjQgMTAuMzcyMzA1NywxMS45MTg2NDU5IEMxMC4zNzQ2MTksMTEuOTE2MzMyNiAxMC4zNzY5NTU0LDExLjkxNDA0MjUgMTAuMzc5MzE0NiwxMS45MTE3NzYgTDE0LjQ1MTI4NTUsNy45OTk3MTQ1IEwxNC40NTEyODU1LDcuOTk5NzE0NSBMNS40NjUyODU1LDcuOTk5OTg0OTUgQzUuMTg5MTUxNDQsNy45OTk5OTMyNiA0Ljk2NTI5MzgxLDcuNzc2MTQ5MTEgNC45NjUyODU1LDcuNTAwMDE1MDUgQzQuOTY1Mjg1NSw3LjUwMDAxMDAzIDQuOTY1Mjg1NSw3LjUwMDAwNTAyIDQuOTY1Mjg1NSw3LjUgQzQuOTY1Mjg1NSw3LjIyMzg1NTE5IDUuMTg5MTQwNjksNi45OTk5OTMyNiA1LjQ2NTI4NTUsNi45OTk5ODQ5NSBMMTQuNDUxMjg1NSw2Ljk5OTcxNDUgTDE0LjQ1MTI4NTUsNi45OTk3MTQ1IEwxMC4zNzkzMzc4LDMuMDg4MTk5ODcgQzEwLjE4NDE1MzcsMi45MDA3MDU5NCAxMC4xNzc5MTk2LDIuNTkwNDg0MDkgMTAuMzY1NDEzNSwyLjM5NTI5OTk5IEMxMC4zNjc2ODczLDIuMzkyOTMyOTQgMTAuMzY5OTg0OCwyLjM5MDU4ODc5IDEwLjM3MjMwNTcsMi4zODgyNjc5IEMxMC41NjkwODUxLDIuMTkxNDg4NDcgMTAuODg2Nzg2NiwyLjE4NzIyMTg1IDExLjA4ODc3OTUsMi4zNzg2NDU5IFoiIGlkPSLlvaLnirbnu5PlkIjlpIfku70tM+Wkh+S7vSIgZmlsbD0iI0ZGRkZGRiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuNDY1Mjg1LCA3LjUwMDAwMCkgc2NhbGUoLTEsIC0xKSByb3RhdGUoLTkwLjAwMDAwMCkgdHJhbnNsYXRlKC0xMC40NjUyODUsIC03LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE3LjE0NjM2MzYsMTEuMTQ2MzYzNSBDMTcuMDUyNTc5MSwxMS4yNDAxNDggMTYuOTk5OTI0OSwxMS4zNjczNjg2IDE3LDExLjQ5OTk5OSBMMTcsMTUuOTk5OTk5IEw0LDE1Ljk5OTk5OSBMNCwxMS40OTk5OTkgQzQsMTEuMjIzODU3NSAzLjc3NjE0MjQ2LDEwLjk5OTk5OSAzLjUsMTAuOTk5OTk5IEMzLjIyMzg1NzcxLDEwLjk5OTk5OSAzLDExLjIyMzg1NzUgMywxMS40OTk5OTkgTDMsMTYuNDk5OTk5IEMzLDE2LjYzMjYzMTIgMy4wNTI1NzkxMiwxNi43NTk4NTE5IDMuMTQ2MzYzNjIsMTYuODUzNjM2NCBDMy4yNDAxNDgxMiwxNi45NDc0MjA5IDMuMzY3MzY4NzksMTcuMDAwMDc1MSAzLjUsMTYuOTk5OTk5IEwxNy41LDE2Ljk5OTk5OSBDMTcuNjMyNjMxNCwxNy4wMDAwNzUxIDE3Ljc1OTg1MiwxNi45NDc0MjA5IDE3Ljg1MzYzNjUsMTYuODUzNjM2NCBDMTcuOTQ3NDIxLDE2Ljc1OTg1MTkgMTgsMTYuNjMyNjMxMiAxOCwxNi40OTk5OTkgTDE4LDExLjQ5OTk5OSBDMTgsMTEuMzY3MzY4NiAxNy45NDc0MjEsMTEuMjQwMTQ4IDE3Ljg1MzYzNjUsMTEuMTQ2MzYzNSBDMTcuNzU5ODUyLDExLjA1MjU3OSAxNy42MzI2MzE0LDEwLjk5OTkyNDcgMTcuNSwxMC45OTk5OTkgQzE3LjM2NzM2ODgsMTAuOTk5OTI0NyAxNy4yNDAxNDgxLDExLjA1MjU3OSAxNy4xNDYzNjM2LDExLjE0NjM2MzUgWiIgaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",clear:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y2xlYXIgdXBsb2FkZWQgZmlsZTwvdGl0bGU+CiAgICA8ZyBpZD0iY2xlYXItdXBsb2FkZWQtZmlsZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTE2LjgyNTEzNjUsNC4wMTU0OCBDMTcuMDU4Mjg3OCwzLjc4MzE4NTQgMTcuMDU4Mjg3OCwzLjQwNjUxODQzIDE2LjgyNTEzNjUsMy4xNzQyMjA5NSBDMTYuNTkzMzMyLDIuOTQxOTI2MzUgMTYuMjE3MTU1MSwyLjk0MTkyNjM1IDE1Ljk4NDQ5NDUsMy4xNzQyMjA5NSBMMTAuMDAwMjM0OCw5LjE1ODcyNDYyIEw0LjAxNTQ4LDMuMTc0MjIwOTUgQzMuNzgzMTg1NCwyLjk0MTkyNjM1IDMuNDA2NTE4NDMsMi45NDE5MjYzNSAzLjE3NDIyMDk1LDMuMTc0MjIwOTUgQzIuOTQxOTI2MzUsMy40MDY1MTU1NiAyLjk0MTkyNjM1LDMuNzgzMTgyNTMgMy4xNzQyMjA5NSw0LjAxNTQ4IEw5LjE1ODg1Mzc4LDEwLjAwMDExMjggTDMuMTc0MjIwOTUsMTUuOTg1MTExNiBDMi45NDE5MjYzNSwxNi4yMTc1MjgyIDIuOTQxOTI2MzUsMTYuNTkzNDYwNCAzLjE3NDIyMDk1LDE2LjgyNTg3NTYgQzMuNDA2NTE1NTYsMTcuMDU4MjkyMiAzLjc4MzE4MjUzLDE3LjA1ODI5MjIgNC4wMTU0OCwxNi44MjU4NzU2IEwxMC4wMDAyMzQ4LDEwLjg0MTM3MTkgTDE1Ljk4NDQ5NDUsMTYuODI1ODc1NiBDMTYuMjE3MTU2NSwxNy4wNTgyOTIyIDE2LjU5MzQ1NjEsMTcuMDU4MjkyMiAxNi44MjUxMzY1LDE2LjgyNTg3NTYgQzE3LjA1ODI4NzgsMTYuNTkzODI2MyAxNy4wNTgyODc4LDE2LjIxNzUyNjcgMTYuODI1MTM2NSwxNS45ODUxMTE2IEwxMC44NDEzNjQ3LDEwLjAwMDExMjggTDE2LjgyNTEzNjUsNC4wMTU0OCBaIiBpZD0i6Lev5b6EIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"},N.IMAGE_FILE_EXTENSIONS=["jpg","jpeg","png","gif","bmp","svg","ico","webp"],N.MIMETYPE_TO_FILE_EXTENSION_MAP={"image/jpeg":N.IMAGE_FILE_EXTENSIONS[1],"image/jpg":N.IMAGE_FILE_EXTENSIONS[0],"image/png":N.IMAGE_FILE_EXTENSIONS[2],"image/gif":N.IMAGE_FILE_EXTENSIONS[3],"image/bmp":N.IMAGE_FILE_EXTENSIONS[4],"image/svg+xml":N.IMAGE_FILE_EXTENSIONS[5],"image/x-icon":N.IMAGE_FILE_EXTENSIONS[6],"image/webp":N.IMAGE_FILE_EXTENSIONS[7]},N.defaultFileUploadProps={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,maxSize:2048,accept:"",isPreviewEnabled:!0,isDownloadEnabled:!0,isClearEnabled:!0,valuePath:"dataUrl"},N.E9e=s=function(t){return t&&"string"==typeof t.name&&(t.blob&&t.blob instanceof Blob||t.dataUrl&&"string"==typeof t.dataUrl)},f=function(t){var i,i,n,n={name:""};return"string"==typeof t?n.dataUrl=t:t instanceof Blob?(n.blob=t,n.name=null!=(i=t.name)?i:""):t instanceof Object&&(n=t)&&t.hasOwnProperty("blob")&&t.blob instanceof Blob&&!t.hasOwnProperty("name")&&(t.name=null!=(i=t.blob.name)?i:""),(0,N.E9e)(n)?n:void 0},N.Hne=o=function(t){var i=crypto&&crypto.randomUUID&&crypto.randomUUID();return n.Common.lt.ht(i)&&(i="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),i=32===t?i.split("-").join(""):i},N.x9e=c=function(t,r,u,a){var l,M,g,h,I,t,i,n,e,s,t,o,c,c,l=t.row,M=t.col,g=t.value,h=t.oldValue,I=t.valuePath,t=t.fileGUID,i=r.VTe(),n=r.Ut.getFileGUID(l,M),e=i.Wxn(n);e&&i.FAe([n]),(s=f(g))?(t=null!=t?t:(0,N.Hne)(),o=function(t){var i,i,n,e,s,o,c,i,n,i,n,n=t.name,e=t.dataUrl;a&&(t[s=null===(s=I)?"cellValue":I]=g),o=!1,c=r.BO(),-1<t.type.indexOf("image")?(c.getImage(e)&&(o=!0),c.addImage(e,"anonymous")):(o=!0,i=null==(i=null==(i=r.getParent())?void 0:i.options)?void 0:i.builtInFileIcons,n=n.split(".").pop(),(i=null==i?void 0:i[n])&&(c.getImage(i)||(o=!1),c.addImage(i,"anonymous"))),u&&(n={name:t.name,blob:t.blob,dataUrl:e},r.getParent().commandManager().execute({cmd:"uploadFile",sheetName:r.name(),row:l,col:M,newValue:n,oldValue:h,fileGUID:t.id,oldFileWrapper:null,newFileWrapper:t,valuePath:I})),o&&c.Zh()},s.blob&&s.dataUrl?(c=i.EAe(s.name,s.blob,s.dataUrl,t),u||r.Ut.setFileGUID(l,M,t),o(c)):(c=i.oZn({id:t,name:s.name,dataUrl:s.dataUrl,blob:s.blob,postCreateFile:function(t){a&&(t.cellValue=g)}}))&&(u||r.Ut.setFileGUID(l,M,t),c.then(function(t){o(t)}))):u?r.getParent().commandManager().execute({cmd:"uploadFile",sheetName:r.name(),row:l,col:M,newValue:void 0,oldValue:h,fileGUID:n,oldFileWrapper:e,newFileWrapper:null,valuePath:I}):r.Ut.setFileGUID(l,M,void 0)},N.getValueByValuePath=r,N.isFileInfoEqual=u},"./dist/plugins/celltype/hyperlinkcelltype.js":function(U,t,i){"use strict";var n,e,j,i,f,i,s,v,o,r,T,b,c,u,a,A,D,y,l,M,g,h,I,z,N,d,w,C,Z,G,m,B,Q,p,Y,L,x,S,e,O;function P(t,i){t.removeChild(i)}function k(){var t,n,t=O.call(this)||this;return t.typeName="8",t.W7e=!1,t.allowOverflow=!1,(n=t)._id=t.MY(),u(L,function(t,i){n["_"+t]=i}),t._onAction=function(t){var i,t,n,e,s,i,t,n,s,n=t&&t.sheet,e=n&&n.getParent(),s=t.row,i=t.col,t=t.sheetArea,n=n.getValue(s,i,t),s=R(this._target);n&&(e&&null!=(t=null==(i=e.docProps)?void 0:i.appDocProps)&&t.hyperlinkBase&&(n=q(e.docProps.appDocProps.hyperlinkBase,n)),l(o(n),s))},t}function R(t){return["_blank","_self","_parent","_top"][t]}function W(t,i,n,e,s,o){var c,r,u,t,c=0,r=0,u=t.width,t=t.height;return c=o=o||0,1===e?c=(u-i)/2:2===e?c=u-i-o:5===e&&(c=(u-i)/2),1===s?r=(t-n)/2:2===s&&(r=t-n),{x:c,y:r}}function H(t,i,n,e){var t,n,t=X(t,n,i),n=t.width;return n+=!0==(1!==i.hAlign&&!v(e))?e:0,t.width=n,t}function V(t,i,n,e,s){var t,n,t=X(t,n,i,e.width),n=W(e,t.width,t.height,i.hAlign,i.vAlign,s);return t.x=n.x,t.y=n.y,t}function J(t,i){var n,t,n=E(i),t=t-3-n;return 5===i.hAlign&&(t-=n),--t}function F(t,i,n,e){var i,n,i=J(i,n),n=j.q.Gge(t);return 1===n.length&&0===n[0].prefixSpaceCount?A(0,j.q.Wt(n[0].word,e,!0)):i}function X(t,i,n,e){var s,o,c,s=r(i),o,c;return{x:0,y:0,width:5===n.hAlign&&e?F(t,e,n,i):Math.max(0,j.q.Wt(t,i,!0)),height:t.split(/\r\n|\r|\n/).length*s}}function _(t,i,n,e,s,o){var c,r,s,u,a,l,s,c,M,g,h,I,N,f,c=s.sheet,r=c.Dn;if(!v(n)&&(o=o||(s=c.getValue(s.row,s.col,s.sheetArea),v(s))?o:s+""))for(e=n.cellType.An(e,n,c.zoom()),o=o.replace(/\s+/g," "),u=n&&n.font?n.font:r.Nn(),u=r._n(u),a=[o],l=E(n),!n.wordWrap&&5!==n.hAlign||(s=e.width-3-l,5===n.hAlign&&(s-=l),o=(a=j.q.un(o,s,u)).join("\r\n")),c=V(o,n,u,e,l),M=e.y+c.y,g=0;g<a.length;g++)if(h=V(a[g],n,u,e,l),I=e.x+h.x,N=D(I+h.width,e.x+e.width),M=D((f=M)+h.height,e.y+e.height),I<=t&&t<N&&f<=i&&i<M)return!0;return!1}function E(t){return 8*(t.textIndent||0)}function K(t,i,n,e,s){var o,e,c,c,r,n,c,u,a,l,M,g,h,I,N,c,o=e&&e.sheet;if(o){if(c=o.Dn,r=i.font||c.Nn(),1<n&&(r=c._n(r)),n=E(i),i.wordWrap||s){if(i.wordWrap){if(c=e.row,u=e.col,a=e.sheetArea,l=0,M=o.Ut.findSpan(c,u,a)){if(M.row>=c&&M.rowCount<=1&&M.col>=u&&u===M.col&&(l=o.nn(u,a),1<M.colCount))for(g=u+1;g<u+M.colCount;g++)l+=o.nn(g,a)}else l=o.nn(u,a);if(e=f(i,1),0<(c=f(i,3))&&(l-=c),0<e&&(l-=e),h=j.q.un(t,l-3-n,r),s&&1<t.split(/\r\n|\r|\n/).length){for(N=I=0;N<h.length;N++)I=Math.max(I,H(h[N],i,r,E(i)).width);return I}s||(t=h.join("\r\n"))}}else t=t.replace(/\s+/g," ");return c=H(t,i,r,E(i)),s?c.width:c.height}return 0}function q(t,i){var t,n,i,t=t.replace(/:\/*/,"://"),n=(t=t.endsWith("://")?t:t.replace(/\/+$/,"")).endsWith("/")?"":"/",i=i.replace(/^\/+/,"");return"".concat(t).concat(n).concat(i)}n=this&&this.__extends||(S=function(t,i){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,e=i("Common"),i=(j=i("Core")).CellTypes.Context,f=i.gn,i=j.CellTypes.Text,s=j.mt.En,v=e.Common.lt.ht,o=e.Common.zf.TY,r=j.mt.vt,T=j.mt.Tt,b=T.mozilla,c=j.GC$,u=c.each,a=null,A=Math.max,D=Math.min,y=Math.floor,l=window.open,M="position",g="absolute",h="margin",I="font",z="left",N="top",d="padding",w="border",C="box-sizing",Z="background-color",G="content-box",m="default",B="white",Q="div",p="hyperlinkInfo",(e=Y=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top",L={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},n(k,O=i),k.prototype.MY=function(){var t,i;return v(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),this._id=++t+"",i},k.prototype.AY=function(t,i,n,e,s,o,c,r,u,a){var l,M,g,h,l,I,N,g,f,D,d,r,v,o,w,j,A,M=1,g=z,h=c.hAlign,l=c.vAlign,I=r.lineHeight,N=u.length;if(M+=i,1===h?(M=s/2,g="center"):2===h&&(M=s-1,M-=i,g="right"),t.textAlign!==g&&(t.textAlign=g),g=1,f="alphabetic",g+=I-(r=I/2-(D=parseInt(r.fontInfo.fontSize,10))/2+(d=8<D?y((D-8)/5+2):1)-1),1===l?I<o&&(g=b?(o-a)/2+1:T.msie?(o-a)/2+.5:(o-a)/2,y(g)!==g&&(g+=.5),g+=I/2-r):2===l&&(g=o-a-2.5-r),t.textBaseline!==f&&(t.textBaseline=f),v=e+g,5===h)c.textDecoration=null!=(l=c.textDecoration)?l:1,o=s-3-2*i,O.prototype.Pge.call(this,t,u,n,v,--o,s/2,1+i,I,c,D,d);else for(w=0;w<N;w++)t.fillText(u[w],n+M,v),j=t.measureText(u[w]).width,(A=c.textDecoration)&&this.le(t,A,n+M,v,j,D,d),v+=I},k.prototype.IY=function(t,i,n,e,s,o,c,r,u){var a,l,M,g,h,I,g,N,f,D,d,v,c,r,w,a=c.hAlign,l=c.vAlign,M=r.lineHeight,h=u.length,N=0,f=0,d=0,v=0;for(2!==a&&(d=1),2===c.vAlign&&(v=-2.5),v-=A(0,Math.round(M/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),c=r.fontInfo.fontSize,r=y((c-12)/21+1),t.lineWidth=r,t.beginPath(),w=0;w<h;w++)g=t.measureText(u[w]).width,g=(I=d+n+(D=W(new j.Rect(n,e,s,o),g,M*h,a,l,i)).x)+g,N=v+e+D.y+M,y(N)===N&&(N+=.5),f=N,t.moveTo(I,N),t.lineTo(g,f),t.stroke(),v+=M},k.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,i,a,l,M,g,h,I,N,f,f,g,h,D,I,N,M,f,d,u=this;if(t&&(i=u.getText(i,r),!v(i))){for(a=(i+="").split(/\r\n|\r|\n/),l=0;l<a.length;)a[l]=a[l].replace(/\s+/g," "),l++;i=a.join("\r\n"),M=!1,g=r.sheet.Ut,h=r.row,I=r.col,N=r.sheetArea,(f=u.W7e?u.J7e(r.sheet,h,I,N):g.getValueForKey(h,I,p,N))&&(u._id===f.id?M=f.visited:g.do("setValueForKey",h,I,p,void 0,N)),t.save(),t.beginPath(),(f=M?u._visitedLinkColor:u._linkColor)&&t.fillStyle!==f&&(t.fillStyle=f),(g=c.font)&&t.font!==g&&j.mt.bt(t,g),h=E(c),r.sheet.outlineColumn&&r.sheet.outlineColumn.Un(r.col)&&(h=0),I=[],M=N=0,(D=c.wordWrap)||5===c.hAlign?(f=s-3-h,5===c.hAlign&&(f-=h),1<(N=(I=j.q.un(i,--f,g)).length)&&0!==c.vAlign&&(M=(N-1)*(d=r.lineHeight))):I.push(i),t.rect(n,e,s,o),t.clip(),t.beginPath(),u.AY(t,h,n,e,s,o,c,r,I,M),5!==c.hAlign&&u.IY(t,h,n,e,s,o,c,r,I),t.restore()}},k.prototype.Rn=function(t,i,n,e){this.yZe&&(v(i.textDecoration)?i.textDecoration=1:2!==i.textDecoration&&4!==i.textDecoration||(i.textDecoration+=1),O.prototype.Rn.call(this,t,i,n,e))},k.prototype.getText=function(t,i){var n=this._text||t;return n=(v(n)||""===n)&&i.sheet&&i.sheet.getActualText?i.sheet.getActualText(t,i):n},k.prototype.j3=function(t,i,n,e){var s;t.Ai||(s=t.parent)&&s.j3(t,i,n,e)},k.prototype.getHitInfo=function(t,i,n,e,s){var o,c,o=this;return s&&(c=s.sheetArea,v(c)&&(c=3),n)&&e?{x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:c,isFocusAware:!0,sheet:s.sheet,isReservedLocation:_(t,i,n,e,s,o._text)}:a},k.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},k.prototype.processMouseUp=function(t){var i,i,i=t&&t.sheet;i&&!i.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},k.prototype.processMouseMove=function(t){var i,n,e,s,i,i=t.row,n=t.col,e=t.sheet,s=this;!e||e.isEditing()&&e.getActiveRowIndex()===i&&e.getActiveColumnIndex()===n||(i=e.Dg(),t.isReservedLocation?i&&(s.kY(e,t),i.style.cursor="pointer"):(s.DY(e),i&&(i.style.cursor=m)))},k.prototype.processMouseLeave=function(t){var t,i,i,t=t.sheet,i=this;i.xY=!1,i.DY(t),t&&(i=t.Dg())&&(i.style.cursor=m)},k.prototype.kY=function(t,i){var n,e,s,n,o,n,i,n=this;n._linkToolTip&&((e=n._Y()).className="gc-spread-hyperlink-celltype-tooltip",(s=c(e)).text(n._linkToolTip),o=(n=t.rt.it()).left+i.x,n=n.top+i.y+20,0===s.parent().length)&&((i=t&&t.qc())&&i.insertBefore(e,a),s.css(N,n).css(z,o))},k.prototype.DY=function(t){var i,t,i=this;i.EY&&((t=t&&t.qc())&&i.EY.parentElement===t&&P(t,i.EY),i.EY=a)},k.prototype._Y=function(){var t,i,t=this;return t.EY||(i=s(Q),c(i).css(M,g).css(h,0).css(d,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(C,G).css(Z,B).css(I,"9pt Arial"),t.EY=i),t.EY},k.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},k.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},k.prototype.getAutoFitWidth=function(t,i,n,e,s){return K(this._text||t,n,e,s,!0)},k.prototype.getAutoFitHeight=function(t,i,n,e,s){return K(this._text||t,n,e,s)},k.prototype.isImeAware=function(t){return!!this.yZe&&O.prototype.isImeAware.call(this,t)},k.prototype.NY=function(t){var i,n,e,s,o,c,i=t&&t.sheet,n=this,e=t.row,s=t.col,o=t.sheetArea,c;n.onClickAction().call(this,t),this.W7e?n.K7e(i,e,s,o):i.Ut.do("setValueForKey",e,s,p,{id:n._id,visited:!0},o),i.repaint(i.getCellRect(e,s,1===o?-1:a,2===o?-1:a)),n.j3(i,e,s,o)},k.prototype.J7e=function(t,i,n,e){return a},k.prototype.K7e=function(t,i,n,e){},k.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},k.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&Y[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},k.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(L,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},k.prototype.fromJSON=function(n){var e=this;u(L,function(t){var i=n[t];v(i)||(e["_"+t]=i)})},k.prototype.jn=function(t){if(this.yZe)return O.prototype.jn.call(this,t)},k.prototype.Ke=function(){var n,e,s,n=this,s=new k;return u(L,function(t,i){(e=n["_"+t])!==i&&(s["_"+t]=e)}),s._onAction=n._onAction,s},x=k,t.HyperLink=x,u(L,function(i){x.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),j.CellTypes.ti[8]=x},"./dist/plugins/celltype/radiochecklistcelltype.js":function(j,t,i){"use strict";var n,Q,i,A,T,Y,P,a,it,M,l,g,h,nt,i,e,c,R,W,v,b,o,H,V,J,r,s,e,i,y,u,I,z,e,e,C,m,p,N,f;function F(t,i){return t.hasOwnProperty(i)}function D(t,i){return t instanceof Date&&i instanceof Date?T(t)===T(i):!h(t)&&!h(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function L(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===b&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function d(){var t,n,t=C.call(this)||this;return t.typeName="11",t.defaultPadding=5,n=t,c(r,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function x(){return null!==m&&m.apply(this,arguments)||this}function S(){var t=null!==p&&p.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,n,t=f.call(this)||this;return t.typeName="13",t.defaultPadding=0,n=t,c(u,function(t,i){n["_"+t]=i="items"===t?[]:i}),n._boxSize=0,delete n.boxSize,t}function O(t,i,n,e,s,o){var c,c,s,c=i.getValue(n,e,o),c=t.wG(c,s),s={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:c,autoFormat:!1};i.Qy().execute(s),t.triggerButtonClicked(i,n,e,o)}function X(t,i,n,e,s){var i,o,n,c,r,i=i.zoom(),o=K(t._boxSize,n.font,i),n=st(t,n),c,r=e;return P(n,o)*(r=t._items.length<e?t._items.length:r)+t._itemSpacing.vertical*i*(r-1)}function _(t,i,n,e,s){var o,c,r,i,u,o=i.zoom(),c=K(t._boxSize,n.font,o),r=t.defaultPadding*o,i=et(t,i,n,e,s),u=0;return i.forEach(function(t){u+=t}),u+=s*(c+r)+(s-1)*t._itemSpacing.horizontal*o}function et(t,i,n,e,s){for(var o,c,r,r,u,u,o=[],c=0;c<t._items.length;c++)r=F(t._items[c],W)?t._items[c].text:t._items[c],r=i.Qt(r,n.font),(u=t.jY()).hasMargin&&(r=r+u.paddingLeft+u.paddingRight),u=Y(c%s),o[u=t._direction===V.vertical?Y(c/e):u]=o[u]===g?r:Math.max(o[u],r);return o}function K(t,i,n){var e=H*n;return"number"==typeof t&&0<=t?e=t*n:"auto"===t&&(e=R(i)/2),e}function st(t,i){var i,t,i=R(i.font),t=t.jY();return i=t.hasMargin?i+t.paddingTop+t.paddingBottom:i}function q(t,i,n,e){var n,s,n=k(t)*n,s=n;return 1===t.hAlign?s=(i.width-e)/2:2===t.hAlign&&(s=i.width-n-e),s}function $(t,i,n,e){var n,s,n=2*n,s=n;return 1===t.vAlign?i.height-n>e&&(s=(i.height-e-n)/2+n):2===t.vAlign&&(s=i.height-e-n),s}function tt(t,i,n,e,s){var o,c,r,u;if(t._direction===V.vertical){if(t._isFlowLayout){if(s!==g)for(o=t._items.length;0<o;){if(!(s<(c=X(t,i,n,o,a(t._items.length/o)))))return[o=P(o,1),a(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=P(1,t._maxRowCount),a(t._items.length/o)]}if(t._isFlowLayout){if(e!==g)for(r=t._items.length;0<r;){if(!(e<(u=_(t,i,n,a(t._items.length/r),r))))return r=P(r,1),[a(t._items.length/r),r];r-=1}return[1,t._items.length]}return r=P(1,t._maxColumnCount),[a(t._items.length/r),r]}function k(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===l||i===g?2:8*i}function E(r,u){for(var t,i,a,l,n,n,t,M,g,h,I,N,f,i,t,D,d,e,s,o,t=u.cellRect.width,i=u.cellRect.height,a=u.sheet,l=a.zoom(),n=a.Z_(u.row,u.col),n=n&&n.font,t=tt(r,a,u.cellStyle,t-1,i),M=t[0],g=t[1],h=et(r,a,u.cellStyle,M,g),I=K(r._boxSize,n,l),N=r.defaultPadding*l,f=P(st(r,u.cellStyle),I),i=_(r,a,u.cellStyle,M,g),t=X(r,a,u.cellStyle,M,g),D=q(u.cellStyle,u.cellRect,l,i),d=$(u.cellStyle,u.cellRect,l,t),e=function(t){var i,i,n,e,s,o,c,n,n,i,i=F(r._items[t],W)?r._items[t].text:r._items[t],i=a.Qt(i,u.cellStyle.font),n=Y(t/g),e=t%g;if(r._direction===V.vertical&&(n=t%M,e=Y(t/M)),s=new Q.Rect,o=0,(c=h.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=D+o+e*(I+N+r._itemSpacing.horizontal*l),s.y=d+n*f+r._itemSpacing.vertical*l*n,n=r.jY(),s.width=(r._textAlign!==J.right||n.hasMargin?h[e]:i)+I+N,s.height=f,n=u.x-u.cellRect.x,i=u.y-u.cellRect.y,s&&s.contains(n,i))return{value:{value:F(r._items[t],v)?r._items[t].value:r._items[t]}}},s=0;s<r._items.length;s++)if("object"==typeof(o=e(s)))return o.value}function U(t,i){var n,e,s,n=!1,e=F(t,v)?t.value:t;if(i!==l)if(Array.isArray(i)){for(s=0;s<i.length;s++)if(D(i[s],e)){n=!0;break}}else n=D(i,e);return n}function Z(t,i,n,e){var s,o,c,r,u;if(e)return i;for(t===l&&(t=[]),Array.isArray(t)||(t=[t]),s={},n.forEach(function(t){s[F(t,v)?t.value:t]=!0}),o=t.length-1;0<=o;o--)s[t[o]]||t.splice(o,1);if(-1===(r=(c=t.slice()).indexOf(i)))c.push(i);else for(o=c.length-1;0<=o;o--)D(c[o],i)&&c.splice(o,1);return u=[],n.forEach(function(t){-1!==c.indexOf(t.value)&&u.push(t.value)}),u}n=this&&this.__extends||(z=function(t,i){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}z(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,Q=i("Core"),i=i("Common"),A=i.Common.lt.tv,T=i.Common.ct.o0,Y=Math.floor,P=Math.max,a=Math.ceil,it="left",M="alphabetic",l=null,g=void 0,h=i.Common.lt.ht,nt=Q.mt.bt,i=Q.CellTypes.Base,e=Q.GC$,c=e.each,R=Q.mt.vt,W="text",v="value",b="string",o="number",H=12,(e=V=t.Direction||(t.Direction={}))[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",(e=J=t.TextAlign||(t.TextAlign={}))[e.left=2]="left",e[e.right=3]="right",r={items:l,direction:V.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:J.right,boxSize:H},n(d,C=i),d.prototype.paintValue=function(t,i,n,e,s,o,c,r){var u,a,U,l,M,g,h,I,N,f,D,d,g,v,w,j,A,T,b,y,z,h,C,m,Z,p,L,x,S,O,k,E,E,G,B,u=this;if(t){for(t.save(),t.rect(n+1,e+1,s-2,o-2),t.clip(),t.beginPath(),U=a=0,M=(l=r.sheet).zoom(),g=c.font,h=r.isPrinting,I=r.printZoomFactor,N=K(u._boxSize,g,M=h&&"number"==typeof I&&1!==I?I:M),f=u.defaultPadding*M,D=N/2,d=new Q.Rect(n+1,e+1,s-2,o-2),j=_(u,l,c,v=(g=tt(u,l,c,s-2,o-2))[0],w=g[1]),A=X(u,l,c,v,w),T=et(u,l,c,v,w),b=st(u,c),y=n+q(c,d,M,j),z=e+$(c,d,M,A),(h=c.font)&&t.font!==h&&nt(t,r.fontInfo.font),c.foreColor&&(t.fillStyle=c.foreColor),C=c.textDecoration,Z=8<(m=r.fontInfo.fontSize)?Y((m-8)/5+2):1,p=0,p=(U=R(c.font))/2-m/2+Z-1,L=y,x=z,O=S=0,N<m&&(S=u.OY(N),O=(b-p-H)/2+1),k=0;k<u._items.length;k++)n+s<y||e+o<z||(E=F(u._items[k],W)?u._items[k].text:u._items[k],a=l.Qt(E,c.font),t.textAlign=it,E=u._direction===V.vertical?T[Y(k/v)]:T[k%w],G=0,G=u._textAlign===J.left?(u.RY(t,u._items[k],i,a,y,z+S,E,b,p),y=y+E+f,t.save(),u.BY(t,i,u._items[k],y,z+O,D),t.restore(),N):(t.save(),u.BY(t,i,u._items[k],y,z+O,D),y=y+N+f,t.restore(),u.RY(t,u._items[k],i,a,y,z+S,E,b,p),E),C&&(B=this.jY(),u.le(t,C,y-(u._textAlign===J.right?0:E+f)+B.paddingLeft,z+b-p-B.paddingBottom,a,m,Z)),u._direction===V.vertical?(z+=P(b,N)+u._itemSpacing.vertical*M,(k+1)%v==0&&(L=L+E+N+f+u._itemSpacing.horizontal*M,z=e+$(c,d,M,A)),y=L):(y=y+G+u._itemSpacing.horizontal*M,(k+1)%w==0&&(y=n+q(c,d,M,j),x=x+P(b,N)+u._itemSpacing.vertical*M),z=x));t.restore()}},d.prototype.OY=function(t){return(t-H)/2},d.prototype.getText=function(t,i){return t},d.prototype.RY=function(t,i,n,e,s,o,c,r,u){var i=F(i,W)?i.text:i;t.textBaseline!==M&&(t.textBaseline=M),t.fillText(i,s,o+r-u)},d.prototype.getItemsBound=function(r,t,i,n){var u,a,l,e,s,o,c,M,t,i,n,g,h,I,N,f,D,t,i,d,v,w,j,A,u=this,a=r.zoom(),l=r.getActualStyle(t,i,n),e,s=Q.W.V("11pt "+r.currentTheme().bodyFont(),a);for(l.font&&(s=Q.W.Lge(l,a)),l.font=s.font,t=(M=r.getCellRect(t,i,o=1===n?-1:void 0,c=2===n?-1:void 0)).width,i=M.height,n=tt(u,r,l,t-1,i),g=n[0],h=n[1],I=et(u,r,l,g,h),N=K(u._boxSize,s.font,a),f=u.defaultPadding*a,D=P(st(u,l),N),t=_(u,r,l,g,h),i=X(u,r,l,g,h),d=q(l,M,a,t),v=$(l,M,a,i),w=[],j=function(t){var i,i,n,e,s,o,c,n,i=F(u._items[t],W)?u._items[t].text:u._items[t],i=r.Qt(i,l.font),n=Y(t/h),e=t%h;u._direction===V.vertical&&(n=t%g,e=Y(t/g)),s=new Q.Rect,o=0,(c=I.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=d+o+e*(N+f+u._itemSpacing.horizontal*a)+M.x,s.y=v+n*D+u._itemSpacing.vertical*a*n+M.y,n=u.jY(),s.width=(u._textAlign!==J.right||n.hasMargin?I[e]:i)+N+f,s.height=D,s.x>M.x+M.width||s.y>M.y+M.height?w[t]=null:w[t]=s},A=0;A<u._items.length;A++)j(A);return w},d.prototype.BY=function(t,i,n,e,s,o){},d.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},d.prototype.getAutoFitWidth=function(t,i,n,e,s){var s,o,c,r,u,s=s&&s.sheet,o=k(n),c=tt(this,s,n),r,u;return(_(this,s,n,c[0],c[1])+o)/e},d.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,s,c,r,o=s&&s.sheet,s=tt(this,o,n,+o.getColumnWidth(s.col)*e),c,r;return X(this,o,n,s[0],s[1])/e},d.prototype.getHitInfo=function(t,i,n,e,s){var o,c,r,t,i,s,c,s,u,o,r,c,a,o=this;return s&&(c=s.sheetArea,r=s.sheet,e=n.cellType.An(e,n,r.zoom()),h(c)||3===c)&&e?(t={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:c,sheet:r},i=r.zoom(),n.font&&(n.font=Q.W.Lge(n,i).font),u=_(o,r,n,c=(s=tt(o,r,n,e.width-1,e.height-2))[0],s=s[1]),o=X(o,r,n,c,s),r=e.x+q(n,e,i,u),c=e.y+$(n,e,i,o),(a=new Q.Rect(r,c,u,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):l},d.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},d.prototype.processMouseLeave=function(t){if(C.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},d.prototype.processMouseUp=function(t){var i,n,e,s,o,c;return!!t&&(n=t.sheet,!!((i=this).pG&&n&&t.isReservedLocation&&(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,c=E(i,t))))&&(O(i,n,e,s,c.value,o),!0)},d.prototype.wG=function(t,i){return Z(t,i,this._items,!0)},d.prototype.triggerButtonClicked=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},d.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&V[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&J[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},d.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return c(r,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]="object"==typeof o?A(o,!1):o)}),s},d.prototype.fromJSON=function(n){var e=this;c(r,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},n(x,m=s=d),x.prototype.BY=function(t,i,n,e,s,o){var n=F(n,v)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(e+o,s+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,o,0,2*Math.PI),t.stroke(),i!==l&&D(i,n)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=e=x,n(S,p=s),S.prototype.BY=function(t,i,n,e,s,o){t.strokeStyle="black",t.strokeRect(e+.5,s+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(e+1,s+1,2*o-1,2*o-1);var n=U(n,i);i!==l&&n&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(e+3,s+o),t.lineTo(e+o,s+2*o-3.5),t.lineTo(e+2*o-1.5,s+3),t.stroke())},S.prototype.wG=function(t,i){return Z(t,i,this._items,!1)},t.CheckBoxList=i=S,(N=y=t.SelectionMode||(t.SelectionMode={}))[N.single=0]="single",N[N.multiple=1]="multiple",u={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:l,itemSpacing:{horizontal:5,vertical:5},selectionMode:y.multiple},n(w,f=s),w.prototype.RY=function(t,i,n,e,s,o,c,r,u){var n,i,a,l,n;t.save(),t.beginPath(),n=U(i,n),i=F(i,W)?i.text:i,a=this._selectedBackColor,l=this._selectedForeColor,n&&(t.fillStyle=a,t.fillRect(s+1,o+1,c-1,r-1),t.fillStyle=l),t.textAlign="center",t.textBaseline!==M&&(t.textBaseline=M),n=this.jY(),t.fillText(i,s+n.paddingLeft+(c-n.paddingLeft-n.paddingRight)/2,o+n.paddingTop+r-n.paddingTop-n.paddingBottom-u),t.restore()},w.prototype.wG=function(t,i){return Z(t,i,this._items,this._selectionMode===y.single)},w.prototype.jY=function(){var t,i,n,e,s,t=0,i=0,n=0,e=0;return this._padding&&(s=L(this._padding),t=typeof(t=parseInt(s[0],10))==o&&0<t?t:0,e=typeof(e=parseInt(s[1],10))==o&&0<e?e:0,i=typeof(i=parseInt(s[2],10))==o&&0<i?i:0,n=typeof(n=parseInt(s[3],10))==o&&0<n?n:0),{hasMargin:!0,paddingTop:t,paddingBottom:i,paddingLeft:n,paddingRight:e}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var e,s,o,e=this,o=f.prototype.toJSON.call(this);return c(u,function(t,i){var n;s=e["_"+t],("items"===t?s&&0<s.length:s!==i)&&(o[t]="object"==typeof s?A(s):s)}),o},w.prototype.fromJSON=function(n){f.prototype.fromJSON.call(this,n);var e=this;c(u,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},I=w,t.ButtonList=I,c(r,function(r){s.prototype[r]=function(t){var i,n,e,s,o,c,c,c,i="_"+r,n=this;if(0===arguments.length)return n[i];if("items"===r){for(e=[],s=0;s<t.length;s++)o=t[s],h(o.text)||h(o.value)?h(o.text)?h(o.value)?h(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}if("itemSpacing"===r)c=n[i],n[i]={horizontal:c.horizontal,vertical:c.vertical},h(t.horizontal)||(c=parseInt(t.horizontal,10),isNaN(c))||(n[i].horizontal=c),h(t.vertical)||(c=parseInt(t.vertical,10),isNaN(c))||(n[i].vertical=c);else if("boxSize"===r){if(h(t))return n[i];"number"==typeof t&&0<=t&&(n[i]=t),"auto"===t&&(n[i]=t)}else n[i]=t;return n}}),Q.CellTypes.ti[11]=e,Q.CellTypes.ti[12]=i,c(u,function(r){I.prototype[r]=function(t){var i,n,e,s,o,c,c,c,i="_"+r,n=this;if(0===arguments.length)return n[i];if("items"===r){for(e=[],s=0;s<t.length;s++)o=t[s],h(o.text)||h(o.value)?h(o.text)?h(o.value)?h(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}return"itemSpacing"===r?(c=n[i],n[i]={horizontal:c.horizontal,vertical:c.vertical},h(t.horizontal)||(c=parseInt(t.horizontal,10),isNaN(c))||(n[i].horizontal=c),h(t.vertical)||(c=parseInt(t.vertical,10),isNaN(c))||(n[i].vertical=c)):n[i]=t,n}}),Q.CellTypes.ti[13]=I},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){"use strict";var e,jt,s,u,At,Tt,n,bt,yt,zt,c,r,e,o,a;function g(t){return t.map(function(t){return{start:t.start,size:t.size}})}function l(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function M(){}function h(t,i,n,e,s){var o,i,o=a.call(this)||this;return o.allowOverflow=!1,o.typeName="16",i=1===arguments.length?new jt.Range(0,0,t.getRowCount(),t.getColumnCount()):new jt.Range(i,n,e,s),t&&i&&(o.GY=(new c).yN(t,i),o.UY=(new r).yN(t,i)),o}function I(t,i,U,n,e,s,Z){var o,c,r,u,a,G,l,B,Q,i,M,g,h,Y,I,P,R,W,N,f,D,H,s,V,J,d,F,X,_,K,q,$,tt,it,v,nt,w,et,st,j,A,T,b,A,ot,y,z,C,m,p,L,x,A,A,m,p,ct,rt,ut,S,O,at,lt,Mt,gt,ht,It,k,b,p,Nt,p,p,p,b,E,ft,Dt,dt,vt,wt,E;if(void 0===Z&&(Z=1),o=i.x,c=i.y,r=i.width,u=i.height,a=n.sheet,G=n.sheetArea,l=n.isPrinting,B=n.needTopGridline,Q=n.needLeftGridline,i=null!=(i=n.printZoomFactor)?i:1,M=[],g=[],h=[],Y=!0,I=[],P=a.BO(),R=s.rowCount,W=s.colCount,N=s.rowSize,f=s.colSize,D=s.cellStyleList,H=s.sparklines,e.HY(U),V=(s=e.zY()).baseRow,J=s.baseCol,F=(d=e.VY).hl,d.cg(new jt.Rect(0,0,r,u)),(X=new jt.Yx(d,d._y(1,3),d.Yy(1,3),3)).JCe.oTe(!0),_=e.YY(!0),c+=1,--u,o+=1,--r,q=K=0,N=N.map(function(t){var i=t.size*u,n=zt(i);return 1<=(q+=i-n)&&(n++,q--),{start:zt(t.start*u),size:n}}),f=f.map(function(t){var i=t.size*r,n=zt(i);return 1<=(K+=i-n)&&(n++,K--),{start:zt(t.start*r),size:n}}),$=d.options.rightToLeft){for(tt=[],it=0,v=W-1;0<=v;v--)tt.push({start:it,size:f[v].size}),it+=f[v].size;tt.reverse(),f=tt}for(nt=d.conditionalFormats,w=0;w<R;w++){for(et={row:w+V,y:c,height:u},st=[],j=0;j<W;j++)if(D[w][j]&&(T=(A=D[w][j]).style,b=A.isSpan,A=A.span,ot=!1,y=_[w][j],!b||A)){if(T=T.clone(!0),z=zt(o+f[j].start),C=zt(c+N[w].start),p=m=void 0,L=b?A.colCount:1,x=b?A.rowCount:1,m=f[A=$?j-L:j+L]?f[A].start:r,A=zt(m-f[j].start),p=N[w+x]?N[w+x].start:u,m=zt(p-N[w].start),et.y=C,et.height=m,y.formatStyle&&(y.formatStyle.h5(T),T=y.formatStyle),T.v5(F),p=yt,b){for(p={row:w,col:j,x:zt(z),y:zt(C),width:zt(A),height:zt(m),rowCount:x,colCount:L},ct={},rt={},ut=[],O=S=void 0,S=lt=at=0;S<L-1;S++)gt=(Mt=f[j+S])?Mt.size:0,at+=rt[S]=gt;for(rt[S]=zt(A)-at,O=0;O<x-1;O++)gt=(ht=N[w+O])?ht.size:0,lt+=ct[O]=gt;for(ct[O]=zt(m)-lt,O=0;O<x;O++){for(It=[],k=0;k<L;k++)D[O+w]&&D[O+w][j+k]&&It.push(D[O+w][j+k].style);ut.push(It)}p.spanSizeInfo={styleList:ut,rowSizes:ct,colSizes:rt}}X.PN(w,j,zt(z),zt(C),zt(A),zt(m),T,p,B&&0===w,Q&&0===j),(b=T.formatter)&&(jt.util.St(b)?(p=a.parent&&a.parent.xO(b))&&(Nt=p.getExpression())&&(p=(0,Tt.formulaToExpression)(a,b.replace("@",JSON.stringify(y.value)),0,0,void 0,!1),(p=(0,Tt.evaluateExpression)(a,p,0,0))instanceof At.CalcError||(y.value=p)):(p=(0,jt.mKe)(b,y.value))&&(T.foreColor=p)),b=null,H[w][j]&&(b=H[w][j].clone())&&(b.ZY=d.name(),b.WY=b.QY(d),b.KY=b.JY(d),b.XY=d),y&&y.value&&"SparklineExValue"===y.value.typeName&&(I.push({value:y.value,x:z,y:C,width:A,height:m,option:n}),ot=!0),y.validStyle&&g.push({style:y.validStyle,x:z,y:C,width:A,height:m}),st.push({col:j+J,x:z,y:C,width:A,height:m}),M.push({data:ot?null:y.value,row:w,col:j,x:z,y:C,width:A,height:m,style:T,sparkline:b,baseRow:w+V,baseCol:j+J,conditionalFormats:nt,imageLoader:P,cellLayout:{row:w,col:j,x:z,y:C,width:A,height:m}}),T&&T.decoration&&T.decoration.icons&&0<T.decoration.icons.length&&h.push({style:T,x:z,y:C,width:A,height:m})}0<st.length&&d.Dn.mfe(h,st,et,l,a,G)}for(t.save(),B&&(c-=2,u+=4),Q&&(o-=2,r+=4),t.rect(o,c,r,u),t.clip(),0<M.length&&d.Dn.eO(t,M,G,l,i,a,V,J,Z),X.paint(t),0<g.length&&d.Dn.EO(t,g),0<h.length&&d.Dn.que(t,h,{isPrinting:l,printZoomFactor:i,sheet:a,imageLoader:P}),t.restore(),w=0;w<I.length;w++)ft=(E=I[w]).value,Dt=E.x,dt=E.y,vt=E.width,wt=E.height,E=E.option,bt.dn(t,ft,Dt,dt,vt,wt,E)}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,jt=n("Core"),s=n("Bindings"),u=n("Sparkline"),At=n("CalcEngine"),Tt=n("SheetsCalc"),n=jt.CellTypes.Base,bt=jt.CellTypes.Context,yt=null,zt=Math.floor,l.prototype.yN=function(t,i){var n=this,e=i.row,s=i.col,o=i.rowCount,c=i.colCount;return n.FY=e,n.PY=s,n.Sx=o,n.Tx=c,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},l.prototype.eZ=function(){return this.tZ},l.prototype.nZ=function(t,i){for(var n,e,s,o,c,r,u,a,l,M,g,h,I,N,e,s,f,D,d,n=this,e=i.row,s=i.col,o=i.rowCount,c=i.colCount,r=0,u=[],a=0,l=[],M=0,g=e+o,h=s+c,I=e;I<g;I++)M=t.getRowHeight(I),a+=M,l.push(M);for(N=s;N<h;N++)M=t.getColumnWidth(N),r+=M,u.push(M);return M=0,e=l.map(function(t){var i=M/a,n;return M+=t,{start:i,size:t/a}}),M=0,s=u.map(function(t){var i=M/r,n;return M+=t,{start:i,size:t/r}}),f=n.ZF(t,i),{rowCount:o,colCount:c,rowSize:e,colSize:s,cellStyleList:D=n.iZ(t,i,f,e,s),sparklines:d=n.rZ(t,i),totalHeight:a,totalWidth:r}},l.prototype.oZ=function(t,i,n,e,s){for(var o,c,r,u,a,l,M,g,h,o=null,c=0,r=s;c<r.length;c++)if(a=(u=r[c]).rowOffset,l=u.colOffset,M=u.rowCount,g=u.colCount,(h=new jt.Range(a+n,l+e,M,g)).contains(t,i)){o=u;break}return o},l.prototype.aZ=function(t,i,n){for(var e,s,o,e,c,r,u,a,l,M,e=[0,0],s=e[0],o=e[1],e=t.rowOffset,c=t.colOffset,r,u,a=e+t.rowCount,l=c+t.colCount,M=e;M<a;M++)o+=i[M]?i[M].size:0;for(M=c;M<l;M++)s+=n[M]?n[M].size:0;return{width:s,height:o}},l.prototype.iZ=function(t,i,n,e,s){for(var o,c,r,u,a,l,M,g,h,I,o=i.row,c=i.col,r=i.rowCount,u=i.colCount,a=[],l=o;l<o+r;l++){for(M=[],g=c;g<c+u;g++)(h=this.oZ(l,g,o,c,n))&&h.rowOffset+o===l&&h.colOffset+c===g?(I=this.aZ(h,e,s),M.push({style:t.getActualStyle(l,g,3,!0),spanWidth:I.width,spanHeight:I.height,isSpan:!0,span:h})):M.push(h?{style:t.getActualStyle(l,g,3,!0),isSpan:!0}:{style:t.getActualStyle(l,g,3,!0)});a.push(M)}return a},l.prototype.ZF=function(t,i){for(var t,n,e,s,o,c,r,u,a,t=t.Ut.getSpans(),n=[],e=i.row,s=i.col,o=i.rowCount,c=i.colCount,r=0,u=t;r<u.length;r++)(a=u[r]).intersect(e,s,o,c)&&n.push({rowOffset:a.row-e,colOffset:a.col-s,rowCount:a.rowCount,colCount:a.colCount});return n},l.prototype.rZ=function(t,i){for(var n,e,s,o,c,r,u,a,l,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=n;r<n+o;r++){for(u=[],a=e;a<e+s;a++)l=t.getSparkline(r,a),u.push(l?l.clone():null);c.push(u)}return c},l.prototype.toJSON=function(){var t,i,n,e,s,o,c,r,t,u,a,l,M,t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,c=t.sparklines,r=t.totalWidth,t=t.totalHeight,u,a,l,M;return{rowCount:i,colCount:n,rowSize:g(e),colSize:g(s),cellStyleList:o.map(function(t){return t.map(function(t){var i,n,e,s,t;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:s,span:t}):null})}),sparklines:c.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:r,totalHeight:t}},l.prototype.fromJSON=function(t){var i,n,e,s,o,c,r,t,e,s,o,c;t&&(i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,c=t.sparklines,r=t.totalWidth,t=t.totalHeight,e=g(e),s=g(s),o=o.map(function(t){return t.map(function(t){var i,n,e,s,t,o;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,o=null,i&&(o=new jt.Style).fromJSON(i),{style:o,spanWidth:n,spanHeight:e,span:t,isSpan:s}):null})}),c=c.map(function(t){return t.map(function(t){var i,n;if(t&&u.SparklineSetting)return i=new u.Sparkline,n=new u.SparklineSetting(t.setting),i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i})}),this.tZ={rowCount:i,colCount:n,rowSize:e,colSize:s,cellStyleList:o,sparklines:c,totalWidth:r,totalHeight:t})},l.prototype.L0=function(){this.tZ=null},c=l,i.$Y=c,M.prototype.yN=function(t,i,n){var e=this;return e.Z5=i,e.VY=new jt.Worksheet,e.uZ=t.parent&&t.parent.options.allowDynamicArray,e.VY.getCalcService&&(e.VY.getCalcService().allowDynamicArray=e.uZ,e.sZ=e.cZ(t)),e.fZ(t,n),e},M.prototype.cZ=function(t){for(var i,n,e,s,o,c,r,u,a,l,M,g,h,I,M,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=t.b3&&t.b3(),u=n;u<n+o;u++)for(a=e;a<e+s;a++)(l=t.getFormula(u,a))&&(M=r&&r.sT(u,a))&&M.isDynamicArray&&(g=M.row,h=M.col,I=M.rowCount,M=M.colCount,1<I&&c.push({row:g+1,col:h,rowCount:I-1,colCount:M}),1<M)&&c.push({row:g,col:h+1,rowCount:1,colCount:M-1});return c},M.prototype.lZ=function(){var t,i,n,e,s,o,c,r,u,o,t,i=this.sZ,n=this.VY;if(i)for(e=0,s=i;e<s.length;e++)c=(o=s[e]).row,r=o.col,u=o.rowCount,o=o.colCount,n.clear(c,r,u,o,3,1)},M.prototype.HY=function(t){var i,t;s.CellBindingSource&&((i=this.VY).suspendEvent(),t=new s.CellBindingSource(t),this.lZ(),i.setDataSource(t),i.resumeEvent())},M.prototype.fZ=function(t,i){var n,e,t,n,e=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i});delete t.charts,delete t.shapes,e.suspendCalcService(),e.fromJSON(JSON.parse(JSON.stringify(t))),e.resumeCalcService(),this.hZ()},M.prototype.hZ=function(){for(var t,i,n,e,s,o,c,r,u,a,t=this,i=t.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=[],u=n;u<n+o;u++){for(r=[],a=e;a<e+s;a++)r.push(t.dZ(u,a,3));c.push(r)}this.vZ=c},M.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},M.prototype.YY=function(t){for(var i,n,e,s,o,c,r,u,a,l,M,g,h,I,N,f,i=this.VY,n=this.Z5,e=n.row,s=n.col,o=n.colCount,c=n.rowCount,r=[],u=e;u<e+c;u++){for(a=[],M=l=void 0,g=s;g<s+o;g++)h=i.getText(u,g),I=i.getValue(u,g,3,1),N=i.Jt.$t(u,g,3,1),f=i.getBindingPath(u,g),l=this.mZ(u,g,3),M=this.gZ(i,u,g,I,t),a.push({value:N,formatStyle:l,text:h,validStyle:M,bindingPath:f});r.push(a)}return r},M.prototype.dZ=function(t,i,n){var e,t,e;return this.VY.b8&&(t=this.VY.getDataValidator(t,i,n))?t.highlightStyle():null},M.prototype.gZ=function(t,i,n,e,s){var s,t,e;return s&&t.isValid&&!t.isValid(i,n,e)?(t=(s=this.Z5).row,e=s.col,this.vZ[i-t][n-e]):null},M.prototype.mZ=function(t,i,n){var e=this.VY.conditionalFormats;return e?e.bL(new jt.Style,t,i,n):null},M.prototype.getCellValueInfo=function(t){for(var i,n,e,s,o,c,r,u,a,l,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,c=[],r=t.Ut,u=n;u<n+o;u++){for(a=[],l=e;l<e+s;l++)a.push({bindPath:t.getBindingPath(u,l),formula:t.getFormula(u,l),value:r.getValue(u,l,3,yt,1)});c.push(a)}return c},M.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},M.prototype.toJSON=function(){var t,i,n,e,s,o,c,r,t=this.VY,i=this.uZ,n=this.sZ.map(function(t){var i,n,e,s;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),e=this.Z5,s,o,c,r;return{spillRanges:n,allowDynamicArray:i,range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},M.prototype.fromJSON=function(t){var i,n,t,e,s,o,t;t&&((n=(i=this).VY=new jt.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),e=(t=t.range).row,s=t.col,o=t.rowCount,t=t.colCount,i.Z5=new jt.Range(e,s,o,t),this.hZ(),n.resumeCalcService)&&n.resumeCalcService()},M.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},r=M,i.qY=r,e(h,a=n),h.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},h.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},h.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},h.prototype.paintContent=function(t,i,n,e,s,o,c,r){var u,a,a,u=this.UY,a=this.GY;u&&a&&(a=this.GY.eZ(),c.cellPadding&&(r.needTopGridline=!0,r.needLeftGridline=!0),I(t,{x:n,y:e,width:s,height:o},i,r,u,a))},h.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},h.prototype.fromJSON=function(t){t.layout&&(this.GY=new c,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new r,this.UY.fromJSON(t.resolver))},i.RangeTemplate=e=h,jt.CellTypes.ti[16]=e,i.paintRangeTemplate=I},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},Core:function(t){"use strict";t.exports=GC.Spread.Sheets},Bindings:function(t){"use strict";t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){"use strict";t.exports=GC.Spread.Sheets.Sparklines}},e={},t=s("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();
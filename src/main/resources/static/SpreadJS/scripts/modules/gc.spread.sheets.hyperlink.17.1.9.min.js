/*!
 * 
 * SpreadJS Library 17.1.9
 *
 * Copyright(c) MESCIUS inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@mescius.com
 * https://developer.mescius.com/spreadjs
 *
 */
var GC;!function(){"use strict";var e,i,n;function r(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},e[n].call(t.exports,t,t.exports,r)),t.exports}e={"./dist/plugins/hyperlink/hyperlink.js":function(P,n,t){var e,g,f,h,l,i,k,u,t,r,C,o,p,c,s,a,m,d,v,w,$,E,F,T,I,R,V,W,q,B,D,y,J,K,x,b,z,H,_,G,Q,j,O,X,Y,Z,nn,tn,en,rn,M,n,on,un;function S(n,t){return on.call(this,n,t)||this}function A(n,t){return un.call(this,n,t)||this}function U(n,t,e,i){return C(i)&&(i=3),!C(n.getHyperlink(t,e,i))}function ln(){var n=i(K);return u(n).css(w,$).css(E,0).css(R,2).css(V,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(W,D).css(B,J).css(F,"9pt Arial"),n}function sn(n,t,e){var i,r,o,i,r,o,e;e&&(r=(i=n&&n.qc()).getElementsByClassName(x)[0],o=!1,C(r)&&((r=ln()).className=x,i.insertBefore(r,s),o=!0),i=u(r),!o&&i.isVisible()||(i.text(e),o=(r=n.rt.it()).left+t.x,e=r.top+t.y+20,i.css(I,e).css(T,o),i.show()))}function L(n){var t,n,t,n=(n&&n.qc()).getElementsByClassName(x)[0];C(n)||u(n).hide()}function an(n,t){C(t)||(t.drawUnderline&&(C(n.textDecoration)?n.textDecoration=1:0!==n.textDecoration&&1!=(1&n.textDecoration)&&(n.textDecoration+=1)),t.isVisited?t.visitedLinkColor===s?n.foreColor="rgba(0,0,0,0)":t.visitedLinkColor===c?n.foreColor=z:n.foreColor=t.visitedLinkColor:C(t.linkColor)?t.linkColor===c&&(n.foreColor||n.foreColor===s)||(n.foreColor=b):n.foreColor=t.linkColor)}function N(n){if(n&&n.cellType){var n=n.cellType.typeName;if(!rn[n])return 1}}function cn(n,t,e,i,r,o,u){var l,s,a,n,u,l=0,s=0,a=n.width,n=n.height,u=fn(u);return u&&(a-=u),l=o=o||0,1===i?l=(a-t)/2:2===i?l=a-t-o:5===i&&(l=(a-t)/2),1===r?s=(n-e)/2:2===r&&(s=n-e),u&&(l+=u),{x:l,y:s}}function fn(n){var t={context:n,value:0};return r.et(n.sheet,"getOutlineColumnOffset",t),t.value}function hn(n,t){var e,n,e=yn(t),n=n-3-e;return 5===t.hAlign&&(n-=e),--n}function pn(n,t,e,i){var t,e,t=hn(t,e),e=g.q.Gge(n);return 1===e.length&&0===e[0].prefixSpaceCount?a(0,g.q.Wt(e[0].word,i,!0)):t}function dn(n,t,e,i){var r,o,u,r=l(t),o,u;return{x:0,y:0,width:5===e.hAlign?pn(n,i,e,t):a(0,g.q.Wt(n,t,!0)),height:n.split(/\r\n|\r|\n/).length*r}}function vn(n,t,e,i,r,o){var n,e,n=dn(n,e,t,i.width),e=cn(i,n.width,n.height,t.hAlign,t.vAlign,r,o);return n.x=e.x,n.y=e.y,n}function wn(n,t,e,i,r,o){var u,l,u,s,a,c,f,l,u,l,u,h,p,d,v,w,y,l=r.sheet,u=l.Dn;if(!C(e)){if(e.textOrientation)return!0;if(s=l.getValue(r.row,r.col,r.sheetArea),o=o||l.getText(r.row,r.col,r.sheetArea))for(o=o.replace(/\s+/g," "),a=e&&e.font?e.font:u.Nn(),a=u._n(a),c=[o],f=yn(e),l=null!=(u=l.outlineColumn.xme)?u:0,!e.wordWrap&&5!==e.hAlign||(u=i.width-3-f-l,5===e.hAlign&&(u-=f),o=(c=g.q.un(o,u,a)).join("\r\n")),3===(l=e.hAlign)&&(l=k(l,s,e.formatter||e._autoFormatter),e.hAlign=l),u=vn(o,e,a,i,f,r),h=i.y+u.y,p=0;p<c.length;p++)if(d=vn(c[p],e,a,i,f,r),v=i.x+d.x,w=m(v+d.width,i.x+i.width),h=m((y=h)+d.height,i.y+i.height),v<=n&&n<w&&y<=t&&t<h)return!0}return!1}function yn(n){return 8*(n.textIndent||0)}function gn(n,t){var n,e,t,n=n.replace(/:\/*/,"://"),e=(n=n.endsWith("://")?n:n.replace(/\/+$/,"")).endsWith("/")?"":"/",t=t.replace(/^\/+/,"");return"".concat(n).concat(e).concat(t)}e=this&&this.__extends||(M=function(n,t){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}M(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HyperlinkTargetType=void 0,g=t("Core"),f=t("Common"),h=t("SheetsCalc"),l=g.mt.vt,i=g.mt.En,k=g.mt.gt,u=g.GC$,t=g.Commands.ActionBase,r=g.CellTypes.Base,C=f.Common.lt.ht,o=f.Common.lt.tv,p=f.Common.zf.TY,c=void 0,s=null,a=Math.max,m=Math.min,d=window.open,v=f.Common.zf.fJ,w="position",$="absolute",E="margin",F="font",T="left",I="top",R="padding",V="border",W="box-sizing",q="pointer",B="background-color",D="content-box",y="default",J="white",K="div",x="gc-spread-hyperlink-tooltip",z="followedHyperlink",H=b="hyperlink",_="openUrl",G="generateHyperlink",Q=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,j=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,O=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(n=X=n.HyperlinkTargetType||(n.HyperlinkTargetType={}))[n.blank=0]="blank",n[n.self=1]="self",n[n.parent=2]="parent",n[n.top=3]="top",g.GC$.extend(g.Y8.prototype,{getHyperlink:function(n,t,e){var i,r,r;return r={row:n,col:t,sheetArea:e=C(e)?3:e,isLinkGet:!1,hyperlink:c},g.Y8.et(i=this,"getHyperlink",r),r.isLinkGet||(r=i.W_(e).J_(n,t))&&!C(r.hyperlink)?r.hyperlink:s},setHyperlink:function(n,t,e,i){var r,o,u,l,l,s,o,a,r=this;if(C(i)&&(i=3),(o=e&&e.url)&&o.match(O)&&0<o.match(O).length?v(o,u="www.")&&(e.url="http://"+o):o&&o.match(j)&&0<o.match(j).length&&(v(o,l="mailto:")||(e.url=l+o)),l=0<r.P8?[["sheetModels",i],c]:c,s=r.W_(i).J_(n,t,!0,l?l[0]:c),C(s))l&&(l.length=0);else{if(o=s.hyperlink,C(e)){if(C(s.hyperlink))return;s.hyperlink=null,delete s.hyperlink}else for(a in s.hyperlink={url:"",linkColor:c,visitedLinkColor:c,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)e[a]!==c&&(s.hyperlink[a]=e[a]);l&&(l[0].push("hyperlink"),l[1]=o,l[2]=s.hyperlink)}l&&0<l.length&&r.G8.push(l)}}),g.GC$.extend(g.Worksheet.prototype,{getHyperlink:function(n,t,e){var i,r;return 0===e?s:(C(e)&&(e=3),r=(i=this).Ut,o(r.getHyperlink(n,t,e)))},setHyperlink:function(n,t,e,i){var r,o,u,l;0===i||(C(i)&&(i=3),u=(o=(r=this).Ut).getRowCount(i),l=o.getColumnCount(i),n<0)||u<=n||t<0||l<=t||(o.do("setHyperlink",n,t,e,i),this.zw())}}),e(S,on=t),S.prototype.execute=function(){var n,n,t,e,i,r,o,u,t,l,n,l,l,s,l,s,a,a,a,a,c,o,t=this,e=t.Mf,i=!1,r=e.parent,o=e,u=t.tT.url;if(!C(u))if(t=t.tT.target||0,0===(u=(n=null==(n=null==(n=r.docProps)?void 0:n.appDocProps)?void 0:n.hyperlinkBase)!==(l="sjs://")||u.startsWith(n)?u:n+u).indexOf(l)||"#"===u[0]){if(l=l.length,l="#"===u[0]?u.substr(1):u.substr(l),(s=(s=(0,h.formulaToRanges)(e,l,0,0,!(s=void 0)))&&0===s.length?(0,h.formulaToRanges)(e,l,0,0,!1,!0):s)&&0<s.length){if(l=s[0].sheetName,s=s[0].ranges[0],l!==e.name()&&r.getSheetFromName(l).visible()===g.SheetTabVisible.visible){if(a=r.getSheetFromName(l),r.ki(g.Events.ActiveSheetChanging,a={oldSheet:o,newSheet:a,cancel:!1}),a.cancel)return;r.setActiveSheet(l),a=r.getActiveSheetIndex(),r.w2.Tg(a),o!==(e=r.getActiveSheet())&&r.ki(g.Events.ActiveSheetChanged,{oldSheet:o,newSheet:e})}r.getSheetFromName(l).visible()===g.SheetTabVisible.visible&&(e.OA(s.row,s.col),e.setSelection(s.row,s.col,s.rowCount,s.colCount))}}else C(u)||(a="mailto:",u.match(O)&&0<u.match(O).length?v(u,c="www.")&&(u="http://"+u):u.match(j)&&0<u.match(j).length?v(u,a)||(u=a+u):n&&(u=gn(n,u)),v(u,a)&&1<f.Common.zf.DU(u,"?")&&(u=(o=u.split("?"))[0]+"?"+o.slice(1).join("%3F")),d(p(u),["_blank","_self","_parent","_top"][t]));return!1},Y=S,g.Commands[_]={canUndo:!1,execute:function(n,t,e){return g.Commands.zA(n,Y,t,e)}},e(A,un=t),A.prototype.execute=function(){var n,t,e,i,r,o,e,u,l,l,n=this,t=n.Mf,e=n.tT,i=e.url,r=e.row,o=e.col,e=e.sheetArea;if(null===i)u=null;else{if("string"!=typeof i)return!1;if(!((l=(!(l=i.match(O))||l.length<1)&&(!(l=i.match(j))||l.length<1)?i.match(Q):l)&&0<l.length&&0===i.indexOf(l[0])&&i.length===l[0].length))return!1;u={url:i,linkColor:b,visitedLinkColor:z}}return t.Ut.startTransaction(),t.suspendPaint(),t.suspendEvent(),t.setHyperlink(r,o,u,e),t.resumeEvent(),t.resumePaint(),l=g.Commands.TI(t.name()),n.tT[l]=t.Ut.endTransaction(),!0},A.prototype.undo=function(){var n,t,e,n,t=this.Mf;return t.suspendPaint(),t.suspendEvent(),e=g.Commands.TI(t.name()),t.Ut.undo(this.tT[e]),t.resumeEvent(),t.resumePaint(),!0},Z=A,g.Commands[G]={canUndo:!0,execute:function(n,t,e){return g.Commands.zA(n,Z,t,e)}},g.Workbook.ch(H,nn={init:function(){this.commandManager().register(_,g.Commands[_]),this.commandManager().register(G,g.Commands[G])}}),g.Worksheet.ch(H,tn={setHyperlinkWhenEditing:function(n){var t,e,i,n,r,o,t=n.url,e=n.row,i=n.col,n=n.sheetArea,r=this,o=r.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:G,sheetName:r.name(),url:t,row:e,col:i,sheetArea:n})}}),r.ch(H,en={applyHyperlinkStyle:function(n){var t,e,i,r,t,t=n.sheet,e=n.row,i=n.col,r=n.style,t=t.getHyperlink(e,i,n.sheetArea);N(r)||an(r,t)},getCellTextHitInfo:function(n){var t,e,i,r,o,u,l,s,a,c,f,c,t=n.context.sheetArea,e=n.cellStyle,i=n.context,r=i.sheet,o=i.row,u=i.col;U(r,o,u,t)&&!N(e)&&((l=n.cellRect)&&(s=r.C0(o),a=r.S0(u),c=r.Fi(),f=void 0,r.getSpan(o,u,t)||!C(t)&&3!==t?2===t?f=c.B1(s):1===t&&(f=c.L1(a)):f=c.c9(s,a),f)&&(l=l.getIntersectRect(f)),!C(t)||3===t)&&e&&l&&(c=r.getText(o,u,t),n.paddingHitInfo={row:o,col:u,x:n.x,y:n.y,sheetArea:t,sheet:r,isFocusAware:!0,isReservedLocation:wn(n.x,n.y,e,l,i,c)})},processMouseUpOnCellPadding:function(n){var t,e,i,r,o,e,n,e,n,e,t=n.sheet,e=n.cellStyle,i=n.row,r=n.col,o=n.sheetArea;t&&!t.isEditing()&&U(t,i,r,o)&&!N(e)&&n.isReservedLocation&&(e=t.Dg(),L(t),e&&(e.style.cursor=y),(n=t.Ut.getHyperlink(i,r,o)).isVisited=!0,e=n.command,C(e)||""===e||e===_?t.getParent().commandManager().execute({cmd:_,sheetName:t.name(),url:n.url,target:n.target}):"string"==typeof e?t.getParent().commandManager().execute({cmd:e,row:i,col:r,sheetName:t.name(),sheetArea:o}):"function"==typeof e&&e.call(s,t,i,r,o),n=t.getColumnCount(),e=new g.Range(i,-1,1,n),t.repaint(t.getRangeRect(1,1,e)))},processMouseMoveOnCellPadding:function(n){var t,e,i,r,o,r,t,t=n.row,e=n.col,i=n.sheet,r=n.cellStyle,o=n.sheetArea;!U(i,t,e,o)||N(r)||!i||i.isEditing()&&i.getActiveRowIndex()===t&&i.getActiveColumnIndex()===e||(r=i.Dg(),t=i.getHyperlink(t,e,o),n.isReservedLocation?r&&(sn(i,n,t.tooltip),r.style.cursor=q):(L(i),r&&(r.style.cursor=y)))},processMouseLeaveOnCellPadding:function(n){var t,e,i,n,e,t=n.sheet,e=n.row,i=n.col,n=n.sheetArea;L(t),U(t,e,i,n)&&t&&(e=t.Dg())&&(e.style.cursor=y)},onUpdateContainer:function(n){var t,e,i,n,t=n.cellStyle,e=n.context.row,i=n.context.col,n=n.context.sheet.getHyperlink(e,i);N(t)||an(t,n)}}),rn={0:!0,1:!0,2:!0,3:!0,4:!0}},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={},n=r("./dist/plugins/hyperlink/hyperlink.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Hyperlink=n}();